import{r as a,j as e,d as w}from"./app-BL23_ioL.js";import{C as h,b as u,c as j,a as f,d as C}from"./card-BPYLlYs-.js";import{B as p}from"./badge-J0MIFrA3.js";import{T as S,a as T,b as l,c as r,d as _,e as s}from"./table-DCctSBnV.js";import{B as y}from"./button-ErPUhfKM.js";import{C as D}from"./circle-check-big-Y3jfL0jT.js";import{R as H}from"./refresh-cw-5teAx7Zi.js";import{f as g}from"./format-BOcL19nD.js";/* empty css            */import"./toDate-DPY-_nel.js";function I({examId:n}){const[d,b]=a.useState(null),[c,o]=a.useState(!0),[N,v]=a.useState(new Date),[m,x]=a.useState(null),i=async()=>{try{o(!0);const t=await w.get(route("admin.exams.monitor",{exam:n}));b(t.data),v(new Date),x(null)}catch(t){console.error("Failed to fetch monitor data:",t),x("Failed to load monitoring data.")}finally{o(!1)}};return a.useEffect(()=>{i();const t=setInterval(i,3e4);return()=>clearInterval(t)},[n]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Total Participants"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(f,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[d?.participated_count||0," / ",d?.total_students||"-"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Students who started the exam"})]})]})}),e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:"Live Monitor"}),e.jsxs(C,{children:["Last updated: ",N.toLocaleTimeString()]})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:i,disabled:c,children:[e.jsx(H,{className:`mr-2 h-4 w-4 ${c?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs(f,{children:[m&&e.jsx("div",{className:"text-red-500 mb-4",children:m}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(S,{children:[e.jsx(T,{children:e.jsxs(l,{children:[e.jsx(r,{children:"Student"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Attempt"}),e.jsx(r,{children:"Start Time"}),e.jsx(r,{children:"Score"})]})}),e.jsx(_,{children:d?.sessions.length===0?e.jsx(l,{children:e.jsx(s,{colSpan:5,className:"text-center h-24 text-muted-foreground",children:"No students have started this exam yet."})}):d?.sessions.map(t=>e.jsxs(l,{children:[e.jsx(s,{className:"font-medium",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.user.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.user.email})]})})}),e.jsx(s,{children:t.is_finished?e.jsx(p,{variant:"secondary",className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Finished"}):e.jsx(p,{variant:"outline",className:"border-blue-200 text-blue-700 bg-blue-50",children:"Ongoing"})}),e.jsxs(s,{children:["#",t.attempt_number]}),e.jsxs(s,{children:[t.start_time?g(new Date(t.start_time),"MMM d, HH:mm"):"-",t.finish_time&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Finished: ",g(new Date(t.finish_time),"HH:mm")]})]}),e.jsx(s,{children:t.total_score!==void 0&&t.total_score!==null?e.jsx("span",{className:"font-bold",children:t.total_score}):e.jsx("span",{className:"text-muted-foreground",children:"-"})})]},t.id))})]})})]})]})]})}export{I as default};

import{f as Ld,g as nm,R as Xr,r as Ne,j as he,c as _l,e as t4}from"./app-DyN-wpxS.js";import{r as rm,R as r6}from"./index-CNe1fd7B.js";import{r as i6,s as n4}from"./index-Bw4bqpEh.js";import{c as Zr,a as rl,B as Cn}from"./button-CdyPjVIa.js";import{I as r4}from"./input-x6uegPVQ.js";import{X as i4}from"./x-lNOBUcxD.js";import{C as o6}from"./checkbox-CA68c0MG.js";const s6=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],a6=Zr("Bold",s6);const l6=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],u6=Zr("Italic",l6);const c6=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],o4=Zr("Keyboard",c6);const d6=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],v0=Zr("Languages",d6);const h6=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],p6=Zr("ListOrdered",h6);const f6=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],m6=Zr("List",f6);const g6=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],s4=Zr("Move",g6);const y6=[["path",{d:"M18 7V5a1 1 0 0 0-1-1H6.5a.5.5 0 0 0-.4.8l4.5 6a2 2 0 0 1 0 2.4l-4.5 6a.5.5 0 0 0 .4.8H17a1 1 0 0 0 1-1v-2",key:"wuwx1p"}]],b6=Zr("Sigma",y6);const v6=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],x6=Zr("Underline",v6);function on(t){this.content=t}on.prototype={constructor:on,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),o=r.content.slice();return i==-1?o.push(n||t,e):(o[i+1]=e,n&&(o[i]=n)),new on(o)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new on(n)},addToStart:function(t,e){return new on([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new on(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),o=r.find(t);return i.splice(o==-1?i.length:o,0,e,n),new on(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=on.from(t),t.size?new on(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=on.from(t),t.size?new on(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=on.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};on.from=function(t){if(t instanceof on)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new on(e)};function a4(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),o=e.child(r);if(i==o){n+=i.nodeSize;continue}if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){let s=a4(i.content,o.content,n+1);if(s!=null)return s}n+=i.nodeSize}}function l4(t,e,n,r){for(let i=t.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:n,b:r};let s=t.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){n-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){let u=0,c=Math.min(s.text.length,a.text.length);for(;u<c&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){let u=l4(s.content,a.content,n-1,r-1);if(u)return u}n-=l,r-=l}}class se{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,o){for(let s=0,a=0;a<n;s++){let l=this.content[s],u=a+l.nodeSize;if(u>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let c=a+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,n-c),r,i+c)}a=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let o="",s=!0;return this.nodesBetween(e,n,(a,l)=>{let u=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&u||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new se(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let o=0,s=0;s<n;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,n-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,n-s-1))),r.push(a),i+=a.nodeSize),s=l}return new se(r,i)}cutByIndex(e,n){return e==n?se.empty:e==0&&n==this.content.length?this:new se(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new se(i,o)}addToStart(e){return new se([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new se(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return a4(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return l4(this,e,n,r)}findIndex(e){if(e==0)return Pl(0,e);if(e==this.size)return Pl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),o=r+i.nodeSize;if(o>=e)return o==e?Pl(n+1,o):Pl(n,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return se.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new se(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return se.empty;let n,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(n||(n=e.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new se(n||e,r)}static from(e){if(!e)return se.empty;if(e instanceof se)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new se([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}se.empty=new se([],0);const lh={index:0,offset:0};function Pl(t,e){return lh.index=t,lh.offset=e,lh}function wc(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!wc(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!wc(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let gt=class Vp{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))n||(n=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&wc(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Vp.none;if(e instanceof Vp)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};gt.none=[];class kc extends Error{}class ve{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=c4(this.content,e+this.openStart,n);return r&&new ve(r,this.openStart,this.openEnd)}removeBetween(e,n){return new ve(u4(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return ve.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ve(se.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.lastChild)i++;return new ve(e,r,i)}}ve.empty=new ve(se.empty,0,0);function u4(t,e,n){let{index:r,offset:i}=t.findIndex(e),o=t.maybeChild(r),{index:s,offset:a}=t.findIndex(n);if(i==e||o.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(r,o.copy(u4(o.content,e-i-1,n-i-1)))}function c4(t,e,n,r){let{index:i,offset:o}=t.findIndex(e),s=t.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=c4(s.content,e-o-1,n,s);return a&&t.replaceChild(i,s.copy(a))}function w6(t,e,n){if(n.openStart>t.depth)throw new kc("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new kc("Inconsistent open depths");return d4(t,e,n,0)}function d4(t,e,n,r){let i=t.index(r),o=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let s=d4(t,e,n,r+1);return o.copy(o.content.replaceChild(i,s))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let s=t.parent,a=s.content;return Bo(s,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=k6(n,t);return Bo(o,p4(t,s,a,e,r))}else return Bo(o,Sc(t,e,r))}function h4(t,e){if(!e.type.compatibleContent(t.type))throw new kc("Cannot join "+e.type.name+" onto "+t.type.name)}function Hp(t,e,n){let r=t.node(n);return h4(r,e.node(n)),r}function To(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ka(t,e,n,r){let i=(e||t).node(n),o=0,s=e?e.index(n):i.childCount;t&&(o=t.index(n),t.depth>n?o++:t.textOffset&&(To(t.nodeAfter,r),o++));for(let a=o;a<s;a++)To(i.child(a),r);e&&e.depth==n&&e.textOffset&&To(e.nodeBefore,r)}function Bo(t,e){return t.type.checkContent(e),t.copy(e)}function p4(t,e,n,r,i){let o=t.depth>i&&Hp(t,e,i+1),s=r.depth>i&&Hp(n,r,i+1),a=[];return Ka(null,t,i,a),o&&s&&e.index(i)==n.index(i)?(h4(o,s),To(Bo(o,p4(t,e,n,r,i+1)),a)):(o&&To(Bo(o,Sc(t,e,i+1)),a),Ka(e,n,i,a),s&&To(Bo(s,Sc(n,r,i+1)),a)),Ka(r,null,i,a),new se(a)}function Sc(t,e,n){let r=[];if(Ka(null,t,n,r),t.depth>n){let i=Hp(t,e,n+1);To(Bo(i,Sc(t,e,n+1)),r)}return Ka(e,null,n,r),new se(r)}function k6(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let o=n-1;o>=0;o--)i=e.node(o).copy(se.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class il{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return gt.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new _c(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,o=n;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),u=o-l;if(r.push(s,a,i+l),!u||(s=s.child(a),s.isText))break;o=u-1,i+=l+1}return new il(n,r,o)}static resolveCached(e,n){let r=x0.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==n)return s}else x0.set(e,r=new S6);let i=r.elts[r.i]=il.resolve(e,n);return r.i=(r.i+1)%_6,i}}class S6{constructor(){this.elts=[],this.i=0}}const _6=12,x0=new WeakMap;class _c{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const M6=Object.create(null);let $i=class Wp{constructor(e,n,r,i=gt.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||se.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&wc(this.attrs,n||e.defaultAttrs||M6)&&gt.sameSet(this.marks,r||gt.none)}copy(e=null){return e==this.content?this:new Wp(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Wp(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return ve.empty;let i=this.resolve(e),o=this.resolve(n),s=r?0:i.sharedDepth(n),a=i.start(s),u=i.node(s).content.cut(i.pos-a,o.pos-a);return new ve(u,i.depth-s,o.depth-s)}replace(e,n,r){return w6(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return il.resolveCached(this,e)}resolveNoCache(e){return il.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),f4(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=se.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,n);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=gt.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!gt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=se.fromJSON(e,n.content),o=e.nodeType(n.type).create(n.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};$i.prototype.text=void 0;class Mc extends $i{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):f4(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Mc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Mc(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function f4(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class jo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new C6(e,n);if(r.next==null)return jo.empty;let i=m4(r);r.next&&r.err("Unexpected trailing text");let o=O6(B6(i));return N6(o,r),o}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let o=n;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!n||l.validEnd))return se.from(a.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:d}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let p=o(d,a.concat(c));if(p)return p}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}jo.empty=new jo(!0);class C6{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function m4(t){let e=[];do e.push(E6(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function E6(t){let e=[];do e.push(A6(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function A6(t){let e=T6(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=D6(t,e);else break;return e}function w0(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function D6(t,e){let n=w0(t),r=n;return t.eat(",")&&(t.next!="}"?r=w0(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function L6(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let o in n){let s=n[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function T6(t){if(t.eat("(")){let e=m4(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=L6(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function B6(t){let e=[[]];return i(o(t,0),n()),e;function n(){return e.push([])-1}function r(s,a,l){let u={term:l,to:a};return e[s].push(u),u}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,u)=>l.concat(o(u,a)),[]);if(s.type=="seq")for(let l=0;;l++){let u=o(s.exprs[l],a);if(l==s.exprs.length-1)return u;i(u,a=n())}else if(s.type=="star"){let l=n();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=n();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let u=0;u<s.min;u++){let c=n();i(o(s.expr,l),c),l=c}if(s.max==-1)i(o(s.expr,l),l);else for(let u=s.min;u<s.max;u++){let c=n();r(l,c),i(o(s.expr,l),c),l=c}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function g4(t,e){return e-t}function k0(t,e){let n=[];return r(e),n.sort(g4);function r(i){let o=t[i];if(o.length==1&&!o[0].term)return r(o[0].to);n.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&n.indexOf(l)==-1&&r(l)}}}function O6(t){let e=Object.create(null);return n(k0(t,0));function n(r){let i=[];r.forEach(s=>{t[s].forEach(({term:a,to:l})=>{if(!a)return;let u;for(let c=0;c<i.length;c++)i[c][0]==a&&(u=i[c][1]);k0(t,l).forEach(c=>{u||i.push([a,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new jo(r.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(g4);o.next.push({type:i[s][0],next:e[a.join(",")]||n(a)})}return o}}function N6(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:u}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function y4(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function b4(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let o=t[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function v4(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let o=t[i];o.validate&&o.validate(e[i])}}function x4(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new I6(t,r,e[r]);return n}let S0=class w4{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=x4(e,r.attrs),this.defaultAttrs=y4(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==jo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:b4(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new $i(this,this.computeAttrs(e),se.from(n),gt.setFrom(r))}createChecked(e=null,n,r){return n=se.from(n),this.checkContent(n),new $i(this,this.computeAttrs(e),n,gt.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=se.from(n),n.size){let s=this.contentMatch.fillBefore(n);if(!s)return null;n=s.append(n)}let i=this.contentMatch.matchFragment(n),o=i&&i.fillBefore(se.empty,!0);return o?new $i(this,e,n.append(o),gt.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){v4(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:gt.none:e}static compile(e,n){let r=Object.create(null);e.forEach((o,s)=>r[o]=new w4(o,n,s));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function P6(t,e,n){let r=n.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${o}`)}}class I6{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?P6(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Td{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=x4(e,i.attrs),this.excluded=null;let o=y4(this.attrs);this.instance=o?new gt(this,o):null}create(e=null){return!e&&this.instance?this.instance:new gt(this,b4(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Td(o,i++,n,s)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){v4(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class k4{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=on.from(e.nodes),n.marks=on.from(e.marks||{}),this.nodes=S0.compile(this.spec.nodes,this),this.marks=Td.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=jo.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?_0(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:_0(this,s.split(" "))}this.nodeFromJSON=i=>$i.fromJSON(this,i),this.markFromJSON=i=>gt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof S0){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Mc(r,r.defaultAttrs,e,gt.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function _0(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],o=t.marks[i],s=o;if(o)n.push(o);else for(let a in t.marks){let l=t.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function R6(t){return t.tag!=null}function z6(t){return t.style!=null}class Ki{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(R6(i))this.tags.push(i);else if(z6(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,n={}){let r=new C0(this,n,!1);return r.addAll(e,gt.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new C0(this,n,!0);return r.addAll(e,gt.none,n.from,n.to),ve.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(K6(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,n,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(s.getAttrs){let l=s.getAttrs(n);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let n=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<n.length;s++){let a=n[s];if((a.priority==null?50:a.priority)<o)break}n.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=E0(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=E0(s)),s.node||s.ignore||s.mark||(s.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Ki(e,Ki.schemaRules(e)))}}const S4={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},F6={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},_4={ol:!0,ul:!0},ol=1,Up=2,ja=4;function M0(t,e,n){return e!=null?(e?ol:0)|(e==="full"?Up:0):t&&t.whitespace=="pre"?ol|Up:n&~ja}class Il{constructor(e,n,r,i,o,s){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=gt.none,this.match=o||(s&ja?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(se.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ol)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let n=se.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(se.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!S4.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class C0{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,o,s=M0(null,n.preserveWhitespace,0)|(r?ja:0);i?o=new Il(i.type,i.attrs,gt.none,!0,n.topMatch||i.type.contentMatch,s):r?o=new Il(null,null,gt.none,!0,null,s):o=new Il(e.schema.topNodeType,null,gt.none,!0,null,s),this.nodes=[o],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,o=i.options&Up?"full":this.localPreserveWS||(i.options&ol)>0,{schema:s}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(s.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),n,!0),a[l]&&this.insertNode(s.text(a[l]),n,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(s.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;_4.hasOwnProperty(s)&&this.parser.normalizeLists&&$6(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:F6.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,c=this.needsBlock;if(S4.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),u=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),u&&this.sync(o),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,l,u,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(u=>!l.clearMark(u)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,i){let o,s;if(n.node)if(s=this.parser.schema.nodes[n.node],s.isLeaf)this.insertNode(s.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(s,n.attrs||null,r,n.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,n,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,n);this.findAtPoint(e,o)}findPlace(e,n,r){let i,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],u=l.findWrapping(e);if(u&&(!i||i.length>u.length+a)&&(i=u,o=l,!u.length))break;if(l.solid){if(r)break;a+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)n=this.enterInner(i[s],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(n=this.enterInner(o,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=gt.none;for(let a of i.concat(e.marks))(o.type?o.type.allowsMarkType(a.type):A0(a.type,e.type))&&(s=a.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,n,r,i){let o=this.findPlace(e.create(n),r,!1);return o&&(o=this.enterInner(e,n,r,!0,i)),o}enterInner(e,n,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=M0(e,o,s.options);s.options&ja&&s.content.length==0&&(a|=ja);let l=gt.none;return r=r.filter(u=>(s.type?s.type.allowsMarkType(u.type):A0(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new Il(e,n,l,i,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=ol)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let u=n[a];if(u==""){if(a==n.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let c=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;l--}}return!0};return s(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function $6(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&_4.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function K6(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function E0(t){let e={};for(let n in t)e[n]=t[n];return e}function A0(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:u,next:c}=a.edge(l);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Xo{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=uh(n).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let u=s.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(o[a][0])||u.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let u=s.marks[l++],c=this.serializeMark(u,s.isInline,n);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=nc(uh(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&nc(uh(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return nc(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Xo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=D0(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return D0(e.marks)}}function D0(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function uh(t){return t.document||window.document}const L0=new WeakMap;function j6(t){let e=L0.get(t);return e===void 0&&L0.set(t,e=q6(t)),e}function q6(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function nc(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=j6(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let a,l=n?t.createElementNS(n,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let d in u)if(u[d]!=null){let p=d.indexOf(" ");p>0?l.setAttributeNS(d.slice(0,p),d.slice(p+1),u[d]):d=="style"&&l.style?l.style.cssText=u[d]:l.setAttribute(d,u[d])}}for(let d=c;d<e.length;d++){let p=e[d];if(p===0){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:g}=nc(t,p,n,r);if(l.appendChild(f),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}const M4=65535,C4=Math.pow(2,16);function V6(t,e){return t+e*C4}function T0(t){return t&M4}function H6(t){return(t-(t&M4))/C4}const E4=1,A4=2,rc=4,D4=8;class Jp{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&D4)>0}get deletedBefore(){return(this.delInfo&(E4|rc))>0}get deletedAfter(){return(this.delInfo&(A4|rc))>0}get deletedAcross(){return(this.delInfo&rc)>0}}class Rn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Rn.empty)return Rn.empty}recover(e){let n=0,r=T0(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+H6(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[a+o],c=this.ranges[a+s],d=l+u;if(e<=d){let p=u?e==l?-1:e==d?1:n:n,f=l+i+(p<0?0:c);if(r)return f;let g=e==(n<0?l:d)?null:V6(a/3,e-l),x=e==l?A4:e==d?E4:rc;return(n<0?e!=l:e!=d)&&(x|=D4),new Jp(f,x,g)}i+=c-u}return r?e+i:new Jp(e+i,0,null)}touches(e,n){let r=0,i=T0(n),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let u=this.ranges[a+o],c=l+u;if(e<=c&&a==i*3)return!0;r+=this.ranges[a+s]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),u=this.ranges[i+n],c=this.ranges[i+r];e(a,a+u,l,l+c),o+=c-u}}invert(){return new Rn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Rn.empty:new Rn(e<0?[0,-e,0]:[0,0,e])}}Rn.empty=new Rn([]);class sl{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new sl(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new sl;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Jp(e,i,null)}}const ch=Object.create(null);class mn{getMap(){return Rn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=ch[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in ch)throw new RangeError("Duplicate use of step JSON ID "+e);return ch[e]=n,n.prototype.jsonID=e,n}}class $t{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new $t(e,null)}static fail(e){return new $t(null,e)}static fromReplace(e,n,r,i){try{return $t.ok(e.replace(n,r,i))}catch(o){if(o instanceof kc)return $t.fail(o.message);throw o}}}function im(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let o=t.child(i);o.content.size&&(o=o.copy(im(o.content,e,o))),o.isInline&&(o=e(o,n,i)),r.push(o)}return se.fromArray(r)}class Ni extends mn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new ve(im(n.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),n.openStart,n.openEnd);return $t.fromReplace(e,this.from,this.to,o)}invert(){return new ar(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ni(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ni(n.from,n.to,e.markFromJSON(n.mark))}}mn.jsonID("addMark",Ni);class ar extends mn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new ve(im(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return $t.fromReplace(e,this.from,this.to,r)}invert(){return new Ni(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ar(n.pos,r.pos,this.mark)}merge(e){return e instanceof ar&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ar(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ar(n.from,n.to,e.markFromJSON(n.mark))}}mn.jsonID("removeMark",ar);class Pi extends mn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return $t.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return $t.fromReplace(e,this.pos,this.pos+1,new ve(se.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new Pi(this.pos,n.marks[i]);return new Pi(this.pos,this.mark)}}return new qo(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Pi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Pi(n.pos,e.markFromJSON(n.mark))}}mn.jsonID("addNodeMark",Pi);class qo extends mn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return $t.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return $t.fromReplace(e,this.pos,this.pos+1,new ve(se.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new Pi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new qo(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new qo(n.pos,e.markFromJSON(n.mark))}}mn.jsonID("removeNodeMark",qo);class Gt extends mn{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Gp(e,this.from,this.to)?$t.fail("Structure replace would overwrite content"):$t.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Rn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Gt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Gt(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Gt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?ve.empty:new ve(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Gt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?ve.empty:new ve(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Gt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Gt(n.from,n.to,ve.fromJSON(e,n.slice),!!n.structure)}}mn.jsonID("replace",Gt);class Yt extends mn{constructor(e,n,r,i,o,s,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Gp(e,this.from,this.gapFrom)||Gp(e,this.gapTo,this.to)))return $t.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return $t.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?$t.fromReplace(e,this.from,this.to,r):$t.fail("Content does not fit in gap")}getMap(){return new Rn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Yt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||o>r.pos?null:new Yt(n.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Yt(n.from,n.to,n.gapFrom,n.gapTo,ve.fromJSON(e,n.slice),n.insert,!!n.structure)}}mn.jsonID("replaceAround",Yt);function Gp(t,e,n){let r=t.resolve(e),i=n-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function W6(t,e,n,r){let i=[],o=[],s,a;t.doc.nodesBetween(e,n,(l,u,c)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let p=Math.max(u,e),f=Math.min(u+l.nodeSize,n),g=r.addToSet(d);for(let x=0;x<d.length;x++)d[x].isInSet(g)||(s&&s.to==p&&s.mark.eq(d[x])?s.to=f:i.push(s=new ar(p,f,d[x])));a&&a.to==p?a.to=f:o.push(a=new Ni(p,f,r))}}),i.forEach(l=>t.step(l)),o.forEach(l=>t.step(l))}function U6(t,e,n,r){let i=[],o=0;t.doc.nodesBetween(e,n,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof Td){let u=s.marks,c;for(;c=r.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let u=Math.min(a+s.nodeSize,n);for(let c=0;c<l.length;c++){let d=l[c],p;for(let f=0;f<i.length;f++){let g=i[f];g.step==o-1&&d.eq(i[f].style)&&(p=g)}p?(p.to=u,p.step=o):i.push({style:d,from:Math.max(a,e),to:u,step:o})}}}),i.forEach(s=>t.step(new ar(s.from,s.to,s.style)))}function om(t,e,n,r=n.contentMatch,i=!0){let o=t.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let u=o.child(l),c=a+u.nodeSize,d=r.matchType(u.type);if(!d)s.push(new Gt(a,c,ve.empty));else{r=d;for(let p=0;p<u.marks.length;p++)n.allowsMarkType(u.marks[p].type)||t.step(new ar(a,c,u.marks[p]));if(i&&u.isText&&n.whitespace!="pre"){let p,f=/\r?\n|\r/g,g;for(;p=f.exec(u.text);)g||(g=new ve(se.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),s.push(new Gt(a+p.index,a+p.index+p[0].length,g))}}a=c}if(!r.validEnd){let l=r.fillBefore(se.empty,!0);t.replace(a,a,new ve(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function J6(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ea(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,i=0,o=0;;--r){let s=t.$from.node(r),a=t.$from.index(r)+i,l=t.$to.indexAfter(r)-o;if(r<t.depth&&s.canReplace(a,l,n))return r;if(r==0||s.type.spec.isolating||!J6(s,a,l))break;a&&(i=1),l<s.childCount&&(o=1)}return null}function G6(t,e,n){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,u=a,c=se.empty,d=0;for(let g=o,x=!1;g>n;g--)x||r.index(g)>0?(x=!0,c=se.from(r.node(g).copy(c)),d++):l--;let p=se.empty,f=0;for(let g=o,x=!1;g>n;g--)x||i.after(g+1)<i.end(g)?(x=!0,p=se.from(i.node(g).copy(p)),f++):u++;t.step(new Yt(l,u,s,a,new ve(c.append(p),d,f),c.size-d,!0))}function sm(t,e,n=null,r=t){let i=X6(t,e),o=i&&Y6(r,e);return o?i.map(B0).concat({type:e,attrs:n}).concat(o.map(B0)):null}function B0(t){return{type:t,attrs:null}}function X6(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return n.canReplaceWith(r,i,s)?o:null}function Y6(t,e){let{parent:n,startIndex:r,endIndex:i}=t,o=n.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;l&&u<i;u++)l=l.matchType(n.child(u).type);return!l||!l.validEnd?null:s}function Z6(t,e,n){let r=se.empty;for(let s=n.length-1;s>=0;s--){if(r.size){let a=n[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=se.from(n[s].type.create(n[s].attrs,r))}let i=e.start,o=e.end;t.step(new Yt(i,o,i,o,new ve(r,0,0),n.length,!0))}function Q6(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,n,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&e8(t.doc,t.mapping.slice(o).map(a),r)){let u=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",g=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!g?u=!1:!f&&g&&(u=!0)}u===!1&&T4(t,s,a,o),om(t,t.mapping.slice(o).map(a,1),r,void 0,u===null);let c=t.mapping.slice(o),d=c.map(a,1),p=c.map(a+s.nodeSize,1);return t.step(new Yt(d,p,d+1,p-1,new ve(se.from(r.create(l,null,s.marks)),0,0),1,!0)),u===!0&&L4(t,s,a,o),!1}})}function L4(t,e,n,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=t.mapping.slice(r).map(n+1+o+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function T4(t,e,n,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(r).map(n+1+o);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function e8(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function t8(t,e,n,r,i){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(r,null,i||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Yt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new ve(se.from(s),0,0),1,!0))}function Wr(t,e,n=1,r){let i=t.resolve(e),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>o;u--,c--){let d=i.node(u),p=i.index(u);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(p,d.childCount),g=r&&r[c+1];g&&(f=f.replaceChild(0,g.type.create(g.attrs)));let x=r&&r[c]||d;if(!d.canReplace(p+1,d.childCount)||!x.type.validContent(f))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function n8(t,e,n=1,r){let i=t.doc.resolve(e),o=se.empty,s=se.empty;for(let a=i.depth,l=i.depth-n,u=n-1;a>l;a--,u--){o=se.from(i.node(a).copy(o));let c=r&&r[u];s=se.from(c?c.type.create(c.attrs,s):i.node(a).copy(s))}t.step(new Gt(e,e,new ve(o.append(s),n,n),!0))}function Qi(t,e){let n=t.resolve(e),r=n.index();return B4(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function r8(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?t.type.schema.nodes.text:o.type;if(n=n.matchType(s),!n||!t.type.allowsMarks(o.marks))return!1}return n.validEnd}function B4(t,e){return!!(t&&e&&!t.isLeaf&&r8(t,e))}function Bd(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):n>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&B4(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function i8(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,o=t.doc.resolve(e-n),s=o.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);c&&!d?r=!1:!c&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);T4(t,c.node(),c.before(),a)}s.inlineContent&&om(t,e+n-1,s,o.node().contentMatchAt(o.index()),r==null);let l=t.mapping.slice(a),u=l.map(e-n);if(t.step(new Gt(u,l.map(e+n,-1),ve.empty,!0)),r===!0){let c=t.doc.resolve(u);L4(t,c.node(),c.before(),t.steps.length)}return t}function o8(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,n))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function O4(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let o=0;o<n.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(n.openStart==0&&n.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(l,l,i);else{let d=u.contentMatchAt(l).findWrapping(i.firstChild.type);c=d&&u.canReplaceWith(l,l,d[0])}if(c)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function Od(t,e,n=e,r=ve.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),o=t.resolve(n);return N4(i,o,r)?new Gt(e,n,r):new s8(i,o,r).fit()}function N4(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class s8{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=se.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=se.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new ve(o,s,a);return e>-1?new Yt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new Gt(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=n.firstChild;if(n.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}n=o.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=dh(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:u}=this.frontier[a],c,d=null;if(n==1&&(s?u.matchType(s.type)||(d=u.fillBefore(se.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(n==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=dh(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new ve(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=dh(e,n);if(i.childCount<=1&&n>0){let o=e.size-n<=n+i.size;this.unplaced=new ve(Oa(e,n-1,1),n-1,o?n-1:r)}else this.unplaced=new ve(Oa(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:o}){for(;this.depth>n;)this.closeFrontierNode();if(o)for(let x=0;x<o.length;x++)this.openFrontierNode(o[x]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,u=0,c=[],{match:d,type:p}=this.frontier[n];if(i){for(let x=0;x<i.childCount;x++)c.push(i.child(x));d=d.matchFragment(i)}let f=a.size+e-(s.content.size-s.openEnd);for(;u<a.childCount;){let x=a.child(u),w=d.matchType(x.type);if(!w)break;u++,(u>1||l==0||x.content.size)&&(d=w,c.push(P4(x.mark(p.allowedMarks(x.marks)),u==1?l:0,u==a.childCount?f:-1)))}let g=u==a.childCount;g||(f=-1),this.placed=Na(this.placed,n,se.from(c)),this.frontier[n].match=d,g&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let x=0,w=a;x<f;x++){let k=w.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),w=k.content}this.unplaced=g?e==0?ve.empty:new ve(Oa(s.content,e-1,1),e-1,f<0?s.openEnd:e-1):new ve(Oa(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!hh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],o=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),s=hh(e,n,i,r,o);if(s){for(let a=n-1;a>=0;a--){let{match:l,type:u}=this.frontier[a],c=hh(e,a,u,l,!0);if(!c||c.childCount)continue e}return{depth:n,fit:s,move:o?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Na(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Na(this.placed,this.depth,se.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(se.empty,!0);n.childCount&&(this.placed=Na(this.placed,this.frontier.length,n))}}function Oa(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Oa(t.firstChild.content,e-1,n)))}function Na(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Na(t.lastChild.content,e-1,n)))}function dh(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function P4(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,P4(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(se.empty,!0)))),t.copy(r)}function hh(t,e,n,r,i){let o=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!a8(n,o.content,s)?a:null}function a8(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function l8(t){return t.spec.defining||t.spec.definingForContent}function u8(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),o=t.doc.resolve(n);if(N4(i,o,r))return t.step(new Gt(e,n,r));let s=R4(i,o);s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let p=i.depth,f=i.pos-1;p>0;p--,f--){let g=i.node(p).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;s.indexOf(p)>-1?a=p:i.before(p)==f&&s.splice(1,0,-p)}let l=s.indexOf(a),u=[],c=r.openStart;for(let p=r.content,f=0;;f++){let g=p.firstChild;if(u.push(g),f==r.openStart)break;p=g.content}for(let p=c-1;p>=0;p--){let f=u[p],g=l8(f.type);if(g&&!f.sameMarkup(i.node(Math.abs(a)-1)))c=p;else if(g||!f.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let f=(p+c+1)%(r.openStart+1),g=u[f];if(g)for(let x=0;x<s.length;x++){let w=s[(x+l)%s.length],k=!0;w<0&&(k=!1,w=-w);let D=i.node(w-1),N=i.index(w-1);if(D.canReplaceWith(N,N,g.type,g.marks))return t.replace(i.before(w),k?o.after(w):n,new ve(I4(r.content,0,r.openStart,f),f,r.openEnd))}}let d=t.steps.length;for(let p=s.length-1;p>=0&&(t.replace(e,n,r),!(t.steps.length>d));p--){let f=s[p];f<0||(e=i.before(f),n=o.after(f))}}function I4(t,e,n,r,i){if(e<n){let o=t.firstChild;t=t.replaceChild(0,o.copy(I4(o.content,e+1,n,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(t).append(t);t=s.append(o.matchFragment(s).fillBefore(se.empty,!0))}return t}function c8(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=o8(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new ve(se.from(r),0,0))}function d8(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),o=R4(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return t.delete(r.before(s),n);t.delete(e,n)}function R4(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let o=t.start(i);if(o<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&n.push(i)}return n}class Is extends mn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return $t.fail("No node at attribute step's position");let r=Object.create(null);for(let o in n.attrs)r[o]=n.attrs[o];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return $t.fromReplace(e,this.pos,this.pos+1,new ve(se.from(i),0,n.isLeaf?0:1))}getMap(){return Rn.empty}invert(e){return new Is(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Is(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Is(n.pos,n.attr,n.value)}}mn.jsonID("attr",Is);class al extends mn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return $t.ok(r)}getMap(){return Rn.empty}invert(e){return new al(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new al(n.attr,n.value)}}mn.jsonID("docAttr",al);let Vs=class extends Error{};Vs=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Vs.prototype=Object.create(Error.prototype);Vs.prototype.constructor=Vs;Vs.prototype.name="TransformError";class z4{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new sl}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Vs(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=ve.empty){let i=Od(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new ve(se.from(r),0,0))}delete(e,n){return this.replace(e,n,ve.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return u8(this,e,n,r),this}replaceRangeWith(e,n,r){return c8(this,e,n,r),this}deleteRange(e,n){return d8(this,e,n),this}lift(e,n){return G6(this,e,n),this}join(e,n=1){return i8(this,e,n),this}wrap(e,n){return Z6(this,e,n),this}setBlockType(e,n=e,r,i=null){return Q6(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return t8(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new Is(e,n,r)),this}setDocAttribute(e,n){return this.step(new al(e,n)),this}addNodeMark(e,n){return this.step(new Pi(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof gt)n.isInSet(r.marks)&&this.step(new qo(e,n));else{let i=r.marks,o,s=[];for(;o=n.isInSet(i);)s.push(new qo(e,o)),i=o.removeFromSet(i);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,n=1,r){return n8(this,e,n,r),this}addMark(e,n,r){return W6(this,e,n,r),this}removeMark(e,n,r){return U6(this,e,n,r),this}clearIncompatible(e,n,r){return om(this,e,n,r),this}}const ph=Object.create(null);class Xe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new h8(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=ve.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:u}=s[a],c=e.mapping.slice(o);e.replaceRange(c.map(l.pos),c.map(u.pos),a?ve.empty:n),a==0&&P0(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),u=l.map(s.pos),c=l.map(a.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),P0(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new $e(e):Ss(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=n<0?Ss(e.node(0),e.node(o),e.before(o+1),e.index(o),n,r):Ss(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,n,r);if(s)return s}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new zn(e.node(0))}static atStart(e){return Ss(e,e,0,0,1)||new zn(e)}static atEnd(e){return Ss(e,e,e.content.size,e.childCount,-1)||new zn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=ph[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in ph)throw new RangeError("Duplicate use of selection JSON ID "+e);return ph[e]=n,n.prototype.jsonID=e,n}getBookmark(){return $e.between(this.$anchor,this.$head).getBookmark()}}Xe.prototype.visible=!0;class h8{constructor(e,n){this.$from=e,this.$to=n}}let O0=!1;function N0(t){!O0&&!t.parent.inlineContent&&(O0=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class $e extends Xe{constructor(e,n=e){N0(e),N0(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Xe.near(r);let i=e.resolve(n.map(this.anchor));return new $e(i.parent.inlineContent?i:r,r)}replace(e,n=ve.empty){if(super.replace(e,n),n==ve.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof $e&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Nd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $e(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let o=Xe.findFrom(n,r,!0)||Xe.findFrom(n,-r,!0);if(o)n=o.$head;else return Xe.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(Xe.findFrom(e,-r,!0)||Xe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new $e(e,n)}}Xe.jsonID("text",$e);class Nd{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Nd(e.map(this.anchor),e.map(this.head))}resolve(e){return $e.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ce extends Xe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),o=e.resolve(i);return r?Xe.near(o):new Ce(o)}content(){return new ve(se.from(this.node),0,0)}eq(e){return e instanceof Ce&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new am(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ce(e.resolve(n.anchor))}static create(e,n){return new Ce(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ce.prototype.visible=!1;Xe.jsonID("node",Ce);class am{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Nd(r,r):new am(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&Ce.isSelectable(r)?new Ce(n):Xe.near(n)}}class zn extends Xe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=ve.empty){if(n==ve.empty){e.delete(0,e.doc.content.size);let r=Xe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new zn(e)}map(e){return new zn(e)}eq(e){return e instanceof zn}getBookmark(){return p8}}Xe.jsonID("all",zn);const p8={map(){return this},resolve(t){return new zn(t)}};function Ss(t,e,n,r,i,o=!1){if(e.inlineContent)return $e.create(t,n);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&Ce.isSelectable(a))return Ce.create(t,n-(i<0?a.nodeSize:0))}else{let l=Ss(t,a,n+i,i<0?a.childCount:0,i,o);if(l)return l}n+=a.nodeSize*i}return null}function P0(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Gt||i instanceof Yt))return;let o=t.mapping.maps[r],s;o.forEach((a,l,u,c)=>{s==null&&(s=c)}),t.setSelection(Xe.near(t.doc.resolve(s),n))}const I0=1,Rl=2,R0=4;class f8 extends z4{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|I0)&~Rl,this.storedMarks=null,this}get selectionSet(){return(this.updated&I0)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Rl,this}ensureMarks(e){return gt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Rl)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Rl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||gt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(n);o=r==n?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,o)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Xe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=R0,this}get scrolledIntoView(){return(this.updated&R0)>0}}function z0(t,e){return!e||!t?t:t.bind(e)}class Pa{constructor(e,n,r){this.name=e,this.init=z0(n.init,r),this.apply=z0(n.apply,r)}}const m8=[new Pa("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Pa("selection",{init(t,e){return t.selection||Xe.atStart(e.doc)},apply(t){return t.selection}}),new Pa("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Pa("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class fh{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=m8.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Pa(r.key,r.spec.state,r))})}}class As{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,u=i?i[s].state:this,c=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new As(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];n[o.name]=o.apply(e,this[o.name],this,n)}return n}get tr(){return new f8(this)}static create(e){let n=new fh(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new As(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new fh(this.schema,e.plugins),r=n.fields,i=new As(n);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new fh(e.schema,e.plugins),o=new As(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=$i.fromJSON(e.schema,n.doc);else if(s.name=="selection")o.selection=Xe.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){o[s.name]=u.fromJSON.call(l,e,n[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function F4(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=F4(i,e,{})),n[r]=i}return n}class Ct{constructor(e){this.spec=e,this.props={},e.props&&F4(e.props,this,this.props),this.key=e.key?e.key.key:$4("plugin")}getState(e){return e[this.key]}}const mh=Object.create(null);function $4(t){return t in mh?t+"$"+ ++mh[t]:(mh[t]=0,t+"$")}class Wt{constructor(e="key"){this.key=$4(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const lm=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function K4(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const j4=(t,e,n)=>{let r=K4(t,n);if(!r)return!1;let i=um(r);if(!i){let s=r.blockRange(),a=s&&ea(s);return a==null?!1:(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(Y4(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Hs(o,"end")||Ce.isSelectable(o)))for(let s=r.depth;;s--){let a=Od(t.doc,r.before(s),r.after(s),ve.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(Hs(o,"end")?Xe.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):Ce.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},g8=(t,e,n)=>{let r=K4(t,n);if(!r)return!1;let i=um(r);return i?q4(t,i,e):!1},y8=(t,e,n)=>{let r=H4(t,n);if(!r)return!1;let i=cm(r);return i?q4(t,i,e):!1};function q4(t,e,n){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let c=a.firstChild;if(!c)return!1;a=c}let u=Od(t.doc,o,l,ve.empty);if(!u||u.from!=o||u instanceof Gt&&u.slice.size>=l-o)return!1;if(n){let c=t.tr.step(u);c.setSelection($e.create(c.doc,o)),n(c.scrollIntoView())}return!0}function Hs(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const V4=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=um(r)}let s=o&&o.nodeBefore;return!s||!Ce.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ce.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function um(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function H4(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const W4=(t,e,n)=>{let r=H4(t,n);if(!r)return!1;let i=cm(r);if(!i)return!1;let o=i.nodeAfter;if(Y4(t,i,e,1))return!0;if(r.parent.content.size==0&&(Hs(o,"start")||Ce.isSelectable(o))){let s=Od(t.doc,r.before(),r.after(),ve.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=t.tr.step(s);a.setSelection(Hs(o,"start")?Xe.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):Ce.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},U4=(t,e,n)=>{let{$head:r,empty:i}=t.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=cm(r)}let s=o&&o.nodeAfter;return!s||!Ce.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ce.create(t.doc,o.pos)).scrollIntoView()),!0)};function cm(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const b8=(t,e)=>{let n=t.selection,r=n instanceof Ce,i;if(r){if(n.node.isTextblock||!Qi(t.doc,n.from))return!1;i=n.from}else if(i=Bd(t.doc,n.from,-1),i==null)return!1;if(e){let o=t.tr.join(i);r&&o.setSelection(Ce.create(o.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},v8=(t,e)=>{let n=t.selection,r;if(n instanceof Ce){if(n.node.isTextblock||!Qi(t.doc,n.to))return!1;r=n.to}else if(r=Bd(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},x8=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),o=i&&ea(i);return o==null?!1:(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)},J4=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function dm(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const w8=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),o=n.indexAfter(-1),s=dm(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,s.createAndFill());l.setSelection(Xe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},G4=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof zn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=dm(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(s,o.createAndFill());a.setSelection($e.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},X4=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(Wr(t.doc,o))return e&&e(t.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),i=r&&ea(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function k8(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof Ce&&e.selection.node.isBlock)return!r.parentOffset||!Wr(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,a,l=!1,u=!1;for(let f=r.depth;;f--)if(r.node(f).isBlock){l=r.end(f)==r.pos+(r.depth-f),u=r.start(f)==r.pos-(r.depth-f),a=dm(r.node(f-1).contentMatchAt(r.indexAfter(f-1))),o.unshift(l&&a?{type:a}:null),s=f;break}else{if(f==1)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof $e||e.selection instanceof zn)&&c.deleteSelection();let d=c.mapping.map(r.pos),p=Wr(c.doc,d,o.length,o);if(p||(o[0]=a?{type:a}:null,p=Wr(c.doc,d,o.length,o)),!p)return!1;if(c.split(d,o.length,o),!l&&u&&r.node(s).type!=a){let f=c.mapping.map(r.before(s)),g=c.doc.resolve(f);a&&r.node(s-1).canReplaceWith(g.index(),g.index()+1,a)&&c.setNodeMarkup(c.mapping.map(r.before(s)),a)}return n&&n(c.scrollIntoView()),!0}}const S8=k8(),_8=(t,e)=>{let{$from:n,to:r}=t.selection,i,o=n.sharedDepth(r);return o==0?!1:(i=n.before(o),e&&e(t.tr.setSelection(Ce.create(t.doc,i))),!0)};function M8(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Qi(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function Y4(t,e,n,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&M8(t,e,n))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(n){let f=e.pos+o.nodeSize,g=se.empty;for(let k=s.length-1;k>=0;k--)g=se.from(s[k].create(null,g));g=se.from(i.copy(g));let x=t.tr.step(new Yt(e.pos-1,f,e.pos,f,new ve(g,1,0),s.length,!0)),w=x.doc.resolve(f+2*s.length);w.nodeAfter&&w.nodeAfter.type==i.type&&Qi(x.doc,w.pos)&&x.join(w.pos),n(x.scrollIntoView())}return!0}let c=o.type.spec.isolating||r>0&&l?null:Xe.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),p=d&&ea(d);if(p!=null&&p>=e.depth)return n&&n(t.tr.lift(d,p).scrollIntoView()),!0;if(u&&Hs(o,"start",!0)&&Hs(i,"end")){let f=i,g=[];for(;g.push(f),!f.isTextblock;)f=f.lastChild;let x=o,w=1;for(;!x.isTextblock;x=x.firstChild)w++;if(f.canReplace(f.childCount,f.childCount,x.content)){if(n){let k=se.empty;for(let N=g.length-1;N>=0;N--)k=se.from(g[N].copy(k));let D=t.tr.step(new Yt(e.pos-g.length,e.pos+o.nodeSize,e.pos+w,e.pos+o.nodeSize-w,new ve(k,g.length,0),0,!0));n(D.scrollIntoView())}return!0}}return!1}function Z4(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(n&&n(e.tr.setSelection($e.create(e.doc,t<0?i.start(o):i.end(o)))),!0):!1}}const C8=Z4(-1),E8=Z4(1);function A8(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o),a=s&&sm(s,t,e);return a?(r&&r(n.tr.wrap(s,a).scrollIntoView()),!0):!1}}function F0(t,e=null){return function(n,r){let i=!1;for(let o=0;o<n.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=n.selection.ranges[o];n.doc.nodesBetween(s,a,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let c=n.doc.resolve(u),d=c.index();i=c.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let o=n.tr;for(let s=0;s<n.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[s];o.setBlockType(a,l,t,e)}r(o.scrollIntoView())}return!0}}function hm(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}hm(lm,j4,V4);hm(lm,W4,U4);hm(J4,G4,X4,S8);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function D8(t,e=null){return function(n,r){let{$from:i,$to:o}=n.selection,s=i.blockRange(o);if(!s)return!1;let a=r?n.tr:null;return L8(a,s,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function L8(t,e,n,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new _c(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new _c(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=sm(o,n,r,e);return a?(t&&T8(t,e,a,i,n),!0):!1}function T8(t,e,n,r,i){let o=se.empty;for(let c=n.length-1;c>=0;c--)o=se.from(n[c].type.create(n[c].attrs,o));t.step(new Yt(e.start-(r?2:0),e.end,e.start,e.end,new ve(o,0,0),n.length,!0));let s=0;for(let c=0;c<n.length;c++)n[c].type==i&&(s=c+1);let a=n.length-s,l=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,d=e.endIndex,p=!0;c<d;c++,p=!1)!p&&Wr(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=u.child(c).nodeSize;return t}function B8(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return o?n?r.node(o.depth-1).type==t?O8(e,n,t,o):N8(e,n,o):!0:!1}}function O8(t,e,n,r){let i=t.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new Yt(o-1,s,o,s,new ve(se.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new _c(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=ea(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return Qi(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function N8(t,e,n){let r=t.tr,i=n.parent;for(let f=n.end,g=n.endIndex-1,x=n.startIndex;g>x;g--)f-=i.child(g).nodeSize,r.delete(f-1,f+1);let o=r.doc.resolve(n.start),s=o.nodeAfter;if(r.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==i.childCount,u=o.node(-1),c=o.index(-1);if(!u.canReplace(c+(a?0:1),c+1,s.content.append(l?se.empty:se.from(i))))return!1;let d=o.pos,p=d+s.nodeSize;return r.step(new Yt(d-(a?1:0),p+(l?1:0),d+1,p-1,new ve((a?se.empty:se.from(i.copy(se.empty))).append(l?se.empty:se.from(i.copy(se.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function P8(t){return function(e,n){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=t)return!1;if(n){let u=l.lastChild&&l.lastChild.type==a.type,c=se.from(u?t.create():null),d=new ve(se.from(t.create(null,se.from(a.type.create(null,c)))),u?3:1,0),p=o.start,f=o.end;n(e.tr.step(new Yt(p-(u?3:1),f,p,f,d,1,!0)).scrollIntoView())}return!0}}const sn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Ws=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Xp=null;const Fr=function(t,e,n){let r=Xp||(Xp=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},I8=function(){Xp=null},Vo=function(t,e,n,r){return n&&($0(t,e,n,r,-1)||$0(t,e,n,r,1))},R8=/^(img|br|input|textarea|hr)$/i;function $0(t,e,n,r,i){for(var o;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Un(t))){let s=t.parentNode;if(!s||s.nodeType!=1||Ml(t)||R8.test(t.nodeName)||t.contentEditable=="false")return!1;e=sn(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?Un(t):0}else return!1}}function Un(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function z8(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Un(t)}else if(t.parentNode&&!Ml(t))e=sn(t),t=t.parentNode;else return null}}function F8(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Ml(t))e=sn(t)+1,t=t.parentNode;else return null}}function $8(t,e,n){for(let r=e==0,i=e==Un(t);r||i;){if(t==n)return!0;let o=sn(t);if(t=t.parentNode,!t)return!1;r=r&&o==0,i=i&&o==Un(t)}}function Ml(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Pd=function(t){return t.focusNode&&Vo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function wo(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function K8(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function j8(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Un(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Un(r.startContainer),r.startOffset)}}}const Mr=typeof navigator<"u"?navigator:null,K0=typeof document<"u"?document:null,eo=Mr&&Mr.userAgent||"",Yp=/Edge\/(\d+)/.exec(eo),Q4=/MSIE \d/.exec(eo),Zp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(eo),An=!!(Q4||Zp||Yp),ji=Q4?document.documentMode:Zp?+Zp[1]:Yp?+Yp[1]:0,Jn=!An&&/gecko\/(\d+)/i.test(eo);Jn&&+(/Firefox\/(\d+)/.exec(eo)||[0,0])[1];const Qp=!An&&/Chrome\/(\d+)/.exec(eo),Xt=!!Qp,e2=Qp?+Qp[1]:0,fn=!An&&!!Mr&&/Apple Computer/.test(Mr.vendor),Us=fn&&(/Mobile\/\w+/.test(eo)||!!Mr&&Mr.maxTouchPoints>2),Wn=Us||(Mr?/Mac/.test(Mr.platform):!1),t2=Mr?/Win/.test(Mr.platform):!1,Hr=/Android \d/.test(eo),Cl=!!K0&&"webkitFontSmoothing"in K0.documentElement.style,q8=Cl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function V8(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Dr(t,e){return typeof t=="number"?t:t[e]}function H8(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function j0(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,o=t.dom.ownerDocument;for(let s=n||t.dom;s;){if(s.nodeType!=1){s=Ws(s);continue}let a=s,l=a==o.body,u=l?V8(o):H8(a),c=0,d=0;if(e.top<u.top+Dr(r,"top")?d=-(u.top-e.top+Dr(i,"top")):e.bottom>u.bottom-Dr(r,"bottom")&&(d=e.bottom-e.top>u.bottom-u.top?e.top+Dr(i,"top")-u.top:e.bottom-u.bottom+Dr(i,"bottom")),e.left<u.left+Dr(r,"left")?c=-(u.left-e.left+Dr(i,"left")):e.right>u.right-Dr(r,"right")&&(c=e.right-u.right+Dr(i,"right")),c||d)if(l)o.defaultView.scrollBy(c,d);else{let f=a.scrollLeft,g=a.scrollTop;d&&(a.scrollTop+=d),c&&(a.scrollLeft+=c);let x=a.scrollLeft-f,w=a.scrollTop-g;e={left:e.left-x,top:e.top-w,right:e.right-x,bottom:e.bottom-w}}let p=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(p))break;s=p=="absolute"?s.offsetParent:Ws(s)}}function W8(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=n+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=t.root.elementFromPoint(o,s);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:n2(t.dom)}}function n2(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ws(r));return e}function U8({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;r2(n,r==0?0:r-e)}function r2(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:o}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let rs=null;function J8(t){if(t.setActive)return t.setActive();if(rs)return t.focus(rs);let e=n2(t);t.focus(rs==null?{get preventScroll(){return rs={preventScroll:!0},!0}}:void 0),rs||(rs=!1,r2(e,0))}function i2(t,e){let n,r=2e8,i,o=0,s=e.top,a=e.top,l,u;for(let c=t.firstChild,d=0;c;c=c.nextSibling,d++){let p;if(c.nodeType==1)p=c.getClientRects();else if(c.nodeType==3)p=Fr(c).getClientRects();else continue;for(let f=0;f<p.length;f++){let g=p[f];if(g.top<=s&&g.bottom>=a){s=Math.max(g.bottom,s),a=Math.min(g.top,a);let x=g.left>e.left?g.left-e.left:g.right<e.left?e.left-g.right:0;if(x<r){n=c,r=x,i=x&&n.nodeType==3?{left:g.right<e.left?g.right:g.left,top:e.top}:e,c.nodeType==1&&x&&(o=d+(e.left>=(g.left+g.right)/2?1:0));continue}}else g.top>e.top&&!l&&g.left<=e.left&&g.right>=e.left&&(l=c,u={left:Math.max(g.left,Math.min(g.right,e.left)),top:g.top});!n&&(e.left>=g.right&&e.top>=g.top||e.left>=g.left&&e.top>=g.bottom)&&(o=d+1)}}return!n&&l&&(n=l,i=u,r=0),n&&n.nodeType==3?G8(n,i):!n||r&&n.nodeType==1?{node:t,offset:o}:i2(n,i)}function G8(t,e){let n=t.nodeValue.length,r=document.createRange(),i;for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let s=Si(r,1);if(s.top!=s.bottom&&pm(e,s)){i={node:t,offset:o+(e.left>=(s.left+s.right)/2?1:0)};break}}return r.detach(),i||{node:t,offset:0}}function pm(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function X8(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function Y8(t,e,n){let{node:r,offset:i}=i2(e,n),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(r,i,o)}function Z8(t,e,n,r){let i=-1;for(let o=e,s=!1;o!=t.dom;){let a=t.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function o2(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),o=i;;){let s=t.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let u=a[l];if(pm(e,u))return o2(s,e,u)}}if((o=(o+1)%r)==i)break}return t}function Q8(t,e){let n=t.dom.ownerDocument,r,i=0,o=j8(n,e.left,e.top);o&&({node:r,offset:i}=o);let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!pm(e,u)||(s=o2(t.dom,e,u),!s))return null}if(fn)for(let u=s;r&&u;u=Ws(u))u.draggable&&(r=void 0);if(s=X8(s,e),r){if(Jn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let u;Cl&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=Z8(t,r,i,e))}a==null&&(a=Y8(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function q0(t){return t.top<t.bottom||t.left<t.right}function Si(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(q0(r))return r}return Array.prototype.find.call(n,q0)||t.getBoundingClientRect()}const ew=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function s2(t,e,n){let{node:r,offset:i,atom:o}=t.docView.domFromPos(e,n<0?-1:1),s=Cl||Jn;if(r.nodeType==3)if(s&&(ew.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=Si(Fr(r,i,i),n);if(Jn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=Si(Fr(r,i-1,i-1),-1);if(u.top==l.top){let c=Si(Fr(r,i,i+1),-1);if(c.top!=l.top)return oa(c,c.left<u.left)}}return l}else{let l=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(l--,c=1):n<0?l--:u++,oa(Si(Fr(r,l,u),c),c<0)}if(!t.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(n<0||i==Un(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return gh(l.getBoundingClientRect(),!1)}if(o==null&&i<Un(r)){let l=r.childNodes[i];if(l.nodeType==1)return gh(l.getBoundingClientRect(),!0)}return gh(r.getBoundingClientRect(),n>=0)}if(o==null&&i&&(n<0||i==Un(r))){let l=r.childNodes[i-1],u=l.nodeType==3?Fr(l,Un(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return oa(Si(u,1),!1)}if(o==null&&i<Un(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?Fr(l,0,s?0:1):l.nodeType==1?l:null:null;if(u)return oa(Si(u,-1),!0)}return oa(Si(r.nodeType==3?Fr(r):r,-n),n>=0)}function oa(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function gh(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function a2(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function tw(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return a2(t,e,()=>{let{node:o}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=s2(t,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Fr(a,0,a.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(n=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const nw=/[\u0590-\u08ac]/;function rw(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=t.domSelection();return a?!nw.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?o:s:a2(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:d}=t.domSelectionRange(),p=a.caretBidiLevel;a.modify("move",n,"character");let f=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:g,focusOffset:x}=t.domSelectionRange(),w=g&&!f.contains(g.nodeType==1?g:g.parentNode)||l==g&&u==x;try{a.collapse(c,d),l&&(l!=c||u!=d)&&a.extend&&a.extend(l,u)}catch{}return p!=null&&(a.caretBidiLevel=p),w}):r.pos==r.start()||r.pos==r.end()}let V0=null,H0=null,W0=!1;function iw(t,e,n){return V0==e&&H0==n?W0:(V0=e,H0=n,W0=n=="up"||n=="down"?tw(t,e,n):rw(t,e,n))}const Gn=0,U0=1,Mo=2,Cr=3;class El{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Gn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>sn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!n||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof u2){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof l2&&o.side>=0;r--);if(n<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&n&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,n):{node:this.contentDOM,offset:o?sn(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,n):{node:this.contentDOM,offset:o?sn(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],u=s+l.size;if(i==-1&&e<=u){let c=s+l.border;if(e>=c&&n<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,c);e=s;for(let d=a;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=sn(p.dom)+1;break}e-=p.size}i==-1&&(i=0)}if(i>-1&&(u>n||a==this.children.length-1)){n=u;for(let c=a+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=sn(d.dom);break}n+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let o=Math.min(e,n),s=Math.max(e,n);for(let f=0,g=0;f<this.children.length;f++){let x=this.children[f],w=g+x.size;if(o>g&&s<w)return x.setSelection(e-g-x.border,n-g-x.border,r,i);g=w}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),d=!1;if((Jn||fn)&&e==n){let{node:f,offset:g}=a;if(f.nodeType==3){if(d=!!(g&&f.nodeValue[g-1]==`
`),d&&g==f.nodeValue.length)for(let x=f,w;x;x=x.parentNode){if(w=x.nextSibling){w.nodeName=="BR"&&(a=l={node:w.parentNode,offset:sn(w)+1});break}let k=x.pmViewDesc;if(k&&k.node&&k.node.isBlock)break}}else{let x=f.childNodes[g-1];d=x&&(x.nodeName=="BR"||x.contentEditable=="false")}}if(Jn&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let f=c.focusNode.childNodes[c.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||d&&fn)&&Vo(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Vo(l.node,l.offset,c.focusNode,c.focusOffset))return;let p=!1;if((u.extend||e==n)&&!(d&&Jn)){u.collapse(a.node,a.offset);try{e!=n&&u.extend(l.node,l.offset),p=!0}catch{}}if(!p){if(e>n){let g=a;a=l,l=g}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&n>=r:e<s&&n>r){let a=r+o.border,l=s-o.border;if(e>=a&&n<=l){this.dirty=e==r||n==s?Mo:U0,e==a&&n==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Cr:o.markDirty(e-a,n-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Mo:Cr}r=s}this.dirty=Mo}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Mo:U0;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class l2 extends El{constructor(e,n,r,i){let o,s=n.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!n.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=n,this.widget=n,o=this}matchesWidget(e){return this.dirty==Gn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class ow extends El{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ho extends El{constructor(e,n,r,i,o){super(e,[],r,i),this.mark=n,this.spec=o}static create(e,n,r,i){let o=i.nodeViews[n.type.name],s=o&&o(n,i,r);return(!s||!s.dom)&&(s=Xo.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Ho(e,n,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Cr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Cr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Gn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Gn}}slice(e,n,r){let i=Ho.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;n<s&&(o=tf(o,n,s,r)),e>0&&(o=tf(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class qi extends El{constructor(e,n,r,i,o,s,a,l,u){super(e,[],o,s),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,n,r,i,o,s){let a=o.nodeViews[n.type.name],l,u=a&&a(n,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),c=u&&u.dom,d=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=Xo.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let p=c;return c=h2(c,r,n),u?l=new sw(e,n,r,i,c,d||null,p,u,o,s+1):n.isText?new Id(e,n,r,i,c,p,o):new qi(e,n,r,i,c,d||null,p,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>se.empty)}return e}matchesNode(e,n,r){return this.dirty==Gn&&e.eq(this.node)&&Cc(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,o=e.composing?this.localCompositionInfo(e,n):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new lw(this,s&&s.node,e);dw(this.node,this.innerDeco,(u,c,d)=>{u.spec.marks?l.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!d&&l.syncToMarks(c==this.node.childCount?gt.none:this.node.child(c).marks,r,e),l.placeWidget(u,e,i)},(u,c,d,p)=>{l.syncToMarks(u.marks,r,e);let f;l.findNodeMatch(u,c,d,p)||a&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(f=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(u,c,d,f,e)||l.updateNextNode(u,c,d,e,p,i)||l.addNode(u,c,d,e,i),i+=u.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Mo)&&(s&&this.protectLocalComposition(e,s),c2(this.contentDOM,this.children,e),Us&&hw(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof $e)||r<n||i>n+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=pw(this.node.content,s,r-n,i-n);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let o=n;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new ow(this,o,n,i);e.input.compositionNodes.push(s),this.children=tf(this.children,r,r+i.length,e,s)}update(e,n,r,i){return this.dirty==Cr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Gn}updateOuterDeco(e){if(Cc(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=d2(this.dom,this.nodeDOM,ef(this.outerDeco,this.node,n),ef(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function J0(t,e,n,r,i){h2(r,e,t);let o=new qi(void 0,t,e,n,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Id extends qi{constructor(e,n,r,i,o,s,a){super(e,n,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Cr||this.dirty!=Gn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Gn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Gn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),o=document.createTextNode(i.text);return new Id(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Cr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class u2 extends El{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Gn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class sw extends qi{constructor(e,n,r,i,o,s,a,l,u,c){super(e,n,r,i,o,s,a,u,c),this.spec=l}update(e,n,r,i){if(this.dirty==Cr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,n,r);return o&&this.updateInner(e,n,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function c2(t,e,n){let r=t.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=G0(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(s instanceof Ho){let l=r?r.previousSibling:t.lastChild;c2(s.contentDOM,s.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=G0(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const qa=function(t){t&&(this.nodeName=t)};qa.prototype=Object.create(null);const Co=[new qa];function ef(t,e,n){if(t.length==0)return Co;let r=n?Co[0]:new qa,i=[r];for(let o=0;o<t.length;o++){let s=t[o].type.attrs;if(s){s.nodeName&&i.push(r=new qa(s.nodeName));for(let a in s){let l=s[a];l!=null&&(n&&i.length==1&&i.push(r=new qa(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function d2(t,e,n,r){if(n==Co&&r==Co)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Co[0]),i=l}aw(i,a||Co[0],s)}return i}function aw(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&t.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&t.classList.add(i[o]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function h2(t,e,n){return d2(t,t,Co,ef(e,n,t.nodeType!=1))}function Cc(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function G0(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class lw{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=uw(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Gn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let u=this.top.children[l];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Ho.create(this.top,e[o],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,n,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let u=this.top.children[a];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,n,r,i,o){let s=this.top.children[i];return s.dirty==Cr&&s.dom==s.contentDOM&&(s.dirty=Mo),s.update(e,n,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof qi){let u=this.preMatch.matched.get(l);if(u!=null&&u!=o)return!1;let c=l.dom,d,p=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Cr&&Cc(n,l.outerDeco));if(!p&&l.update(e,n,r,i))return this.destroyBetween(this.index,a),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!p&&(d=this.recreateWrapper(l,e,n,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Mo,d.updateChildren(i,s+1),d.dirty=Gn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,o,s){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Cc(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=qi.create(this.top,n,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,i,o){let s=qi.create(this.top,e,n,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new l2(this.top,e,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Ho;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Id)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((fn||Xt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new u2(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function uw(t,e){let n=e,r=n.children.length,i=t.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let u=n.children[r-1];if(u instanceof Ho)n=u,r=u.children.length;else{a=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function cw(t,e){return t.type.side-e.type.side}function dw(t,e,n,r){let i=e.locals(t),o=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,a=[],l=null;for(let u=0;;){let c,d;for(;s<i.length&&i[s].to==o;){let w=i[s++];w.widget&&(c?(d||(d=[c])).push(w):c=w)}if(c)if(d){d.sort(cw);for(let w=0;w<d.length;w++)n(d[w],u,!!l)}else n(c,u,!!l);let p,f;if(l)f=-1,p=l,l=null;else if(u<t.childCount)f=u,p=t.child(u++);else break;for(let w=0;w<a.length;w++)a[w].to<=o&&a.splice(w--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let g=o+p.nodeSize;if(p.isText){let w=g;s<i.length&&i[s].from<w&&(w=i[s].from);for(let k=0;k<a.length;k++)a[k].to<w&&(w=a[k].to);w<g&&(l=p.cut(w-o),p=p.cut(0,w-o),g=w,f=-1)}else for(;s<i.length&&i[s].to<g;)s++;let x=p.isInline&&!p.isLeaf?a.filter(w=>!w.inline):a.slice();r(p,x,e.forChild(o,p),f),o=g}}function hw(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function pw(t,e,n,r){for(let i=0,o=0;i<t.childCount&&o<=r;){let s=t.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let u=t.child(i++);if(o+=u.nodeSize,!u.isText)break;l+=u.text}if(o>=n){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let u=a<r?l.lastIndexOf(e,r-a-1):-1;if(u>=0&&u+e.length+a>=n)return a+u;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function tf(t,e,n,r,i){let o=[];for(let s=0,a=0;s<t.length;s++){let l=t[s],u=a,c=a+=l.size;u>=n||c<=e?o.push(l):(u<e&&o.push(l.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>n&&o.push(l.slice(n-u,l.size,r)))}return o}function fm(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),o=i&&i.size==0,s=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,u;if(Pd(n)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&Ce.isSelectable(d)&&i.parent&&!(d.isInline&&$8(n.focusNode,n.focusOffset,i.dom))){let p=i.posBefore;u=new Ce(s==p?a:r.resolve(p))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=s,p=s;for(let f=0;f<n.rangeCount;f++){let g=n.getRangeAt(f);d=Math.min(d,t.docView.posFromDOM(g.startContainer,g.startOffset,1)),p=Math.max(p,t.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(d<0)return null;[l,s]=p==t.state.selection.anchor?[p,d]:[d,p],a=r.resolve(s)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let c=r.resolve(l);if(!u){let d=e=="pointer"||t.state.selection.head<a.pos&&!o?1:-1;u=mm(t,c,a,d)}return u}function p2(t){return t.editable?t.hasFocus():m2(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ur(t,e=!1){let n=t.state.selection;if(f2(t,n),!!p2(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Xt){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Vo(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)mw(t);else{let{anchor:r,head:i}=n,o,s;X0&&!(n instanceof $e)&&(n.$from.parent.inlineContent||(o=Y0(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(s=Y0(t,n.to))),t.docView.setSelection(r,i,t,e),X0&&(o&&Z0(o),s&&Z0(s)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&fw(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const X0=fn||Xt&&e2<63;function Y0(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,o=r?n.childNodes[r-1]:null;if(fn&&i&&i.contentEditable=="false")return yh(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return yh(i);if(o)return yh(o)}}function yh(t){return t.contentEditable="true",fn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Z0(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function fw(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!p2(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function mw(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,sn(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&An&&ji<=11&&(n.disabled=!0,n.disabled=!1)}function f2(t,e){if(e instanceof Ce){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Q0(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Q0(t)}function Q0(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function mm(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||$e.between(e,n,r)}function eg(t){return t.editable&&!t.hasFocus()?!1:m2(t)}function m2(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function gw(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Vo(e.node,e.offset,n.anchorNode,n.anchorOffset)}function nf(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),o=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return o&&Xe.findFrom(o,e)}function Ei(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function tg(t,e,n){let r=t.state.selection;if(r instanceof $e)if(n.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Ei(t,new $e(r.$anchor,s))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=nf(t.state,e);return i&&i instanceof Ce?Ei(t,i):!1}else if(!(Wn&&n.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=t.docView.descAt(a))&&!s.contentDOM?Ce.isSelectable(o)?Ei(t,new Ce(e<0?t.state.doc.resolve(i.pos-o.nodeSize):i)):Cl?Ei(t,new $e(t.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Ce&&r.node.isInline)return Ei(t,new $e(e>0?r.$to:r.$from));{let i=nf(t.state,e);return i?Ei(t,i):!1}}}function Ec(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Va(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function is(t,e){return e<0?yw(t):bw(t)}function yw(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,o,s=!1;for(Jn&&n.nodeType==1&&r<Ec(n)&&Va(n.childNodes[r],-1)&&(s=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(Va(a,-1))i=n,o=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(g2(n))break;{let a=n.previousSibling;for(;a&&Va(a,-1);)i=n.parentNode,o=sn(a),a=a.previousSibling;if(a)n=a,r=Ec(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}s?rf(t,n,r):i&&rf(t,i,o)}function bw(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Ec(n),o,s;for(;;)if(r<i){if(n.nodeType!=1)break;let a=n.childNodes[r];if(Va(a,1))o=n,s=++r;else break}else{if(g2(n))break;{let a=n.nextSibling;for(;a&&Va(a,1);)o=a.parentNode,s=sn(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=Ec(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}o&&rf(t,o,s)}function g2(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function vw(t,e){for(;t&&e==t.childNodes.length&&!Ml(t);)e=sn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function xw(t,e){for(;t&&!e&&!Ml(t);)e=sn(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function rf(t,e,n){if(e.nodeType!=3){let o,s;(s=vw(e,n))?(e=s,n=0):(o=xw(e,n))&&(e=o,n=o.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Pd(r)){let o=document.createRange();o.setEnd(e,n),o.setStart(e,n),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Ur(t)},50)}function ng(t,e){let n=t.state.doc.resolve(e);if(!(Xt||t2)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let o=t.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<n.end()){let o=t.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function rg(t,e,n){let r=t.state.selection;if(r instanceof $e&&!r.empty||n.indexOf("s")>-1||Wn&&n.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=nf(t.state,e);if(s&&s instanceof Ce)return Ei(t,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof zn?Xe.near(s,e):Xe.findFrom(s,e);return a?Ei(t,a):!1}return!1}function ig(t,e){if(!(t.state.selection instanceof $e))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let s=t.state.tr;return e<0?s.delete(n.pos-o.nodeSize,n.pos):s.delete(n.pos,n.pos+o.nodeSize),t.dispatch(s),!0}return!1}function og(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function ww(t){if(!fn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;og(t,r,"true"),setTimeout(()=>og(t,r,"false"),20)}return!1}function kw(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Sw(t,e){let n=e.keyCode,r=kw(e);if(n==8||Wn&&n==72&&r=="c")return ig(t,-1)||is(t,-1);if(n==46&&!e.shiftKey||Wn&&n==68&&r=="c")return ig(t,1)||is(t,1);if(n==13||n==27)return!0;if(n==37||Wn&&n==66&&r=="c"){let i=n==37?ng(t,t.state.selection.from)=="ltr"?-1:1:-1;return tg(t,i,r)||is(t,i)}else if(n==39||Wn&&n==70&&r=="c"){let i=n==39?ng(t,t.state.selection.from)=="ltr"?1:-1:1;return tg(t,i,r)||is(t,i)}else{if(n==38||Wn&&n==80&&r=="c")return rg(t,-1,r)||is(t,-1);if(n==40||Wn&&n==78&&r=="c")return ww(t)||rg(t,1,r)||is(t,1);if(r==(Wn?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function gm(t,e){t.someProp("transformCopied",f=>{e=f(e,t)});let n=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let f=r.firstChild;n.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let s=t.someProp("clipboardSerializer")||Xo.fromSchema(t.state.schema),a=k2(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let u=l.firstChild,c,d=0;for(;u&&u.nodeType==1&&(c=w2[u.nodeName.toLowerCase()]);){for(let f=c.length-1;f>=0;f--){let g=a.createElement(c[f]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),d++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(n)}`);let p=t.someProp("clipboardTextSerializer",f=>f(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:p,slice:e}}function y2(t,e,n,r,i){let o=i.parent.type.spec.code,s,a;if(!n&&!e)return null;let l=!!e&&(r||o||!n);if(l){if(t.someProp("transformPastedText",p=>{e=p(e,o||r,t)}),o)return a=new ve(se.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",p=>{a=p(a,t,!0)}),a;let d=t.someProp("clipboardTextParser",p=>p(e,i,r,t));if(d)a=d;else{let p=i.marks(),{schema:f}=t.state,g=Xo.fromSchema(f);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(x=>{let w=s.appendChild(document.createElement("p"));x&&w.appendChild(g.serializeNode(f.text(x,p)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),s=Ew(n),Cl&&Aw(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let p=s.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;s=p}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Ki.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:i,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!_w.test(p.parentNode.nodeName)?{ignore:!0}:null}})),c)a=Dw(sg(a,+c[1],+c[2]),c[4]);else if(a=ve.maxOpen(Mw(a.content,i),!0),a.openStart||a.openEnd){let d=0,p=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;p<a.openEnd&&!f.type.spec.isolating;p++,f=f.lastChild);a=sg(a,d,p)}return t.someProp("transformPasted",d=>{a=d(a,t,l)}),a}const _w=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Mw(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),o,s=[];if(t.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),u;if(!l)return s=null;if(u=s.length&&o.length&&v2(l,o,a,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=x2(s[s.length-1],o.length));let c=b2(a,l);s.push(c),i=i.matchType(c.type),o=l}}),s)return se.from(s)}return t}function b2(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,se.from(t));return t}function v2(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let o=v2(t,e,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(se.from(b2(n,t,i+1))))}}function x2(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,x2(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(se.empty,!0);return t.copy(n.append(r))}function of(t,e,n,r,i,o){let s=e<0?t.firstChild:t.lastChild,a=s.content;return t.childCount>1&&(o=0),i<r-1&&(a=of(a,e,n,r,i+1,o)),i>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(se.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}function sg(t,e,n){return e<t.openStart&&(t=new ve(of(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new ve(of(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const w2={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ag=null;function k2(){return ag||(ag=document.implementation.createHTMLDocument("title"))}let bh=null;function Cw(t){let e=window.trustedTypes;return e?(bh||(bh=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),bh.createHTML(t)):t}function Ew(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=k2().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&w2[r[1].toLowerCase()])&&(t=i.map(o=>"<"+o+">").join("")+t+i.map(o=>"</"+o+">").reverse().join("")),n.innerHTML=Cw(t),i)for(let o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}function Aw(t){let e=t.querySelectorAll(Xt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Dw(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:o,openEnd:s}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=se.from(l.create(r[a+1],i)),o++,s++}return new ve(i,o,s)}const kn={},Sn={},Lw={touchstart:!0,touchmove:!0};class Tw{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Bw(t){for(let e in kn){let n=kn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{Nw(t,r)&&!ym(t,r)&&(t.editable||!(r.type in Sn))&&n(t,r)},Lw[e]?{passive:!0}:void 0)}fn&&t.dom.addEventListener("input",()=>null),sf(t)}function Ii(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Ow(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function sf(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>ym(t,r))})}function ym(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function Nw(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Pw(t,e){!ym(t,e)&&kn[e.type]&&(t.editable||!(e.type in Sn))&&kn[e.type](t,e)}Sn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!_2(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Hr&&Xt&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Us&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,wo(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Sw(t,n)?n.preventDefault():Ii(t,"key")};Sn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Sn.keypress=(t,e)=>{let n=e;if(_2(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Wn&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof $e)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),o=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i,o))&&t.dispatch(o()),n.preventDefault()}};function Rd(t){return{left:t.clientX,top:t.clientY}}function Iw(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function bm(t,e,n,r,i){if(r==-1)return!1;let o=t.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(t.someProp(e,a=>s>o.depth?a(t,n,o.nodeAfter,o.before(s),i,!0):a(t,n,o.node(s),o.before(s),i,!1)))return!0;return!1}function Rs(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function Rw(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&Ce.isSelectable(r)?(Rs(t,new Ce(n)),!0):!1}function zw(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof Ce&&(r=n.node);let o=t.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(Ce.isSelectable(a)){r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?i=o.before(n.$from.depth):i=o.before(s);break}}return i!=null?(Rs(t,Ce.create(t.state.doc,i)),!0):!1}function Fw(t,e,n,r,i){return bm(t,"handleClickOn",e,n,r)||t.someProp("handleClick",o=>o(t,e,r))||(i?zw(t,n):Rw(t,n))}function $w(t,e,n,r){return bm(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function Kw(t,e,n,r){return bm(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||jw(t,n,r)}function jw(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Rs(t,$e.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)Rs(t,$e.create(r,a+1,a+1+s.content.size));else if(Ce.isSelectable(s))Rs(t,Ce.create(r,a));else continue;return!0}}function vm(t){return Ac(t)}const S2=Wn?"metaKey":"ctrlKey";kn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=vm(t),i=Date.now(),o="singleClick";i-t.input.lastClick.time<500&&Iw(n,t.input.lastClick)&&!n[S2]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?o="doubleClick":t.input.lastClick.type=="doubleClick"&&(o="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:o,button:n.button};let s=t.posAtCoords(Rd(n));s&&(o=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new qw(t,s,n,!!r)):(o=="doubleClick"?$w:Kw)(t,s.pos,s.inside,n)?n.preventDefault():Ii(t,"pointer"))};class qw{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[S2],this.allowDefault=r.shiftKey;let o,s;if(n.inside>-1)o=e.state.doc.nodeAt(n.inside),s=n.inside;else{let c=e.state.doc.resolve(n.pos);o=c.parent,s=c.depth?c.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof Ce&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Jn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ii(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ur(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Rd(e))),this.updateAllowDefault(e),this.allowDefault||!n?Ii(this.view,"pointer"):Fw(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||fn&&this.mightDrag&&!this.mightDrag.node.isAtom||Xt&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Rs(this.view,Xe.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Ii(this.view,"pointer")}move(e){this.updateAllowDefault(e),Ii(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}kn.touchstart=t=>{t.input.lastTouch=Date.now(),vm(t),Ii(t,"pointer")};kn.touchmove=t=>{t.input.lastTouch=Date.now(),Ii(t,"pointer")};kn.contextmenu=t=>vm(t);function _2(t,e){return t.composing?!0:fn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Vw=Hr?5e3:-1;Sn.compositionstart=Sn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof $e&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Xt&&t2&&Hw(t)))t.markCursor=t.state.storedMarks||n.marks(),Ac(t,!0),t.markCursor=null;else if(Ac(t,!e.selection.empty),Jn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=t.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}t.input.composing=!0}M2(t,Vw)};function Hw(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}Sn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,M2(t,20))};function M2(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Ac(t),e))}function C2(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=Uw());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Ww(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=z8(e.focusNode,e.focusOffset),r=F8(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,o=t.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let s=n.pmViewDesc;if(!(!s||!s.isText(n.nodeValue)))return r}}return n||r}function Uw(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Ac(t,e=!1){if(!(Hr&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),C2(t),e||t.docView&&t.docView.dirty){let n=fm(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function Jw(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const ll=An&&ji<15||Us&&q8<604;kn.copy=Sn.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let o=ll?null:n.clipboardData,s=r.content(),{dom:a,text:l}=gm(t,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):Jw(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Gw(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function Xw(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ul(t,r.value,null,i,e):ul(t,r.textContent,r.innerHTML,i,e)},50)}function ul(t,e,n,r,i){let o=y2(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,o||ve.empty)))return!0;if(!o)return!1;let s=Gw(o),a=s?t.state.tr.replaceSelectionWith(s,r):t.state.tr.replaceSelection(o);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function E2(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Sn.paste=(t,e)=>{let n=e;if(t.composing&&!Hr)return;let r=ll?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&ul(t,E2(r),r.getData("text/html"),i,n)?n.preventDefault():Xw(t,n)};class A2{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const Yw=Wn?"altKey":"ctrlKey";function D2(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[Yw]}kn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,o=i.empty?null:t.posAtCoords(Rd(n)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof Ce?i.to-1:i.to))){if(r&&r.mightDrag)s=Ce.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(s=Ce.create(t.state.doc,d.posBefore))}}let a=(s||t.state.selection).content(),{dom:l,text:u,slice:c}=gm(t,a);(!n.dataTransfer.files.length||!Xt||e2>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(ll?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",ll||n.dataTransfer.setData("text/plain",u),t.dragging=new A2(c,D2(t,n),s)};kn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Sn.dragover=Sn.dragenter=(t,e)=>e.preventDefault();Sn.drop=(t,e)=>{try{Zw(t,e,t.dragging)}finally{t.dragging=null}};function Zw(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Rd(e));if(!r)return;let i=t.state.doc.resolve(r.pos),o=n&&n.slice;o?t.someProp("transformPasted",f=>{o=f(o,t,!1)}):o=y2(t,E2(e.dataTransfer),ll?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(n&&D2(t,e));if(t.someProp("handleDrop",f=>f(t,e,o||ve.empty,s))){e.preventDefault();return}if(!o)return;e.preventDefault();let a=o?O4(t.state.doc,i.pos,o):i.pos;a==null&&(a=i.pos);let l=t.state.tr;if(s){let{node:f}=n;f?f.replace(l):l.deleteSelection()}let u=l.mapping.map(a),c=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=l.doc;if(c?l.replaceRangeWith(u,u,o.content.firstChild):l.replaceRange(u,u,o),l.doc.eq(d))return;let p=l.doc.resolve(u);if(c&&Ce.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))l.setSelection(new Ce(p));else{let f=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((g,x,w,k)=>f=k),l.setSelection(mm(t,p,l.doc.resolve(f)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}kn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ur(t)},20))};kn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};kn.beforeinput=(t,e)=>{if(Xt&&Hr&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",o=>o(t,wo(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Sn)kn[t]=Sn[t];function cl(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Dc{constructor(e,n){this.toDOM=e,this.spec=n||Oo,this.side=this.spec.side||0}map(e,n,r,i){let{pos:o,deleted:s}=e.mapResult(n.from+i,this.side<0?-1:1);return s?null:new xn(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Dc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&cl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Vi{constructor(e,n){this.attrs=e,this.spec=n||Oo}map(e,n,r,i){let o=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new xn(o,s,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Vi&&cl(this.attrs,e.attrs)&&cl(this.spec,e.spec)}static is(e){return e.type instanceof Vi}destroy(){}}class xm{constructor(e,n){this.attrs=e,this.spec=n||Oo}map(e,n,r,i){let o=e.mapResult(n.from+i,1);if(o.deleted)return null;let s=e.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new xn(o.pos-r,s.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),o;return i==n.from&&!(o=e.child(r)).isText&&i+o.nodeSize==n.to}eq(e){return this==e||e instanceof xm&&cl(this.attrs,e.attrs)&&cl(this.spec,e.spec)}destroy(){}}class xn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new xn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new xn(e,e,new Dc(n,r))}static inline(e,n,r,i){return new xn(e,n,new Vi(r,i))}static node(e,n,r,i){return new xn(e,n,new xm(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Vi}get widget(){return this.type instanceof Dc}}const _s=[],Oo={};class Mt{constructor(e,n){this.local=e.length?e:_s,this.children=n.length?n:_s}static create(e,n){return n.length?Lc(n,e,0,Oo):pn}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=n&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<n&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,n-a,r,i+a,o)}}map(e,n,r){return this==pn||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Oo)}mapInner(e,n,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?Qw(this.children,s||[],e,n,r,i,o):s?new Mt(s.sort(No),_s):pn}add(e,n){return n.length?this==pn?Mt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,o=0;e.forEach((a,l)=>{let u=l+r,c;if(c=T2(n,a,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,c,u+1):i.splice(o,0,l,l+a.nodeSize,Lc(c,a,u+1,Oo)),o+=3}});let s=L2(o?B2(n):n,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Mt(s.length?this.local.concat(s).sort(No):this.local,i||this.children)}remove(e){return e.length==0||this==pn?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+n,l=r[o+1]+n;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>a&&d.to<l&&(e[c]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,a+1);u!=pn?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Mt(i,r):pn}forChild(e,n){if(this==pn)return this;if(n.isLeaf)return Mt.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Vi){let u=Math.max(o,l.from)-o,c=Math.min(s,l.to)-o;u<c&&(i||(i=[])).push(l.copy(u,c))}}if(i){let a=new Mt(i.sort(No),_s);return r?new Ti([a,r]):a}return r||pn}eq(e){if(this==e)return!0;if(!(e instanceof Mt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return wm(this.localsInner(e))}localsInner(e){if(this==pn)return _s;if(e.inlineContent||!this.local.some(Vi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Vi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Mt.empty=new Mt([],[]);Mt.removeOverlap=wm;const pn=Mt.empty;class Ti{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,Oo));return Ti.from(r)}forChild(e,n){if(n.isLeaf)return Mt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,n);o!=pn&&(o instanceof Ti?r=r.concat(o.members):r.push(o))}return Ti.from(r)}eq(e){if(!(e instanceof Ti)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!n)n=o;else{r&&(n=n.slice(),r=!1);for(let s=0;s<o.length;s++)n.push(o[s])}}return n?wm(r?n:n.sort(No)):_s}static from(e){switch(e.length){case 0:return pn;case 1:return e[0];default:return new Ti(e.every(n=>n instanceof Mt)?e:e.reduce((n,r)=>n.concat(r instanceof Mt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function Qw(t,e,n,r,i,o,s){let a=t.slice();for(let u=0,c=o;u<n.maps.length;u++){let d=0;n.maps[u].forEach((p,f,g,x)=>{let w=x-g-(f-p);for(let k=0;k<a.length;k+=3){let D=a[k+1];if(D<0||p>D+c-d)continue;let N=a[k]+c-d;f>=N?a[k+1]=p<=N?-2:-1:p>=c&&w&&(a[k]+=w,a[k+1]+=w)}d+=w}),c=n.maps[u].map(c,-1)}let l=!1;for(let u=0;u<a.length;u+=3)if(a[u+1]<0){if(a[u+1]==-2){l=!0,a[u+1]=-1;continue}let c=n.map(t[u]+o),d=c-i;if(d<0||d>=r.content.size){l=!0;continue}let p=n.map(t[u+1]+o,-1),f=p-i,{index:g,offset:x}=r.content.findIndex(d),w=r.maybeChild(g);if(w&&x==d&&x+w.nodeSize==f){let k=a[u+2].mapInner(n,w,c+1,t[u]+o+1,s);k!=pn?(a[u]=d,a[u+1]=f,a[u+2]=k):(a[u+1]=-2,l=!0)}else l=!0}if(l){let u=ek(a,t,e,n,i,o,s),c=Lc(u,r,0,s);e=c.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,p=0;d<c.children.length;d+=3){let f=c.children[d];for(;p<a.length&&a[p]<f;)p+=3;a.splice(p,0,c.children[d],c.children[d+1],c.children[d+2])}}return new Mt(e.sort(No),a)}function L2(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new xn(i.from+e,i.to+e,i.type))}return n}function ek(t,e,n,r,i,o,s){function a(l,u){for(let c=0;c<l.local.length;c++){let d=l.local[c].map(r,i,u);d?n.push(d):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)a(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+o+1);return n}function T2(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let o=0,s;o<t.length;o++)(s=t[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),t[o]=null);return i}function B2(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Lc(t,e,n,r){let i=[],o=!1;e.forEach((a,l)=>{let u=T2(t,a,l+n);if(u){o=!0;let c=Lc(u,a,n+l+1,r);c!=pn&&i.push(l,l+a.nodeSize,c)}});let s=L2(o?B2(t):t,-n).sort(No);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new Mt(s,i):pn}function No(t,e){return t.from-e.from||t.to-e.to}function wm(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==t&&(e=t.slice()),e[i]=o.copy(o.from,r.to),lg(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,o.from),lg(e,i,r.copy(o.from,r.to)));break}}}return e}function lg(t,e,n){for(;e<t.length&&No(n,t[e])>0;)e++;t.splice(e,0,n)}function vh(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=pn&&e.push(r)}),t.cursorWrapper&&e.push(Mt.create(t.state.doc,[t.cursorWrapper.deco])),Ti.from(e)}const tk={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},nk=An&&ji<=11;class rk{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class ik{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new rk,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);An&&ji<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),nk&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,tk)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(eg(this.view)){if(this.suppressingSelectionUpdates)return Ur(this.view);if(An&&ji<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Vo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let o=e.focusNode;o;o=Ws(o))n.add(o);for(let o=e.anchorNode;o;o=Ws(o))if(n.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&eg(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let c=0;c<n.length;c++){let d=this.registerMutation(n[c],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(Jn&&l.length){let c=l.filter(d=>d.nodeName=="BR");if(c.length==2){let[d,p]=c;d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let p of c){let f=p.parentNode;f&&f.nodeName=="LI"&&(!d||ak(e,d)!=f)&&p.remove()}}}else if((Xt||fn)&&l.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of l)if(c.nodeName=="BR"&&c.parentNode){let d=c.nextSibling;d&&d.nodeType==1&&d.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Pd(r)&&(u=fm(e))&&u.eq(Xe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ur(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),ok(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ur(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let d=e.addedNodes[c];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(An&&ji<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:d,nextSibling:p}=e.addedNodes[c];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(o=p)}let s=i&&i.parentNode==e.target?sn(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?sn(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,l,1);return{from:a,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let ug=new WeakMap,cg=!1;function ok(t){if(!ug.has(t)&&(ug.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Jn,cg)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cg=!0}}function dg(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Vo(s.node,s.offset,i,o)&&([n,r,i,o]=[i,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:o}}function sk(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return dg(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?dg(t,n):null}function ak(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function lk(t,e,n){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),u,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],Pd(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Xt&&t.input.lastKeyCode===8)for(let w=o;w>i;w--){let k=r.childNodes[w-1],D=k.pmViewDesc;if(k.nodeName=="BR"&&!D){o=w;break}if(!D||D.size)break}let d=t.state.doc,p=t.someProp("domParser")||Ki.fromSchema(t.state.schema),f=d.resolve(s),g=null,x=p.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:o,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:uk,context:f});if(u&&u[0].pos!=null){let w=u[0].pos,k=u[1]&&u[1].pos;k==null&&(k=w),g={anchor:w+s,head:k+s}}return{doc:x,sel:g,from:s,to:a}}function uk(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(fn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||fn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ck=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function dk(t,e,n,r,i){let o=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let L=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,P=fm(t,L);if(P&&!t.state.selection.eq(P)){if(Xt&&Hr&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",de=>de(t,wo(13,"Enter"))))return;let W=t.state.tr.setSelection(P);L=="pointer"?W.setMeta("pointer",!0):L=="key"&&W.scrollIntoView(),o&&W.setMeta("composition",o),t.dispatch(W)}return}let s=t.state.doc.resolve(e),a=s.sharedDepth(n);e=s.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,u=lk(t,e,n),c=t.state.doc,d=c.slice(u.from,u.to),p,f;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(p=t.state.selection.to,f="end"):(p=t.state.selection.from,f="start"),t.input.lastKeyCode=null;let g=fk(d.content,u.doc.content,u.from,p,f);if(g&&t.input.domChangeCount++,(Us&&t.input.lastIOSEnter>Date.now()-225||Hr)&&i.some(L=>L.nodeType==1&&!ck.test(L.nodeName))&&(!g||g.endA>=g.endB)&&t.someProp("handleKeyDown",L=>L(t,wo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!g)if(r&&l instanceof $e&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let L=hg(t,t.state.doc,u.sel);if(L&&!L.eq(t.state.selection)){let P=t.state.tr.setSelection(L);o&&P.setMeta("composition",o),t.dispatch(P)}}return}t.state.selection.from<t.state.selection.to&&g.start==g.endB&&t.state.selection instanceof $e&&(g.start>t.state.selection.from&&g.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?g.start=t.state.selection.from:g.endA<t.state.selection.to&&g.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(g.endB+=t.state.selection.to-g.endA,g.endA=t.state.selection.to)),An&&ji<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>u.from&&u.doc.textBetween(g.start-u.from-1,g.start-u.from+1)==" "&&(g.start--,g.endA--,g.endB--);let x=u.doc.resolveNoCache(g.start-u.from),w=u.doc.resolveNoCache(g.endB-u.from),k=c.resolve(g.start),D=x.sameParent(w)&&x.parent.inlineContent&&k.end()>=g.endA;if((Us&&t.input.lastIOSEnter>Date.now()-225&&(!D||i.some(L=>L.nodeName=="DIV"||L.nodeName=="P"))||!D&&x.pos<u.doc.content.size&&(!x.sameParent(w)||!x.parent.inlineContent)&&x.pos<w.pos&&!/\S/.test(u.doc.textBetween(x.pos,w.pos,"","")))&&t.someProp("handleKeyDown",L=>L(t,wo(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>g.start&&pk(c,g.start,g.endA,x,w)&&t.someProp("handleKeyDown",L=>L(t,wo(8,"Backspace")))){Hr&&Xt&&t.domObserver.suppressSelectionUpdates();return}Xt&&g.endB==g.start&&(t.input.lastChromeDelete=Date.now()),Hr&&!D&&x.start()!=w.start()&&w.parentOffset==0&&x.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==g.endA&&(g.endB-=2,w=u.doc.resolveNoCache(g.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(L){return L(t,wo(13,"Enter"))})},20));let N=g.start,B=g.endA,T=L=>{let P=L||t.state.tr.replace(N,B,u.doc.slice(g.start-u.from,g.endB-u.from));if(u.sel){let W=hg(t,P.doc,u.sel);W&&!(Xt&&t.composing&&W.empty&&(g.start!=g.endB||t.input.lastChromeDelete<Date.now()-100)&&(W.head==N||W.head==P.mapping.map(B)-1)||An&&W.empty&&W.head==N)&&P.setSelection(W)}return o&&P.setMeta("composition",o),P.scrollIntoView()},R;if(D)if(x.pos==w.pos){An&&ji<=11&&x.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ur(t),20));let L=T(t.state.tr.delete(N,B)),P=c.resolve(g.start).marksAcross(c.resolve(g.endA));P&&L.ensureMarks(P),t.dispatch(L)}else if(g.endA==g.endB&&(R=hk(x.parent.content.cut(x.parentOffset,w.parentOffset),k.parent.content.cut(k.parentOffset,g.endA-k.start())))){let L=T(t.state.tr);R.type=="add"?L.addMark(N,B,R.mark):L.removeMark(N,B,R.mark),t.dispatch(L)}else if(x.parent.child(x.index()).isText&&x.index()==w.index()-(w.textOffset?0:1)){let L=x.parent.textBetween(x.parentOffset,w.parentOffset),P=()=>T(t.state.tr.insertText(L,N,B));t.someProp("handleTextInput",W=>W(t,N,B,L,P))||t.dispatch(P())}else t.dispatch(T());else t.dispatch(T())}function hg(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:mm(t,e.resolve(n.anchor),e.resolve(n.head))}function hk(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,o=r,s,a,l;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)o=n[c].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=c=>c.mark(a.addToSet(c.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=c=>c.mark(a.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(l(e.child(c)));if(se.from(u).eq(t))return{mark:a,type:s}}function pk(t,e,n,r,i){if(n-e<=i.pos-r.pos||xh(r,!0,!1)<i.pos)return!1;let o=t.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&n==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=t.resolve(xh(o,!0,!0));return!s.parent.isTextblock||s.pos>n||xh(s,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function xh(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let o=t.node(r).maybeChild(t.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function fk(t,e,n,r,i){let o=t.findDiffStart(e,n);if(o==null)return null;let{a:s,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&t.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&pg(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<t.size&&pg(t.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function pg(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class O2{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Tw,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(bg),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=gg(this),mg(this),this.nodeViews=yg(this),this.docView=J0(this.state.doc,fg(this),vh(this),this.dom,this),this.domObserver=new ik(this,(r,i,o,s)=>dk(this,r,i,o,s)),this.domObserver.start(),Bw(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&sf(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(bg),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(C2(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let f=yg(this);gk(f,this.nodeViews)&&(this.nodeViews=f,o=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&sf(this),this.editable=gg(this),mg(this);let l=vh(this),u=fg(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,u,l);(d||!e.selection.eq(i.selection))&&(s=!0);let p=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&W8(this);if(s){this.domObserver.stop();let f=d&&(An||Xt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&mk(i.selection,e.selection);if(d){let g=Xt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Ww(this)),(o||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=J0(e.doc,u,l,this.dom,this)),g&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&gw(this))?Ur(this,f):(f2(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():p&&U8(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Ce){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&j0(this,n.getBoundingClientRect(),e)}else j0(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-n.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new A2(e.slice,e.move,i<0?void 0:Ce.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=n?n(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=n?n(a):a))return i}}hasFocus(){if(An){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&J8(this.dom),Ur(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Q8(this,e)}coordsAtPos(e,n=1){return s2(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return iw(this,n||this.state,e)}pasteHTML(e,n){return ul(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return ul(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return gm(this,e)}destroy(){this.docView&&(Ow(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],vh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,I8())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Pw(this,e)}domSelectionRange(){let e=this.domSelection();return e?fn&&this.root.nodeType===11&&K8(this.dom.ownerDocument)==this.dom&&sk(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}O2.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function fg(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[xn.node(0,t.state.doc.content.size,e)]}function mg(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:xn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function gg(t){return!t.someProp("editable",e=>e(t.state)===!1)}function mk(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function yg(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function gk(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function bg(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Wi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Tc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yk=typeof navigator<"u"&&/Mac/.test(navigator.platform),bk=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var an=0;an<10;an++)Wi[48+an]=Wi[96+an]=String(an);for(var an=1;an<=24;an++)Wi[an+111]="F"+an;for(var an=65;an<=90;an++)Wi[an]=String.fromCharCode(an+32),Tc[an]=String.fromCharCode(an);for(var wh in Wi)Tc.hasOwnProperty(wh)||(Tc[wh]=Wi[wh]);function vk(t){var e=yk&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||bk&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Tc:Wi)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const xk=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),wk=typeof navigator<"u"&&/Win/.test(navigator.platform);function kk(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))xk?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function Sk(t){let e=Object.create(null);for(let n in t)e[kk(n)]=t[n];return e}function kh(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function _k(t){return new Ct({props:{handleKeyDown:N2(t)}})}function N2(t){let e=Sk(t);return function(n,r){let i=vk(r),o,s=e[kh(i,r)];if(s&&s(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[kh(i,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(wk&&r.ctrlKey&&r.altKey)&&(o=Wi[r.keyCode])&&o!=i){let a=e[kh(o,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}var Mk=Object.defineProperty,km=(t,e)=>{for(var n in e)Mk(t,n,{get:e[n],enumerable:!0})};function zd(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}}}var Fd=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:i}=n,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,a])=>[s,(...u)=>{const c=a(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s=[],a=!!t,l=t||i.tr,u=()=>(!a&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),s.every(d=>d===!0)),c={...Object.fromEntries(Object.entries(n).map(([d,p])=>[d,(...g)=>{const x=this.buildProps(l,e),w=p(...g)(x);return s.push(w),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:n}=this,r=!1,i=t||n.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>l(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:i}=this,{view:o}=r,s={tr:t,editor:r,view:o,state:zd({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([a,l])=>[a,(...u)=>l(...u)(s)]))}};return s}},P2={};km(P2,{blur:()=>Ck,clearContent:()=>Ek,clearNodes:()=>Ak,command:()=>Dk,createParagraphNear:()=>Lk,cut:()=>Tk,deleteCurrentNode:()=>Bk,deleteNode:()=>Ok,deleteRange:()=>Nk,deleteSelection:()=>Pk,enter:()=>Ik,exitCode:()=>Rk,extendMarkRange:()=>zk,first:()=>Fk,focus:()=>$k,forEach:()=>Kk,insertContent:()=>jk,insertContentAt:()=>Hk,joinBackward:()=>Jk,joinDown:()=>Uk,joinForward:()=>Gk,joinItemBackward:()=>Xk,joinItemForward:()=>Yk,joinTextblockBackward:()=>Zk,joinTextblockForward:()=>Qk,joinUp:()=>Wk,keyboardShortcut:()=>t7,lift:()=>n7,liftEmptyBlock:()=>r7,liftListItem:()=>i7,newlineInCode:()=>o7,resetAttributes:()=>s7,scrollIntoView:()=>a7,selectAll:()=>l7,selectNodeBackward:()=>u7,selectNodeForward:()=>c7,selectParentNode:()=>d7,selectTextblockEnd:()=>h7,selectTextblockStart:()=>p7,setContent:()=>f7,setMark:()=>N7,setMeta:()=>P7,setNode:()=>I7,setNodeSelection:()=>R7,setTextDirection:()=>z7,setTextSelection:()=>F7,sinkListItem:()=>$7,splitBlock:()=>K7,splitListItem:()=>j7,toggleList:()=>q7,toggleMark:()=>V7,toggleNode:()=>H7,toggleWrap:()=>W7,undoInputRule:()=>U7,unsetAllMarks:()=>J7,unsetMark:()=>G7,unsetTextDirection:()=>X7,updateAttributes:()=>Y7,wrapIn:()=>Z7,wrapInList:()=>Q7});var Ck=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),Ek=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),Ak=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{t.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:u,mapping:c}=e,d=u.resolve(c.map(l)),p=u.resolve(c.map(l+a.nodeSize)),f=d.blockRange(p);if(!f)return;const g=ea(f);if(a.type.isTextblock){const{defaultType:x}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,x)}(g||g===0)&&e.lift(f,g)})}),!0},Dk=t=>e=>t(e),Lk=()=>({state:t,dispatch:e})=>G4(t,e),Tk=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,o=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new $e(r.doc.resolve(Math.max(s-1,0)))),!0},Bk=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1};function Kt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var Ok=t=>({tr:e,state:n,dispatch:r})=>{const i=Kt(t,n.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),u=o.after(s);e.delete(l,u).scrollIntoView()}return!0}return!1},Nk=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},Pk=()=>({state:t,dispatch:e})=>lm(t,e),Ik=()=>({commands:t})=>t.keyboardShortcut("Enter"),Rk=()=>({state:t,dispatch:e})=>w8(t,e);function Sm(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Bc(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:Sm(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function I2(t,e,n={}){return t.find(r=>r.type===e&&Bc(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function vg(t,e,n={}){return!!I2(t,e,n)}function _m(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(n=n||((r=i.node.marks[0])==null?void 0:r.attrs),!I2([...i.node.marks],e,n)))return;let s=i.index,a=t.start()+i.offset,l=s+1,u=a+i.node.nodeSize;for(;s>0&&vg([...t.parent.child(s-1).marks],e,n);)s-=1,a-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&vg([...t.parent.child(l).marks],e,n);)u+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:u}}function Qr(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var zk=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const o=Qr(t,r.schema),{doc:s,selection:a}=n,{$from:l,from:u,to:c}=a;if(i){const d=_m(l,o,e);if(d&&d.from<=u&&d.to>=c){const p=$e.create(s,d.from,d.to);n.setSelection(p)}}return!0},Fk=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function R2(t){return t instanceof $e}function Eo(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function z2(t,e=null){if(!e)return null;const n=Xe.atStart(t),r=Xe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,o=r.to;return e==="all"?$e.create(t,Eo(0,i,o),Eo(t.content.size,i,o)):$e.create(t,Eo(e,i,o),Eo(e,i,o))}function F2(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function $d(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var $k=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{($d()||F2())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!R2(n.state.selection))return s(),!0;const a=z2(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},Kk=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),jk=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),$2=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&$2(r)}return t};function zl(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return $2(n)}function dl(t,e,n){if(t instanceof $i||t instanceof se)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return se.fromArray(t.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(t);return n.errorOnInvalidContent&&s.check(),s}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),dl("",e,n)}if(i){if(n.errorOnInvalidContent){let s=!1,a="";const l=new k4({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,a=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?Ki.fromSchema(l).parseSlice(zl(t),n.parseOptions):Ki.fromSchema(l).parse(zl(t),n.parseOptions),n.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=Ki.fromSchema(e);return n.slice?o.parseSlice(zl(t),n.parseOptions).content:o.parse(zl(t),n.parseOptions)}return dl("",e,n)}function qk(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Gt||i instanceof Yt))return;const o=t.mapping.maps[r];let s=0;o.forEach((a,l,u,c)=>{s===0&&(s=c)}),t.setSelection(Xe.near(t.doc.resolve(s),n))}var Vk=t=>!("type"in t),Hk=(t,e,n)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const l=w=>{o.emit("contentError",{editor:o,error:w,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{dl(e,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(w){l(w)}try{a=dl(e,o.schema,{parseOptions:u,errorOnInvalidContent:(s=n.errorOnInvalidContent)!=null?s:o.options.enableContentCheck})}catch(w){return l(w),!1}let{from:c,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},p=!0,f=!0;if((Vk(a)?a:[a]).forEach(w=>{w.check(),p=p?w.isText&&w.marks.length===0:!1,f=f?w.isBlock:!1}),c===d&&f){const{parent:w}=r.doc.resolve(c);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(c-=1,d+=1)}let x;if(p){if(Array.isArray(e))x=e.map(w=>w.text||"").join("");else if(e instanceof se){let w="";e.forEach(k=>{k.text&&(w+=k.text)}),x=w}else typeof e=="object"&&e&&e.text?x=e.text:x=e;r.insertText(x,c,d)}else{x=a;const w=r.doc.resolve(c),k=w.node(),D=w.parentOffset===0,N=k.isText||k.isTextblock,B=k.content.size>0;D&&N&&B&&(c=Math.max(0,c-1)),r.replaceWith(c,d,x)}n.updateSelection&&qk(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:x}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:x})}return!0},Wk=()=>({state:t,dispatch:e})=>b8(t,e),Uk=()=>({state:t,dispatch:e})=>v8(t,e),Jk=()=>({state:t,dispatch:e})=>j4(t,e),Gk=()=>({state:t,dispatch:e})=>W4(t,e),Xk=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Bd(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},Yk=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Bd(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},Zk=()=>({state:t,dispatch:e})=>g8(t,e),Qk=()=>({state:t,dispatch:e})=>y8(t,e);function K2(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function e7(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))$d()||K2()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var t7=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const o=e7(t).split(/-(?!$)/),s=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,a))});return l?.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function Ui(t,e,n={}){const{from:r,to:i,empty:o}=t.selection,s=e?Kt(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(d,p)=>{if(d.isText)return;const f=Math.max(r,p),g=Math.min(i,p+d.nodeSize);a.push({node:d,from:f,to:g})});const l=i-r,u=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>Bc(d.node.attrs,n,{strict:!1}));return o?!!u.length:u.reduce((d,p)=>d+p.to-p.from,0)>=l}var n7=(t,e={})=>({state:n,dispatch:r})=>{const i=Kt(t,n.schema);return Ui(n,i,e)?x8(n,r):!1},r7=()=>({state:t,dispatch:e})=>X4(t,e),i7=t=>({state:e,dispatch:n})=>{const r=Kt(t,e.schema);return B8(r)(e,n)},o7=()=>({state:t,dispatch:e})=>J4(t,e);function Kd(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function xg(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}var s7=(t,e)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=Kd(typeof t=="string"?t:t.name,r.schema);if(!a)return!1;a==="node"&&(o=Kt(t,r.schema)),a==="mark"&&(s=Qr(t,r.schema));let l=!1;return n.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,d)=>{o&&o===c.type&&(l=!0,i&&n.setNodeMarkup(d,void 0,xg(c.attrs,e))),s&&c.marks.length&&c.marks.forEach(p=>{s===p.type&&(l=!0,i&&n.addMark(d,d+c.nodeSize,s.create(xg(p.attrs,e))))})})}),l},a7=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),l7=()=>({tr:t,dispatch:e})=>{if(e){const n=new zn(t.doc);t.setSelection(n)}return!0},u7=()=>({state:t,dispatch:e})=>V4(t,e),c7=()=>({state:t,dispatch:e})=>U4(t,e),d7=()=>({state:t,dispatch:e})=>_8(t,e),h7=()=>({state:t,dispatch:e})=>E8(t,e),p7=()=>({state:t,dispatch:e})=>C8(t,e);function af(t,e,n={},r={}){return dl(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var f7=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{const{doc:l}=o;if(r.preserveWhitespace!=="full"){const u=af(t,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&o.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!n),!0}return s&&o.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:l.content.size},t,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function j2(t,e){const n=Qr(e,t.schema),{from:r,to:i,empty:o}=t.selection,s=[];o?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function q2(t,e){const n=new z4(t);return e.forEach(r=>{r.steps.forEach(i=>{n.step(i)})}),n}function m7(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function g7(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(i,o)=>{n(i)&&r.push({node:i,pos:o})}),r}function y7(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function jd(t){return e=>y7(e.$from,t)}function Ee(t,e,n){return t.config[e]===void 0&&t.parent?Ee(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?Ee(t.parent,e,n):null}):t.config[e]}function Mm(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=Ee(e,"addExtensions",n);return r?[e,...Mm(r())]:e}).flat(10)}function Cm(t,e){const n=Xo.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function V2(t){return typeof t=="function"}function pt(t,e=void 0,...n){return V2(t)?e?t.bind(e)(...n):t(...n):t}function b7(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Js(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function H2(t){const e=[],{nodeExtensions:n,markExtensions:r}=Js(t),i=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=Ee(s,"addGlobalAttributes",a);if(!l)return;l().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([p,f])=>{e.push({type:d,name:p,attribute:{...o,...f}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=Ee(s,"addAttributes",a);if(!l)return;const u=l();Object.entries(u).forEach(([c,d])=>{const p={...o,...d};typeof p?.default=="function"&&(p.default=p.default()),p?.isRequired&&p?.default===void 0&&delete p.default,e.push({type:s.name,name:c,attribute:p})})}),e}function St(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],u=a.filter(c=>!l.includes(c));r[i]=[...l,...u].join(" ")}else if(i==="style"){const a=o?o.split(";").map(c=>c.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{const[d,p]=c.split(":").map(f=>f.trim());u.set(d,p)}),a.forEach(c=>{const[d,p]=c.split(":").map(f=>f.trim());u.set(d,p)}),r[i]=Array.from(u.entries()).map(([c,d])=>`${c}: ${d}`).join("; ")}else r[i]=o}),r},{})}function hl(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>St(n,r),{})}function v7(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function wg(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(n):v7(n.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function kg(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&b7(n)?!1:n!=null))}function Sg(t){var e,n;const r={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(r.default=t.attribute.default),((n=t?.attribute)==null?void 0:n.validate)!==void 0&&(r.validate=t.attribute.validate),[t.name,r]}function x7(t,e){var n;const r=H2(t),{nodeExtensions:i,markExtensions:o}=Js(t),s=(n=i.find(u=>Ee(u,"topNode")))==null?void 0:n.name,a=Object.fromEntries(i.map(u=>{const c=r.filter(k=>k.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((k,D)=>{const N=Ee(D,"extendNodeSchema",d);return{...k,...N?N(u):{}}},{}),f=kg({...p,content:pt(Ee(u,"content",d)),marks:pt(Ee(u,"marks",d)),group:pt(Ee(u,"group",d)),inline:pt(Ee(u,"inline",d)),atom:pt(Ee(u,"atom",d)),selectable:pt(Ee(u,"selectable",d)),draggable:pt(Ee(u,"draggable",d)),code:pt(Ee(u,"code",d)),whitespace:pt(Ee(u,"whitespace",d)),linebreakReplacement:pt(Ee(u,"linebreakReplacement",d)),defining:pt(Ee(u,"defining",d)),isolating:pt(Ee(u,"isolating",d)),attrs:Object.fromEntries(c.map(Sg))}),g=pt(Ee(u,"parseHTML",d));g&&(f.parseDOM=g.map(k=>wg(k,c)));const x=Ee(u,"renderHTML",d);x&&(f.toDOM=k=>x({node:k,HTMLAttributes:hl(k,c)}));const w=Ee(u,"renderText",d);return w&&(f.toText=w),[u.name,f]})),l=Object.fromEntries(o.map(u=>{const c=r.filter(w=>w.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((w,k)=>{const D=Ee(k,"extendMarkSchema",d);return{...w,...D?D(u):{}}},{}),f=kg({...p,inclusive:pt(Ee(u,"inclusive",d)),excludes:pt(Ee(u,"excludes",d)),group:pt(Ee(u,"group",d)),spanning:pt(Ee(u,"spanning",d)),code:pt(Ee(u,"code",d)),attrs:Object.fromEntries(c.map(Sg))}),g=pt(Ee(u,"parseHTML",d));g&&(f.parseDOM=g.map(w=>wg(w,c)));const x=Ee(u,"renderHTML",d);return x&&(f.toDOM=w=>x({mark:w,HTMLAttributes:hl(w,c)})),[u.name,f]}));return new k4({topNode:s,nodes:a,marks:l})}function w7(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Em(t){return t.sort((n,r)=>{const i=Ee(n,"priority")||100,o=Ee(r,"priority")||100;return i>o?-1:i<o?1:0})}function W2(t){const e=Em(Mm(t)),n=w7(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function U2(t,e,n){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=n||{};let a="";return t.nodesBetween(r,i,(l,u,c,d)=>{var p;l.isBlock&&u>r&&(a+=o);const f=s?.[l.type.name];if(f)return c&&(a+=f({node:l,pos:u,parent:c,index:d,range:e})),!1;l.isText&&(a+=(p=l?.text)==null?void 0:p.slice(Math.max(r,u)-u,i-u))}),a}function k7(t,e){const n={from:0,to:t.content.size};return U2(t,n,e)}function J2(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function S7(t,e){const n=Kt(e,t.schema),{from:r,to:i}=t.selection,o=[];t.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===n.name);return s?{...s.attrs}:{}}function G2(t,e){const n=Kd(typeof e=="string"?e:e.name,t.schema);return n==="node"?S7(t,e):n==="mark"?j2(t,e):{}}function _7(t,e=JSON.stringify){const n={};return t.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(n,i)?!1:n[i]=!0})}function M7(t){const e=_7(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,s)=>s!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function X2(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((i,o)=>{const s=[];if(i.ranges.length)i.forEach((a,l)=>{s.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;s.push({from:a,to:l})}s.forEach(({from:a,to:l})=>{const u=e.slice(o).map(a,-1),c=e.slice(o).map(l),d=e.invert().map(u,-1),p=e.invert().map(c);r.push({oldRange:{from:d,to:p},newRange:{from:u,to:c}})})}),M7(r)}function Am(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const o=n.resolve(t),s=_m(o,i.type);s&&r.push({mark:i,...s})}):n.nodesBetween(t,e,(i,o)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}var C7=(t,e,n,r=20)=>{const i=t.doc.resolve(n);let o=r,s=null;for(;o>0&&s===null;){const a=i.node(o);a?.type.name===e?s=a:o-=1}return[s,o]};function Sh(t,e){return e.nodes[t]||e.marks[t]||null}function ic(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}var E7=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,u;const c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,r-o))}),n};function lf(t,e,n={}){const{empty:r,ranges:i}=t.selection,o=e?Qr(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>Bc(d.attrs,n,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:p})=>{const f=d.pos,g=p.pos;t.doc.nodesBetween(f,g,(x,w)=>{if(!x.isText&&!x.marks.length)return;const k=Math.max(f,w),D=Math.min(g,w+x.nodeSize),N=D-k;s+=N,a.push(...x.marks.map(B=>({mark:B,from:k,to:D})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>Bc(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),u=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+u:l)>=s}function A7(t,e,n={}){if(!e)return Ui(t,null,n)||lf(t,null,n);const r=Kd(e,t.schema);return r==="node"?Ui(t,e,n):r==="mark"?lf(t,e,n):!1}var D7=(t,e)=>{const{$from:n,$to:r,$anchor:i}=t.selection;if(e){const o=jd(a=>a.type.name===e)(t.selection);if(!o)return!1;const s=t.doc.resolve(o.pos+1);return i.pos+1===s.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},L7=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function _g(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Mg(t,e){const{nodeExtensions:n}=Js(e),r=n.find(s=>s.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=pt(Ee(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function qd(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(o=>{i!==!1&&(qd(o,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function Y2(t){return t instanceof Ce}var Z2=class Q2{constructor(e){this.position=e}static fromJSON(e){return new Q2(e.position)}toJSON(){return{position:this.position}}};function T7(t,e){const n=e.mapping.mapResult(t.position);return{position:new Z2(n.pos),mapResult:n}}function B7(t){return new Z2(t)}function O7(t,e,n){var r;const{selection:i}=e;let o=null;if(R2(i)&&(o=i.$cursor),o){const a=(r=t.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(n)&&(!!n.isInSet(a)||!a.some(u=>u.type.excludes(n)))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let u=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(c,d,p)=>{if(u)return!1;if(c.isInline){const f=!p||p.type.allowsMarkType(n),g=!!n.isInSet(c.marks)||!c.marks.some(x=>x.type.excludes(n));u=f&&g}return!u}),u})}var N7=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:a}=o,l=Qr(t,r.schema);if(i)if(s){const u=j2(r,l);n.addStoredMark(l.create({...u,...e}))}else a.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;r.doc.nodesBetween(c,d,(p,f)=>{const g=Math.max(f,c),x=Math.min(f+p.nodeSize,d);p.marks.find(k=>k.type===l)?p.marks.forEach(k=>{l===k.type&&n.addMark(g,x,l.create({...k.attrs,...e}))}):n.addMark(g,x,l.create(e))})});return O7(r,n,l)},P7=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),I7=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const o=Kt(t,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>F0(o,{...s,...e})(n)?!0:a.clearNodes()).command(({state:a})=>F0(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},R7=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=Eo(t,0,r.content.size),o=Ce.create(r,i);e.setSelection(o)}return!0},z7=(t,e)=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=r;let s,a;return typeof e=="number"?(s=e,a=e):e&&"from"in e&&"to"in e?(s=e.from,a=e.to):(s=o.from,a=o.to),i&&n.doc.nodesBetween(s,a,(l,u)=>{l.isText||n.setNodeMarkup(u,void 0,{...l.attrs,dir:t})}),!0},F7=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:o}=typeof t=="number"?{from:t,to:t}:t,s=$e.atStart(r).from,a=$e.atEnd(r).to,l=Eo(i,s,a),u=Eo(o,s,a),c=$e.create(r,l,u);e.setSelection(c)}return!0},$7=t=>({state:e,dispatch:n})=>{const r=Kt(t,e.schema);return P8(r)(e,n)};function Cg(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(r)}}var K7=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,u=i.extensionManager.attributes,c=ic(u,a.node().type.name,a.node().attrs);if(o instanceof Ce&&o.node.isBlock)return!a.parentOffset||!Wr(s,a.pos)?!1:(r&&(t&&Cg(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:m7(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&p?[{type:p,attrs:c}]:void 0,g=Wr(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!g&&Wr(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(g=!0,f=p?[{type:p,attrs:c}]:void 0),r){if(g&&(o instanceof $e&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,f),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const x=e.mapping.map(a.before()),w=e.doc.resolve(x);a.node(-1).canReplaceWith(w.index(),w.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}t&&Cg(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return g},j7=(t,e={})=>({tr:n,state:r,dispatch:i,editor:o})=>{var s;const a=Kt(t,r.schema),{$from:l,$to:u}=r.selection,c=r.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;const d=l.node(-1);if(d.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let k=se.empty;const D=l.index(-1)?1:l.index(-2)?2:3;for(let P=l.depth-D;P>=l.depth-3;P-=1)k=se.from(l.node(P).copy(k));const N=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,B={...ic(p,l.node().type.name,l.node().attrs),...e},T=((s=a.contentMatch.defaultType)==null?void 0:s.createAndFill(B))||void 0;k=k.append(se.from(a.createAndFill(null,T)||void 0));const R=l.before(l.depth-(D-1));n.replace(R,l.after(-N),new ve(k,4-D,0));let L=-1;n.doc.nodesBetween(R,n.doc.content.size,(P,W)=>{if(L>-1)return!1;P.isTextblock&&P.content.size===0&&(L=W+1)}),L>-1&&n.setSelection($e.near(n.doc.resolve(L))),n.scrollIntoView()}return!0}const f=u.pos===l.end()?d.contentMatchAt(0).defaultType:null,g={...ic(p,d.type.name,d.attrs),...e},x={...ic(p,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,u.pos);const w=f?[{type:a,attrs:g},{type:f,attrs:x}]:[{type:a,attrs:g}];if(!Wr(n.doc,l.pos,2))return!1;if(i){const{selection:k,storedMarks:D}=r,{splittableMarks:N}=o.extensionManager,B=D||k.$to.parentOffset&&k.$from.marks();if(n.split(l.pos,2,w).scrollIntoView(),!B||!i)return!0;const T=B.filter(R=>N.includes(R.type.name));n.ensureMarks(T)}return!0},_h=(t,e)=>{const n=jd(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Qi(t.doc,n.pos)&&t.join(n.pos),!0},Mh=(t,e)=>{const n=jd(s=>s.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Qi(t.doc,r)&&t.join(r),!0},q7=(t,e,n,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:u,can:c})=>{const{extensions:d,splittableMarks:p}=i.extensionManager,f=Kt(t,s.schema),g=Kt(e,s.schema),{selection:x,storedMarks:w}=s,{$from:k,$to:D}=x,N=k.blockRange(D),B=w||x.$to.parentOffset&&x.$from.marks();if(!N)return!1;const T=jd(R=>Mg(R.type.name,d))(x);if(N.depth>=1&&T&&N.depth-T.depth<=1){if(T.node.type===f)return u.liftListItem(g);if(Mg(T.node.type.name,d)&&f.validContent(T.node.content)&&a)return l().command(()=>(o.setNodeMarkup(T.pos,f),!0)).command(()=>_h(o,f)).command(()=>Mh(o,f)).run()}return!n||!B||!a?l().command(()=>c().wrapInList(f,r)?!0:u.clearNodes()).wrapInList(f,r).command(()=>_h(o,f)).command(()=>Mh(o,f)).run():l().command(()=>{const R=c().wrapInList(f,r),L=B.filter(P=>p.includes(P.type.name));return o.ensureMarks(L),R?!0:u.clearNodes()}).wrapInList(f,r).command(()=>_h(o,f)).command(()=>Mh(o,f)).run()},V7=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=Qr(t,r.schema);return lf(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},H7=(t,e,n={})=>({state:r,commands:i})=>{const o=Kt(t,r.schema),s=Kt(e,r.schema),a=Ui(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...n})},W7=(t,e={})=>({state:n,commands:r})=>{const i=Kt(t,n.schema);return Ui(n,i,e)?r.lift(i):r.wrapIn(i,e)},U7=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(t))){if(e){const s=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},J7=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},G7=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=n,l=Qr(t,r.schema),{$from:u,empty:c,ranges:d}=a;if(!i)return!0;if(c&&s){let{from:p,to:f}=a;const g=(o=u.marks().find(w=>w.type===l))==null?void 0:o.attrs,x=_m(u,l,g);x&&(p=x.from,f=x.to),n.removeMark(p,f,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},X7=t=>({tr:e,state:n,dispatch:r})=>{const{selection:i}=n;let o,s;return typeof t=="number"?(o=t,s=t):t&&"from"in t&&"to"in t?(o=t.from,s=t.to):(o=i.from,s=i.to),r&&e.doc.nodesBetween(o,s,(a,l)=>{if(a.isText)return;const u={...a.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},Y7=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const a=Kd(typeof t=="string"?t:t.name,r.schema);if(!a)return!1;a==="node"&&(o=Kt(t,r.schema)),a==="mark"&&(s=Qr(t,r.schema));let l=!1;return n.selection.ranges.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;let p,f,g,x;n.selection.empty?r.doc.nodesBetween(c,d,(w,k)=>{o&&o===w.type&&(l=!0,g=Math.max(k,c),x=Math.min(k+w.nodeSize,d),p=k,f=w)}):r.doc.nodesBetween(c,d,(w,k)=>{k<c&&o&&o===w.type&&(l=!0,g=Math.max(k,c),x=Math.min(k+w.nodeSize,d),p=k,f=w),k>=c&&k<=d&&(o&&o===w.type&&(l=!0,i&&n.setNodeMarkup(k,void 0,{...w.attrs,...e})),s&&w.marks.length&&w.marks.forEach(D=>{if(s===D.type&&(l=!0,i)){const N=Math.max(k,c),B=Math.min(k+w.nodeSize,d);n.addMark(N,B,s.create({...D.attrs,...e}))}}))}),f&&(p!==void 0&&i&&n.setNodeMarkup(p,void 0,{...f.attrs,...e}),s&&f.marks.length&&f.marks.forEach(w=>{s===w.type&&i&&n.addMark(g,x,s.create({...w.attrs,...e}))}))}),l},Z7=(t,e={})=>({state:n,dispatch:r})=>{const i=Kt(t,n.schema);return A8(i,e)(n,r)},Q7=(t,e={})=>({state:n,dispatch:r})=>{const i=Kt(t,n.schema);return D8(i,e)(n,r)},e9=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},Vd=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},t9=(t,e)=>{if(Sm(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Fl(t){var e;const{editor:n,from:r,to:i,text:o,rules:s,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(r);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(p=>p.type.spec.code))return!1;let c=!1;const d=E7(u)+o;return s.forEach(p=>{if(c)return;const f=t9(d,p.find);if(!f)return;const g=l.state.tr,x=zd({state:l.state,transaction:g}),w={from:r-(f[0].length-o.length),to:i},{commands:k,chain:D,can:N}=new Fd({editor:n,state:x});p.handler({state:x,range:w,match:f,commands:k,chain:D,can:N})===null||!g.steps.length||(p.undoable&&g.setMeta(a,{transform:g,from:r,to:i,text:o}),l.dispatch(g),c=!0)}),c}function n9(t){const{editor:e,rules:n}=t,r=new Ct({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=Cm(se.from(c),s.schema);const{from:d}=l,p=d+c.length;Fl({editor:e,from:d,to:p,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return Fl({editor:e,from:o,to:s,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&Fl({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Fl({editor:e,from:s.pos,to:s.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function r9(t){return Object.prototype.toString.call(t).slice(8,-1)}function $l(t){return r9(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function e3(t,e){const n={...t};return $l(t)&&$l(e)&&Object.keys(e).forEach(r=>{$l(e[r])&&$l(t[r])?n[r]=e3(t[r],e[r]):n[r]=e[r]}),n}var Dm=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...pt(Ee(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...pt(Ee(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>e3(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},to=class t3 extends Dm{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new t3(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>u?.type.name===n.name))return!1;const l=s.find(u=>u?.type.name===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function i9(t){return typeof t=="number"}var o9=class{constructor(t){this.find=t.find,this.handler=t.handler}},s9=(t,e,n)=>{if(Sm(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=t,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function a9(t){const{editor:e,state:n,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=t,{commands:l,chain:u,can:c}=new Fd({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(f,g)=>{var x,w,k,D,N;if((w=(x=f.type)==null?void 0:x.spec)!=null&&w.code||!(f.isText||f.isTextblock||f.isInline))return;const B=(N=(D=(k=f.content)==null?void 0:k.size)!=null?D:f.nodeSize)!=null?N:0,T=Math.max(r,g),R=Math.min(i,g+B);if(T>=R)return;const L=f.isText?f.text||"":f.textBetween(T-g,R-g,void 0,"");s9(L,o.find,s).forEach(W=>{if(W.index===void 0)return;const de=T+W.index+1,q=de+W[0].length,ae={from:n.tr.mapping.map(de),to:n.tr.mapping.map(q)},be=o.handler({state:n,range:ae,match:W,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:a});d.push(be)})}),d.every(f=>f!==null)}var Kl=null,l9=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function u9(t){const{editor:e,rules:n}=t;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:c,from:d,to:p,rule:f,pasteEvt:g})=>{const x=c.tr,w=zd({state:c,transaction:x});if(!(!a9({editor:e,state:w,from:Math.max(d-1,0),to:p.b-1,rule:f,pasteEvent:g,dropEvent:a})||!x.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,x}};return n.map(c=>new Ct({view(d){const p=g=>{var x;r=(x=d.dom.parentElement)!=null&&x.contains(g.target)?d.dom.parentElement:null,r&&(Kl=e)},f=()=>{Kl&&(Kl=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,p)=>{if(o=r===d.dom.parentElement,a=p,!o){const f=Kl;f?.isEditable&&setTimeout(()=>{const g=f.state.selection;g&&f.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(d,p)=>{var f;const g=(f=p.clipboardData)==null?void 0:f.getData("text/html");return s=p,i=!!g?.includes("data-pm-slice"),!1}}},appendTransaction:(d,p,f)=>{const g=d[0],x=g.getMeta("uiEvent")==="paste"&&!i,w=g.getMeta("uiEvent")==="drop"&&!o,k=g.getMeta("applyPasteRules"),D=!!k;if(!x&&!w&&!D)return;if(D){let{text:T}=k;typeof T=="string"?T=T:T=Cm(se.from(T),f.schema);const{from:R}=k,L=R+T.length,P=l9(T);return l({rule:c,state:f,from:R,to:{b:L},pasteEvt:P})}const N=p.doc.content.findDiffStart(f.doc.content),B=p.doc.content.findDiffEnd(f.doc.content);if(!(!i9(N)||!B||N===B.b))return l({rule:c,state:f,from:N,to:B,pasteEvt:s})}}))}var Hd=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=W2(t),this.schema=x7(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Sh(e.name,this.schema)},r=Ee(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Em([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Sh(r.name,this.schema)},o=[],s=Ee(r,"addKeyboardShortcuts",i);let a={};if(r.type==="mark"&&Ee(r,"exitable",i)&&(a.ArrowRight=()=>to.handleExit({editor:t,mark:r})),s){const p=Object.fromEntries(Object.entries(s()).map(([f,g])=>[f,()=>g({editor:t})]));a={...a,...p}}const l=_k(a);o.push(l);const u=Ee(r,"addInputRules",i);if(_g(r,t.options.enableInputRules)&&u){const p=u();if(p&&p.length){const f=n9({editor:t,rules:p}),g=Array.isArray(f)?f:[f];o.push(...g)}}const c=Ee(r,"addPasteRules",i);if(_g(r,t.options.enablePasteRules)&&c){const p=c();if(p&&p.length){const f=u9({editor:t,rules:p});o.push(...f)}}const d=Ee(r,"addProseMirrorPlugins",i);if(d){const p=d();o.push(...p)}return o})}get attributes(){return H2(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Js(this.extensions);return Object.fromEntries(e.filter(n=>!!Ee(n,"addNodeView")).map(n=>{const r=this.attributes.filter(l=>l.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Kt(n.name,this.schema)},o=Ee(n,"addNodeView",i);if(!o)return[];const s=o();if(!s)return[];const a=(l,u,c,d,p)=>{const f=hl(l,r);return s({node:l,view:u,getPos:c,decorations:d,innerDecorations:p,editor:t,extension:n,HTMLAttributes:f})};return[n.name,a]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Js(this.extensions);return Object.fromEntries(e.filter(n=>!!Ee(n,"addMarkView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Qr(n.name,this.schema)},o=Ee(n,"addMarkView",i);if(!o)return[];const s=(a,l,u)=>{const c=hl(a,r);return o()({mark:a,view:l,inline:u,editor:t,extension:n,HTMLAttributes:c,updateAttributes:d=>{S9(a,t,d)}})};return[n.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Sh(e.name,this.schema)};e.type==="mark"&&((n=pt(Ee(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const i=Ee(e,"onBeforeCreate",r),o=Ee(e,"onCreate",r),s=Ee(e,"onUpdate",r),a=Ee(e,"onSelectionUpdate",r),l=Ee(e,"onTransaction",r),u=Ee(e,"onFocus",r),c=Ee(e,"onBlur",r),d=Ee(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}};Hd.resolve=W2;Hd.sort=Em;Hd.flatten=Mm;var c9={};km(c9,{ClipboardTextSerializer:()=>r3,Commands:()=>i3,Delete:()=>o3,Drop:()=>s3,Editable:()=>a3,FocusEvents:()=>u3,Keymap:()=>c3,Paste:()=>d3,Tabindex:()=>h3,TextDirection:()=>p3,focusEventsPluginKey:()=>l3});var yt=class n3 extends Dm{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new n3(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},r3=yt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ct({key:new Wt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(c=>c.$from.pos)),a=Math.max(...o.map(c=>c.$to.pos)),l=J2(n);return U2(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),i3=yt.create({name:"commands",addCommands(){return{...P2}}}),o3=yt.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,i;const o=()=>{var s,a,l,u;if((u=(l=(a=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,t))!=null?u:t.getMeta("y-sync$"))return;const c=q2(t.before,[t,...e]);X2(c).forEach(f=>{c.mapping.mapResult(f.oldRange.from).deletedAfter&&c.mapping.mapResult(f.oldRange.to).deletedBefore&&c.before.nodesBetween(f.oldRange.from,f.oldRange.to,(g,x)=>{const w=x+g.nodeSize-2,k=f.oldRange.from<=x&&w<=f.oldRange.to;this.editor.emit("delete",{type:"node",node:g,from:x,to:w,newFrom:c.mapping.map(x),newTo:c.mapping.map(w),deletedRange:f.oldRange,newRange:f.newRange,partial:!k,editor:this.editor,transaction:t,combinedTransform:c})})});const p=c.mapping;c.steps.forEach((f,g)=>{var x,w;if(f instanceof ar){const k=p.slice(g).map(f.from,-1),D=p.slice(g).map(f.to),N=p.invert().map(k,-1),B=p.invert().map(D),T=(x=c.doc.nodeAt(k-1))==null?void 0:x.marks.some(L=>L.eq(f.mark)),R=(w=c.doc.nodeAt(D))==null?void 0:w.marks.some(L=>L.eq(f.mark));this.editor.emit("delete",{type:"mark",mark:f.mark,from:f.from,to:f.to,deletedRange:{from:N,to:B},newRange:{from:k,to:D},partial:!!(R||T),editor:this.editor,transaction:t,combinedTransform:c})}})};(i=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||i?setTimeout(o,0):o()}}),s3=yt.create({name:"drop",addProseMirrorPlugins(){return[new Ct({key:new Wt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),a3=yt.create({name:"editable",addProseMirrorPlugins(){return[new Ct({key:new Wt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),l3=new Wt("focusEvents"),u3=yt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ct({key:l3,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),c3=yt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:u}=a,{empty:c,$anchor:d}=l,{pos:p,parent:f}=d,g=d.parent.isTextblock&&p>0?a.doc.resolve(p-1):d,x=g.parent.type.spec.isolating,w=d.pos-d.parentOffset,k=x&&g.parent.childCount===1?w===d.pos:Xe.atStart(u).from===p;return!c||!f.type.isTextblock||f.textContent.length||!k||k&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return $d()||K2()?o:i},addProseMirrorPlugins(){return[new Ct({key:new Wt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(x=>x.getMeta("composition")))return;const r=t.some(x=>x.docChanged)&&!e.doc.eq(n.doc),i=t.some(x=>x.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=Xe.atStart(e.doc).from,u=Xe.atEnd(e.doc).to;if(o||!(s===l&&a===u)||!qd(n.doc))return;const p=n.tr,f=zd({state:n,transaction:p}),{commands:g}=new Fd({editor:this.editor,state:f});if(g.clearNodes(),!!p.steps.length)return p}})]}}),d3=yt.create({name:"paste",addProseMirrorPlugins(){return[new Ct({key:new Wt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),h3=yt.create({name:"tabindex",addProseMirrorPlugins(){return[new Ct({key:new Wt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),p3=yt.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Js(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ct({key:new Wt("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),d9=class Ms{constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Ms(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Ms(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Ms(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Ms(a,this.editor,i,i?n:null);i&&(l.actualDepth=this.depth+1),e.push(new Ms(a,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const o=i.node.attrs,s=Object.keys(n);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==n[l])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(n);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>n[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},h9=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function p9(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var f9=class extends e9{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:T7,createMappablePosition:B7},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:o})=>this.options.onDrop(r,i,o)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=z2(e,this.options.autofocus);this.editorState=As.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=p9(h9,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=V2(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;n=n.filter(s=>!s.key.startsWith(o))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[a3,r3.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),i3,u3,c3,h3,s3,d3,o3,p3.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Hd(r,this)}createCommandManager(){this.commandManager=new Fd({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=af(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=af(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new O2(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),i=n.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=n.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),a=s?.getMeta("focus"),l=s?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!n.some(u=>u.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return G2(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return A7(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Cm(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return k7(this.state.doc,{blockSeparator:e,textSerializers:{...J2(this.schema),...n}})}get isEmpty(){return qd(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new d9(e,this)}get $doc(){return this.$pos(0)}};function Gs(t){return new Vd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=pt(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),u=n.from+a.indexOf(s),c=u+s.length;if(Am(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(x=>x===t.type&&x!==f.mark.type)).filter(f=>f.to>u).length)return null;c<n.to&&o.delete(c,n.to),u>n.from&&o.delete(n.from+l,u);const p=n.from+l+s.length;o.addMark(n.from+l,p,t.type.create(i||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function m9(t){return new Vd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=pt(t.getAttributes,void 0,r)||{},{tr:o}=e,s=n.from;let a=n.to;const l=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=s+u;c>a?c=a:a=c+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(c,a,l)}else if(r[0]){const u=t.type.isInline?s:s-1;o.insert(u,t.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()},undoable:t.undoable})}function uf(t){return new Vd({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),o=pt(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)},undoable:t.undoable})}function Xs(t){return new Vd({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const o=pt(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),u=l&&sm(l,t.type,o);if(!u)return null;if(s.wrap(l,u),t.keepMarks&&t.editor){const{selection:d,storedMarks:p}=e,{splittableMarks:f}=t.editor.extensionManager,g=p||d.$to.parentOffset&&d.$from.marks();if(g){const x=g.filter(w=>f.includes(w.type.name));s.ensureMarks(x)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Qi(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)},undoable:t.undoable})}function g9(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof Ce){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}var y9={};km(y9,{createAtomBlockMarkdownSpec:()=>b9,createBlockMarkdownSpec:()=>v9,createInlineMarkdownSpec:()=>k9,parseAttributes:()=>Lm,parseIndentedBlocks:()=>cf,renderNestedMarkdownContent:()=>Bm,serializeAttributes:()=>Tm});function Lm(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,u=>(n.push(u),`__QUOTED_${n.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(s)).forEach(([,u,c])=>{var d;const p=parseInt(((d=c.match(/__QUOTED_(\d+)__/))==null?void 0:d[1])||"0",10),f=n[p];f&&(e[u]=f.slice(1,-1))});const l=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function Tm(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function b9(t){const{nodeName:e,name:n,parseAttributes:r=Lm,serializeAttributes:i=Tm,defaultAttributes:o={},requiredAttributes:s=[],allowedAttributes:a}=t,l=n||e,u=c=>{if(!a)return c;const d={};return a.forEach(p=>{p in c&&(d[p]=c[p])}),d};return{parseMarkdown:(c,d)=>{const p={...o,...c.attributes};return d.createNode(e,p,[])},markdownTokenizer:{name:e,level:"block",start(c){var d;const p=new RegExp(`^:::${l}(?:\\s|$)`,"m"),f=(d=c.match(p))==null?void 0:d.index;return f!==void 0?f:-1},tokenize(c,d,p){const f=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),g=c.match(f);if(!g)return;const x=g[1]||"",w=r(x);if(!s.find(D=>!(D in w)))return{type:e,raw:g[0],attributes:w}}},renderMarkdown:c=>{const d=u(c.attrs||{}),p=i(d),f=p?` {${p}}`:"";return`:::${l}${f} :::`}}}function v9(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=Lm,serializeAttributes:o=Tm,defaultAttributes:s={},content:a="block",allowedAttributes:l}=t,u=n||e,c=d=>{if(!l)return d;const p={};return l.forEach(f=>{f in d&&(p[f]=d[f])}),p};return{parseMarkdown:(d,p)=>{let f;if(r){const x=r(d);f=typeof x=="string"?[{type:"text",text:x}]:x}else a==="block"?f=p.parseChildren(d.tokens||[]):f=p.parseInline(d.tokens||[]);const g={...s,...d.attributes};return p.createNode(e,g,f)},markdownTokenizer:{name:e,level:"block",start(d){var p;const f=new RegExp(`^:::${u}`,"m"),g=(p=d.match(f))==null?void 0:p.index;return g!==void 0?g:-1},tokenize(d,p,f){var g;const x=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=d.match(x);if(!w)return;const[k,D=""]=w,N=i(D);let B=1;const T=k.length;let R="";const L=/^:::([\w-]*)(\s.*)?/gm,P=d.slice(T);for(L.lastIndex=0;;){const W=L.exec(P);if(W===null)break;const de=W.index,q=W[1];if(!((g=W[2])!=null&&g.endsWith(":::"))){if(q)B+=1;else if(B-=1,B===0){const ae=P.slice(0,de);R=ae.trim();const be=d.slice(0,T+de+W[0].length);let re=[];if(R)if(a==="block")for(re=f.blockTokens(ae),re.forEach(ce=>{ce.text&&(!ce.tokens||ce.tokens.length===0)&&(ce.tokens=f.inlineTokens(ce.text))});re.length>0;){const ce=re[re.length-1];if(ce.type==="paragraph"&&(!ce.text||ce.text.trim()===""))re.pop();else break}else re=f.inlineTokens(R);return{type:e,raw:be,attributes:N,content:R,tokens:re}}}}}},renderMarkdown:(d,p)=>{const f=c(d.attrs||{}),g=o(f),x=g?` {${g}}`:"",w=p.renderChildren(d.content||[],`

`);return`:::${u}${x}

${w}

:::`}}}function x9(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,i,o,s]=r;e[i]=o||s,r=n.exec(t)}return e}function w9(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function k9(t){const{nodeName:e,name:n,getContent:r,parseAttributes:i=x9,serializeAttributes:o=w9,defaultAttributes:s={},selfClosing:a=!1,allowedAttributes:l}=t,u=n||e,c=p=>{if(!l)return p;const f={};return l.forEach(g=>{const x=typeof g=="string"?g:g.name,w=typeof g=="string"?void 0:g.skipIfDefault;if(x in p){const k=p[x];if(w!==void 0&&k===w)return;f[x]=k}}),f},d=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(p,f)=>{const g={...s,...p.attributes};if(a)return f.createNode(e,g);const x=r?r(p):p.content||"";return x?f.createNode(e,g,[f.createTextNode(x)]):f.createNode(e,g,[])},markdownTokenizer:{name:e,level:"inline",start(p){const f=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),g=p.match(f),x=g?.index;return x!==void 0?x:-1},tokenize(p,f,g){const x=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),w=p.match(x);if(!w)return;let k="",D="";if(a){const[,B]=w;D=B}else{const[,B,T]=w;D=B,k=T||""}const N=i(D.trim());return{type:e,raw:w[0],content:k.trim(),attributes:N}}},renderMarkdown:p=>{let f="";r?f=r(p):p.content&&p.content.length>0&&(f=p.content.filter(k=>k.type==="text").map(k=>k.text).join(""));const g=c(p.attrs||{}),x=o(g),w=x?` ${x}`:"";return a?`[${u}${w}]`:`[${u}${w}]${f}[/${u}]`}}}function cf(t,e,n){var r,i,o,s;const a=t.split(`
`),l=[];let u="",c=0;const d=e.baseIndentSize||2;for(;c<a.length;){const p=a[c],f=p.match(e.itemPattern);if(!f){if(l.length>0)break;if(p.trim()===""){c+=1,u=`${u}${p}
`;continue}else return}const g=e.extractItemData(f),{indentLevel:x,mainContent:w}=g;u=`${u}${p}
`;const k=[w];for(c+=1;c<a.length;){const T=a[c];if(T.trim()===""){const L=a.slice(c+1).findIndex(de=>de.trim()!=="");if(L===-1)break;if((((i=(r=a[c+1+L].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>x){k.push(T),u=`${u}${T}
`,c+=1;continue}else break}if((((s=(o=T.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:s.length)||0)>x)k.push(T),u=`${u}${T}
`,c+=1;else break}let D;const N=k.slice(1);if(N.length>0){const T=N.map(R=>R.slice(x+d)).join(`
`);T.trim()&&(e.customNestedParser?D=e.customNestedParser(T):D=n.blockTokens(T))}const B=e.createToken(g,D);l.push(B)}if(l.length!==0)return{items:l,raw:u}}function Bm(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const i=typeof n=="function"?n(r):n,[o,...s]=t.content,a=e.renderChildren([o]),l=[`${i}${a}`];return s&&s.length>0&&s.forEach(u=>{const c=e.renderChildren([u]);if(c){const d=c.split(`
`).map(p=>p?e.indent(p):"").join(`
`);l.push(d)}}),l.join(`
`)}function S9(t,e,n={}){const{state:r}=e,{doc:i,tr:o}=r,s=t;i.descendants((a,l)=>{const u=o.mapping.map(l),c=o.mapping.map(l)+a.nodeSize;let d=null;if(a.marks.forEach(f=>{if(f!==s)return!1;d=f}),!d)return;let p=!1;if(Object.keys(n).forEach(f=>{n[f]!==d.attrs[f]&&(p=!0)}),p){const f=t.type.create({...t.attrs,...n});o.removeMark(u,c,t.type),o.addMark(u,c,f)}}),o.docChanged&&e.view.dispatch(o)}var gn=class f3 extends Dm{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new f3(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},_9=class{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.innerDecorations=e.innerDecorations,this.view=e.view,this.HTMLAttributes=e.HTMLAttributes,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var e,n,r,i,o,s,a;const{view:l}=this.editor,u=t.target,c=u.nodeType===3?(e=u.parentElement)==null?void 0:e.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||(n=this.contentDOM)!=null&&n.contains(u)||!c)return;let d=0,p=0;if(this.dom!==c){const D=this.dom.getBoundingClientRect(),N=c.getBoundingClientRect(),B=(i=t.offsetX)!=null?i:(r=t.nativeEvent)==null?void 0:r.offsetX,T=(s=t.offsetY)!=null?s:(o=t.nativeEvent)==null?void 0:o.offsetY;d=N.x-D.x+B,p=N.y-D.y+T}const f=this.dom.cloneNode(!0);try{const D=this.dom.getBoundingClientRect();f.style.width=`${Math.round(D.width)}px`,f.style.height=`${Math.round(D.height)}px`,f.style.boxSizing="border-box",f.style.pointerEvents="none"}catch{}let g=null;try{g=document.createElement("div"),g.style.position="absolute",g.style.top="-9999px",g.style.left="-9999px",g.style.pointerEvents="none",g.appendChild(f),document.body.appendChild(g),(a=t.dataTransfer)==null||a.setDragImage(f,d,p)}finally{g&&setTimeout(()=>{try{g?.remove()}catch{}},0)}const x=this.getPos();if(typeof x!="number")return;const w=Ce.create(l.state.doc,x),k=l.state.tr.setSelection(w);l.dispatch(k)}stopEvent(t){var e;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const n=t.target;if(!(this.dom.contains(n)&&!((e=this.contentDOM)!=null&&e.contains(n))))return!1;const i=t.type.startsWith("drag"),o=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!o&&!i)return!0;const{isEditable:a}=this.editor,{isDragging:l}=this,u=!!this.node.type.spec.draggable,c=Ce.isSelectable(this.node),d=t.type==="copy",p=t.type==="paste",f=t.type==="cut",g=t.type==="mousedown";if(!u&&c&&i&&t.target===this.dom&&t.preventDefault(),u&&i&&!l&&t.target===this.dom)return t.preventDefault(),!1;if(u&&a&&!l&&g){const x=n.closest("[data-drag-handle]");x&&(this.dom===x||this.dom.contains(x))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(l||o||d||p||f||g&&c)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&($d()||F2())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(n=>n.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:e})=>{const n=this.getPos();return typeof n!="number"?!1:(e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if(typeof t!="number")return;const e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}};function Wo(t){return new o9({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const o=pt(t.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let u=n.to;if(a){const c=l.search(/\S/),d=n.from+l.indexOf(a),p=d+a.length;if(Am(n.from,n.to,e.doc).filter(g=>g.mark.type.excluded.find(w=>w===t.type&&w!==g.mark.type)).filter(g=>g.to>d).length)return null;p<n.to&&s.delete(p,n.to),d>n.from&&s.delete(n.from+c,d),u=n.from+c+a.length,s.addMark(n.from+c,u,t.type.create(o||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:M9,getOwnPropertySymbols:C9}=Object,{hasOwnProperty:E9}=Object.prototype;function Ch(t,e){return function(r,i,o){return t(r,i,o)&&e(r,i,o)}}function jl(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:o}=i,s=o.get(n),a=o.get(r);if(s&&a)return s===r&&a===n;o.set(n,r),o.set(r,n);const l=t(n,r,i);return o.delete(n),o.delete(r),l}}function A9(t){return t?.[Symbol.toStringTag]}function Eg(t){return M9(t).concat(C9(t))}const D9=Object.hasOwn||((t,e)=>E9.call(t,e));function Yo(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const L9="__v",T9="__o",B9="_owner",{getOwnPropertyDescriptor:Ag,keys:Dg}=Object;function O9(t,e){return t.byteLength===e.byteLength&&Oc(new Uint8Array(t),new Uint8Array(e))}function N9(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function P9(t,e){return t.byteLength===e.byteLength&&Oc(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function I9(t,e){return Yo(t.getTime(),e.getTime())}function R9(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function z9(t,e){return t===e}function Lg(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.entries();let s,a,l=0;for(;(s=o.next())&&!s.done;){const u=e.entries();let c=!1,d=0;for(;(a=u.next())&&!a.done;){if(i[d]){d++;continue}const p=s.value,f=a.value;if(n.equals(p[0],f[0],l,d,t,e,n)&&n.equals(p[1],f[1],p[0],f[0],t,e,n)){c=i[d]=!0;break}d++}if(!c)return!1;l++}return!0}const F9=Yo;function $9(t,e,n){const r=Dg(t);let i=r.length;if(Dg(e).length!==i)return!1;for(;i-- >0;)if(!m3(t,e,n,r[i]))return!1;return!0}function sa(t,e,n){const r=Eg(t);let i=r.length;if(Eg(e).length!==i)return!1;let o,s,a;for(;i-- >0;)if(o=r[i],!m3(t,e,n,o)||(s=Ag(t,o),a=Ag(e,o),(s||a)&&(!s||!a||s.configurable!==a.configurable||s.enumerable!==a.enumerable||s.writable!==a.writable)))return!1;return!0}function K9(t,e){return Yo(t.valueOf(),e.valueOf())}function j9(t,e){return t.source===e.source&&t.flags===e.flags}function Tg(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=t.values();let s,a;for(;(s=o.next())&&!s.done;){const l=e.values();let u=!1,c=0;for(;(a=l.next())&&!a.done;){if(!i[c]&&n.equals(s.value,a.value,s.value,a.value,t,e,n)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function Oc(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function q9(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function m3(t,e,n,r){return(r===B9||r===T9||r===L9)&&(t.$$typeof||e.$$typeof)?!0:D9(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const V9="[object ArrayBuffer]",H9="[object Arguments]",W9="[object Boolean]",U9="[object DataView]",J9="[object Date]",G9="[object Error]",X9="[object Map]",Y9="[object Number]",Z9="[object Object]",Q9="[object RegExp]",eS="[object Set]",tS="[object String]",nS={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},rS="[object URL]",iS=Object.prototype.toString;function oS({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:o,areMapsEqual:s,areNumbersEqual:a,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:d,areTypedArraysEqual:p,areUrlsEqual:f,unknownTagComparators:g}){return function(w,k,D){if(w===k)return!0;if(w==null||k==null)return!1;const N=typeof w;if(N!==typeof k)return!1;if(N!=="object")return N==="number"?a(w,k,D):N==="function"?o(w,k,D):!1;const B=w.constructor;if(B!==k.constructor)return!1;if(B===Object)return l(w,k,D);if(Array.isArray(w))return e(w,k,D);if(B===Date)return r(w,k,D);if(B===RegExp)return c(w,k,D);if(B===Map)return s(w,k,D);if(B===Set)return d(w,k,D);const T=iS.call(w);if(T===J9)return r(w,k,D);if(T===Q9)return c(w,k,D);if(T===X9)return s(w,k,D);if(T===eS)return d(w,k,D);if(T===Z9)return typeof w.then!="function"&&typeof k.then!="function"&&l(w,k,D);if(T===rS)return f(w,k,D);if(T===G9)return i(w,k,D);if(T===H9)return l(w,k,D);if(nS[T])return p(w,k,D);if(T===V9)return t(w,k,D);if(T===U9)return n(w,k,D);if(T===W9||T===Y9||T===tS)return u(w,k,D);if(g){let R=g[T];if(!R){const L=A9(w);L&&(R=g[L])}if(R)return R(w,k,D)}return!1}}function sS({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:O9,areArraysEqual:n?sa:N9,areDataViewsEqual:P9,areDatesEqual:I9,areErrorsEqual:R9,areFunctionsEqual:z9,areMapsEqual:n?Ch(Lg,sa):Lg,areNumbersEqual:F9,areObjectsEqual:n?sa:$9,arePrimitiveWrappersEqual:K9,areRegExpsEqual:j9,areSetsEqual:n?Ch(Tg,sa):Tg,areTypedArraysEqual:n?Ch(Oc,sa):Oc,areUrlsEqual:q9,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=jl(r.areArraysEqual),o=jl(r.areMapsEqual),s=jl(r.areObjectsEqual),a=jl(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:s,areSetsEqual:a})}return r}function aS(t){return function(e,n,r,i,o,s,a){return t(e,n,a)}}function lS({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(a,l){const{cache:u=t?new WeakMap:void 0,meta:c}=n();return e(a,l,{cache:u,equals:r,meta:c,strict:i})};if(t)return function(a,l){return e(a,l,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const o={cache:void 0,equals:r,meta:void 0,strict:i};return function(a,l){return e(a,l,o)}}const uS=no();no({strict:!0});no({circular:!0});no({circular:!0,strict:!0});no({createInternalComparator:()=>Yo});no({strict:!0,createInternalComparator:()=>Yo});no({circular:!0,createInternalComparator:()=>Yo});no({circular:!0,createInternalComparator:()=>Yo,strict:!0});function no(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,o=sS(t),s=oS(o),a=n?n(s):aS(s);return lS({circular:e,comparator:s,createState:r,equals:a,strict:i})}var Eh={exports:{}},Ah={};var Bg;function cS(){if(Bg)return Ah;Bg=1;var t=Ld(),e=i6();function n(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,o=t.useRef,s=t.useEffect,a=t.useMemo,l=t.useDebugValue;return Ah.useSyncExternalStoreWithSelector=function(u,c,d,p,f){var g=o(null);if(g.current===null){var x={hasValue:!1,value:null};g.current=x}else x=g.current;g=a(function(){function k(R){if(!D){if(D=!0,N=R,R=p(R),f!==void 0&&x.hasValue){var L=x.value;if(f(L,R))return B=L}return B=R}if(L=B,r(N,R))return L;var P=p(R);return f!==void 0&&f(L,P)?(N=R,L):(N=R,B=P)}var D=!1,N,B,T=d===void 0?null:d;return[function(){return k(c())},T===null?void 0:function(){return k(T())}]},[c,d,p,f]);var w=i(u,g[0],g[1]);return s(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},Ah}var Og;function dS(){return Og||(Og=1,Eh.exports=cS()),Eh.exports}var g3=dS();const nT=nm(g3);var hS=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},pS=({contentComponent:t})=>{const e=n4.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return he.jsx(he.Fragment,{children:Object.values(e)})};function fS(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:r6.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}var mS=class extends Xr.Component{constructor(t){var e;super(t),this.editorContentRef=Xr.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=fS(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return he.jsxs(he.Fragment,{children:[he.jsx("div",{ref:hS(e,this.editorContentRef),...n}),t?.contentComponent&&he.jsx(pS,{contentComponent:t.contentComponent})]})}},gS=Ne.forwardRef((t,e)=>{const n=Xr.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Xr.createElement(mS,{key:n,innerRef:e,...t})}),yS=Xr.memo(gS),bS=typeof window<"u"?Ne.useLayoutEffect:Ne.useEffect,vS=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function xS(t){var e;const[n]=Ne.useState(()=>new vS(t.editor)),r=g3.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:uS);return bS(()=>n.watch(t.editor),[t.editor,n]),Ne.useDebugValue(r),r}var wS=!1,df=typeof window>"u",kS=df||!!(typeof window<"u"&&window.next),SS=class y3{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?df||kS?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)==null?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)==null?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)==null?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)==null?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)==null?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)==null?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)==null?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)==null?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)==null?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)==null?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)==null?void 0:o.call(i,...r)},onDelete:(...r)=>{var i,o;return(o=(i=this.options.current).onDelete)==null?void 0:o.call(i,...r)}};return new f9(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=n.extensions)==null?void 0:s[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?y3.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function _S(t={},e=[]){const n=Ne.useRef(t);n.current=t;const[r]=Ne.useState(()=>new SS(n)),i=n4.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return Ne.useDebugValue(i),Ne.useEffect(r.onRender(e)),xS({editor:i,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&o===0?0:o+1}),i}var MS=Ne.createContext({editor:null});MS.Consumer;var b3=Ne.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),CS=()=>Ne.useContext(b3),Om=Xr.forwardRef((t,e)=>{const{onDragStart:n}=CS(),r=t.as||"div";return he.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function Ng(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function Pg(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function ES(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function AS(t){if(Ng(t)||Pg(t))return!0;if(ES(t)){const e=t.type;if(e)return Ng(e)||Pg(e)}return!1}function DS(){try{if(Ne.version)return parseInt(Ne.version.split(".")[0],10)>=19}catch{}return!1}var LS=class{constructor(t,{editor:e,props:n={},as:r="div",className:i=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?rm.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var t;const e=this.component,n=this.props,r=this.editor,i=DS(),o=AS(e),s={...n};s.ref&&!(i||o)&&delete s.ref,!s.ref&&(i||o)&&(s.ref=a=>{this.ref=a}),this.reactElement=he.jsx(e,{...s}),(t=r?.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.props={...this.props,...t},this.render()}destroy(){var t;const e=this.editor;(t=e?.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};Xr.createContext({markViewContentRef:()=>{}});var TS=class extends _9{constructor(t,e,n){if(super(t,e,n),this.selectionRafId=null,!this.node.isLeaf){this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.dataset.nodeViewWrapper="",this.contentDOMElement.style.whiteSpace="inherit";const r=this.dom.querySelector("[data-node-view-content]");if(!r)return;r.appendChild(this.contentDOMElement)}}mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(l={})=>this.updateAttributes(l),deleteNode:()=>this.deleteNode(),ref:Ne.createRef()};if(!this.component.displayName){const l=u=>u.charAt(0).toUpperCase()+u.substring(1);this.component.displayName=l(this.extension.name)}const r={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:l=>{l&&this.contentDOMElement&&l.firstChild!==this.contentDOMElement&&(l.hasAttribute("data-node-view-wrapper")&&l.removeAttribute("data-node-view-wrapper"),l.appendChild(this.contentDOMElement))}},i=this.component,o=Ne.memo(l=>he.jsx(b3.Provider,{value:r,children:Ne.createElement(i,l)}));o.displayName="ReactNodeView";let s=this.node.isInline?"span":"div";this.options.as&&(s=this.options.as);const{className:a=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new LS(o,{editor:this.editor,props:t,as:s,className:`node-${this.node.type.name} ${a}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var t;if(this.renderer.element.firstElementChild&&!((t=this.renderer.element.firstElementChild)!=null&&t.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null),this.selectionRafId=requestAnimationFrame(()=>{this.selectionRafId=null;const{from:t,to:e}=this.editor.state.selection,n=this.getPos();if(typeof n=="number")if(t<=n&&e>=n+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}})}update(t,e,n){const r=i=>{this.renderer.updateProps(i),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(t.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const i=this.node,o=this.decorations,s=this.innerDecorations;return this.node=t,this.decorations=e,this.innerDecorations=n,this.options.update({oldNode:i,oldDecorations:o,newNode:t,newDecorations:e,oldInnerDecorations:s,innerDecorations:n,updateProps:()=>r({node:t,decorations:e,innerDecorations:n})})}return t===this.node&&this.decorations===e&&this.innerDecorations===n||(this.node=t,this.decorations=e,this.innerDecorations=n,r({node:t,decorations:e,innerDecorations:n})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null,this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null)}updateElementAttributes(){if(this.options.attrs){let t={};if(typeof this.options.attrs=="function"){const e=this.editor.extensionManager.attributes,n=hl(this.node,e);t=this.options.attrs({node:this.node,HTMLAttributes:n})}else t=this.options.attrs;this.renderer.updateAttributes(t)}}};function Nm(t,e){return n=>n.editor.contentComponent?new TS(t,n,e):{}}var Nc=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},BS=/^\s*>\s$/,OS=gn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Nc("blockquote",{...St(this.options.HTMLAttributes,t),children:Nc("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=">",r=[];return t.content.forEach(i=>{const a=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?n:`${n} ${l}`);r.push(a.join(`
`))}),r.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Xs({find:BS,type:this.type})]}}),NS=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,PS=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,IS=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,RS=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,zS=to.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Nc("strong",{...St(this.options.HTMLAttributes,t),children:Nc("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Gs({find:NS,type:this.type}),Gs({find:IS,type:this.type})]},addPasteRules(){return[Wo({find:PS,type:this.type}),Wo({find:RS,type:this.type})]}}),FS=/(^|[^`])`([^`]+)`(?!`)$/,$S=/(^|[^`])`([^`]+)`(?!`)/g,KS=to.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",St(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Gs({find:FS,type:this.type})]},addPasteRules(){return[Wo({find:$S,type:this.type})]}}),Dh=4,jS=/^```([a-z]+)?[\s\n]$/,qS=/^~~~([a-z]+)?[\s\n]$/,VS=gn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Dh,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",St(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const i=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Dh,{state:r}=t,{selection:i}=r,{$from:o,empty:s}=i;if(o.parent.type!==this.type)return!1;const a=" ".repeat(n);return s?t.commands.insertContent(a):t.commands.command(({tr:l})=>{const{from:u,to:c}=i,f=r.doc.textBetween(u,c,`
`,`
`).split(`
`).map(g=>a+g).join(`
`);return l.replaceWith(u,c,r.schema.text(f)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Dh,{state:r}=t,{selection:i}=r,{$from:o,empty:s}=i;return o.parent.type!==this.type?!1:s?t.commands.command(({tr:a})=>{var l;const{pos:u}=o,c=o.start(),d=o.end(),f=r.doc.textBetween(c,d,`
`,`
`).split(`
`);let g=0,x=0;const w=u-c;for(let R=0;R<f.length;R+=1){if(x+f[R].length>=w){g=R;break}x+=f[R].length+1}const D=((l=f[g].match(/^ */))==null?void 0:l[0])||"",N=Math.min(D.length,n);if(N===0)return!0;let B=c;for(let R=0;R<g;R+=1)B+=f[R].length+1;return a.delete(B,B+N),u-B<=N&&a.setSelection($e.create(a.doc,B)),!0}):t.commands.command(({tr:a})=>{const{from:l,to:u}=i,p=r.doc.textBetween(l,u,`
`,`
`).split(`
`).map(f=>{var g;const x=((g=f.match(/^ */))==null?void 0:g[0])||"",w=Math.min(x.length,n);return f.slice(w)}).join(`
`);return a.replaceWith(l,u,r.schema.text(p)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:u})=>(u.setSelection(Xe.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[uf({find:jS,type:this.type,getAttributes:t=>({language:t[1]})}),uf({find:qS,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ct({key:new Wt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i?.mode;if(!n||!o)return!1;const{tr:s,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection($e.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),HS=gn.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),WS=gn.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",St(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){const d=l.filter(p=>a.includes(p.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),US=gn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,St(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,i="#".repeat(r);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>uf({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),JS=gn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",St(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!g9(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,i=t();return Y2(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:s,dispatch:a})=>{if(a){const{$to:l}=s.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection($e.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(Ce.create(s.doc,l.pos)):s.setSelection($e.create(s.doc,l.pos));else{const c=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,d=c?.create();d&&(s.insert(u,d),s.setSelection($e.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[m9({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),GS=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,XS=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,YS=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,ZS=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,QS=to.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Gs({find:GS,type:this.type}),Gs({find:YS,type:this.type})]},addPasteRules(){return[Wo({find:XS,type:this.type}),Wo({find:ZS,type:this.type})]}});const e_="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",t_="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",hf="numeric",pf="ascii",ff="alpha",Ha="asciinumeric",Ia="alphanumeric",mf="domain",v3="emoji",n_="scheme",r_="slashscheme",Lh="whitespace";function i_(t,e){return t in e||(e[t]=[]),e[t]}function Ao(t,e,n){e[hf]&&(e[Ha]=!0,e[Ia]=!0),e[pf]&&(e[Ha]=!0,e[ff]=!0),e[Ha]&&(e[Ia]=!0),e[ff]&&(e[Ia]=!0),e[Ia]&&(e[mf]=!0),e[v3]&&(e[mf]=!0);for(const r in e){const i=i_(r,n);i.indexOf(t)<0&&i.push(t)}}function o_(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function En(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}En.groups={};En.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(t))return o}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let i=0;i<t.length;i++)this.tt(t[i],e,n,r)},tr(t,e,n,r){r=r||En.groups;let i;return e&&e.j?i=e:(i=new En(e),n&&r&&Ao(e,n,r)),this.jr.push([t,i]),i},ts(t,e,n,r){let i=this;const o=t.length;if(!o)return i;for(let s=0;s<o-1;s++)i=i.tt(t[s]);return i.tt(t[o-1],e,n,r)},tt(t,e,n,r){r=r||En.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const o=e;let s,a=i.go(t);if(a?(s=new En,Object.assign(s.j,a.j),s.jr.push.apply(s.jr,a.jr),s.jd=a.jd,s.t=a.t):s=new En,o){if(r)if(s.t&&typeof s.t=="string"){const l=Object.assign(o_(s.t,r),n);Ao(o,l,r)}else n&&Ao(o,n,r);s.t=o}return i.j[t]=s,s}};const Ge=(t,e,n,r,i)=>t.ta(e,n,r,i),At=(t,e,n,r,i)=>t.tr(e,n,r,i),Ig=(t,e,n,r,i)=>t.ts(e,n,r,i),le=(t,e,n,r,i)=>t.tt(e,n,r,i),Ir="WORD",gf="UWORD",x3="ASCIINUMERICAL",w3="ALPHANUMERICAL",pl="LOCALHOST",yf="TLD",bf="UTLD",oc="SCHEME",Cs="SLASH_SCHEME",Pm="NUM",vf="WS",Im="NL",Wa="OPENBRACE",Ua="CLOSEBRACE",Pc="OPENBRACKET",Ic="CLOSEBRACKET",Rc="OPENPAREN",zc="CLOSEPAREN",Fc="OPENANGLEBRACKET",$c="CLOSEANGLEBRACKET",Kc="FULLWIDTHLEFTPAREN",jc="FULLWIDTHRIGHTPAREN",qc="LEFTCORNERBRACKET",Vc="RIGHTCORNERBRACKET",Hc="LEFTWHITECORNERBRACKET",Wc="RIGHTWHITECORNERBRACKET",Uc="FULLWIDTHLESSTHAN",Jc="FULLWIDTHGREATERTHAN",Gc="AMPERSAND",Xc="APOSTROPHE",Yc="ASTERISK",Ai="AT",Zc="BACKSLASH",Qc="BACKTICK",ed="CARET",Bi="COLON",Rm="COMMA",td="DOLLAR",yr="DOT",nd="EQUALS",zm="EXCLAMATION",Hn="HYPHEN",Ja="PERCENT",rd="PIPE",id="PLUS",od="POUND",Ga="QUERY",Fm="QUOTE",k3="FULLWIDTHMIDDLEDOT",$m="SEMI",br="SLASH",Xa="TILDE",sd="UNDERSCORE",S3="EMOJI",ad="SYM";var _3=Object.freeze({__proto__:null,ALPHANUMERICAL:w3,AMPERSAND:Gc,APOSTROPHE:Xc,ASCIINUMERICAL:x3,ASTERISK:Yc,AT:Ai,BACKSLASH:Zc,BACKTICK:Qc,CARET:ed,CLOSEANGLEBRACKET:$c,CLOSEBRACE:Ua,CLOSEBRACKET:Ic,CLOSEPAREN:zc,COLON:Bi,COMMA:Rm,DOLLAR:td,DOT:yr,EMOJI:S3,EQUALS:nd,EXCLAMATION:zm,FULLWIDTHGREATERTHAN:Jc,FULLWIDTHLEFTPAREN:Kc,FULLWIDTHLESSTHAN:Uc,FULLWIDTHMIDDLEDOT:k3,FULLWIDTHRIGHTPAREN:jc,HYPHEN:Hn,LEFTCORNERBRACKET:qc,LEFTWHITECORNERBRACKET:Hc,LOCALHOST:pl,NL:Im,NUM:Pm,OPENANGLEBRACKET:Fc,OPENBRACE:Wa,OPENBRACKET:Pc,OPENPAREN:Rc,PERCENT:Ja,PIPE:rd,PLUS:id,POUND:od,QUERY:Ga,QUOTE:Fm,RIGHTCORNERBRACKET:Vc,RIGHTWHITECORNERBRACKET:Wc,SCHEME:oc,SEMI:$m,SLASH:br,SLASH_SCHEME:Cs,SYM:ad,TILDE:Xa,TLD:yf,UNDERSCORE:sd,UTLD:bf,UWORD:gf,WORD:Ir,WS:vf});const Lr=/[a-z]/,aa=new RegExp("\\p{L}","u"),Th=new RegExp("\\p{Emoji}","u"),Tr=/\d/,Bh=/\s/,Rg="\r",Oh=`
`,s_="",a_="",Nh="";let ql=null,Vl=null;function l_(t=[]){const e={};En.groups=e;const n=new En;ql==null&&(ql=zg(e_)),Vl==null&&(Vl=zg(t_)),le(n,"'",Xc),le(n,"{",Wa),le(n,"}",Ua),le(n,"[",Pc),le(n,"]",Ic),le(n,"(",Rc),le(n,")",zc),le(n,"<",Fc),le(n,">",$c),le(n,"",Kc),le(n,"",jc),le(n,"",qc),le(n,"",Vc),le(n,"",Hc),le(n,"",Wc),le(n,"",Uc),le(n,"",Jc),le(n,"&",Gc),le(n,"*",Yc),le(n,"@",Ai),le(n,"`",Qc),le(n,"^",ed),le(n,":",Bi),le(n,",",Rm),le(n,"$",td),le(n,".",yr),le(n,"=",nd),le(n,"!",zm),le(n,"-",Hn),le(n,"%",Ja),le(n,"|",rd),le(n,"+",id),le(n,"#",od),le(n,"?",Ga),le(n,'"',Fm),le(n,"/",br),le(n,";",$m),le(n,"~",Xa),le(n,"_",sd),le(n,"\\",Zc),le(n,"",k3);const r=At(n,Tr,Pm,{[hf]:!0});At(r,Tr,r);const i=At(r,Lr,x3,{[Ha]:!0}),o=At(r,aa,w3,{[Ia]:!0}),s=At(n,Lr,Ir,{[pf]:!0});At(s,Tr,i),At(s,Lr,s),At(i,Tr,i),At(i,Lr,i);const a=At(n,aa,gf,{[ff]:!0});At(a,Lr),At(a,Tr,o),At(a,aa,a),At(o,Tr,o),At(o,Lr),At(o,aa,o);const l=le(n,Oh,Im,{[Lh]:!0}),u=le(n,Rg,vf,{[Lh]:!0}),c=At(n,Bh,vf,{[Lh]:!0});le(n,Nh,c),le(u,Oh,l),le(u,Nh,c),At(u,Bh,c),le(c,Rg),le(c,Oh),At(c,Bh,c),le(c,Nh,c);const d=At(n,Th,S3,{[v3]:!0});le(d,"#"),At(d,Th,d),le(d,s_,d);const p=le(d,a_);le(p,"#"),At(p,Th,d);const f=[[Lr,s],[Tr,i]],g=[[Lr,null],[aa,a],[Tr,o]];for(let x=0;x<ql.length;x++)oi(n,ql[x],yf,Ir,f);for(let x=0;x<Vl.length;x++)oi(n,Vl[x],bf,gf,g);Ao(yf,{tld:!0,ascii:!0},e),Ao(bf,{utld:!0,alpha:!0},e),oi(n,"file",oc,Ir,f),oi(n,"mailto",oc,Ir,f),oi(n,"http",Cs,Ir,f),oi(n,"https",Cs,Ir,f),oi(n,"ftp",Cs,Ir,f),oi(n,"ftps",Cs,Ir,f),Ao(oc,{scheme:!0,ascii:!0},e),Ao(Cs,{slashscheme:!0,ascii:!0},e),t=t.sort((x,w)=>x[0]>w[0]?1:-1);for(let x=0;x<t.length;x++){const w=t[x][0],D=t[x][1]?{[n_]:!0}:{[r_]:!0};w.indexOf("-")>=0?D[mf]=!0:Lr.test(w)?Tr.test(w)?D[Ha]=!0:D[pf]=!0:D[hf]=!0,Ig(n,w,w,D)}return Ig(n,"localhost",pl,{ascii:!0}),n.jd=new En(ad),{start:n,tokens:Object.assign({groups:e},_3)}}function M3(t,e){const n=u_(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=n.length,i=[];let o=0,s=0;for(;s<r;){let a=t,l=null,u=0,c=null,d=-1,p=-1;for(;s<r&&(l=a.go(n[s]));)a=l,a.accepts()?(d=0,p=0,c=a):d>=0&&(d+=n[s].length,p++),u+=n[s].length,o+=n[s].length,s++;o-=d,s-=p,u-=d,i.push({t:c.t,v:e.slice(o-u,o),s:o-u,e:o})}return i}function u_(t){const e=[],n=t.length;let r=0;for(;r<n;){let i=t.charCodeAt(r),o,s=i<55296||i>56319||r+1===n||(o=t.charCodeAt(r+1))<56320||o>57343?t[r]:t.slice(r,r+2);e.push(s),r+=s.length}return e}function oi(t,e,n,r,i){let o;const s=e.length;for(let a=0;a<s-1;a++){const l=e[a];t.j[l]?o=t.j[l]:(o=new En(r),o.jr=i.slice(),t.j[l]=o),t=o}return o=new En(n),o.jr=i.slice(),t.j[e[s-1]]=o,o}function zg(t){const e=[],n=[];let r=0,i="0123456789";for(;r<t.length;){let o=0;for(;i.indexOf(t[r+o])>=0;)o++;if(o>0){e.push(n.join(""));for(let s=parseInt(t.substring(r,r+o),10);s>0;s--)n.pop();r+=o}else n.push(t[r]),r++}return e}const fl={defaultProtocol:"http",events:null,format:Fg,formatHref:Fg,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Km(t,e=null){let n=Object.assign({},fl);t&&(n=Object.assign(n,t instanceof Km?t.o:t));const r=n.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=i}Km.prototype={o:fl,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:fl[t],typeof i=="function"&&r&&(i=i(e,n))):typeof i=="function"&&r&&(i=i(e,n.t,n)),i)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function Fg(t){return t}function C3(t,e){this.t="token",this.v=t,this.tk=e}C3.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=fl.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),i=t.get("tagName",n,e),o=this.toFormattedString(t),s={},a=t.get("className",n,e),l=t.get("target",n,e),u=t.get("rel",n,e),c=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return s.href=r,a&&(s.class=a),l&&(s.target=l),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:o,eventListeners:d}}};function Wd(t,e){class n extends C3{constructor(i,o){super(i,o),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const $g=Wd("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Kg=Wd("text"),c_=Wd("nl"),Hl=Wd("url",{isLink:!0,toHref(t=fl.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==pl&&t[1].t===Bi}}),Fn=t=>new En(t);function d_({groups:t}){const e=t.domain.concat([Gc,Yc,Ai,Zc,Qc,ed,td,nd,Hn,Pm,Ja,rd,id,od,br,ad,Xa,sd]),n=[Xc,Bi,Rm,yr,zm,Ja,Ga,Fm,$m,Fc,$c,Wa,Ua,Ic,Pc,Rc,zc,Kc,jc,qc,Vc,Hc,Wc,Uc,Jc],r=[Gc,Xc,Yc,Zc,Qc,ed,td,nd,Hn,Wa,Ua,Ja,rd,id,od,Ga,br,ad,Xa,sd],i=Fn(),o=le(i,Xa);Ge(o,r,o),Ge(o,t.domain,o);const s=Fn(),a=Fn(),l=Fn();Ge(i,t.domain,s),Ge(i,t.scheme,a),Ge(i,t.slashscheme,l),Ge(s,r,o),Ge(s,t.domain,s);const u=le(s,Ai);le(o,Ai,u),le(a,Ai,u),le(l,Ai,u);const c=le(o,yr);Ge(c,r,o),Ge(c,t.domain,o);const d=Fn();Ge(u,t.domain,d),Ge(d,t.domain,d);const p=le(d,yr);Ge(p,t.domain,d);const f=Fn($g);Ge(p,t.tld,f),Ge(p,t.utld,f),le(u,pl,f);const g=le(d,Hn);le(g,Hn,g),Ge(g,t.domain,d),Ge(f,t.domain,d),le(f,yr,p),le(f,Hn,g);const x=le(f,Bi);Ge(x,t.numeric,$g);const w=le(s,Hn),k=le(s,yr);le(w,Hn,w),Ge(w,t.domain,s),Ge(k,r,o),Ge(k,t.domain,s);const D=Fn(Hl);Ge(k,t.tld,D),Ge(k,t.utld,D),Ge(D,t.domain,s),Ge(D,r,o),le(D,yr,k),le(D,Hn,w),le(D,Ai,u);const N=le(D,Bi),B=Fn(Hl);Ge(N,t.numeric,B);const T=Fn(Hl),R=Fn();Ge(T,e,T),Ge(T,n,R),Ge(R,e,T),Ge(R,n,R),le(D,br,T),le(B,br,T);const L=le(a,Bi),P=le(l,Bi),W=le(P,br),de=le(W,br);Ge(a,t.domain,s),le(a,yr,k),le(a,Hn,w),Ge(l,t.domain,s),le(l,yr,k),le(l,Hn,w),Ge(L,t.domain,T),le(L,br,T),le(L,Ga,T),Ge(de,t.domain,T),Ge(de,e,T),le(de,br,T);const q=[[Wa,Ua],[Pc,Ic],[Rc,zc],[Fc,$c],[Kc,jc],[qc,Vc],[Hc,Wc],[Uc,Jc]];for(let ae=0;ae<q.length;ae++){const[be,re]=q[ae],ce=le(T,be);le(R,be,ce),le(ce,re,T);const ge=Fn(Hl);Ge(ce,e,ge);const xe=Fn();Ge(ce,n),Ge(ge,e,ge),Ge(ge,n,xe),Ge(xe,e,ge),Ge(xe,n,xe),le(ge,re,T),le(xe,re,T)}return le(i,pl,D),le(i,Im,c_),{start:i,tokens:_3}}function h_(t,e,n){let r=n.length,i=0,o=[],s=[];for(;i<r;){let a=t,l=null,u=null,c=0,d=null,p=-1;for(;i<r&&!(l=a.go(n[i].t));)s.push(n[i++]);for(;i<r&&(u=l||a.go(n[i].t));)l=null,a=u,a.accepts()?(p=0,d=a):p>=0&&p++,i++,c++;if(p<0)i-=c,i<r&&(s.push(n[i]),i++);else{s.length>0&&(o.push(Ph(Kg,e,s)),s=[]),i-=p,c-=p;const f=d.t,g=n.slice(i-c,i);o.push(Ph(f,e,g))}}return s.length>0&&o.push(Ph(Kg,e,s)),o}function Ph(t,e,n){const r=n[0].s,i=n[n.length-1].e,o=e.slice(r,i);return new t(o,n)}const p_=typeof console<"u"&&console&&console.warn||(()=>{}),f_="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",wt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function m_(){return En.groups={},wt.scanner=null,wt.parser=null,wt.tokenQueue=[],wt.pluginQueue=[],wt.customSchemes=[],wt.initialized=!1,wt}function jg(t,e=!1){if(wt.initialized&&p_(`linkifyjs: already initialized - will not register custom scheme "${t}" ${f_}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);wt.customSchemes.push([t,e])}function g_(){wt.scanner=l_(wt.customSchemes);for(let t=0;t<wt.tokenQueue.length;t++)wt.tokenQueue[t][1]({scanner:wt.scanner});wt.parser=d_(wt.scanner.tokens);for(let t=0;t<wt.pluginQueue.length;t++)wt.pluginQueue[t][1]({scanner:wt.scanner,parser:wt.parser});return wt.initialized=!0,wt}function jm(t){return wt.initialized||g_(),h_(wt.parser.start,t,M3(wt.scanner.start,t))}jm.scan=M3;function E3(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new Km(n),i=jm(t),o=[];for(let s=0;s<i.length;s++){const a=i[s];a.isLink&&(!e||a.t===e)&&r.check(a)&&o.push(a.toFormattedObject(r))}return o}var qm="[\0- -\u2029]",y_=new RegExp(qm),b_=new RegExp(`${qm}$`),v_=new RegExp(qm,"g");function x_(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function w_(t){return new Ct({key:new Wt("autolink"),appendTransaction:(e,n,r)=>{const i=e.some(u=>u.docChanged)&&!n.doc.eq(r.doc),o=e.some(u=>u.getMeta("preventAutolink"));if(!i||o)return;const{tr:s}=r,a=q2(n.doc,[...e]);if(X2(a).forEach(({newRange:u})=>{const c=g7(r.doc,u,f=>f.isTextblock);let d,p;if(c.length>1)d=c[0],p=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(c.length){const f=r.doc.textBetween(u.from,u.to," "," ");if(!b_.test(f))return;d=c[0],p=r.doc.textBetween(d.pos,u.to,void 0," ")}if(d&&p){const f=p.split(y_).filter(Boolean);if(f.length<=0)return!1;const g=f[f.length-1],x=d.pos+p.lastIndexOf(g);if(!g)return!1;const w=jm(g).map(k=>k.toObject(t.defaultProtocol));if(!x_(w))return!1;w.filter(k=>k.isLink).map(k=>({...k,from:x+k.start+1,to:x+k.end+1})).filter(k=>r.schema.marks.code?!r.doc.rangeHasMark(k.from,k.to,r.schema.marks.code):!0).filter(k=>t.validate(k.value)).filter(k=>t.shouldAutoLink(k.value)).forEach(k=>{Am(k.from,k.to,r.doc).some(D=>D.mark.type===t.type)||s.addMark(k.from,k.to,t.type.create({href:k.href}))})}}),!!s.steps.length)return s}})}function k_(t){return new Ct({key:new Wt("handleClickLink"),props:{handleClick:(e,n,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let s=!1;if(t.enableClickSelection&&(s=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){let a=null;if(r.target instanceof HTMLAnchorElement)a=r.target;else{let d=r.target;const p=[];for(;d.nodeName!=="DIV";)p.push(d),d=d.parentNode;a=p.find(f=>f.nodeName==="A")}if(!a)return s;const l=G2(e.state,t.type.name),u=(i=a?.href)!=null?i:l.href,c=(o=a?.target)!=null?o:l.target;a&&u&&(window.open(u,c),s=!0)}return s}}})}function S_(t){return new Ct({key:new Wt("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:i}=t,{state:o}=e,{selection:s}=o,{empty:a}=s;if(a)return!1;let l="";r.content.forEach(c=>{l+=c.textContent});const u=E3(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.href)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function ro(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&n.push(i)}),!t||t.replace(v_,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var __=to.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){jg(t);return}jg(t.scheme,t.optionalSlashes)})},onDestroy(){m_()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ro(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!ro(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!ro(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",St(this.options.HTMLAttributes,t),0]:["a",St(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!ro(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!ro(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Wo({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,i=E3(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:s=>!!ro(s,n),protocols:n,defaultProtocol:r}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(w_({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!ro(i,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),t.push(k_({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(S_({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),M_=Object.defineProperty,C_=(t,e)=>{for(var n in e)M_(t,n,{get:e[n],enumerable:!0})},E_="listItem",qg="textStyle",Vg=/^\s*([-+*])\s$/,A3=gn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",St(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(E_,this.editor.getAttributes(qg)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Xs({find:Vg,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xs({find:Vg,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(qg),editor:this.editor})),[t]}}),D3=gn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",St(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))n=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),a=e.parseChildren(s);n.push(...a)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Bm(t,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),A_={};C_(A_,{findListItemPos:()=>Al,getNextListDepth:()=>Vm,handleBackspace:()=>xf,handleDelete:()=>wf,hasListBefore:()=>L3,hasListItemAfter:()=>D_,hasListItemBefore:()=>T3,listItemHasSubList:()=>B3,nextListIsDeeper:()=>O3,nextListIsHigher:()=>N3});var Al=(t,e)=>{const{$from:n}=e.selection,r=Kt(t,e.schema);let i=null,o=n.depth,s=n.pos,a=null;for(;o>0&&a===null;)i=n.node(o),i.type===r?a=o:(o-=1,s-=1);return a===null?null:{$pos:e.doc.resolve(s),depth:a}},Vm=(t,e)=>{const n=Al(t,e);if(!n)return!1;const[,r]=C7(e,t,n.$pos.pos+4);return r},L3=(t,e,n)=>{const{$anchor:r}=t.selection,i=Math.max(0,r.pos-2),o=t.doc.resolve(i).node();return!(!o||!n.includes(o.type.name))},T3=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((n=i.nodeBefore)==null?void 0:n.type.name)!==t)},B3=(t,e,n)=>{if(!n)return!1;const r=Kt(t,e.schema);let i=!1;return n.descendants(o=>{o.type===r&&(i=!0)}),i},xf=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Ui(t.state,e)&&L3(t.state,e,n)){const{$anchor:a}=t.state.selection,l=t.state.doc.resolve(a.before()-1),u=[];l.node().descendants((p,f)=>{p.type.name===e&&u.push({node:p,pos:f})});const c=u.at(-1);if(!c)return!1;const d=t.state.doc.resolve(l.start()+c.pos+1);return t.chain().cut({from:a.start()-1,to:a.end()+1},d.end()).joinForward().run()}if(!Ui(t.state,e)||!L7(t.state))return!1;const r=Al(e,t.state);if(!r)return!1;const o=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),s=B3(e,t.state,o);return T3(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},O3=(t,e)=>{const n=Vm(t,e),r=Al(t,e);return!r||!n?!1:n>r.depth},N3=(t,e)=>{const n=Vm(t,e),r=Al(t,e);return!r||!n?!1:n<r.depth},wf=(t,e)=>{if(!Ui(t.state,e)||!D7(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:i}=n;return!n.empty&&r.sameParent(i)?!1:O3(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():N3(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},D_=(t,e)=>{var n;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((n=i.nodeAfter)==null?void 0:n.type.name)!==t)},P3=yt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&wf(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&wf(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&xf(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&xf(t,n,r)&&(e=!0)}),e}}}}),Hg=/^(\s*)(\d+)\.\s+(.*)$/,L_=/^\s/;function T_(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n],o=i.match(Hg);if(!o)break;const[,s,a,l]=o,u=s.length;let c=l,d=n+1;const p=[i];for(;d<t.length;){const f=t[d];if(f.match(Hg))break;if(f.trim()==="")p.push(f),c+=`
`,d+=1;else if(f.match(L_))p.push(f),c+=`
${f.slice(u+2)}`,d+=1;else break}e.push({indent:u,number:parseInt(a,10),content:c.trim(),raw:p.join(`
`)}),r=d,n=d}return[e,r]}function I3(t,e,n){var r;const i=[];let o=0;for(;o<t.length;){const s=t[o];if(s.indent===e){const a=s.content.split(`
`),l=((r=a[0])==null?void 0:r.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const c=a.slice(1).join(`
`).trim();if(c){const f=n.blockTokens(c);u.push(...f)}let d=o+1;const p=[];for(;d<t.length&&t[d].indent>e;)p.push(t[d]),d+=1;if(p.length>0){const f=Math.min(...p.map(x=>x.indent)),g=I3(p,f,n);u.push({type:"list",ordered:!0,start:p[0].number,items:g,raw:p.map(x=>x.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),o=d}else o+=1}return i}function B_(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const o=e.parseChildren([i]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([i]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var O_="listItem",Wg="textStyle",Ug=/^(\d+)\.\s$/,R3=gn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",St(this.options.HTMLAttributes,n),0]:["ol",St(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?B_(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const i=t.split(`
`),[o,s]=T_(i);if(o.length===0)return;const a=I3(o,0,n);return a.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:a,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(O_,this.editor.getAttributes(Wg)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Xs({find:Ug,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Xs({find:Ug,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Wg)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),N_=/^\s*(\[([( |x])?\])\s$/,P_=gn.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",St(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const i=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Bm(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),s=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),u=c=>{var d,p;a.ariaLabel=((p=(d=this.options.a11y)==null?void 0:d.checkboxLabel)==null?void 0:p.call(d,c,a.checked))||`Task item checkbox for ${c.textContent||"empty task item"}`};return u(t),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",c=>c.preventDefault()),a.addEventListener("change",c=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:d}=c.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const f=n();if(typeof f!="number")return!1;const g=p.doc.nodeAt(f);return p.setNodeMarkup(f,void 0,{...g?.attrs,checked:d}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,d)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,d])=>{i.setAttribute(c,d)}),i.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,o.append(a,s),i.append(o,l),Object.entries(e).forEach(([c,d])=>{i.setAttribute(c,d)}),{dom:i,contentDOM:l,update:c=>c.type!==this.type?!1:(i.dataset.checked=c.attrs.checked,a.checked=c.attrs.checked,u(c),!0)}}},addInputRules(){return[Xs({find:N_,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),I_=gn.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",St(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=o=>{const s=cf(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:n.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},n);return s?[{type:"taskList",raw:s.raw,items:s.items}]:n.blockTokens(o)},i=cf(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,s)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:s}),customNestedParser:r},n);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});yt.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(A3.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(D3.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(P3.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(R3.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(P_.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(I_.configure(this.options.taskList)),t}});var R_=gn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",St(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),z_=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,F_=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,$_=to.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",St(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Gs({find:z_,type:this.type})]},addPasteRules(){return[Wo({find:F_,type:this.type})]}}),K_=gn.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),z3=to.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",St(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),j_=z3;function q_(t={}){return new Ct({view(e){return new V_(e,t)}})}class V_{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,a=o.height/i.offsetHeight;if(n){let d=e.nodeBefore,p=e.nodeAfter;if(d||p){let f=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(f){let g=f.getBoundingClientRect(),x=d?g.bottom:g.top;d&&p&&(x=(x+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*a;r={left:g.left,right:g.right,top:x-w,bottom:x+w}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*s;r={left:d.left-p,right:d.left+p,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,c=-pageYOffset;else{let d=l.getBoundingClientRect(),p=d.width/l.offsetWidth,f=d.height/l.offsetHeight;u=d.left-l.scrollLeft*p,c=d.top-l.scrollTop*f}this.element.style.left=(r.left-u)/s+"px",this.element.style.top=(r.top-c)/a+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!o){let s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=O4(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Tt extends Xe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Tt.valid(r)?new Tt(r):Xe.near(r)}content(){return ve.empty}eq(e){return e instanceof Tt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Tt(e.resolve(n.pos))}getBookmark(){return new Hm(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!H_(e)||!W_(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Tt.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(n>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(n>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=n;let l=e.doc.resolve(i);if(Tt.valid(l))return l}for(;;){let s=n>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!Ce.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*n),r=!1;continue e}break}o=s,i+=n;let a=e.doc.resolve(i);if(Tt.valid(a))return a}return null}}}Tt.prototype.visible=!1;Tt.findFrom=Tt.findGapCursorFrom;Xe.jsonID("gapcursor",Tt);class Hm{constructor(e){this.pos=e}map(e){return new Hm(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Tt.valid(n)?new Tt(n):Xe.near(n)}}function F3(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function H_(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||F3(i.type))return!0;if(i.inlineContent)return!1}}return!0}function W_(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||F3(i.type))return!0;if(i.inlineContent)return!1}}return!0}function U_(){return new Ct({props:{decorations:Y_,createSelectionBetween(t,e,n){return e.pos==n.pos&&Tt.valid(n)?new Tt(n):null},handleClick:G_,handleKeyDown:J_,handleDOMEvents:{beforeinput:X_}}})}const J_=N2({ArrowLeft:Wl("horiz",-1),ArrowRight:Wl("horiz",1),ArrowUp:Wl("vert",-1),ArrowDown:Wl("vert",1)});function Wl(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof $e){if(!o.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let u=Tt.findGapCursorFrom(a,e,l);return u?(i&&i(r.tr.setSelection(new Tt(u))),!0):!1}}function G_(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Tt.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&Ce.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Tt(r))),!0)}function X_(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Tt))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=se.empty;for(let s=r.length-1;s>=0;s--)i=se.from(r[s].createAndFill(null,i));let o=t.state.tr.replace(n.pos,n.pos,new ve(i,0,0));return o.setSelection($e.near(o.doc.resolve(n.pos+1))),t.dispatch(o),!1}function Y_(t){if(!(t.selection instanceof Tt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Mt.create(t.doc,[xn.widget(t.selection.head,e,{key:"gapcursor"})])}var ld=200,Zt=function(){};Zt.prototype.append=function(e){return e.length?(e=Zt.from(e),!this.length&&e||e.length<ld&&this.leafAppend(e)||this.length<ld&&e.leafPrepend(this)||this.appendInner(e)):this};Zt.prototype.prepend=function(e){return e.length?Zt.from(e).append(this):this};Zt.prototype.appendInner=function(e){return new Z_(this,e)};Zt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Zt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Zt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Zt.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Zt.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},n,r),i};Zt.from=function(e){return e instanceof Zt?e:e&&e.length?new $3(e):Zt.empty};var $3=(function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=ld)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=ld)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(Zt);Zt.empty=new $3([]);var Z_=(function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(Zt);const Q_=500;class or{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;n&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,u=[],c=[];return this.items.forEach((d,p)=>{if(!d.step){i||(i=this.remapping(r,p+1),o=i.maps.length),o--,c.push(d);return}if(i){c.push(new vr(d.map));let f=d.step.map(i.slice(o)),g;f&&s.maybeStep(f).doc&&(g=s.mapping.maps[s.mapping.maps.length-1],u.push(new vr(g,void 0,void 0,u.length+c.length))),o--,g&&i.appendMap(g,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new or(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,n,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),p=new vr(e.mapping.maps[c],d,n),f;(f=l&&l.merge(p))&&(p=f,c?o.pop():a=a.slice(0,a.length-1)),o.push(p),n&&(s++,n=void 0),i||(l=p)}let u=s-r.depth;return u>tM&&(a=eM(a,u),s-=u),new or(a.append(o),s)}remapping(e,n){let r=new sl;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,n),r}addMaps(e){return this.eventCount==0?this:new or(this.items.append(e.map(n=>new vr(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},i);let l=n;this.items.forEach(p=>{let f=o.getMirror(--l);if(f==null)return;s=Math.min(s,f);let g=o.maps[f];if(p.step){let x=e.steps[f].invert(e.docs[f]),w=p.selection&&p.selection.map(o.slice(l+1,f));w&&a++,r.push(new vr(g,x,w))}else r.push(new vr(g))},i);let u=[];for(let p=n;p<s;p++)u.push(new vr(o.maps[p]));let c=this.items.slice(0,i).append(u).append(r),d=new or(c,a);return d.emptyItemCount()>Q_&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(n.slice(r)),u=l&&l.getMap();if(r--,u&&n.appendMap(u,r),l){let c=s.selection&&s.selection.map(n.slice(r));c&&o++;let d=new vr(u.invert(),l,c),p,f=i.length-1;(p=i.length&&i[f].merge(d))?i[f]=p:i.push(d)}}else s.map&&r--},this.items.length,0),new or(Zt.from(i.reverse()),o)}}or.empty=new or(Zt.empty,0);function eM(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class vr{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new vr(n.getMap().invert(),n,this.selection)}}}class Di{constructor(e,n,r,i,o){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const tM=20;function nM(t,e,n,r){let i=n.getMeta(Po),o;if(i)return i.historyState;n.getMeta(oM)&&(t=new Di(t.done,t.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(s&&s.getMeta(Po))return s.getMeta(Po).redo?new Di(t.done.addTransform(n,void 0,r,sc(e)),t.undone,Jg(n.mapping.maps),t.prevTime,t.prevComposition):new Di(t.done,t.undone.addTransform(n,void 0,r,sc(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!rM(n,t.prevRanges)),u=s?Ih(t.prevRanges,n.mapping):Jg(n.mapping.maps);return new Di(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,sc(e)),or.empty,u,n.time,a??t.prevComposition)}else return(o=n.getMeta("rebased"))?new Di(t.done.rebased(n,o),t.undone.rebased(n,o),Ih(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Di(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Ih(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function rM(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(n=!0)}),n}function Jg(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,o,s)=>e.push(o,s));return e}function Ih(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),o=e.map(t[r+1],-1);i<=o&&n.push(i,o)}return n}function iM(t,e,n){let r=sc(e),i=Po.get(e).spec.config,o=(n?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(n?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new Di(n?a:o.remaining,n?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(Po,{redo:n,historyState:l})}let Rh=!1,Gg=null;function sc(t){let e=t.plugins;if(Gg!=e){Rh=!1,Gg=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Rh=!0;break}}return Rh}const Po=new Wt("history"),oM=new Wt("closeHistory");function sM(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ct({key:Po,state:{init(){return new Di(or.empty,or.empty,null,0,-1)},apply(e,n,r){return nM(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?j3:r=="historyRedo"?q3:null;return!i||!e.editable?!1:(n.preventDefault(),i(e.state,e.dispatch))}}}})}function K3(t,e){return(n,r)=>{let i=Po.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let o=iM(i,n,t);o&&r(e?o.scrollIntoView():o)}return!0}}const j3=K3(!1,!0),q3=K3(!0,!0);yt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new Ct({key:new Wt("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const o=this.storage.characters({node:r.doc});if(o>i){const s=o-i,a=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=r.tr.deleteRange(a,l);return t=!0,u}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:n.doc}),o=this.storage.characters({node:e.doc});if(o<=r||i>r&&o>r&&o<=i)return!0;if(i>r&&o>r&&o>i||!e.getMeta("paste"))return!1;const a=e.selection.$head.pos,l=o-r,u=a-l,c=a;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>r)}})]}});var aM=yt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[q_(this.options)]}});yt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ct({key:new Wt("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:i}=e,o=[];if(!n||!r)return Mt.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;s+=1});let a=0;return t.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&s-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(xn.node(u,u+l.nodeSize,{class:this.options.className}))}),Mt.create(t,o)}}})]}});var lM=yt.create({name:"gapCursor",addProseMirrorPlugins(){return[U_()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=pt(Ee(t,"allowGapCursor",n)))!=null?e:null}}});yt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ct({key:new Wt("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,u=!s.isLeaf&&qd(s);if((l||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];o&&c.push(this.options.emptyEditorClass);const d=xn.node(a,a+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),Mt.create(t,i)}}})]}});yt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Ct({key:new Wt("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||Y2(n.selection)||t.view.dragging?null:Mt.create(n.doc,[xn.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function Xg({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var uM=yt.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Wt(this.name),n=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(n).includes(i.name));return[new Ct({key:e,appendTransaction:(i,o,s)=>{const{doc:a,tr:l,schema:u}=s,c=e.getState(s),d=a.content.size,p=u.nodes[n];if(c)return l.insert(d,p.create())},state:{init:(i,o)=>{const s=o.tr.doc.lastChild;return!Xg({node:s,types:r})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;const s=i.doc.lastChild;return!Xg({node:s,types:r})}}})]}}),cM=yt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>j3(t,e),redo:()=>({state:t,dispatch:e})=>q3(t,e)}},addProseMirrorPlugins(){return[sM(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),dM=yt.create({name:"starterKit",addExtensions(){var t,e,n,r;const i=[];return this.options.bold!==!1&&i.push(zS.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(OS.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(A3.configure(this.options.bulletList)),this.options.code!==!1&&i.push(KS.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(VS.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(HS.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(aM.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(lM.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(WS.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(US.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(cM.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(JS.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(QS.configure(this.options.italic)),this.options.listItem!==!1&&i.push(D3.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(P3.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(__.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(R3.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(R_.configure(this.options.paragraph)),this.options.strike!==!1&&i.push($_.configure(this.options.strike)),this.options.text!==!1&&i.push(K_.configure(this.options.text)),this.options.underline!==!1&&i.push(z3.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&i.push(uM.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),hM=dM,pM=20,V3=(t,e=0)=>{const n=[];return!t.children.length||e>pM||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...V3(r,e+1))}),n},fM=t=>{if(!t.children.length)return;const e=V3(t);e&&e.forEach(n=>{var r,i;const o=n.getAttribute("style"),s=(i=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:i.getAttribute("style");n.setAttribute("style",`${s};${o}`)})},H3=to.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&fM(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",St(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(o=>!!o))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),mM=yt.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const o=r[i].split(":");if(o.length>=2){const s=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(s==="background-color")return a.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),gM=yt.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const o=r[i].split(":");if(o.length>=2){const s=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(s==="color")return a.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),yM=yt.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),bM=yt.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),vM=yt.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});yt.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(mM.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(gM.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(yM.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(bM.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(vM.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(H3.configure(this.options.textStyle)),t}});var xM=Object.defineProperty,wM=Object.defineProperties,kM=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,W3=Object.prototype.hasOwnProperty,U3=Object.prototype.propertyIsEnumerable,Yg=(t,e,n)=>e in t?xM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O=(t,e)=>{for(var n in e||(e={}))W3.call(e,n)&&Yg(t,n,e[n]);if(ud)for(var n of ud(e))U3.call(e,n)&&Yg(t,n,e[n]);return t},V=(t,e)=>wM(t,kM(e)),Zg=t=>typeof t=="symbol"?t:t+"",cd=(t,e)=>{var n={};for(var r in t)W3.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ud)for(var r of ud(t))e.indexOf(r)<0&&U3.call(t,r)&&(n[r]=t[r]);return n};function Xn(){return"window"in globalThis&&"document"in globalThis}function J3(){return"matchMedia"in window?window.matchMedia("(pointer: coarse)").matches:"ontouchstart"in window||navigator.maxTouchPoints>0}function SM(){try{return window.self!==window.top}catch{return!0}}function G3(){return typeof navigator.vibrate=="function"}function ta(){var t,e;if(!Xn())return"other";let n=(e=(t=navigator.userAgentData)==null?void 0:t.platform)!=null?e:navigator.platform;return/^mac/i.test(n)?navigator.maxTouchPoints===5?"ios":"macos":/^win/i.test(n)?"windows":/android/i.test(navigator.userAgent)?"android":/iphone|ipod|ipad/i.test(navigator.userAgent)?"ios":/\bcros\b/i.test(navigator.userAgent)?"chromeos":"other"}function _M(){if(!Xn())return!0;if(/firefox/i.test(navigator.userAgent)){let t=navigator.userAgent.match(/firefox\/(\d+)/i);return t?parseInt(t[1])>=78:!1}if(/trident/i.test(navigator.userAgent))return!1;if(/edge/i.test(navigator.userAgent)){let t=navigator.userAgent.match(/edg\/(\d+)/i);return t?parseInt(t[1])>=79:!1}return!0}function Qg(){return HTMLElement.prototype.hasOwnProperty("popover")}var MM={id:"dvorak",locale:"en",displayName:"Dvorak",virtualLayout:"dvorak",platform:"",score:0,mapping:{KeyA:["a","A","",""],KeyB:["x","X","",""],KeyC:["j","J","",""],KeyD:["e","E","",""],KeyE:[".",">","",""],KeyF:["u","U","",""],KeyG:["i","I","",""],KeyH:["d","D","",""],KeyI:["c","C","",""],KeyJ:["h","H","",""],KeyK:["t","T","",""],KeyL:["n","N","",""],KeyM:["m","M","",""],KeyN:["b","B","",""],KeyO:["r","R","",""],KeyP:["l","L","",""],KeyQ:["'",'"',"",""],KeyR:["p","P","",""],KeyS:["o","O","",""],KeyT:["y","Y","",""],KeyU:["g","G","",""],KeyV:["k","K","",""],KeyW:[",","<","",""],KeyX:["q","Q","",""],KeyY:["f","F","",""],KeyZ:[";",":","",""],Digit1:["1","!","",""],Digit2:["2","@","",""],Digit3:["3","#","",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","^","",""],Digit7:["7","&","",""],Digit8:["8","*","",""],Digit9:["9","(","",""],Digit0:["0",")","",""],Space:[" "," "," "," "],Minus:["[","{","",""],Equal:["]","}","",""],BracketLeft:["/","?","",""],BracketRight:["=","+","",""],Backslash:["\\","|","",""],Semicolon:["s","S","",""],Quote:["-","_","",""],Backquote:["`","~","`","`"],Comma:["w","W","",""],Period:["v","V","",""],Slash:["z","Z","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[".",".",".","."],IntlBackslash:["","","",""],NumpadEqual:["=","=","=","="],AudioVolumeUp:["","=","","="]}},kf={id:"apple.en-intl",displayName:"English (international)",virtualLayout:"qwerty",platform:"apple",locale:"en",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["z","Z","",""],Digit1:["1","!","",""],Digit2:["2","@","",""],Digit3:["3","#","",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","^","",""],Digit7:["7","&","",""],Digit8:["8","*","",""],Digit9:["9","(","",""],Digit0:["0",")","",""],Space:[" "," "," "," "],Minus:["-","_","",""],Equal:["=","+","",""],BracketLeft:["[","{","",""],BracketRight:["]","}","",""],Backslash:["\\","|","",""],Semicolon:[";",":","",""],Quote:["'",'"',"",""],Backquote:["`","","`","`"],Comma:[",","<","",""],Period:[".",">","",""],Slash:["/","?","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[".",".",".","."],IntlBackslash:["","","",""],NumpadEqual:["=","=","=","="],AudioVolumeUp:["","=","","="]}},X3={id:"windows.en-intl",displayName:"English (international)",platform:"windows",virtualLayout:"qwerty",locale:"en",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["z","Z","",""],Digit1:["1","!","",""],Digit2:["2","@","",""],Digit3:["3","#","",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","^","",""],Digit7:["7","&","",""],Digit8:["8","*","",""],Digit9:["9","(","",""],Digit0:["0",")","",""],Space:[" "," ","",""],Minus:["-","_","",""],Equal:["=","+","",""],BracketLeft:["[","{","",""],BracketRight:["]","}","",""],Backslash:["\\","|","",""],Semicolon:[";",":","",""],Quote:["'",'"',"",""],Backquote:["`","~","",""],Comma:[",","<","",""],Period:[".",">","",""],Slash:["/","?","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["\\","|","",""]}},Y3={id:"linux.en",displayName:"English",platform:"linux",virtualLayout:"qwerty",locale:"en",score:0,mapping:{KeyA:["a","A","a","A"],KeyB:["b","B","b","B"],KeyC:["c","C","c","C"],KeyD:["d","D","d","D"],KeyE:["e","E","e","E"],KeyF:["f","F","f","F"],KeyG:["g","G","g","G"],KeyH:["h","H","h","H"],KeyI:["i","I","i","I"],KeyJ:["j","J","j","J"],KeyK:["k","K","k","K"],KeyL:["l","L","l","L"],KeyM:["m","M","m","M"],KeyN:["n","N","n","N"],KeyO:["o","O","o","O"],KeyP:["p","P","p","P"],KeyQ:["q","Q","q","Q"],KeyR:["r","R","r","R"],KeyS:["s","S","s","S"],KeyT:["t","T","t","T"],KeyU:["u","U","u","U"],KeyV:["v","V","v","V"],KeyW:["w","W","w","W"],KeyX:["x","X","x","X"],KeyY:["y","Y","y","Y"],KeyZ:["z","Z","z","Z"],Digit1:["1","!","1","!"],Digit2:["2","@","2","@"],Digit3:["3","#","3","#"],Digit4:["4","$","4","$"],Digit5:["5","%","5","%"],Digit6:["6","^","6","^"],Digit7:["7","&","7","&"],Digit8:["8","*","8","*"],Digit9:["9","(","9","("],Digit0:["0",")","0",")"],Space:[" "," "," "," "],Minus:["-","_","-","_"],Equal:["=","+","=","+"],BracketLeft:["[","{","[","{"],BracketRight:["]","}","]","}"],Backslash:["\\","|","\\","|"],Semicolon:[";",":",";",":"],Quote:["'",'"',"'",'"'],Backquote:["`","~","`","~"],Comma:[",","<",",","<"],Period:[".",">",".",">"],Slash:["/","?","/","?"],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|",""],NumpadEqual:["=","=","=","="],NumpadComma:[".",".",".","."],NumpadParenLeft:["(","(","(","("],NumpadParenRight:[")",")",")",")"]}},CM={id:"apple.french",locale:"fr",displayName:"French",platform:"apple",virtualLayout:"azerty",score:0,mapping:{KeyA:["q","Q","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","","|"],KeyM:[",","?","",""],KeyN:["n","N","~",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["a","A","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["z","Z","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["w","W","",""],Digit1:["&","1","",""],Digit2:["","2","",""],Digit3:['"',"3","",""],Digit4:["'","4","",""],Digit5:["(","5","{","["],Digit6:["","6","",""],Digit7:["","7","",""],Digit8:["!","8","",""],Digit9:["","9","",""],Digit0:["","0","",""],Space:[" "," "," "," "],Minus:[")","","}","]"],Equal:["-","_","",""],BracketLeft:["^","","",""],BracketRight:["$","*","",""],Backslash:["`","","@","#"],Semicolon:["m","M","",""],Quote:["","%","",""],Backquote:["<",">","",""],Comma:[";",".","",""],Period:[":","/","","\\"],Slash:["=","+","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:[",",".",",","."],IntlBackslash:["@","#","",""],NumpadEqual:["=","=","=","="]}},EM={id:"windows.french",locale:"fr",displayName:"French",virtualLayout:"azerty",platform:"windows",score:0,mapping:{KeyA:["q","Q","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:[",","?","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["a","A","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["z","Z","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["w","W","",""],Digit1:["&","1","",""],Digit2:["","2","~",""],Digit3:['"',"3","#",""],Digit4:["'","4","{",""],Digit5:["(","5","[",""],Digit6:["-","6","|",""],Digit7:["","7","`",""],Digit8:["_","8","\\",""],Digit9:["","9","^",""],Digit0:["","0","@",""],Space:[" "," ","",""],Minus:[")","","]",""],Equal:["=","+","}",""],BracketLeft:["^","","",""],BracketRight:["$","","",""],Backslash:["*","","",""],Semicolon:["m","M","",""],Quote:["","%","",""],Backquote:["","","",""],Comma:[";",".","",""],Period:[":","/","",""],Slash:["!","","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","",""]}},AM={id:"linux.french",locale:"fr",displayName:"French",virtualLayout:"azerty",platform:"linux",score:0,mapping:{KeyA:["q","Q","@",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","","&"],KeyL:["l","L","",""],KeyM:[",","?","",""],KeyN:["n","N","n","N"],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["a","A","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["z","Z","","<"],KeyX:["x","X","",">"],KeyY:["y","Y","",""],KeyZ:["w","W","",""],Digit1:["&","1","",""],Digit2:["","2","~",""],Digit3:['"',"3","#",""],Digit4:["'","4","{","$"],Digit5:["(","5","[",""],Digit6:["-","6","|",""],Digit7:["","7","`",""],Digit8:["_","8","\\",""],Digit9:["","9","^",""],Digit0:["","0","@",""],Enter:["\r","\r","\r","\r"],Escape:["\x1B","\x1B","\x1B","\x1B"],Backspace:["\b","\b","\b","\b"],Tab:["	","","	",""],Space:[" "," "," "," "],Minus:[")","","]",""],Equal:["=","+","}",""],BracketLeft:["","","",""],BracketRight:["$","","",""],Backslash:["*","","",""],Semicolon:["m","M","",""],Quote:["","%","",""],Backquote:["","~","",""],Comma:[";",".","",""],Period:[":","/","",""],Slash:["!","","",""],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|",""]}},DM={id:"apple.german",locale:"de",displayName:"German",virtualLayout:"qwertz",platform:"apple",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","@",""],KeyM:["m","M","",""],KeyN:["n","N","~",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["z","Z","",""],KeyZ:["y","Y","",""],Digit1:["1","!","",""],Digit2:["2",'"',"",""],Digit3:["3","","","#"],Digit4:["4","$","",""],Digit5:["5","%","[",""],Digit6:["6","&","]","^"],Digit7:["7","/","|","\\"],Digit8:["8","(","{",""],Digit9:["9",")","}",""],Digit0:["0","=","",""],Space:[" "," "," "," "],Minus:["","?","",""],Equal:["","`","'",""],BracketLeft:["","","",""],BracketRight:["+","*","",""],Backslash:["#","'","",""],Semicolon:["","","",""],Quote:["","","",""],Backquote:["<",">","",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadDecimal:[",",",",".","."],IntlBackslash:["^","","",""],NumpadEqual:["=","=","=","="]}},LM={id:"windows.german",locale:"de",displayName:"German",platform:"windows",virtualLayout:"qwertz",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","@",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["z","Z","",""],KeyZ:["y","Y","",""],Digit1:["1","!","",""],Digit2:["2",'"',"",""],Digit3:["3","","",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","&","",""],Digit7:["7","/","{",""],Digit8:["8","(","[",""],Digit9:["9",")","]",""],Digit0:["0","=","}",""],Space:[" "," ","",""],Minus:["","?","\\",""],Equal:["","`","",""],BracketLeft:["","","",""],BracketRight:["+","*","~",""],Backslash:["#","'","",""],Semicolon:["","","",""],Quote:["","","",""],Backquote:["^","","",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","|",""]}},TM={id:"linux.german",locale:"de",displayName:"German",platform:"windows",virtualLayout:"qwertz",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","","&"],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","@",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["z","Z","",""],KeyZ:["y","Y","",""],Digit1:["1","!","",""],Digit2:["2",'"',"",""],Digit3:["3","","",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","&","",""],Digit7:["7","/","{",""],Digit8:["8","(","[",""],Digit9:["9",")","]",""],Digit0:["0","=","}",""],Enter:["\r","\r","\r","\r"],Escape:["\x1B","\x1B","\x1B","\x1B"],Backspace:["\b","\b","\b","\b"],Tab:["	","","	",""],Space:[" "," "," "," "],Minus:["","?","\\",""],Equal:["","","",""],BracketLeft:["","","",""],BracketRight:["+","*","~",""],Backslash:["#","'","",""],Semicolon:["","","",""],Quote:["","","",""],Backquote:["","","",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],PrintScreen:["","","",""],PageUp:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["","1","","1"],Numpad2:["","2","","2"],Numpad3:["","3","","3"],Numpad4:["","4","","4"],Numpad5:["","5","","5"],Numpad6:["","6","","6"],Numpad7:["","7","","7"],Numpad8:["","8","","8"],Numpad9:["","9","","9"],Numpad0:["","0","","0"],NumpadDecimal:["",",","",","],IntlBackslash:["<",">","|",""],AltRight:["\r","\r","\r","\r"],MetaRight:[".",".",".","."]}},BM={id:"apple.spanish",locale:"es",displayName:"Spanish ISO",platform:"apple",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C",""," "],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H",""," "],KeyI:["i","I"," "," "],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L"," ",""],KeyM:["m","M","",""],KeyN:["n","N"," ",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R",""," "],KeyS:["s","S",""," "],KeyT:["t","T","",""],KeyU:["u","U"," "," "],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["y","Y",""," "],KeyZ:["z","Z","",""],Digit1:["1","!","|",""],Digit2:["2",'"',"@",""],Digit3:["3","","#",""],Digit4:["4","$","",""],Digit5:["5","%","",""],Digit6:["6","&",""," "],Digit7:["7","/","",""],Digit8:["8","(","",""],Digit9:["9",")","",""],Digit0:["0","=","",""],Space:[" "," "," "," "],Minus:["'","?","",""],Equal:["","","",""],BracketLeft:["`","^","[",""],BracketRight:["+","*","]",""],Backslash:["","","}",""],Semicolon:["","","~",""],Quote:["","","{",""],Backquote:["<",">","",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],Numpad1:["1","1","1","1"],Numpad2:["2","2","2","2"],Numpad3:["3","3","3","3"],Numpad4:["4","4","4","4"],Numpad5:["5","5","5","5"],Numpad6:["6","6","6","6"],Numpad7:["7","7","7","7"],Numpad8:["8","8","8","8"],Numpad9:["9","9","9","9"],Numpad0:["0","0","0","0"],NumpadDecimal:[",",",",",",","],IntlBackslash:["","","\\",""]}},OM={id:"windows.spanish",locale:"es",displayName:"Spanish",platform:"windows",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","",""],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","",""],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",""],KeyY:["y","Y","",""],KeyZ:["z","Z","",""],Digit1:["1","!","|",""],Digit2:["2",'"',"@",""],Digit3:["3","","#",""],Digit4:["4","$","~",""],Digit5:["5","%","",""],Digit6:["6","&","",""],Digit7:["7","/","",""],Digit8:["8","(","",""],Digit9:["9",")","",""],Digit0:["0","=","",""],Space:[" "," ","",""],Minus:["'","?","",""],Equal:["","","",""],BracketLeft:["`","^","[",""],BracketRight:["+","*","]",""],Backslash:["","","}",""],Semicolon:["","","",""],Quote:["","","{",""],Backquote:["","","\\",""],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","",""],NumpadMultiply:["*","*","",""],NumpadSubtract:["-","-","",""],NumpadAdd:["+","+","",""],IntlBackslash:["<",">","",""]}},NM={id:"linux.spanish",locale:"es",displayName:"Spanish",platform:"linux",virtualLayout:"qwerty",score:0,mapping:{KeyA:["a","A","",""],KeyB:["b","B","",""],KeyC:["c","C","",""],KeyD:["d","D","",""],KeyE:["e","E","",""],KeyF:["f","F","",""],KeyG:["g","G","",""],KeyH:["h","H","",""],KeyI:["i","I","",""],KeyJ:["j","J","",""],KeyK:["k","K","","&"],KeyL:["l","L","",""],KeyM:["m","M","",""],KeyN:["n","N","n","N"],KeyO:["o","O","",""],KeyP:["p","P","",""],KeyQ:["q","Q","@",""],KeyR:["r","R","",""],KeyS:["s","S","",""],KeyT:["t","T","",""],KeyU:["u","U","",""],KeyV:["v","V","",""],KeyW:["w","W","",""],KeyX:["x","X","",">"],KeyY:["y","Y","",""],KeyZ:["z","Z","","<"],Digit1:["1","!","|",""],Digit2:["2",'"',"@",""],Digit3:["3","","#",""],Digit4:["4","$","~","$"],Digit5:["5","%","",""],Digit6:["6","&","",""],Digit7:["7","/","{",""],Digit8:["8","(","[",""],Digit9:["9",")","]",""],Digit0:["0","=","}",""],Enter:["\r","\r","\r","\r"],Escape:["\x1B","\x1B","\x1B","\x1B"],Backspace:["\b","\b","\b","\b"],Tab:["	","","	",""],Space:[" "," "," "," "],Minus:["'","?","\\",""],Equal:["","","","~"],BracketLeft:["","","[",""],BracketRight:["+","*","]",""],Backslash:["","","}",""],Semicolon:["","","~",""],Quote:["","","{","{"],Backquote:["","","\\","\\"],Comma:[",",";","",""],Period:[".",":","",""],Slash:["-","_","",""],NumpadDivide:["/","/","/","/"],NumpadMultiply:["*","*","*","*"],NumpadSubtract:["-","-","-","-"],NumpadAdd:["+","+","+","+"],NumpadEnter:["\r","\r","\r","\r"],Numpad1:["","1","","1"],Numpad2:["","2","","2"],Numpad3:["","3","","3"],Numpad4:["","4","","4"],Numpad5:["","5","","5"],Numpad6:["","6","","6"],Numpad7:["","7","","7"],Numpad8:["","8","","8"],Numpad9:["","9","","9"],Numpad0:["","0","","0"],NumpadDecimal:["",".","","."],IntlBackslash:["<",">","|",""],NumpadEqual:["=","=","=","="],NumpadComma:[".",".",".","."],NumpadParenLeft:["(","(","(","("],NumpadParenRight:[")",")",")",")"]}};function Z3(t){let e=t.split("+"),n={shift:!1,alt:!1,cmd:!1,win:!1,meta:!1,ctrl:!1,key:e.pop()};return e.includes("shift")&&(n.shift=!0),e.includes("alt")&&(n.alt=!0),e.includes("ctrl")&&(n.ctrl=!0),e.includes("cmd")&&(n.cmd=!0),e.includes("win")&&(n.win=!0),e.includes("meta")&&(n.meta=!0),n}function Ds(t){let e="";return t.shift&&(e+="shift+"),t.alt&&(e+="alt+"),t.ctrl&&(e+="ctrl+"),t.cmd&&(e+="cmd+"),t.win&&(e+="win+"),t.meta&&(e+="meta+"),e+t.key}var PM={enter:"[Enter]",escape:"[Escape]",backspace:"[Backspace]",tab:"[Tab]",space:"[Space]",pausebreak:"[Pause]",insert:"[Insert]",home:"[Home]",pageup:"[PageUp]",delete:"[Delete]",end:"[End]",pagedown:"[PageDown]",right:"[ArrowRight]",left:"[ArrowLeft]",down:"[ArrowDown]",up:"[ArrowUp]",numpad0:"[Numpad0]",numpad1:"[Numpad1]",numpad2:"[Numpad2]",numpad3:"[Numpad3]",numpad4:"[Numpad4]",numpad5:"[Numpad5]",numpad6:"[Numpad6]",numpad7:"[Numpad7]",numpad8:"[Numpad8]",numpad9:"[Numpad9]",numpad_divide:"[NumpadDivide]",numpad_multiply:"[NumpadMultiply]",numpad_subtract:"[NumpadSubtract]",numpad_add:"[NumpadAdd]",numpad_decimal:"[NumpadDecimal]",numpad_separator:"[NumpadComma]",capslock:"[Capslock]",f1:"[F1]",f2:"[F2]",f3:"[F3]",f4:"[F4]",f5:"[F5]",f6:"[F6]",f7:"[F7]",f8:"[F8]",f9:"[F9]",f10:"[F10]",f11:"[F11]",f12:"[F12]",f13:"[F13]",f14:"[F14]",f15:"[F15]",f16:"[F16]",f17:"[F17]",f18:"[F18]",f19:"[F19]"},dd=[];function Wm(){switch(ta()){case"macos":case"ios":return"apple";case"windows":return"windows"}return"linux"}function On(t){(!t.platform||t.platform===Wm())&&dd.push(t)}function IM(t,e){var n;let r={shift:!1,alt:!1,cmd:!1,win:!1,meta:!1,ctrl:!1,key:""};if(!t)return r;for(let[i,o]of Object.entries(e.mapping)){if(o[0]===t)return r.key=`[${i}]`,r;if(o[1]===t)return r.shift=!0,r.key=`[${i}]`,r;if(o[2]===t)return r.alt=!0,r.key=`[${i}]`,r;if(o[3]===t)return r.shift=!0,r.alt=!0,r.key=`[${i}]`,r}return r.key=(n=PM[t])!=null?n:"",r}function RM(t){if(t.code)return t;let e=Object.entries(ml().mapping),n=!1,r=!1,i="";for(let o=0;o<4;o++){for(let[s,a]of e)if(a[o]===t.key){i=s,o===3?(n=!0,r=!0):o===2?n=!0:o===1&&(r=!0);break}if(i)break}return new KeyboardEvent(t.type,V(O({},t),{altKey:n,shiftKey:r,code:i}))}function zM(t){var e,n;if(!t||t.key==="Unidentified"||t.key==="Dead")return;let r=t.shiftKey&&t.altKey?3:t.altKey?2:t.shiftKey?1:0;for(let i of dd)((e=i.mapping[t.code])==null?void 0:e[r])===t.key?i.score+=1:(n=i.mapping[t.code])!=null&&n[r]&&(i.score=0);dd.sort((i,o)=>o.score-i.score)}function ml(){return dd[0]}function FM(){switch(Wm()){case"apple":return kf;case"windows":return X3;case"linux":return Y3}return kf}switch(Wm()){case"apple":On(kf),On(CM),On(BM),On(DM);break;case"windows":On(X3),On(EM),On(OM),On(LM);break;case"linux":On(Y3),On(AM),On(NM),On(TM);break}On(MM);function Ht(t){return Array.isArray(t)}var $M={en:{"keyboard.tooltip.symbols":"Symbols","keyboard.tooltip.greek":"Greek Letters","keyboard.tooltip.numeric":"Numeric","keyboard.tooltip.alphabetic":"Roman Letters","tooltip.copy to clipboard":"Copy to Clipboard","tooltip.cut to clipboard":"Cut to Clipboard","tooltip.paste from clipboard":"Paste from Clipboard","tooltip.redo":"Redo","tooltip.toggle virtual keyboard":"Toggle Virtual Keyboard","tooltip.menu":"Menu","tooltip.undo":"Undo","menu.borders":"Borders","menu.insert matrix":"Insert Matrix","menu.array.add row above":"Add Row Before","menu.array.add row below":"Add Row After","menu.array.add column after":"Add Column After","menu.array.add column before":"Add Column Before","menu.array.delete row":"Delete Row","menu.array.delete rows":"Delete Selected Rows","menu.array.delete column":"Delete Column","menu.array.delete columns":"Delete Selected Columns","menu.mode":"Mode","menu.mode-math":"Math","menu.mode-text":"Text","menu.mode-latex":"LaTeX","menu.insert":"Insert","menu.insert.abs":"Absolute Value","menu.insert.abs-template":"\\left|x\\right|","menu.insert.nth-root":"n<sup>th</sup> Root","menu.insert.nth-root-template":"\\sqrt[n]{x}","menu.insert.log-base":"Logarithm base a","menu.insert.log-base-template":"\\log_a(x)","menu.insert.heading-calculus":"Calculus","menu.insert.derivative":"Derivative","menu.insert.derivative-template":"\\dfrac{\\mathrm{d}}{\\mathrm{d}x}f(x)\\bigm|_{x=a}","menu.insert.nth-derivative":"n<sup>th</sup> derivative","menu.insert.nth-derivative-template":"\\dfrac{\\mathrm{d}^n}{\\mathrm{d}x^n}f(x)\\bigm|_{x=a}","menu.insert.integral":"Integral","menu.insert.integral-template":"$\\int_a^b f(x)\\,\\mathrm{d}x$","menu.insert.sum":"Sum","menu.insert.sum-template":"$\\sum_{i=1}^n x_i$","menu.insert.product":"Product","menu.insert.product-template":"\\prod_{i=1}^n x_i","menu.insert.heading-complex-numbers":"Complex Numbers","menu.insert.modulus":"Modulus","menu.insert.modulus-template":"\\lvert z \\rvert","menu.insert.argument":"Argument","menu.insert.argument-template":"\\arg(z)","menu.insert.real-part":"Real Part","menu.insert.real-part-template":"\\Re(z)","menu.insert.imaginary-part":"Imaginary Part","menu.insert.imaginary-part-template":"\\Im(z)","menu.insert.conjugate":"Conjugate","menu.insert.conjugate-template":"\\overline{z}","tooltip.blackboard":"Blackboard","tooltip.bold":"Bold","tooltip.italic":"Italic","tooltip.fraktur":"Fraktur","tooltip.script":"Script","tooltip.caligraphic":"Caligraphic","tooltip.typewriter":"Typewriter","tooltip.roman-upright":"Roman Upright","tooltip.row-by-col":"%@  %@","menu.font-style":"Font Style","menu.accent":"Accent","menu.decoration":"Decoration","menu.color":"Color","menu.background-color":"Background","menu.evaluate":"Evaluate","menu.simplify":"Simplify","menu.solve":"Solve","menu.solve-for":"Solve for %@","menu.cut":"Cut","menu.copy":"Copy","menu.copy-as-latex":"Copy as LaTeX","menu.copy-as-typst":"Copy as Typst","menu.copy-as-ascii-math":"Copy as ASCII Math","menu.copy-as-mathml":"Copy as MathML","menu.paste":"Paste","menu.select-all":"Select All","color.red":"Red","color.orange":"Orange","color.yellow":"Yellow","color.lime":"Lime","color.green":"Green","color.teal":"Teal","color.cyan":"Cyan","color.blue":"Blue","color.indigo":"Indigo","color.purple":"Purple","color.magenta":"Magenta","color.black":"Black","color.dark-grey":"Dark Grey","color.grey":"Grey","color.light-grey":"Light Grey","color.white":"White"},ar:{"keyboard.tooltip.symbols":"  ","keyboard.tooltip.greek":" ","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":"  ","tooltip.copy to clipboard":"  ","tooltip.cut to clipboard":"  ","tooltip.paste from clipboard":"  ","tooltip.redo":"","tooltip.toggle virtual keyboard":"   ","tooltip.undo":"","menu.insert matrix":" ","menu.borders":" ","menu.array.add row above":"   ","menu.array.add row below":"  ","menu.array.add column after":"   ","menu.array.add column before":"  ","menu.array.delete row":" ","menu.array.delete rows":"  ","menu.array.delete column":" ","menu.array.delete columns":"  ","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":" ","tooltip.roman-upright":" ","tooltip.row-by-col":"%@  %@","menu.font-style":" ","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"  %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":"  LaTeX","menu.copy-as-ascii-math":"  ASCII Math","menu.copy-as-mathml":"  MathML","menu.paste":"","menu.select-all":" ","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":" ","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":" ","color.grey":"","color.light-grey":" ","color.white":""},de:{"keyboard.tooltip.symbols":"Symbole","keyboard.tooltip.greek":"Griechische Buchstaben","keyboard.tooltip.numeric":"Numerisch","keyboard.tooltip.alphabetic":"Rmische Buchstaben","tooltip.copy to clipboard":"In die Zwischenablage kopieren","tooltip.redo":"Wiederholen","tooltip.toggle virtual keyboard":"Virtuelle Tastatur umschalten","tooltip.undo":"Widerrufen","menu.insert matrix":"Matrix einfgen","menu.borders":"Matrixtrennzeichen","menu.array.add row above":"Zeile hinzufgen nach","menu.array.add row below":"Zeile hinzufgen vor","menu.array.add column after":"Spalte hinzufgen nach","menu.array.add column before":"Spalte hinzufgen vor","menu.array.delete row":"Zeile lschen","menu.array.delete rows":"Ausgewhlte Zeilen lschen","menu.array.delete column":"Spalte lschen","menu.array.delete columns":"Ausgewhlte Spalten lschen","menu.mode":"Modus","menu.mode-math":"Mathematik","menu.mode-text":"Text","menu.mode-latex":"LaTeX","tooltip.blackboard":"Tafel","tooltip.bold":"Fett","tooltip.italic":"Kursiv","tooltip.fraktur":"Fraktur","tooltip.script":"Skript","tooltip.caligraphic":"Kalligraphie","tooltip.typewriter":"Schreibmaschine","tooltip.roman-upright":"Rmisch aufrecht","tooltip.row-by-col":"%@  %@","menu.font-style":"Schriftstil","menu.accent":"Akzent","menu.decoration":"Dekoration","menu.color":"Farbe","menu.background-color":"Hintergrund","menu.evaluate":"Auswerten","menu.simplify":"Vereinfachen","menu.solve":"Lsen","menu.solve-for":"Lsen fr %@","menu.cut":"Ausschneiden","menu.copy":"Kopieren","menu.copy-as-latex":"Als LaTeX kopieren","menu.copy-as-ascii-math":"Als ASCII Math kopieren","menu.copy-as-mathml":"Als MathML kopieren","menu.paste":"Einfgen","menu.select-all":"Alles auswhlen","color.red":"Rot","color.orange":"Orange","color.yellow":"Gelb","color.lime":"Limette","color.green":"Grn","color.teal":"Blaugrn","color.cyan":"Cyan","color.blue":"Blau","color.indigo":"Indigo","color.purple":"Lila","color.magenta":"Magenta","color.black":"Schwarz","color.dark-grey":"Dunkelgrau","color.grey":"Grau","color.light-grey":"Hellgrau","color.white":"Wei"},el:{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":" ","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":" ","tooltip.copy to clipboard":"  ","tooltip.redo":"","tooltip.toggle virtual keyboard":"  ","tooltip.undo":"","menu.insert matrix":" ","menu.borders":" ","menu.array.add row above":"  ","menu.array.add row below":"  ","menu.array.add column after":"  ","menu.array.add column before":"  ","menu.array.delete row":" ","menu.array.delete rows":"  ","menu.array.delete column":" ","menu.array.delete columns":"  ","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":" ","tooltip.roman-upright":" ","tooltip.row-by-col":"%@  %@","menu.font-style":" ","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":" ","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"  %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":"  LaTeX","menu.copy-as-ascii-math":"  ASCII Math","menu.copy-as-mathml":"  MathML","menu.paste":"","menu.select-all":" ","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":" ","color.grey":"","color.light-grey":" ","color.white":""},es:{"keyboard.tooltip.symbols":"Smbolos","keyboard.tooltip.greek":"Letras griegas","keyboard.tooltip.numeric":"Numrico","keyboard.tooltip.alphabetic":"Letras romanas","tooltip.copy to clipboard":"Copiar al portapapeles","tooltip.redo":"Rehacer","tooltip.toggle virtual keyboard":"Alternar teclado virtual","tooltip.undo":"Deshacer","menu.insert matrix":"Aadir Matriz","menu.borders":"Delimitadores de Matriz","menu.array.add row above":"Aadir Lnea Antes","menu.array.add row below":"Aadir Lnea Despues","menu.array.add column after":"Aadir Columna Despues","menu.array.add column before":"Aadir Columna Antes","menu.array.delete row":"Borrar Lnea","menu.array.delete rows":"Borrar Lneas Seleccionadas","menu.array.delete column":"Borrar Columna","menu.array.delete columns":"Borrar Columnas Seleccionadas","menu.mode":"Modo","menu.mode-math":"Matemticas","menu.mode-text":"Texto","menu.mode-latex":"LaTeX","tooltip.blackboard":"Pizarra","tooltip.bold":"Negrita","tooltip.italic":"Cursiva","tooltip.fraktur":"Fraktur","tooltip.script":"Script","tooltip.caligraphic":"Caligrfico","tooltip.typewriter":"Mquina de escribir","tooltip.roman-upright":"Romano Vertical","tooltip.row-by-col":"%@  %@","menu.font-style":"Estilo de fuente","menu.accent":"Acento","menu.decoration":"Decoracin","menu.color":"Color","menu.background-color":"Fondo","menu.evaluate":"Evaluar","menu.simplify":"Simplificar","menu.solve":"Resolver","menu.solve-for":"Resolver para %@","menu.cut":"Cortar","menu.copy":"Copiar","menu.copy-as-latex":"Copiar como LaTeX","menu.copy-as-ascii-math":"Copiar como ASCII Math","menu.copy-as-mathml":"Copiar como MathML","menu.paste":"Pegar","menu.select-all":"Seleccionar todo","color.red":"Rojo","color.orange":"Naranja","color.yellow":"Amarillo","color.lime":"Lima","color.green":"Verde","color.teal":"Verde azulado","color.cyan":"Cian","color.blue":"Azul","color.indigo":"ndigo","color.purple":"Morado","color.magenta":"Magenta","color.black":"Negro","color.dark-grey":"Gris oscuro","color.grey":"Gris","color.light-grey":"Gris claro","color.white":"Blanco"},fr:{"keyboard.tooltip.symbols":"Symboles","keyboard.tooltip.greek":"Lettres grecques","keyboard.tooltip.numeric":"Numrique","keyboard.tooltip.alphabetic":"Lettres romaines","tooltip.menu":"Menu","tooltip.copy to clipboard":"Copier dans le presse-papiers","tooltip.redo":"Rtablir","tooltip.toggle virtual keyboard":"Afficher/Masquer le clavier virtuel","tooltip.undo":"Annuler","menu.insert matrix":"Insrer une Matrice","menu.borders":"Bords","menu.array.add row above":"Ajouter une Ligne Avant","menu.array.add row below":"Ajouter une Ligne Aprs","menu.array.add column before":"Ajouter une Colonne Avant","menu.array.add column after":"Ajouter une Colonne Aprs","menu.array.delete row":"Enlever une Ligne","menu.array.delete rows":"Enlever les Lignes Slectiones","menu.array.delete column":"Enlever une Colone","menu.array.delete columns":"Enlever les Colonnes Slectiones","menu.mode":"Mode","menu.mode-math":"Math","menu.mode-text":"Text","menu.mode-latex":"LaTeX","tooltip.blackboard":"Tableau noir","tooltip.bold":"Gras","tooltip.italic":"Italique","tooltip.fraktur":"Fraktur","tooltip.script":"Script","tooltip.caligraphic":"Calligraphique","tooltip.typewriter":"Machine  crire","tooltip.roman-upright":"Romain droit","tooltip.row-by-col":"%@  %@","menu.font-style":"Style de police","menu.accent":"Accent","menu.decoration":"Dcoration","menu.color":"Couleur","menu.background-color":"Arrire-plan","menu.evaluate":"valuer","menu.simplify":"Simplifier","menu.solve":"Rsoudre","menu.solve-for":"Rsoudre pour %@","menu.cut":"Couper","menu.copy":"Copier","menu.copy-as-latex":"Copier en LaTeX","menu.copy-as-ascii-math":"Copier en ASCII Math","menu.copy-as-mathml":"Copier en MathML","menu.paste":"Coller","menu.select-all":"Slectionner tout","color.red":"Rouge","color.orange":"Orange","color.yellow":"Jaune","color.lime":"Citron vert","color.green":"Vert","color.teal":"Turquoise","color.cyan":"Cyan","color.blue":"Bleu","color.indigo":"Indigo","color.purple":"Violet","color.magenta":"Magenta","color.black":"Noir","color.dark-grey":"Gris fonc","color.grey":"Gris","color.light-grey":"Gris clair","color.white":"Blanc"},he:{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":" ","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":" ","tooltip.copy to clipboard":" ","tooltip.redo":" ","tooltip.toggle virtual keyboard":"   ","tooltip.undo":"","menu.insert matrix":" ","menu.borders":" ","menu.array.add row above":"  ","menu.array.add row below":"  ","menu.array.add column after":"  ","menu.array.add column before":"  ","menu.array.delete row":" ","menu.array.delete rows":"  ","menu.array.delete column":" ","menu.array.delete columns":"  ","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":" ","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":" ","tooltip.roman-upright":" ","tooltip.row-by-col":"%@  %@","menu.font-style":" ","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"  %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":" LaTeX","menu.copy-as-ascii-math":" ASCII Math","menu.copy-as-mathml":" MathML","menu.paste":"","menu.select-all":" ","color.red":"","color.orange":"","color.yellow":"","color.lime":" ","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":" ","color.grey":"","color.light-grey":" ","color.white":""},it:{"keyboard.tooltip.symbols":"Simboli","keyboard.tooltip.greek":"Lettere Greche","keyboard.tooltip.numeric":"Numerico","keyboard.tooltip.alphabetic":"Lettere Romane","tooltip.copy to clipboard":"Copia negli appunti","tooltip.cut to clipboard":"Taglia negli appunti","tooltip.paste from clipboard":"Incolla dagli appunti","tooltip.redo":"Ripeti","tooltip.toggle virtual keyboard":"Attiva/Disattiva Tastiera Virtuale","tooltip.menu":"Menu","tooltip.undo":"Annulla","menu.borders":"Bordi","menu.insert matrix":"Inserisci Matrice","menu.array.add row above":"Aggiungi Riga Prima","menu.array.add row below":"Aggiungi Riga Dopo","menu.array.add column after":"Aggiungi Colonna Dopo","menu.array.add column before":"Aggiungi Colonna Prima","menu.array.delete row":"Elimina Riga","menu.array.delete rows":"Elimina Righe Selezionate","menu.array.delete column":"Elimina Colonna","menu.array.delete columns":"Elimina Colonne Selezionate","menu.mode":"Modalit","menu.mode-math":"Matematica","menu.mode-text":"Testo","menu.mode-latex":"LaTeX","menu.insert":"Inserisci","menu.insert.abs":"Valore Assoluto","menu.insert.abs-template":"\\left|x\\right|","menu.insert.nth-root":"Radice n-esima","menu.insert.nth-root-template":"\\sqrt[n]{x}","menu.insert.log-base":"Logaritmo in base a","menu.insert.log-base-template":"\\log_a(x)","menu.insert.heading-calculus":"Calcolo","menu.insert.derivative":"Derivata","menu.insert.derivative-template":"\\dfrac{\\mathrm{d}}{\\mathrm{d}x}f(x)\\bigm|_{x=a}","menu.insert.nth-derivative":"Derivata n-esima","menu.insert.nth-derivative-template":"\\dfrac{\\mathrm{d}^n}{\\mathrm{d}x^n}f(x)\\bigm|_{x=a}","menu.insert.integral":"Integrale","menu.insert.integral-template":"$\\int_a^b f(x)\\,\\mathrm{d}x$","menu.insert.sum":"Somma","menu.insert.sum-template":"$\\sum_{i=1}^n x_i$","menu.insert.product":"Prodotto","menu.insert.product-template":"\\prod_{i=1}^n x_i","menu.insert.heading-complex-numbers":"Numeri Complessi","menu.insert.modulus":"Modulo","menu.insert.modulus-template":"\\lvert z \\rvert","menu.insert.argument":"Argomento","menu.insert.argument-template":"\\arg(z)","menu.insert.real-part":"Parte Reale","menu.insert.real-part-template":"\\Re(z)","menu.insert.imaginary-part":"Parte Immaginaria","menu.insert.imaginary-part-template":"\\Im(z)","menu.insert.conjugate":"Coniugato","menu.insert.conjugate-template":"\\overline{z}","tooltip.blackboard":"Lavagna","tooltip.bold":"Grassetto","tooltip.italic":"Corsivo","tooltip.fraktur":"Fraktur","tooltip.script":"Script","tooltip.caligraphic":"Calligrafico","tooltip.typewriter":"Macchina da Scrivere","tooltip.roman-upright":"Romano Dritto","tooltip.row-by-col":"%@  %@","menu.font-style":"Stile del Carattere","menu.accent":"Accento","menu.decoration":"Decorazione","menu.color":"Colore","menu.background-color":"Sfondo","menu.evaluate":"Valuta","menu.simplify":"Semplifica","menu.solve":"Risolvi","menu.solve-for":"Risolvi per %@","menu.cut":"Taglia","menu.copy":"Copia","menu.copy-as-latex":"Copia come LaTeX","menu.copy-as-ascii-math":"Copia come ASCII Math","menu.copy-as-mathml":"Copia come MathML","menu.paste":"Incolla","menu.select-all":"Seleziona Tutto","color.red":"Rosso","color.orange":"Arancione","color.yellow":"Giallo","color.lime":"Lime","color.green":"Verde","color.teal":"Verde Acqua","color.cyan":"Ciano","color.blue":"Blu","color.indigo":"Indaco","color.purple":"Viola","color.magenta":"Magenta","color.black":"Nero","color.dark-grey":"Grigio Scuro","color.grey":"Grigio","color.light-grey":"Grigio Chiaro","color.white":"Bianco"},ja:{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":"","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":"","tooltip.menu":"","tooltip.copy to clipboard":"","tooltip.redo":"","tooltip.toggle virtual keyboard":"","tooltip.undo":"","menu.insert matrix":"","menu.borders":"","menu.array.add row above":"","menu.array.add row below":"","menu.array.add column after":"","menu.array.add column before":"","menu.array.delete row":"","menu.array.delete rows":"","menu.array.delete column":"","menu.array.delete columns":"","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":"","tooltip.roman-upright":"","tooltip.row-by-col":"%@  %@","menu.font-style":"","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"%@ ","menu.cut":"","menu.copy":"","menu.copy-as-latex":"LaTeX","menu.copy-as-ascii-math":"ASCII Math","menu.copy-as-mathml":"MathML","menu.paste":"","menu.select-all":"","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":"","color.grey":"","color.light-grey":"","color.white":""},ko:{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":" ","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":" ","tooltip.copy to clipboard":"  ","tooltip.redo":" ","tooltip.toggle virtual keyboard":"  ","tooltip.undo":" ","menu.insert matrix":" ","menu.borders":"  ","menu.array.add row above":"  ","menu.array.add row below":"  ","menu.array.add column after":"  ","menu.array.add column before":"  ","menu.array.delete row":" ","menu.array.delete rows":"  ","menu.array.delete column":" ","menu.array.delete columns":"  ","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":"","tooltip.roman-upright":" ","tooltip.row-by-col":"%@  %@","menu.font-style":" ","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"%@  ","menu.cut":"","menu.copy":"","menu.copy-as-latex":"LaTeX ","menu.copy-as-ascii-math":"ASCII Math ","menu.copy-as-mathml":"MathML ","menu.paste":"","menu.select-all":" ","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":" ","color.grey":"","color.light-grey":" ","color.white":""},pl:{"keyboard.tooltip.symbols":"Symbolika","keyboard.tooltip.greek":"Litery greckie","keyboard.tooltip.numeric":"Numeryczne","keyboard.tooltip.alphabetic":"Litery rzymskie","tooltip.copy to clipboard":"Kopiuj do Schowka","tooltip.cut to clipboard":"Wytnij ze Schowka","tooltip.paste from clipboard":"Wklej ze Schowka","tooltip.redo":"Przywr","tooltip.toggle virtual keyboard":"Przecz klawiatur wirtualn","tooltip.menu":"Menu","tooltip.undo":"Cofnij","menu.borders":"Ograniczniki macierzy","menu.insert matrix":"Wstaw macierz","menu.array.add row above":"Dodaj wiersz przed","menu.array.add row below":"Dodaj wiersz po","menu.array.add column after":"Dodaj kolumn po","menu.array.add column before":"Dodaj kolumn przed","menu.array.delete row":"Usu wiersz","menu.array.delete rows":"Usu wybrane wiersze","menu.array.delete column":"Usu kolumn","menu.array.delete columns":"Usu wybrane kolumny","menu.mode":"Tryb","menu.mode-math":"Formua","menu.mode-text":"Tekst","menu.mode-latex":"LaTeX","menu.insert":"Wstaw","menu.insert.abs":"Warto bezwzgldna","menu.insert.abs-template":"\\left|x\\right|","menu.insert.nth-root":"Pierwiastek n-tego stopnia","menu.insert.nth-root-template":"\\sqrt[n]{x}","menu.insert.log-base":"Logarytm o podstawie a","menu.insert.log-base-template":"\\log_a(x)","menu.insert.heading-calculus":"Rachunek rniczkowy i cakowy","menu.insert.derivative":"Pochodna","menu.insert.derivative-template":"\\dfrac{\\mathrm{d}}{\\mathrm{d}x}f(x)\\bigm|_{x=a}","menu.insert.nth-derivative":"Pochodna n-tego rzdu","menu.insert.nth-derivative-template":"\\dfrac{\\mathrm{d}^n}{\\mathrm{d}x^n}f(x)\\bigm|_{x=a}","menu.insert.integral":"Caka","menu.insert.integral-template":"$\\int_a^b f(x)\\,\\mathrm{d}x$","menu.insert.sum":"Suma","menu.insert.sum-template":"$\\sum_{i=1}^n x_i$","menu.insert.product":"Iloczyn","menu.insert.product-template":"\\prod_{i=1}^n x_i","menu.insert.heading-complex-numbers":"Liczby zespolone","menu.insert.modulus":"Modu","menu.insert.modulus-template":"\\lvert z \\rvert","menu.insert.argument":"Argument","menu.insert.argument-template":"\\arg(z)","menu.insert.real-part":"Cz rzeczywista","menu.insert.real-part-template":"\\Re(z)","menu.insert.imaginary-part":"Cz urojona","menu.insert.imaginary-part-template":"\\Im(z)","menu.insert.conjugate":"Sprzenie","menu.insert.conjugate-template":"\\overline{z}","tooltip.blackboard":"Tablica","tooltip.bold":"Pogrubienie","tooltip.italic":"Kursywa","tooltip.fraktur":"Fraktura","tooltip.script":"Skrypt","tooltip.caligraphic":"Kaligraficzny","tooltip.typewriter":"Maszynowy","tooltip.roman-upright":"Rzymski prosto","tooltip.row-by-col":"%@  %@","menu.font-style":"Styl czcionki","menu.accent":"Akcent","menu.decoration":"Dekoracja","menu.color":"Kolor","menu.background-color":"To","menu.evaluate":"Oblicz","menu.simplify":"Upro","menu.solve":"Rozwi","menu.solve-for":"Rozwi dla %@","menu.cut":"Wytnij","menu.copy":"Kopiuj","menu.copy-as-latex":"Kopiuj jako LaTeX","menu.copy-as-ascii-math":"Kopiuj jako ASCII Math","menu.copy-as-mathml":"Kopiuj jako MathML","menu.paste":"Wklej","menu.select-all":"Zaznacz wszystko","color.red":"Czerwony","color.orange":"Pomaraczowy","color.yellow":"ty","color.lime":"Limetkowy","color.green":"Zielony","color.teal":"Turkusowy","color.cyan":"Cyjan","color.blue":"Niebieski","color.indigo":"Indygo","color.purple":"Fioletowy","color.magenta":"Magenta","color.black":"Czarny","color.dark-grey":"Ciemnoszary","color.grey":"Szary","color.light-grey":"Jasnoszary","color.white":"Biay"},pt:{"keyboard.tooltip.symbols":"Smbolos","keyboard.tooltip.greek":"Letras gregas","keyboard.tooltip.numeric":"Numrico","keyboard.tooltip.alphabetic":"Letras romanas","tooltip.copy to clipboard":"Copiar para rea de transferncia","tooltip.redo":"Refazer","tooltip.toggle virtual keyboard":"Alternar teclado virtual","tooltip.undo":"Desfazer","menu.insert matrix":"Inserir Matriz","menu.borders":"Delimitadores de matriz","menu.array.add row above":"Adicionar linha depois","menu.array.add row below":"Adicionar linha antes","menu.array.add column after":"Adicionar coluna depois","menu.array.add column before":"Adicionar coluna antes","menu.array.delete row":"Excluir linha","menu.array.delete rows":"Excluir linhas selecionadas","menu.array.delete column":"Apagar Coluna","menu.array.delete columns":"Excluir Colunas Selecionadas","menu.mode":"Modo","menu.mode-math":"Frmula","menu.mode-text":"Texto","menu.mode-latex":"LaTeX","tooltip.blackboard":"Quadro Negro","tooltip.bold":"Negrito","tooltip.italic":"Itlico","tooltip.fraktur":"Fraktur","tooltip.script":"Script","tooltip.caligraphic":"Caligrfico","tooltip.typewriter":"Mquina de Escrever","tooltip.roman-upright":"Romano Vertical","tooltip.row-by-col":"%@  %@","menu.font-style":"Estilo da Fonte","menu.accent":"Acento","menu.decoration":"Decorao","menu.color":"Cor","menu.background-color":"Cor de Fundo","menu.evaluate":"Avaliar","menu.simplify":"Simplificar","menu.solve":"Resolver","menu.solve-for":"Resolver para %@","menu.cut":"Recortar","menu.copy":"Copiar","menu.copy-as-latex":"Copiar como LaTeX","menu.copy-as-ascii-math":"Copiar como ASCII Math","menu.copy-as-mathml":"Copiar como MathML","menu.paste":"Colar","menu.select-all":"Selecionar Tudo","color.red":"Vermelho","color.orange":"Laranja","color.yellow":"Amarelo","color.lime":"Verde Lima","color.green":"Verde","color.teal":"Verde-azulado","color.cyan":"Ciano","color.blue":"Azul","color.indigo":"ndigo","color.purple":"Roxo","color.magenta":"Magenta","color.black":"Preto","color.dark-grey":"Cinza Escuro","color.grey":"Cinza","color.light-grey":"Cinza Claro","color.white":"Branco"},uk:{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":" ","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":" ","tooltip.copy to clipboard":"   ","tooltip.cut to clipboard":"   ","tooltip.paste from clipboard":"   ","tooltip.redo":"","tooltip.toggle virtual keyboard":"  ","tooltip.menu":"","tooltip.undo":"","menu.borders":"","menu.insert matrix":" ","menu.array.add row above":"  ","menu.array.add row below":"  ","menu.array.add column after":"  ","menu.array.add column before":"  ","menu.array.delete row":" ","menu.array.delete rows":"  ","menu.array.delete column":" ","menu.array.delete columns":"  ","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","menu.insert":"","menu.insert.abs":" ","menu.insert.abs-template":"\\left|x\\right|","menu.insert.nth-root":" n- ","menu.insert.nth-root-template":"\\sqrt[n]{x}","menu.insert.log-base":"   a","menu.insert.log-base-template":"\\log_a(x)","menu.insert.heading-calculus":"","menu.insert.derivative":"","menu.insert.derivative-template":"\\dfrac{\\mathrm{d}}{\\mathrm{d}x}f(x)\\bigm|_{x=a}","menu.insert.nth-derivative":" n- ","menu.insert.nth-derivative-template":"\\dfrac{\\mathrm{d}^n}{\\mathrm{d}x^n}f(x)\\bigm|_{x=a}","menu.insert.integral":"","menu.insert.integral-template":"$\\int_a^b f(x)\\,\\mathrm{d}x$","menu.insert.sum":"","menu.insert.sum-template":"$\\sum_{i=1}^n x_i$","menu.insert.product":"","menu.insert.product-template":"\\prod_{i=1}^n x_i","menu.insert.heading-complex-numbers":" ","menu.insert.modulus":"","menu.insert.modulus-template":"\\lvert z \\rvert","menu.insert.argument":"","menu.insert.argument-template":"\\arg(z)","menu.insert.real-part":" ","menu.insert.real-part-template":"\\Re(z)","menu.insert.imaginary-part":" ","menu.insert.imaginary-part-template":"\\Im(z)","menu.insert.conjugate":" ","menu.insert.conjugate-template":"\\overline{z}","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":"","tooltip.roman-upright":" ","tooltip.row-by-col":"%@  %@","menu.font-style":" ","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":"  %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":"  LaTeX","menu.copy-as-ascii-math":"  ASCII Math","menu.copy-as-mathml":"  MathML","menu.paste":"","menu.select-all":" ","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"-","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":"-","color.grey":"","color.light-grey":"-","color.white":""},"zh-cn":{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":"","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":"","tooltip.copy to clipboard":"","tooltip.redo":"","tooltip.toggle virtual keyboard":"","tooltip.undo":"","menu.insert matrix":"","menu.borders":"","menu.array.add row above":"","menu.array.add row below":"","menu.array.add column after":"r","menu.array.add column before":"","menu.array.delete row":"","menu.array.delete rows":"","menu.array.delete column":"","menu.array.delete columns":"","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"Fraktur","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":"","tooltip.roman-upright":"","tooltip.row-by-col":"%@  %@","menu.font-style":"","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":" %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":" LaTeX","menu.copy-as-ascii-math":" ASCII Math","menu.copy-as-mathml":" MathML","menu.paste":"","menu.select-all":"","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":"","color.grey":"","color.light-grey":"","color.white":""},"zh-tw":{"keyboard.tooltip.symbols":"","keyboard.tooltip.greek":"","keyboard.tooltip.numeric":"","keyboard.tooltip.alphabetic":"","tooltip.copy to clipboard":"","tooltip.redo":"","tooltip.toggle virtual keyboard":"","tooltip.undo":"","menu.insert matrix":"","menu.borders":"","menu.array.add row above":"","menu.array.add row below":"","menu.array.add column after":"","menu.array.add column before":"","menu.array.delete row":"","menu.array.delete rows":"","menu.array.delete column":"","menu.array.delete columns":"","menu.mode":"","menu.mode-math":"","menu.mode-text":"","menu.mode-latex":"LaTeX","tooltip.blackboard":"","tooltip.bold":"","tooltip.italic":"","tooltip.fraktur":"Fraktur","tooltip.script":"","tooltip.caligraphic":"","tooltip.typewriter":"","tooltip.roman-upright":"","tooltip.row-by-col":"%@  %@","menu.font-style":"","menu.accent":"","menu.decoration":"","menu.color":"","menu.background-color":"","menu.evaluate":"","menu.simplify":"","menu.solve":"","menu.solve-for":" %@","menu.cut":"","menu.copy":"","menu.copy-as-latex":" LaTeX","menu.copy-as-ascii-math":" ASCII Math","menu.copy-as-mathml":" MathML","menu.paste":"","menu.select-all":"","color.red":"","color.orange":"","color.yellow":"","color.lime":"","color.green":"","color.teal":"","color.cyan":"","color.blue":"","color.indigo":"","color.purple":"","color.magenta":"","color.black":"","color.dark-grey":"","color.grey":"","color.light-grey":"","color.white":""}},qe={strings:$M,_locale:"",_dirty:!1,_subscribers:[],_numberFormatter:void 0,get locale(){return qe._locale||(qe._locale=Xn()?navigator.language.slice(0,5):"en-US"),qe._locale},set locale(t){qe._locale=t,qe._numberFormatter=void 0,qe.dirty=!0},get numberFormatter(){if(!qe._numberFormatter)try{qe._numberFormatter=new Intl.NumberFormat(qe.locale)}catch{try{qe._numberFormatter=new Intl.NumberFormat(qe.locale.slice(0,2))}catch{qe._numberFormatter=new Intl.NumberFormat("en-US")}}return qe._numberFormatter},merge(t,e){if(typeof t=="string"&&e)qe.strings[t]=O(O({},qe.strings[t]),e),qe.dirty=!0;else for(let n of Object.keys(t))qe.merge(n,t[n])},get dirty(){return qe._dirty},set dirty(t){qe._dirty||qe._dirty===t||(qe._dirty=!0,setTimeout(()=>{qe._dirty=!1,this._subscribers.forEach(e=>e?.())},0))},subscribe(t){return qe._subscribers.push(t),qe._subscribers.length-1},unsubscribe(t){t<0||t>=qe._subscribers.length||(qe._subscribers[t]=void 0)},update(t){let e=t.querySelectorAll("[data-l10n-tooltip]");for(let n of e){let r=n.getAttribute("data-l10n-tooltip");if(r){let i=Le(r);i&&n.setAttribute("data-tooltip",i)}}e=t.querySelectorAll("[data-l10n-arial-label]");for(let n of e){let r=n.getAttribute("data-l10n-arial-label");if(r){let i=Le(r);i&&n.setAttribute("aria-label",i)}}}};function Le(t,...e){if(t===void 0)return;let n="",r=qe.locale;qe.strings[r]&&(n=qe.strings[r][t]);let i=r.slice(0,2);if(!n&&qe.strings[i]&&(n=qe.strings[i][t]),n||(n=qe.strings.en[t]),!n)return;let o=/(%@|%([0-9]+)\$@)/g,s=o.exec(n),a=0;for(;s;){if(e[a++]){let l=s[2]?parseInt(s[2],10)-1:a-1,u=e[l];typeof u=="number"&&(u=qe.numberFormatter.format(u)),n=n.replace(s[1],u)}s=o.exec(n)}return n=n.replace(/%%/g,"%"),n}var KM={m0:"#3F3D99",m1:"#993D71",m2:"#998B3D",m3:"#3D9956",m4:"#3D5A99",m5:"#993D90",m6:"#996D3D",m7:"#43993D",m8:"#3D7999",m9:"#843D99"},jM={blue:"#0072BD",orange:"#D95319",yellow:"#EDB120",purple:"#7E2F8E",green:"#77AC30",cyan:"#4DBEEE",red:"#A2142F"},Io={red:"#fbbbb6",orange:"#ffe0c2",yellow:"#fff1c2",lime:"#d0e8b9",green:"#bceac4",teal:"#b9f1f1",cyan:"#b8e5c9",blue:"#b6d9fb",indigo:"#d1c2f0",purple:"#e3baf8",magenta:"#f9c8e0",black:"#353535","dark-grey":"#8C8C8C",grey:"#D0D0D0","light-grey":"#F0F0F0",white:"#ffffff"},Ro={red:"#d7170b",orange:"#fe8a2b",yellow:"#ffc02b",lime:"#63b215",green:"#21ba3a",teal:"#17cfcf",cyan:"#13a7ec",blue:"#0d80f2",indigo:"#63c",purple:"#a219e6",magenta:"#eb4799",black:"#000","dark-grey":"#666",grey:"#A6A6A6","light-grey":"#d4d5d2",white:"#ffffff"},Q3={Red:"red",Orange:"orange",Yellow:"yellow",LimeGreen:"lime",Green:"green",TealBlue:"teal",Blue:"blue",Violet:"indigo",Purple:"purple",Magenta:"magenta",Black:"black",Gray:"grey",White:"white"},qM={Apricot:"#FBB982",Aquamarine:"#00B5BE",Bittersweet:"#C04F17",Black:"#221E1F",Blue:"#2D2F92",BlueGreen:"#00B3B8",BlueViolet:"#473992",BrickRed:"#B6321C",Brown:"#792500",BurntOrange:"#F7921D",CadetBlue:"#74729A",CarnationPink:"#F282B4",Cerulean:"#00A2E3",CornflowerBlue:"#41B0E4",Cyan:"#00AEEF",Dandelion:"#FDBC42",DarkOrchid:"#A4538A",Emerald:"#00A99D",ForestGreen:"#009B55",Fuchsia:"#8C368C",Goldenrod:"#FFDF42",Gray:"#949698",Green:"#00A64F",GreenYellow:"#DFE674",JungleGreen:"#00A99A",Lavender:"#F49EC4",Limegreen:"#8DC73E",Magenta:"#EC008C",Mahogany:"#A9341F",Maroon:"#AF3235",Melon:"#F89E7B",MidnightBlue:"#006795",Mulberry:"#A93C93",NavyBlue:"#006EB8",OliveGreen:"#3C8031",Orange:"#F58137",OrangeRed:"#ED135A",Orchid:"#AF72B0",Peach:"#F7965A",Periwinkle:"#7977B8",PineGreen:"#008B72",Plum:"#92268F",ProcessBlue:"#00B0F0",Purple:"#99479B",RawSienna:"#974006",Red:"#ED1B23",RedOrange:"#F26035",RedViolet:"#A1246B",Rhodamine:"#EF559F",RoyalBlue:"#0071BC",RoyalPurple:"#613F99",RubineRed:"#ED017D",Salmon:"#F69289",SeaGreen:"#3FBC9D",Sepia:"#671800",SkyBlue:"#46C5DD",SpringGreen:"#C6DC67",Tan:"#DA9D76",TealBlue:"#00AEB3",Thistle:"#D883B7",Turquoise:"#00B4CE",Violet:"#58429B",VioletRed:"#EF58A0",White:"#FFFFFF",WildStrawberry:"#EE2967",Yellow:"#FFF200",YellowGreen:"#98CC70",YellowOrange:"#FAA21A"};function Ud(t){var e,n,r,i,o,s;let a=t.split("!"),l,u,c,d=255,p=255,f=255,g=-1,x=a.length>0&&a[0].startsWith("-");x&&(a[0]=a[0].slice(1));for(let w=0;w<a.length;w++){l=d,u=p,c=f;let k=(e=a[w].trim().match(/^([A-Za-z\d-]+)/))==null?void 0:e[1],D=k?.toLowerCase(),N=k&&(s=(o=(i=(r=(n=Ro[D])!=null?n:Ro[Q3[k]])!=null?r:jM[k])!=null?i:qM[k])!=null?o:KM[k])!=null?s:a[w].trim(),B=N.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);if(B!=null&&B[1]&&B[2]&&B[3])d=Math.max(0,Math.min(255,Number.parseInt(B[1],16))),p=Math.max(0,Math.min(255,Number.parseInt(B[2],16))),f=Math.max(0,Math.min(255,Number.parseInt(B[3],16)));else if(B=N.match(/^#([\da-f]{3})$/i),B!=null&&B[1]){let T=Number.parseInt(B[1][0],16),R=Number.parseInt(B[1][1],16),L=Number.parseInt(B[1][2],16);d=Math.max(0,Math.min(255,T*16+T)),p=Math.max(0,Math.min(255,R*16+R)),f=Math.max(0,Math.min(255,L*16+L))}else if(B=N.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),B!=null&&B[1]&&B[2]&&B[3])d=Math.max(0,Math.min(255,Number.parseInt(B[1]))),p=Math.max(0,Math.min(255,Number.parseInt(B[2]))),f=Math.max(0,Math.min(255,Number.parseInt(B[3])));else return;g>=0&&(d=(1-g)*d+g*l,p=(1-g)*p+g*u,f=(1-g)*f+g*c,g=-1),w+1<a.length&&(g=Math.max(0,Math.min(100,Number.parseInt(a[++w])))/100)}return g>=0&&(d=g*d+(1-g)*l,p=g*p+(1-g)*u,f=g*f+(1-g)*c),x&&(d=255-d,p=255-p,f=255-f),"#"+("00"+Math.round(d).toString(16)).slice(-2)+("00"+Math.round(p).toString(16)).slice(-2)+("00"+Math.round(f).toString(16)).slice(-2)}function Um(t){var e,n;return t=t.trim(),(n=(e=Io[t.toLowerCase()])!=null?e:Io[Q3[t]])!=null?n:Ud(t)}function VM(t){if(!t||t[0]!=="#")return;t=t.slice(1);let e;return t.length<=4?(e={r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)},t.length===4&&(e.a=parseInt(t[3]+t[3],16)/255)):(e={r:parseInt(t[0]+t[1],16),g:parseInt(t[2]+t[3],16),b:parseInt(t[4]+t[5],16)},t.length===8&&(e.a=parseInt(t[6]+t[7],16)/255)),e&&e.a===void 0&&(e.a=1),e}function zh(t,e,n){return n<0&&(n+=6),n>=6&&(n-=6),n<1?(e-t)*n+t:n<3?e:n<4?(e-t)*(4-n)+t:t}function HM(t){let[e,n,r]=[t.h,t.s,t.l];e=(e+360)%360/60,r=Math.max(0,Math.min(r,1)),n=Math.max(0,Math.min(n,1));let i=r<=.5?r*(n+1):r+n-r*n,o=r*2-i;return{r:Math.round(255*zh(o,i,e+2)),g:Math.round(255*zh(o,i,e)),b:Math.round(255*zh(o,i,e-2))}}function Fh(t){return t<0?0:t>255?255:Math.round(t)}function WM(t){let{r:e,g:n,b:r}=t,i=((1<<24)+(Fh(e)<<16)+(Fh(n)<<8)+Fh(r)).toString(16).slice(1);return i[0]===i[1]&&i[2]===i[3]&&i[4]===i[5]&&i[6]===i[7]&&(i=i[0]+i[2]+i[4]),"#"+i}function UM(t){let{r:e,g:n,b:r}=t;e=e/255,n=n/255,r=r/255;let i=Math.min(e,n,r),o=Math.max(e,n,r),s=o-i,a,l;o===i?a=0:e===o?a=(n-r)/s:n===o?a=2+(r-e)/s:r===o&&(a=4+(e-n)/s),a=Math.min(a*60,360),a<0&&(a+=360);let u=(i+o)/2;return o===i?l=0:u<=.5?l=s/(o+i):l=s/(2-o-i),{h:a,s:l,l:u}}function JM(t){let e=VM(t);if(!e)return t;let{h:n,s:r,l:i}=UM(e);return r+=.1,i-=.1,WM(HM({h:n,s:r,l:i}))}var ex={60:"\\lt",62:"\\gt",111:"o",38:"\\&",123:"\\lbrace",125:"\\rbrace",91:"\\lbrack",93:"\\rbrack",58:"\\colon",160:"~",172:"\\neg",183:"\\cdot",188:"\\frac{1}{4}",189:"\\frac{1}{2}",190:"\\frac{3}{4}",8304:"^{0}",8305:"^{i}",185:"^{1}",178:"^{2}",179:"^{3}",8224:"\\dagger",8225:"\\ddagger",8230:"\\ldots",8308:"^{4}",8309:"^{5}",8310:"^{6}",8311:"^{7}",8312:"^{8}",8313:"^{9}",8314:"^{+}",8315:"^{-}",8316:"^{=}",8319:"^{n}",8320:"_{0}",8321:"_{1}",8322:"_{2}",8323:"_{3}",8324:"_{4}",8325:"_{5}",8326:"_{6}",8327:"_{7}",8328:"_{8}",8329:"_{9}",8330:"_{+}",8331:"_{-}",8332:"_{=}",8336:"_{a}",8337:"_{e}",8338:"_{o}",8339:"_{x}",8242:"\\prime",39:"\\prime",8592:"\\gets",8594:"\\to",9651:"\\triangle",9661:"\\triangledown",8715:"\\owns",8727:"\\ast",8739:"\\vert",8741:"\\Vert",8743:"\\land",8744:"\\lor",8901:"\\cdot",8904:"\\bowtie",8800:"\\ne",8804:"\\le",8805:"\\ge",8869:"\\bot",10178:"\\perp",10231:"\\biconditional",10232:"\\impliedby",10233:"\\implies",10234:"\\iff",8450:"\\mathbb{C}",8469:"\\mathbb{N}",8473:"\\mathbb{P}",8474:"\\mathbb{Q}",8477:"\\mathbb{R}",8484:"\\mathbb{Z}",8461:"\\mathbb{H}",8476:"\\Re",8465:"\\Im",42:"\\ast",11036:"\\square",9633:"\\square",8720:"\\coprod",8716:"\\not\\ni",9671:"\\diamond",8846:"\\uplus",8851:"\\sqcap",8852:"\\sqcup",8768:"\\wr",8750:"\\oint",8226:"\\textbullet",8722:"-",978:"\\Upsilon"},Sf={119893:8462,119965:8492,119968:8496,119969:8497,119971:8459,119972:8464,119975:8466,119976:8499,119981:8475,119994:8495,119996:8458,120004:8500,120070:8493,120075:8460,120076:8465,120085:8476,120093:8488,120122:8450,120127:8461,120133:8469,120135:8473,120136:8474,120137:8477,120145:8484},tx=[{start:119808,len:26,offset:65,style:"bold"},{start:119834,len:26,offset:97,style:"bold"},{start:120488,len:25,offset:913,style:"bold"},{start:120514,len:25,offset:945,style:"bold"},{start:119860,len:26,offset:65,style:"italic"},{start:119886,len:26,offset:97,style:"italic"},{start:120546,len:25,offset:913,style:"italic"},{start:120572,len:25,offset:945,style:"italic"},{start:119912,len:26,offset:65,style:"bolditalic"},{start:119938,len:26,offset:97,style:"bolditalic"},{start:120604,len:25,offset:913,style:"bolditalic"},{start:120630,len:25,offset:945,style:"bolditalic"},{start:120782,len:10,offset:48,variant:"main",style:"bold"},{start:119964,len:26,offset:65,variant:"script"},{start:119990,len:26,offset:97,variant:"script"},{start:120016,len:26,offset:65,variant:"script",style:"bold"},{start:120042,len:26,offset:97,variant:"script",style:"bold"},{start:120068,len:26,offset:65,variant:"fraktur"},{start:120094,len:26,offset:97,variant:"fraktur"},{start:120172,len:26,offset:65,variant:"fraktur",style:"bold"},{start:120198,len:26,offset:97,variant:"fraktur",style:"bold"},{start:120120,len:26,offset:65,variant:"double-struck"},{start:120146,len:26,offset:97,variant:"double-struck"},{start:120792,len:10,offset:48,variant:"double-struck"},{start:120432,len:26,offset:65,variant:"monospace"},{start:120458,len:26,offset:97,variant:"monospace"},{start:120822,len:10,offset:48,variant:"monospace"},{start:120224,len:26,offset:65,variant:"sans-serif"},{start:120250,len:26,offset:97,variant:"sans-serif"},{start:120276,len:26,offset:65,variant:"sans-serif",style:"bold"},{start:120302,len:26,offset:97,variant:"sans-serif",style:"bold"},{start:120328,len:26,offset:65,variant:"sans-serif",style:"italic"},{start:120354,len:26,offset:97,variant:"sans-serif",style:"italic"},{start:120380,len:26,offset:65,variant:"sans-serif",style:"bolditalic"},{start:120406,len:26,offset:97,variant:"sans-serif",style:"bolditalic"},{start:120662,len:25,offset:913,variant:"sans-serif",style:"bold"},{start:120688,len:25,offset:945,variant:"sans-serif",style:"bold"},{start:120720,len:25,offset:913,variant:"sans-serif",style:"bolditalic"},{start:120746,len:25,offset:945,variant:"sans-serif",style:"bolditalic"},{start:120803,len:10,offset:48,variant:"sans-serif"},{start:120812,len:10,offset:48,variant:"sans-serif",style:"bold"}];function _f(t,e,n){if(!/[A-Za-z\d]/.test(t)||(n==="up"&&(n=void 0),!e&&!n))return;let r=t.codePointAt(0);if(r===void 0)return t;for(let i of tx)if((!e||i.variant===e)&&(!n||i.style===n)&&r>=i.offset&&r<i.offset+i.len){let o=i.start+r-i.offset;return String.fromCodePoint(Sf[o]||o)}}function GM(t){var e;if((t<119808||t>120831)&&(t<8448||t>8527))return{char:String.fromCodePoint(t)};for(let n in Sf)if(Sf[n]===t){t=(e=n.codePointAt(0))!=null?e:0;break}for(let n of tx)if(t>=n.start&&t<n.start+n.len)return{char:String.fromCodePoint(t-n.start+n.offset),variant:n.variant,style:n.style};return{char:String.fromCodePoint(t)}}function XM(t){var e;if("{}<>[]$&*#^_%:'".includes(t)||t.length>1)return;let n=(e=t.codePointAt(0))!=null?e:0,r=ex[n];if(r)return r;let{char:i,variant:o,style:s}=GM(n);if(!(!o&&!s)){switch(r=i,o){case"double-struck":r=`\\mathbb{${r}}`;break;case"fraktur":r=`\\mathfrak{${r}}`;break;case"script":r=`\\mathscr{${r}}`;break;case"sans-serif":r=`\\mathsf{${r}}`;break;case"monospace":r=`\\mathtt{${r}}`;break;case"calligraphic":r=`\\mathcal{${r}}`;break}switch(s){case"bold":r=`\\mathbf{${r}}`;break;case"italic":r=`\\mathit{${r}}`;break;case"bolditalic":r=`\\mathbfit{${r}}`;break}return r}}function pe(t){return t?Array.isArray(t)?t:typeof t=="object"&&"group"in t?t.group:[]:[]}var gl={},hd=O({},ex),zs={},Jm={},YM={darr:"\\downarrow",dArr:"\\Downarrow",Darr:"\\Downarrow",lang:"\\langle",rang:"\\rangle",uarr:"\\uparrow",uArr:"\\Uparrow",Uarr:"\\Uparrow",C:"\\mathbb{C}",H:"\\mathbb{H}",N:"\\mathbb{N}",Q:"\\mathbb{Q}",R:"\\mathbb{R}",Z:"\\mathbb{Z}",alef:"\\aleph",alefsym:"\\aleph",Alpha:"\\mathrm{A}",Beta:"\\mathrm{B}",bull:"\\bullet",Chi:"\\mathrm{X}",clubs:"\\clubsuit",cnums:"\\mathbb{C}",Complex:"\\mathbb{C}",Dagger:"\\ddagger",diamonds:"\\diamondsuit",doublecap:"\\Cap",doublecup:"\\Cup",empty:"\\emptyset",Epsilon:"\\mathrm{E}",Eta:"\\mathrm{H}",exist:"\\exists",hArr:"\\Leftrightarrow",harr:"\\leftrightarrow",Harr:"\\Leftrightarrow",hearts:"\\heartsuit",image:"\\Im",infin:"\\infty",Iota:"\\mathrm{I}",isin:"\\in",Kappa:"\\mathrm{K}",larr:"\\leftarrow",Larr:"\\Leftarrow",lArr:"\\Leftarrow",lrarr:"\\leftrightarrow",Lrarr:"\\Leftrightarrow",lrArr:"\\Leftrightarrow",Mu:"\\mathrm{M}",natnums:"\\mathbb{N}",Nu:"\\mathrm{N}",Omicron:"\\mathrm{O}",part:"\\partial",plusmn:"\\pm",rarr:"\\rightarrow",Rarr:"\\Rightarrow",rArr:"\\Rightarrow",real:"\\Re",reals:"\\mathbb{R}",Reals:"\\mathbb{R}",restriction:"\\upharpoonright",Rho:"\\mathrm{P}",sdot:"\\cdot",sect:"\\S",spades:"\\spadesuit",sub:"\\subset",sube:"\\subseteq",supe:"\\supseteq",Tau:"\\mathrm{T}",thetasym:"\\vartheta",varcoppa:"\\coppa",weierp:"\\wp",Zeta:"\\mathrm{Z}"},ZM={varGamma:"\\mathit{\\Gamma}",varDelta:"\\mathit{\\Delta}",varTheta:"\\mathit{\\Theta}",varLambda:"\\mathit{\\Lambda}",varXi:"\\mathit{\\Xi}",varPi:"\\mathit{\\Pi}",varSigma:"\\mathit{\\Sigma}",varUpsilon:"\\mathit{\\Upsilon}",varPhi:"\\mathit{\\Phi}",varPsi:"\\mathit{\\Psi}",varOmega:"\\mathit{\\Omega}",pmod:{def:"\\quad(\\operatorname{mod}\\ #1)",args:1,expand:!1,captureSelection:!1},mod:{def:"\\quad\\operatorname{mod}\\,\\,#1",args:1,expand:!1},bmod:{def:"\\;\\mathbin{\\operatorname{mod }}",expand:!1}},QM={bra:{def:"\\mathinner{\\langle{#1}|}",args:1,captureSelection:!1},ket:{def:"\\mathinner{|{#1}\\rangle}",args:1,captureSelection:!1},braket:{def:"\\mathinner{\\langle{#1}\\rangle}",args:1,captureSelection:!1},set:{def:"\\mathinner{\\lbrace #1 \\rbrace}",args:1,captureSelection:!1},Bra:{def:"\\left\\langle #1\\right|",args:1,captureSelection:!1},Ket:{def:"\\left|#1\\right\\rangle",args:1,captureSelection:!1},Braket:{def:"\\left\\langle{#1}\\right\\rangle",args:1,captureSelection:!1},Set:{def:"\\left\\lbrace #1 \\right\\rbrace",args:1,captureSelection:!1}},eC={strut:{primitive:!0,def:"\\phantom{\\rule[0.3\\baselineskip]{0}{0.7\\baselineskip}}",args:0,captureSelection:!0},iff:{primitive:!0,captureSelection:!0,def:"\\;\\Longleftrightarrow\\;"},nicefrac:"^{#1}\\!\\!/\\!_{#2}",phase:{def:"\\enclose{phasorangle}{#1}",args:1,captureSelection:!1},rd:"\\mathrm{d}",rD:"\\mathrm{D}",odif:"\\mathrm{d}",doubleStruckCapitalN:"\\mathbb{N}",doubleStruckCapitalR:"\\mathbb{R}",doubleStruckCapitalQ:"\\mathbb{Q}",doubleStruckCapitalZ:"\\mathbb{Z}",doubleStruckCapitalP:"\\mathbb{P}",scriptCapitalE:"\\mathscr{E}",scriptCapitalH:"\\mathscr{H}",scriptCapitalL:"\\mathscr{L}",gothicCapitalC:"\\mathfrak{C}",gothicCapitalH:"\\mathfrak{H}",gothicCapitalI:"\\mathfrak{I}",gothicCapitalR:"\\mathfrak{R}",imaginaryI:"\\mathrm{i}",imaginaryJ:"\\mathrm{j}",exponentialE:"\\mathrm{e}",differentialD:"\\mathrm{d}",capitalDifferentialD:"\\mathrm{D}",mathstrut:{def:"\\vphantom{(}",primitive:!0},angl:"\\enclose{actuarial}{#1}",angln:"\\enclose{actuarial}{n}",anglr:"\\enclose{actuarial}{r}",anglk:"\\enclose{actuarial}{k}",mathtools:{primitive:!0,package:{ordinarycolon:":",vcentcolon:"\\mathrel{\\mathop\\ordinarycolon}",dblcolon:'{\\mathop{\\char"2237}}',coloneqq:'{\\mathop{\\char"2254}}',Coloneqq:'{\\mathop{\\char"2A74}}',coloneq:'{\\mathop{\\char"2254}}',Coloneq:'{\\mathop{\\char"2A74}}',eqqcolon:'{\\mathop{\\char"2255}}',Eqqcolon:'{\\mathop{\\char"3D\\char"2237}}',eqcolon:'{\\mathop{\\char"2255}}',Eqcolon:'{\\mathop{\\char"3D\\char"2237}}',colonapprox:'{\\mathop{\\char"003A\\char"2248}}',Colonapprox:'{\\mathop{\\char"2237\\char"2248}}',colonsim:'{\\mathop{\\char"3A\\char"223C}}',Colonsim:'{\\mathop{\\char"2237\\char"223C}}',colondash:"\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}",Colondash:"\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}",dashcolon:"\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}",Dashcolon:"\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}"}},ratio:"\\vcentcolon",coloncolon:"\\dblcolon",colonequals:"\\coloneq",coloncolonequals:"\\Coloneq",equalscolon:"\\eqcolon",equalscoloncolon:"\\Eqcolon",colonminus:"\\colondash",coloncolonminus:"\\Colondash",minuscolon:"\\dashcolon",minuscoloncolon:"\\Dashcolon",coloncolonapprox:"\\Colonapprox",coloncolonsim:"\\Colonsim",simcolon:"\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}",Simcolon:"\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}",simcoloncolon:"\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}",approxcolon:"\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}",Approxcolon:"\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}",approxcoloncolon:"\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}",notni:"\\mathrel{\\char`}",limsup:"\\operatorname*{lim\\,sup}",liminf:"\\operatorname*{lim\\,inf}",injlim:"\\operatorname*{inj\\,lim}",projlim:"\\operatorname*{proj\\,lim}",varlimsup:"\\operatorname*{\\overline{lim}}",varliminf:"\\operatorname*{\\underline{lim}}",varinjlim:"\\operatorname*{\\underrightarrow{lim}}",varprojlim:"\\operatorname*{\\underleftarrow{lim}}",argmin:"\\operatorname*{arg\\,min}",argmax:"\\operatorname*{arg\\,max}",plim:"\\mathop{\\operatorname{plim}}\\limits",tripledash:{def:"\\vphantom{-}\\raise{4mu}{\\mkern1.5mu\\rule{2mu}{1.5mu}\\mkern{2.25mu}\\rule{2mu}{1.5mu}\\mkern{2.25mu}\\rule{2mu}{1.5mu}\\mkern{2mu}}",expand:!0},"braket.sty":{package:QM},"amsmath.sty":{package:ZM,primitive:!0},"texvc.sty":{package:YM,primitive:!1}},Ls={" ":32,"\\!":33,"\\#":35,"\\$":36,"\\%":37,"\\&":38,"\\_":95,"-":45,"\\textunderscore":95,"\\euro":8364,"\\maltese":10016,"\\{":123,"\\}":125,"\\textbraceleft":123,"\\textbraceright":125,"\\lbrace":123,"\\rbrace":125,"\\lbrack":91,"\\rbrack":93,"\\nobreakspace":160,"\\ldots":8230,"\\textellipsis":8230,"\\backslash":92,"`":8216,"'":8217,"``":8220,"''":8221,"\\degree":176,"\\textasciicircum":94,"\\textasciitilde":126,"\\textasteriskcentered":42,"\\textbackslash":92,"\\textbullet":8226,"\\textdollar":36,"\\textsterling":163,"\\textdagger":8224,"\\textdaggerdbl":8225,"":8211,"":8212,"":8216,"":8217,"":8220,"":8221,'"':8221,"\\ss":223,"\\ae":230,"\\oe":339,"\\AE":198,"\\OE":338,"\\O":216,"\\i":305,"\\j":567,"\\aa":229,"\\AA":197},tC=/[\w!@*()-=+{}\[\]\\';:?/.,~<>`|$%#&^" ]/,Mf,yl;_M()?(Mf=new RegExp("\\p{Letter}","u"),yl=new RegExp("[0-9\\p{Letter}]","u")):(Mf=/[a-zA-Z]/,yl=/[\da-zA-Z]/);function Cf(t,e,n="mord",r){e!==void 0&&(gl[t]={definitionType:"symbol",type:n,variant:r,codepoint:e},hd[e]||(hd[e]=t))}function Ut(t,e,n){if(typeof t=="string"){for(let r=0;r<t.length;r++){let i=t.charAt(r);Cf(i,i.codePointAt(0))}return}for(let[r,i,o,s]of t)Cf(r,i,o??e,s??n)}function nx(t,e){for(let n=t;n<=e;n++)Cf(String.fromCodePoint(n),n)}function nC(t){var e;return(e=Jm[t])!=null?e:null}function rC(t,e){var n,r;if(e.length===0||e==="\\"||!e.startsWith("\\"))return[];let i=[];for(let s in zs)s.startsWith(e)&&!zs[s].infix&&i.push({match:s,frequency:(n=zs[s].frequency)!=null?n:0});for(let s in gl)s.startsWith(e)&&i.push({match:s,frequency:(r=gl[s].frequency)!=null?r:0});let o=e.substring(1);for(let s of Object.keys(t.options.macros))s.startsWith(o)&&i.push({match:"\\"+s,frequency:0});return i.sort((s,a)=>{var l,u;return s.frequency===a.frequency?s.match.length===a.match.length?s.match<a.match?-1:1:s.match.length-a.match.length:((l=a.frequency)!=null?l:0)-((u=s.frequency)!=null?u:0)}),i.map(s=>s.match)}function e1(t){let e="auto",n=t.match(/:([^=]+)/);return n&&(e=n[1].trim()),e}function pd(t){if(!t)return[];let e=[],n=t.split("]");if(n[0].startsWith("[")){e.push({isOptional:!0,type:e1(n[0].slice(1))});for(let r=1;r<=n.length;r++)e.push(...pd(n[r]))}else if(n=t.split("}"),n[0].startsWith("{")){e.push({isOptional:!1,type:e1(n[0].slice(1))});for(let r=1;r<=n.length;r++)e.push(...pd(n[r]))}return e}function rx(t){if(!t)return"";let e="",n=!0;for(let r of t)typeof r.value=="string"?e+=r.value:n=!1;return n?e:""}function ei(t,e,n){typeof t=="string"&&(t=[t]);let r={tabular:!0,rootOnly:!1,params:pd(e),createAtom:n};for(let i of t)Jm[i]=r}function Gm(t,e,n){var r;typeof t=="string"&&(t=[t]);let i={tabular:(r=n?.tabular)!=null?r:!1,rootOnly:!0,params:[],createAtom:e};for(let o of t)Jm[o]=i}function Z(t,e,n){var r,i;n||(n={});let o={definitionType:"function",params:pd(e),ifMode:n.ifMode,isFunction:(r=n.isFunction)!=null?r:!1,applyMode:n.applyMode,infix:(i=n.infix)!=null?i:!1,parse:n.parse,createAtom:n.createAtom,applyStyle:n.applyStyle,serialize:n.serialize,render:n.render};if(typeof t=="string")zs["\\"+t]=o;else for(let s of t)zs["\\"+s]=o}var Ul;function Xm(t){return Ul||(Ul=fd(eC)),t?fd(O(O({},Ul),t)):Ul}function t1(t,e){var n,r,i,o;if(typeof t=="string"){let s=0,a=t;return/(^|[^\\])#1/.test(a)&&(s=1),/(^|[^\\])#2/.test(a)&&(s=2),/(^|[^\\])#3/.test(a)&&(s=3),/(^|[^\\])#4/.test(a)&&(s=4),/(^|[^\\])#5/.test(a)&&(s=5),/(^|[^\\])#6/.test(a)&&(s=6),/(^|[^\\])#7/.test(a)&&(s=7),/(^|[^\\])#8/.test(a)&&(s=8),/(^|[^\\])#9/.test(a)&&(s=9),{expand:(n=e?.expand)!=null?n:!0,captureSelection:(r=e?.captureSelection)!=null?r:!0,args:s,def:a}}return O({expand:(i=e?.expand)!=null?i:!0,captureSelection:(o=e?.captureSelection)!=null?o:!0,args:0},t)}function fd(t){if(!t)return{};let e={};for(let n of Object.keys(t)){let r=t[n];if(r==null)delete e[n];else if(typeof r=="object"&&"package"in r)for(let i of Object.keys(r.package))e[i]=t1(r.package[i],{expand:!r.primitive,captureSelection:r.captureSelection});else e[n]=t1(r)}return e}function Vt(t,e="math"){if(!t||t.length===0)return null;let n=null;if(t.startsWith("\\")){if(n=zs[t],n)return!n.ifMode||n.ifMode===e?n:null;e==="math"?n=gl[t]:Ls[t]&&(n={definitionType:"symbol",type:"mord",codepoint:Ls[t]})}else if(e==="math"){if(n=gl[t],!n&&t.length===1){let r=ix("math",t.codePointAt(0));return r.startsWith("\\")?V(O({},Vt(r,"math")),{command:r}):null}}else Ls[t]?n={definitionType:"symbol",type:"mord",codepoint:Ls[t]}:e==="text"&&(n={definitionType:"symbol",type:"mord",codepoint:t.codePointAt(0)});return n??null}function Ym(t,e){if(!t.startsWith("\\"))return null;let n=t.slice(1);return e[n]}function ix(t,e){return e===void 0?"":t==="math"&&hd[e]?hd[e]:t==="text"&&Object.keys(Ls).find(r=>Ls[r]===e)||String.fromCodePoint(e)}var $n=[0,.68889,0,0,.72222],io=[0,.68889,0,0,.66667],$h=[0,.68889,0,0,.77778],Jl=[0,.68889,0,0,.61111],n1=[.16667,.68889,0,0,.77778],la=[0,.68889,0,0,.55556],rt=[0,0,0,0,.25],r1=[0,.825,0,0,2.33334],i1=[0,.9,0,0,2.33334],Gl=[0,.68889,0,0,.54028],Kh=[-.03598,.46402,0,0,.5],cn=[-.13313,.36687,0,0,1],Xl=[.01354,.52239,0,0,1],o1=[.01354,.52239,0,0,1.11111],s1=[0,.54986,0,0,1],Yl=[0,.69224,0,0,.5],jh=[0,.43056,0,0,1],si=[.08198,.58198,0,0,.77778],Zl=[.19444,.69224,0,0,.41667],Ql=[.1808,.675,0,0,1],a1=[.19444,.69224,0,0,.83334],l1=[.13667,.63667,0,0,1],u1=[-.064,.437,0,0,1.334],ai=[.08167,.58167,0,0,.77778],ua=[0,.69224,0,0,.72222],qh=[0,.69224,0,0,.66667],eu=[-.13313,.36687,0,0,.77778],c1=[.06062,.54986,0,0,.77778],tu=[0,.69224,0,0,.77778],ss=[.25583,.75583,0,0,.77778],cr=[.25142,.75726,0,0,.77778],as=[.20576,.70576,0,0,.77778],tr=[.30274,.79383,0,0,.77778],ca=[.22958,.72958,0,0,.77778],d1=[.1808,.675,0,0,.77778],dr=[.13667,.63667,0,0,.77778],_n=[.13597,.63597,0,0,.77778],li=[.03517,.54986,0,0,.77778],ls=[0,.675,0,0,.77778],h1=[.19444,.69224,0,0,.61111],p1=[0,.54986,0,0,.76042],f1=[0,.54986,0,0,.66667],ui=[.0391,.5391,0,0,.77778],m1=[.03517,.54986,0,0,1.33334],g1=[.38569,.88569,0,0,.77778],nu=[.23222,.74111,0,0,.77778],y1=[.19444,.69224,0,0,.77778],b1=[0,.37788,0,0,.5],ru=[0,.54986,0,0,.72222],v1=[0,.69224,0,0,.83334],x1=[.11111,.69224,0,0,.66667],us=[.26167,.75726,0,0,.77778],w1=[.48256,.98256,0,0,.77778],k1=[.28481,.79383,0,0,.77778],S1=[.08167,.58167,0,0,.22222],_1=[.08167,.58167,0,0,.38889],M1=[0,.43056,.04028,0,.66667],C1=[.41951,.91951,0,0,.77778],E1=[.24982,.74947,0,0,.38865],A1=[.08319,.58283,0,0,.75623],D1=[0,.10803,0,0,.27764],Vh=[0,.47534,0,0,.50181],da=[.18906,.47534,0,0,.50181],L1=[0,.69141,0,0,.50181],T1=[.24982,.74947,0,0,.27764],Hh=[0,.69141,0,0,.21471],iu=[.25,.75,0,0,.44722],Kn=[0,.64444,0,0,.575],cs=[.08556,.58556,0,0,.89444],ou=[0,.69444,0,0,.89444],su=[0,.68611,0,0,.9],Wh=[0,.68611,0,0,.86944],ci=[.25,.75,0,0,.575],au=[.25,.75,0,0,.31944],oo=[0,.69444,0,0,.63889],ds=[0,.69444,0,0,.31944],B1=[0,.44444,0,0,.63889],O1=[0,.44444,0,0,.51111],di=[0,.69444,0,0,.575],nr=[.13333,.63333,0,0,.89444],N1=[0,.44444,0,0,.31944],P1=[0,.69444,0,0,.86944],I1=[0,.68611,0,0,.69166],lu=[0,.68611,0,0,.83055],Uh=[0,.68611,0,0,.89444],Jh=[0,.69444,0,0,.60278],R1=[.19444,.69444,0,0,.51111],z1=[0,.69444,0,0,.83055],hr=[-.10889,.39111,0,0,1.14999],F1=[.19444,.69444,0,0,.575],ha=[.19444,.69444,0,0,1.14999],$1=[.19444,.69444,0,0,.70277],K1=[.05556,.75,0,0,.575],Gh=[0,.68611,0,0,.95833],j1=[.08556,.58556,0,0,.76666],Xh=[-.02639,.47361,0,0,.575],q1=[0,.44444,0,0,.89444],so=[0,.55556,0,0,.76666],V1=[-.10889,.39111,0,0,.89444],Yh=[.00222,.50222,0,0,.89444],hi=[.19667,.69667,0,0,.89444],H1=[.08556,.58556,0,0,1.14999],Zh=[0,.69444,0,0,.70277],uu=[-.02778,.47222,0,0,.575],cu=[.25,.75,0,0,.51111],W1=[-.13889,.36111,0,0,1.14999],U1=[.19444,.69444,0,0,1.02222],du=[.12963,.69444,0,0,.89444],J1=[.19444,.69444,0,0,.44722],pi=[0,.64444,.13167,0,.59111],G1=[.19444,.64444,.13167,0,.59111],Qh=[0,.68611,.17208,0,.8961],X1=[.19444,.44444,.105,0,.53222],Y1=[0,.44444,.085,0,.82666],Z1=[0,.69444,.06709,0,.59111],hu=[0,.69444,.12945,0,.35555],Q1=[0,.69444,0,0,.94888],ep=[0,.69444,.11472,0,.59111],ey=[0,.68611,.10778,0,.88555],ty=[0,.69444,.07939,0,.62055],pu=[0,.69444,.12417,0,.30667],fi=[0,.64444,.13556,0,.51111],ny=[.19444,.64444,.13556,0,.51111],fu=[0,.68333,.16389,0,.74333],ry=[.19444,.43056,.08847,0,.46],iy=[0,.43056,.07514,0,.71555],oy=[0,.69444,.06646,0,.51111],sy=[0,.69444,0,0,.83129],ay=[0,.69444,.1225,0,.51111],ly=[0,.68333,.09403,0,.76666],uy=[0,.68333,.11111,0,.76666],cy=[0,.69444,.06961,0,.51444],Br=[0,.69444,0,0,.27778],hs=[.25,.75,0,0,.38889],jn=[0,.64444,0,0,.5],ao=[0,.69444,0,0,.77778],lo=[0,.68333,0,0,.75],pa=[0,.68333,0,0,.77778],dy=[0,.68333,0,0,.68056],fa=[0,.68333,0,0,.72222],Or=[.25,.75,0,0,.5],mu=[.25,.75,0,0,.27778],Ft=[0,.69444,0,0,.5],ps=[0,.69444,0,0,.55556],tp=[0,.43056,0,0,.44445],ma=[0,.43056,0,0,.5],hy=[.19444,.43056,0,0,.55556],py=[0,.43056,0,0,.55556],qn=[.08333,.58333,0,0,.77778],fy=[0,.43056,0,0,.27778],my=[0,.66786,0,0,.27778],gy=[0,.69444,0,0,.75],yy=[0,.66786,0,0,.5],by=[0,.68333,0,0,.625],np=[.19444,.69444,0,0,.44445],ga=[0,.69444,0,0,.72222],vy=[.19444,.69444,0,0,.5],ya=[.19444,.69444,0,0,1],xy=[.011,.511,0,0,1.126],rp=[.19444,.69444,0,0,.61111],ip=[.05556,.75,0,0,.5],wy=[0,.68333,0,0,.83334],ky=[.0391,.5391,0,0,.66667],op=[-.05555,.44445,0,0,.5],Sy=[0,.43056,0,0,.77778],uo=[0,.55556,0,0,.66667],gu=[-.03625,.46375,0,0,.77778],_y=[-.01688,.48312,0,0,.77778],My=[.0391,.5391,0,0,1],mi=[0,.69444,0,0,.61111],yu=[-.03472,.46528,0,0,.5],bu=[.25,.75,0,0,.44445],Cy=[-.14236,.35764,0,0,1],vu=[.244,.744,0,0,.412],Ey=[.19444,.69444,0,0,.88889],xu=[.12963,.69444,0,0,.77778],Ay=[.19444,.69444,0,0,.38889],Dy=[.011,.511,0,0,1.638],Ly=[.19444,.69444,0,0,0],wu=[0,.44444,0,0,.575],ba=[.19444,.44444,0,0,.575],Ty=[0,.68611,0,0,.75555],By=[0,.69444,0,0,.66759],Oy=[0,.68611,0,0,.80555],Ny=[0,.68611,.08229,0,.98229],Py=[0,.68611,0,0,.76666],Iy=[0,.44444,0,0,.58472],Ry=[.19444,.44444,0,0,.6118],va=[.19444,.43056,0,0,.5],zy=[0,.68333,.02778,.08334,.76278],Fy=[0,.68333,.08125,.05556,.83125],$y=[0,.43056,0,.05556,.48472],Ky=[.19444,.43056,0,.08334,.51702],jy=[.25,.75,0,0,.42778],rn=[0,.69444,0,0,.55],Nr=[0,.69444,0,0,.73334],gi=[0,.69444,0,0,.79445],qy=[0,.69444,0,0,.51945],sp=[0,.69444,0,0,.70278],Vy=[0,.69444,0,0,.76389],Hy=[.25,.75,0,0,.34306],ap=[0,.69444,0,0,.56111],Wy=[0,.69444,0,0,.25556],Uy=[.19444,.45833,0,0,.56111],Jy=[0,.45833,0,0,.56111],ku=[0,.69444,0,0,.30556],Gy=[0,.69444,0,0,.58056],Xy=[0,.69444,0,0,.67223],lp=[0,.69444,0,0,.85556],up=[0,.69444,0,0,.55834],pr=[0,.65556,.11156,0,.5],cp=[0,.69444,.08094,0,.70834],dp=[.17014,0,0,0,.44445],Yy=[0,.69444,.0799,0,.5],Zy=[0,.69444,0,0,.73752],Qy=[0,.69444,.09205,0,.5],eb=[0,.69444,.09031,0,.77778],hp=[0,.69444,.07816,0,.27778],tb=[0,.69444,.00316,0,.5],nb=[.19444,.69444,0,0,.83334],rb=[.05556,.75,0,0,.83334],ib=[0,.75,0,0,.5],ob=[.125,.08333,0,0,.27778],sb=[0,.08333,0,0,.27778],fr=[0,.65556,0,0,.5],pp=[0,.69444,0,0,.47222],Pr=[0,.69444,0,0,.66667],ab=[0,.69444,0,0,.59722],fp=[0,.69444,0,0,.54167],mp=[0,.69444,0,0,.70834],lb=[.25,.75,0,0,.28889],gp=[0,.69444,0,0,.51667],ub=[0,.44444,0,0,.44445],cb=[.19444,.44444,0,0,.51667],db=[0,.44444,0,0,.38333],hb=[0,.44444,0,0,.51667],pb=[0,.69444,0,0,.83334],fb=[.35001,.85,0,0,.45834],mb=[.35001,.85,0,0,.57778],gb=[.35001,.85,0,0,.41667],yb=[.35001,.85,0,0,.58334],Su=[0,.72222,0,0,.55556],bb=[1e-5,.6,0,0,.66667],vb=[1e-5,.6,0,0,.77778],xb=[.25001,.75,0,0,.94445],wb=[.306,.805,.19445,0,.47222],kb=[.30612,.805,.19445,0,.47222],fs=[.25001,.75,0,0,.83334],ms=[.35001,.85,0,0,.47222],yp=[.25001,.75,0,0,1.11111],Sb=[.65002,1.15,0,0,.59722],_b=[.65002,1.15,0,0,.81111],Mb=[.65002,1.15,0,0,.47222],Cb=[.65002,1.15,0,0,.66667],_u=[0,.75,0,0,1],Eb=[.55001,1.05,0,0,1.27778],Ab=[.862,1.36,.44445,0,.55556],Db=[.86225,1.36,.44445,0,.55556],gs=[.55001,1.05,0,0,1.11111],Mu=[.65002,1.15,0,0,.52778],Lb=[.65002,1.15,0,0,.61111],bp=[.55001,1.05,0,0,1.51112],Tb=[.95003,1.45,0,0,.73611],Bb=[.95003,1.45,0,0,1.04445],Ob=[.95003,1.45,0,0,.52778],Cu=[.95003,1.45,0,0,.75],Eu=[0,.75,0,0,1.44445],Au=[.95003,1.45,0,0,.58334],Nb=[1.25003,1.75,0,0,.79167],Pb=[1.25003,1.75,0,0,1.27778],Ib=[1.25003,1.75,0,0,.58334],Du=[1.25003,1.75,0,0,.80556],Lu=[0,.825,0,0,1.8889],Tu=[1.25003,1.75,0,0,.63889],Bu=[.64502,1.155,0,0,.875],Rb=[1e-5,.6,0,0,.875],vp=[-99e-5,.601,0,0,.66667],Ou=[.64502,1.155,0,0,.66667],zb=[1e-5,.9,0,0,.88889],Fb=[.65002,1.15,0,0,.88889],$b=[.90001,0,0,0,.88889],Kb=[-.00499,.605,0,0,1.05556],Nu=[0,.12,0,0,.45],me=[0,.61111,0,0,.525],rr=[.08333,.69444,0,0,.525],jb=[-.08056,.53055,0,0,.525],qb=[-.05556,.55556,0,0,.525],yn=[0,.43056,0,0,.525],xa=[.22222,.43056,0,0,.525],Vb=[0,0,0,0,.525],iC={"AMS-Regular":{32:rt,65:$n,66:io,67:$n,68:$n,69:io,70:Jl,71:$h,72:$h,73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:$h,76:io,77:[0,.68889,0,0,.94445],78:$n,79:n1,80:Jl,81:n1,82:$n,83:la,84:io,85:$n,86:$n,87:[0,.68889,0,0,1],88:$n,89:$n,90:io,107:la,160:rt,165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:la,295:Gl,710:r1,732:i1,770:r1,771:i1,989:ai,1008:M1,8245:[0,.54986,0,0,.275],8463:Gl,8487:$n,8498:la,8502:io,8503:[0,.68889,0,0,.44445],8504:io,8513:[0,.68889,0,0,.63889],8592:Kh,8594:Kh,8602:cn,8603:cn,8606:Xl,8608:Xl,8610:o1,8611:o1,8619:s1,8620:s1,8621:[-.13313,.37788,0,0,1.38889],8622:cn,8624:Yl,8625:Yl,8630:jh,8631:jh,8634:si,8635:si,8638:Zl,8639:Zl,8642:Zl,8643:Zl,8644:Ql,8646:Ql,8647:Ql,8648:a1,8649:Ql,8650:a1,8651:Xl,8652:Xl,8653:cn,8654:cn,8655:cn,8666:l1,8667:l1,8669:[-.13313,.37788,0,0,1],8672:u1,8674:u1,8705:[0,.825,0,0,.5],8708:la,8709:ai,8717:[0,.43056,0,0,.42917],8722:Kh,8724:[.08198,.69224,0,0,.77778],8726:ai,8733:tu,8736:ua,8737:ua,8738:[.03517,.52239,0,0,.72222],8739:S1,8740:[.25142,.74111,0,0,.27778],8741:_1,8742:[.25142,.74111,0,0,.5],8756:qh,8757:qh,8764:eu,8765:[-.13313,.37788,0,0,.77778],8769:eu,8770:gu,8774:tr,8776:_y,8778:ai,8782:c1,8783:c1,8785:si,8786:si,8787:si,8790:tu,8791:ca,8796:[.08198,.91667,0,0,.77778],8806:ss,8807:ss,8808:cr,8809:cr,8812:[.25583,.75583,0,0,.5],8814:as,8815:as,8816:tr,8817:tr,8818:ca,8819:ca,8822:d1,8823:d1,8828:dr,8829:dr,8830:ca,8831:ca,8832:as,8833:as,8840:tr,8841:tr,8842:_n,8843:_n,8847:li,8848:li,8858:si,8859:si,8861:si,8862:ls,8863:ls,8864:ls,8865:ls,8872:[0,.69224,0,0,.61111],8873:ua,8874:[0,.69224,0,0,.88889],8876:Jl,8877:Jl,8878:$n,8879:$n,8882:li,8883:li,8884:dr,8885:dr,8888:[0,.54986,0,0,1.11111],8890:hy,8891:h1,8892:h1,8901:[0,.54986,0,0,.27778],8903:ai,8905:ai,8906:ai,8907:tu,8908:tu,8909:[-.03598,.46402,0,0,.77778],8910:p1,8911:p1,8912:li,8913:li,8914:f1,8915:f1,8916:qh,8918:ui,8919:ui,8920:m1,8921:m1,8922:g1,8923:g1,8926:dr,8927:dr,8928:tr,8929:tr,8934:nu,8935:nu,8936:nu,8937:nu,8938:as,8939:as,8940:tr,8941:tr,8994:y1,8995:y1,9416:[.15559,.69224,0,0,.90222],9484:Yl,9488:Yl,9492:b1,9496:b1,9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:ls,9633:ls,9650:ru,9651:ru,9654:li,9660:ru,9661:ru,9664:li,9674:x1,9733:[.19444,.69224,0,0,.94445],10003:v1,10016:v1,10731:x1,10846:[.19444,.75583,0,0,.61111],10877:dr,10878:dr,10885:ss,10886:ss,10887:_n,10888:_n,10889:us,10890:us,10891:w1,10892:w1,10901:dr,10902:dr,10933:cr,10934:cr,10935:us,10936:us,10937:us,10938:us,10949:ss,10950:ss,10955:k1,10956:k1,57350:S1,57351:_1,57352:ai,57353:M1,57356:cr,57357:cr,57358:C1,57359:tr,57360:tr,57361:C1,57366:cr,57367:cr,57368:cr,57369:cr,57370:_n,57371:_n},"Caligraphic-Regular":{32:rt,65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:rt},"Fraktur-Regular":{32:rt,33:[0,.69141,0,0,.29574],34:Hh,38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:E1,41:E1,42:[0,.62119,0,0,.27764],43:A1,44:D1,45:A1,46:D1,47:[.24982,.74947,0,0,.50181],48:Vh,49:Vh,50:Vh,51:da,52:da,53:da,54:L1,55:da,56:L1,57:da,58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:T1,93:T1,94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:rt,8216:Hh,8217:Hh,58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:rt,33:[0,.69444,0,0,.35],34:Jh,35:[.19444,.69444,0,0,.95833],36:K1,37:[.05556,.75,0,0,.95833],38:ou,39:ds,40:iu,41:iu,42:[0,.75,0,0,.575],43:nr,44:[.19444,.15556,0,0,.31944],45:db,46:[0,.15556,0,0,.31944],47:ci,48:Kn,49:Kn,50:Kn,51:Kn,52:Kn,53:Kn,54:Kn,55:Kn,56:Kn,57:Kn,58:N1,59:[.19444,.44444,0,0,.31944],60:cs,61:V1,62:cs,63:[0,.69444,0,0,.54305],64:ou,65:Wh,66:[0,.68611,0,0,.81805],67:lu,68:[0,.68611,0,0,.88194],69:Ty,70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:su,73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:I1,77:[0,.68611,0,0,1.09166],78:su,79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:Wh,89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:au,92:ci,93:au,94:di,95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:oo,99:O1,100:oo,101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:oo,105:ds,106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:ds,109:[0,.44444,0,0,.95833],110:B1,111:wu,112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:B1,118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:O1,123:ci,124:au,125:ci,126:[.35,.34444,0,0,.575],160:rt,163:[0,.69444,0,0,.86853],168:di,172:[0,.44444,0,0,.76666],176:P1,177:nr,184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:nr,216:[.04861,.73472,0,0,.89444],223:ab,230:[0,.44444,0,0,.83055],247:nr,248:[.09722,.54167,0,0,.575],305:N1,338:[0,.68611,0,0,1.16944],339:q1,567:[.19444,.44444,0,0,.35139],710:di,711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:di,715:di,728:di,729:ds,730:P1,732:di,733:di,915:I1,916:Gh,920:Uh,923:Oy,926:Py,928:su,931:lu,933:Uh,934:lu,936:Uh,937:lu,8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:ds,8217:ds,8220:Jh,8221:Jh,8224:R1,8225:R1,8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:By,8465:z1,8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:z1,8501:Zh,8592:hr,8593:F1,8594:hr,8595:F1,8596:hr,8597:ci,8598:ha,8599:ha,8600:ha,8601:ha,8636:hr,8637:hr,8640:hr,8641:hr,8656:hr,8657:$1,8658:hr,8659:$1,8660:hr,8661:[.25,.75,0,0,.70277],8704:oo,8706:[0,.69444,.06389,0,.62847],8707:oo,8709:K1,8711:Gh,8712:j1,8715:j1,8722:nr,8723:nr,8725:ci,8726:ci,8727:uu,8728:Xh,8729:Xh,8730:[.18,.82,0,0,.95833],8733:q1,8734:[0,.44444,0,0,1.14999],8736:ua,8739:au,8741:ci,8743:so,8744:so,8745:so,8746:so,8747:[.19444,.69444,.12778,0,.56875],8764:V1,8768:[.19444,.69444,0,0,.31944],8771:Yh,8776:[.02444,.52444,0,0,.89444],8781:Yh,8801:Yh,8804:hi,8805:hi,8810:H1,8811:H1,8826:cs,8827:cs,8834:cs,8835:cs,8838:hi,8839:hi,8846:so,8849:hi,8850:hi,8851:so,8852:so,8853:nr,8854:nr,8855:nr,8856:nr,8857:nr,8866:Zh,8867:Zh,8868:ou,8869:ou,8900:Xh,8901:[-.02639,.47361,0,0,.31944],8902:uu,8968:cu,8969:cu,8970:cu,8971:cu,8994:W1,8995:W1,9651:U1,9657:uu,9661:U1,9667:uu,9711:ha,9824:du,9825:du,9826:du,9827:du,9837:[0,.75,0,0,.44722],9838:J1,9839:J1,10216:iu,10217:iu,10815:su,10927:hi,10928:hi,57376:Ly},"Main-BoldItalic":{32:rt,33:[0,.69444,.11417,0,.38611],34:ty,35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:hu,40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:pi,49:pi,50:pi,51:pi,52:G1,53:pi,54:pi,55:G1,56:pi,57:pi,58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:ep,64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:Qh,73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:Qh,79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:Z1,95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:X1,104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:X1,114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:rt,168:[0,.69444,.11473,0,.59111],176:Q1,184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:Y1,248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:Y1,567:[.19444,.44444,.04611,0,.385],710:Z1,711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:hu,730:Q1,732:ep,733:ep,915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:Qh,931:[0,.68611,.11431,0,.82666],933:ey,934:[0,.68611,.05632,0,.82666],936:ey,937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:hu,8217:hu,8220:[0,.69444,.16772,0,.62055],8221:ty},"Main-Italic":{32:rt,33:pu,34:cy,35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:pu,40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:fi,49:fi,50:fi,51:fi,52:ny,53:fi,54:fi,55:ny,56:fi,57:fi,58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:ay,64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:fu,73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:fu,79:ly,80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:fu,86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:oy,95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:ry,104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:ry,114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:rt,168:[0,.66786,.10474,0,.51111],176:sy,184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:iy,248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:iy,710:oy,711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:sy,732:[0,.66786,.11585,0,.51111],733:ay,915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:ly,923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:fu,931:[0,.68333,.12028,0,.71555],933:uy,934:[0,.68333,.05986,0,.71555],936:uy,937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:pu,8217:pu,8220:[0,.69444,.1685,0,.51444],8221:cy,8463:Gl},"Main-Regular":{32:rt,33:Br,34:Ft,35:nb,36:ip,37:rb,38:ao,39:Br,40:hs,41:hs,42:ib,43:qn,44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:Or,48:jn,49:jn,50:jn,51:jn,52:jn,53:jn,54:jn,55:jn,56:jn,57:jn,58:fy,59:[.19444,.43056,0,0,.27778],60:ui,61:eu,62:ui,63:pp,64:ao,65:lo,66:[0,.68333,0,0,.70834],67:fa,68:[0,.68333,0,0,.76389],69:dy,70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:lo,73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:pa,76:by,77:[0,.68333,0,0,.91667],78:lo,79:pa,80:dy,81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:fa,85:lo,86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:lo,89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:mu,92:Or,93:mu,94:Ft,95:[.31,.12056,.02778,0,.5],97:ma,98:ps,99:tp,100:ps,101:tp,102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:ps,105:my,106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:Br,109:[0,.43056,0,0,.83334],110:py,111:ma,112:hy,113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:py,118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:tp,123:Or,124:mu,125:Or,126:[.35,.31786,0,0,.5],160:rt,163:[0,.69444,0,0,.76909],167:np,168:yy,172:[0,.43056,0,0,.66667],176:gy,177:qn,182:rp,184:dp,198:[0,.68333,0,0,.90278],215:qn,216:[.04861,.73194,0,0,.77778],223:Ft,230:[0,.43056,0,0,.72222],247:qn,248:[.09722,.52778,0,0,.5],305:fy,338:[0,.68333,0,0,1.01389],339:Sy,567:[.19444,.43056,0,0,.30556],710:Ft,711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:Ft,715:Ft,728:Ft,729:my,730:gy,732:yy,733:Ft,915:by,916:wy,920:pa,923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:lo,931:fa,933:pa,934:fa,936:pa,937:fa,8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:Br,8217:Br,8220:Ft,8221:Ft,8224:np,8225:np,8230:[0,.12,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:Gl,8465:ga,8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:ga,8501:mi,8592:cn,8593:vy,8594:cn,8595:vy,8596:cn,8597:Or,8598:ya,8599:ya,8600:ya,8601:ya,8614:[.011,.511,0,0,1],8617:xy,8618:xy,8636:cn,8637:cn,8640:cn,8641:cn,8652:[.011,.671,0,0,1],8656:cn,8657:rp,8658:cn,8659:rp,8660:cn,8661:[.25,.75,0,0,.61111],8704:ps,8706:[0,.69444,.05556,.08334,.5309],8707:ps,8709:ip,8711:wy,8712:ky,8715:ky,8722:qn,8723:qn,8725:Or,8726:Or,8727:yu,8728:op,8729:op,8730:[.2,.8,0,0,.83334],8733:Sy,8734:jh,8736:ua,8739:mu,8741:Or,8743:uo,8744:uo,8745:uo,8746:uo,8747:[.19444,.69444,.11111,0,.41667],8764:eu,8768:[.19444,.69444,0,0,.27778],8771:gu,8773:[-.022,.589,0,0,1],8776:_y,8781:gu,8784:[-.133,.67,0,0,.778],8801:gu,8804:_n,8805:_n,8810:My,8811:My,8826:ui,8827:ui,8834:ui,8835:ui,8838:_n,8839:_n,8846:uo,8849:_n,8850:_n,8851:uo,8852:uo,8853:qn,8854:qn,8855:qn,8856:qn,8857:qn,8866:mi,8867:mi,8868:ao,8869:ao,8872:[.249,.75,0,0,.867],8900:op,8901:[-.05555,.44445,0,0,.27778],8902:yu,8904:[.005,.505,0,0,.9],8942:[.03,.9,0,0,.278],8943:[-.19,.31,0,0,1.172],8945:[-.1,.82,0,0,1.282],8968:bu,8969:bu,8970:bu,8971:bu,8994:Cy,8995:Cy,9136:vu,9137:vu,9651:Ey,9657:yu,9661:Ey,9667:yu,9711:ya,9824:xu,9825:xu,9826:xu,9827:xu,9837:[0,.75,0,0,.38889],9838:Ay,9839:Ay,10216:hs,10217:hs,10222:vu,10223:vu,10229:[.011,.511,0,0,1.609],10230:Dy,10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:Dy,10815:lo,10927:_n,10928:_n,57376:Ly},"Math-BoldItalic":{32:rt,48:wu,49:wu,50:wu,51:ba,52:ba,53:ba,54:Kn,55:ba,56:Kn,57:ba,65:Wh,66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:Ny,73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:Ty,77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:By,105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:Iy,112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:rt,915:[0,.68611,.15972,0,.65694],916:Gh,920:[0,.68611,.03194,0,.86722],923:Oy,926:[0,.68611,.07458,0,.84125],928:Ny,931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:Py,936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:Iy,960:[0,.44444,.03704,0,.68241],961:Ry,962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:Ry,1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:rt,48:ma,49:ma,50:ma,51:va,52:va,53:va,54:jn,55:va,56:jn,57:va,65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:Fy,73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:zy,80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:$y,112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:rt,915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:zy,923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:Fy,931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:$y,960:[0,.43056,.03588,0,.57003],961:Ky,962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:Ky,1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:rt,33:[0,.69444,0,0,.36667],34:up,35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:ku,40:jy,41:jy,42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:rn,49:rn,50:rn,51:rn,52:rn,53:rn,54:rn,55:rn,56:rn,57:rn,58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:qy,64:Nr,65:Nr,66:Nr,67:sp,68:gi,69:[0,.69444,0,0,.64167],70:mi,71:Nr,72:gi,73:[0,.69444,0,0,.33056],74:qy,75:Vy,76:Gy,77:[0,.69444,0,0,.97778],78:gi,79:gi,80:sp,81:[.10556,.69444,0,0,.79445],82:sp,83:mi,84:Nr,85:Vy,86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:Nr,89:[0,.69444,.0275,0,.73334],90:Xy,91:Hy,93:Hy,94:rn,95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:ap,99:[0,.45833,0,0,.48889],100:ap,101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:ap,105:Wy,106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:Wy,109:[0,.45833,0,0,.86667],110:Jy,111:[0,.45833,0,0,.55],112:Uy,113:Uy,114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:Jy,118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:rt,168:rn,176:Nr,180:rn,184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:rn,711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:rn,729:ku,730:Nr,732:rn,733:rn,915:Gy,916:[0,.69444,0,0,.91667],920:lp,923:Xy,926:Nr,928:gi,931:gi,933:lp,934:gi,936:lp,937:gi,8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:ku,8217:ku,8220:up,8221:up},"SansSerif-Italic":{32:rt,33:[0,.69444,.05733,0,.31945],34:tb,35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:hp,40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:ob,45:[0,.44444,.01946,0,.33333],46:sb,47:[.25,.75,.13164,0,.5],48:pr,49:pr,50:pr,51:pr,52:pr,53:pr,54:pr,55:pr,56:pr,57:pr,58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:Pr,66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:cp,73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:fp,77:[0,.69444,.08094,0,.875],78:cp,79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:Yy,95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:rt,168:[0,.67937,.06385,0,.5],176:Zy,184:dp,305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:Yy,711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:Qy,715:Ft,728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:Zy,732:[0,.67659,.08826,0,.5],733:Qy,915:[0,.69444,.13372,0,.54167],916:pb,920:[0,.69444,.07555,0,.77778],923:mi,926:[0,.69444,.12816,0,.66667],928:cp,931:[0,.69444,.11983,0,.72222],933:eb,934:[0,.69444,.04603,0,.72222],936:eb,937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:hp,8217:hp,8220:[0,.69444,.14205,0,.5],8221:tb},"SansSerif-Regular":{32:rt,33:[0,.69444,0,0,.31945],34:Ft,35:nb,36:ip,37:rb,38:[0,.69444,0,0,.75834],39:Br,40:hs,41:hs,42:ib,43:qn,44:ob,45:[0,.44444,0,0,.33333],46:sb,47:Or,48:fr,49:fr,50:fr,51:fr,52:fr,53:fr,54:fr,55:fr,56:fr,57:fr,58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:pp,64:Pr,65:Pr,66:Pr,67:oo,68:[0,.69444,0,0,.72223],69:ab,70:[0,.69444,0,0,.56945],71:Pr,72:mp,73:Br,74:pp,75:[0,.69444,0,0,.69445],76:fp,77:[0,.69444,0,0,.875],78:mp,79:[0,.69444,0,0,.73611],80:oo,81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:ps,84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:Pr,89:[0,.69444,.025,0,.66667],90:mi,91:lb,93:lb,94:Ft,95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:gp,99:ub,100:gp,101:ub,102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:gp,105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:hb,111:[0,.44444,0,0,.5],112:cb,113:cb,114:[0,.44444,.01389,0,.34167],115:db,116:[0,.57143,0,0,.36111],117:hb,118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:rt,168:[0,.67937,0,0,.5],176:Pr,184:dp,305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:Ft,711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:Ft,715:Ft,728:Ft,729:[0,.67937,0,0,.27778],730:Pr,732:[0,.67659,0,0,.5],733:Ft,915:fp,916:pb,920:ao,923:mi,926:Pr,928:mp,931:ga,933:ao,934:ga,936:ao,937:ga,8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:Br,8217:Br,8220:Ft,8221:Ft},"Script-Regular":{32:rt,65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:rt},"Size1-Regular":{32:rt,40:fb,41:fb,47:mb,91:gb,92:mb,93:gb,123:yb,125:yb,160:rt,710:Su,732:Su,770:Su,771:Su,8214:[-99e-5,.601,0,0,.77778],8593:bb,8595:bb,8657:vb,8659:vb,8719:xb,8720:xb,8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:kb,8748:wb,8749:wb,8750:kb,8896:fs,8897:fs,8898:fs,8899:fs,8968:ms,8969:ms,8970:ms,8971:ms,9168:vp,10216:ms,10217:ms,10752:yp,10753:yp,10754:yp,10756:fs,10758:fs},"Size2-Regular":{32:rt,40:Sb,41:Sb,47:_b,91:Mb,92:_b,93:Mb,123:Cb,125:Cb,160:rt,710:_u,732:_u,770:_u,771:_u,8719:Eb,8720:Eb,8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:Db,8748:Ab,8749:Ab,8750:Db,8896:gs,8897:gs,8898:gs,8899:gs,8968:Mu,8969:Mu,8970:Mu,8971:Mu,10216:Lb,10217:Lb,10752:bp,10753:bp,10754:bp,10756:gs,10758:gs},"Size3-Regular":{32:rt,40:Tb,41:Tb,47:Bb,91:Ob,92:Bb,93:Ob,123:Cu,125:Cu,160:rt,710:Eu,732:Eu,770:Eu,771:Eu,8730:[.95003,1.45,0,0,1],8968:Au,8969:Au,8970:Au,8971:Au,10216:Cu,10217:Cu},"Size4-Regular":{32:rt,40:Nb,41:Nb,47:Pb,91:Ib,92:Pb,93:Ib,123:Du,125:Du,160:rt,710:Lu,732:Lu,770:Lu,771:Lu,8730:[1.25003,1.75,0,0,1],8968:Tu,8969:Tu,8970:Tu,8971:Tu,9115:Bu,9116:Rb,9117:Bu,9118:Bu,9119:Rb,9120:Bu,9121:Ou,9122:vp,9123:Ou,9124:Ou,9125:vp,9126:Ou,9127:zb,9128:Fb,9129:$b,9130:[0,.3,0,0,.88889],9131:zb,9132:Fb,9133:$b,9143:[.88502,.915,0,0,1.05556],10216:Du,10217:Du,57344:Kb,57345:Kb,57680:Nu,57681:Nu,57682:Nu,57683:Nu},"Typewriter-Regular":{32:Vb,33:me,34:me,35:me,36:rr,37:rr,38:me,39:me,40:rr,41:rr,42:[0,.52083,0,0,.525],43:jb,44:[.13889,.125,0,0,.525],45:jb,46:[0,.125,0,0,.525],47:rr,48:me,49:me,50:me,51:me,52:me,53:me,54:me,55:me,56:me,57:me,58:yn,59:[.13889,.43056,0,0,.525],60:qb,61:[-.19549,.41562,0,0,.525],62:qb,63:me,64:me,65:me,66:me,67:me,68:me,69:me,70:me,71:me,72:me,73:me,74:me,75:me,76:me,77:me,78:me,79:me,80:me,81:[.13889,.61111,0,0,.525],82:me,83:me,84:me,85:me,86:me,87:me,88:me,89:me,90:me,91:rr,92:rr,93:rr,94:me,95:[.09514,0,0,0,.525],96:me,97:yn,98:me,99:yn,100:me,101:yn,102:me,103:xa,104:me,105:me,106:[.22222,.61111,0,0,.525],107:me,108:me,109:yn,110:yn,111:yn,112:xa,113:xa,114:yn,115:yn,116:[0,.55358,0,0,.525],117:yn,118:yn,119:yn,120:yn,121:xa,122:yn,123:rr,124:rr,125:rr,126:me,127:me,160:Vb,176:me,184:[.19445,0,0,0,.525],305:yn,567:xa,711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:me,715:me,728:me,730:me,770:me,771:me,776:me,915:me,916:me,920:me,923:me,926:me,928:me,931:me,933:me,934:me,936:me,937:me,8216:me,8217:me,8242:me,9251:[.11111,.21944,0,0,.525]}},oC=/[\u3040-\u309F]|[\u30A0-\u30FF]|[\u4E00-\u9FAF]|[\uAC00-\uD7AF]/,Ys=10,lr=.25,sC=1.2,Jr=.431,Hb={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[Jr,Jr,Jr],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.5,.732,.925],num2:[.394,.384,.5],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[lr,lr,lr],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04]},Ef=[0,.5,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],Zm=5,Wb={"":" ","":" ",:"A",:"C",:"D",:"o",:"a",:"c",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function Ts(t,e){t===void 0&&(t=77);let n=iC[e][t];if(n)return{defaultMetrics:!1,depth:n[0],height:n[1],italic:n[2],skew:n[3],width:n[4]};if(t===11034)return{defaultMetrics:!0,depth:.2,height:.8,italic:0,skew:0,width:.8};let r=String.fromCodePoint(t);if(r in Wb)t=Wb[r].codePointAt(0);else if(oC.test(r))return t=77,{defaultMetrics:!0,depth:.2,height:.9,italic:0,skew:0,width:1};return{defaultMetrics:!0,depth:.2,height:.7,italic:0,skew:0,width:.8}}var Af={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],longrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],longleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],longleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],longrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],longleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xleftrightarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],longleftrightarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xRightleftharpoons:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],longRightleftharpoons:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xLeftrightharpoons:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716],longLeftrightharpoons:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},Df={widehat1:[1062,239,.24],widehat2:[2364,300,.3],widehat3:[2364,360,.36],widehat4:[2364,420,.42],widecheck1:[1062,239,.24],widecheck2:[2364,300,.3],widecheck3:[2364,360,.36],widecheck4:[2364,420,.42],widetilde1:[600,260,.26],widetilde2:[1033,286,.286],widetilde3:[2339,306,.306],widetilde4:[2340,312,.34],overarc:[1061,159,.3],underarc:[1061,159,.3]},Ub={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,overarc:"M529 0c179 0 524 115 524 115 5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2s-338-93-512-92c-174 0-513 92-513 92h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13 0 0 342-115 520-115z",underarc:`m 529 160
  c -179 0 -524 -115 -524 -115
  c -5 -1 -9 -5 -9 -10
  c 0 -1 1 -2 1 -3
  l 4 -22
  c 1 -5 5 -9 11 -9
  h 2
  s 338 93 512 92
  c 174 0 513 -92 513 -92
  h 2
  c 5 0 9 4 11 9
  l 5 22
  c 1 6 -2 12 -8 13
  c 0 0 -342 115 -520 115
  z
  `,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,widetilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,widetilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,widetilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,widetilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`};function aC(t){if(Df[t]){let[u,c,d]=Df[t],p=`<span class="ML__stretchy" style="height:${d}em"><svg width="100%" height="${d}em" viewBox="0 0 ${u} ${c}" preserveAspectRatio="none" ><path fill="currentcolor" d="${Ub[t]}"></path></svg></span>`;return`<span style="display:inline-block;height:${Math.floor(100*d/2)/100}em;min-width:0">${p}</span>`}let[e,n,r,i]=Af[t],o,s,a=r/1e3;e.length===3?(o=["slice-1-of-3","slice-2-of-3","slice-3-of-3"],s=["xMinYMin","xMidYMin","xMaxYMin"]):e.length===2?(o=["slice-1-of-2","slice-2-of-2"],s=["xMinYMin","xMaxYMin"]):(o=["slice-1-of-1"],s=[i]);let l=e.map((u,c)=>`<span class="${o[c]}" style=height:${a}em><svg width=400em height=${a}em viewBox="0 0 400000 ${r}" preserveAspectRatio="${s[c]} slice"><path fill="currentcolor" d="${Ub[u]}"></path></svg></span>`).join("");return`<span style="display:inline-block;height:${a}em;min-width:${n}em;">${l}</span>`}function lC(t){return Af[t]?Af[t][2]/1e3:Df[t][2]}function uC(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r===13&&t.charCodeAt(n+1)===10&&(r=10,n++),(r===13||r===12)&&(r=10),r===0&&(r=65533),r>=55296&&r<=56319){let i=t.charCodeAt(n+1);if(i>=56320&&i<=57343){let o=r-55296,s=i-56320;r=2**16+o*2**10+s,n++}}e.push(r)}return e}var ac=8205,cC=[[ac,1],[65038,2],[127995,5],[129456,4],[917536,96]],Pu,Jb=[127462,127487];function Gb(t){var e;if(Pu===void 0){Pu={};for(let n of cC)for(let r=n[0];r<=n[0]+n[1]-1;r++)Pu[r]=!0}return(e=Pu[t])!=null?e:!1}function dC(t){return t>=Jb[0]&&t<=Jb[1]}function ox(t){if(/^[\u0020-\u00FF]*$/.test(t))return t;let e=[],n=uC(t),r=0;for(;r<n.length;){let i=n[r++],o=n[r];if(o===ac){let s=r-1;for(r+=2;n[r]===ac;)r+=2;e.push(String.fromCodePoint(...n.slice(s,r-s+1)))}else if(Gb(o)){let s=r-1;for(;Gb(n[r]);)r+=n[r]===ac?2:1;e.push(String.fromCodePoint(...n.slice(s,2*r-s-1)))}else dC(i)?(r+=1,e.push(String.fromCodePoint(...n.slice(r-2,2)))):e.push(String.fromCodePoint(i))}return e}var hC=class{constructor(t){this.obeyspaces=!1,this.pos=0,this.s=ox(t)}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:""}peek(){return this.s[this.pos]}match(t){let e=typeof this.s=="string"?t.exec(this.s.slice(this.pos)):t.exec(this.s.slice(this.pos).join(""));return e!=null&&e[0]?(this.pos+=e[0].length,e[0]):""}next(){if(this.end())return null;if(!this.obeyspaces&&this.match(/^[ \f\n\r\t\v\u00A0\u2028\u2029]+/)||this.obeyspaces&&this.match(/^[ \f\n\r\t\v\u00A0\u2028\u2029]/))return"<space>";let t=this.get();if(t==="\\"){if(!this.end()){let e=this.match(/^[a-zA-Z\*]+/);return e?this.match(/^[ \f\n\r\t\v\u00A0\u2028\u2029]*/):e=this.get(),"\\"+e}}else{if(t==="{")return"<{>";if(t==="}")return"<}>";if(t==="^"){if(this.peek()==="^"){this.get();let e=this.match(/^(\^(\^(\^(\^[\da-f])?[\da-f])?[\da-f])?[\da-f])?[\da-f]{2}/);if(e)return String.fromCodePoint(Number.parseInt(e.slice(e.lastIndexOf("^")+1),16))}return t}else if(t==="#"){if(!this.end()){let e=!1;if(/[\d?@]/.test(this.peek())&&(e=!0,this.pos+1<this.s.length)){let n=this.s[this.pos+1];e=/[^\dA-Za-z]/.test(n)}return e?"#"+this.get():"#"}}else if(t==="$")return this.peek()==="$"?(this.get(),"<$$>"):"<$>"}return t}};function pC(t,e){var n,r,i,o;let s=[],a=t.next();if(a&&a!=="\\relax"){if(a==="\\noexpand")a=t.next(),a&&s.push(a);else if(a==="\\obeyspaces")t.obeyspaces=!0;else if(a==="\\bgroup")s.push("<{>");else if(a==="\\egroup")s.push("<}>");else if(a==="\\string"){if(a=t.next(),a)if(a.startsWith("\\"))for(let l of a)s.push(l==="\\"?"\\backslash":l);else a==="<{>"?s.push("\\{"):a==="<space>"?s.push("~"):a==="<}>"&&s.push("\\}")}else if(a==="\\csname"){for(;t.peek()==="<space>";)t.next();let l="",u=!1,c=[];do{if(c.length===0)if(/^#[\d?@]$/.test(t.peek())){let d=t.get().slice(1);c=bl((r=(n=e?.(d))!=null?n:e?.("?"))!=null?r:"\\placeholder{}",e),a=c[0]}else a=t.next(),c=a?[a]:[];u=c.length===0,!u&&a==="\\endcsname"&&(u=!0,c.shift()),u||(u=a==="<$>"||a==="<$$>"||a==="<{>"||a==="<}>"||typeof a=="string"&&a.length>1&&a.startsWith("\\")),u||(l+=c.shift())}while(!u);l&&s.push("\\"+l),s.push(...c)}else if(a!=="\\endcsname")if(a.length>1&&a.startsWith("#")){let l=a.slice(1);s.push(...bl((o=(i=e?.(l))!=null?i:e?.("?"))!=null?o:"\\placeholder{}",e))}else s.push(a)}return s}function bl(t,e=null){if(!t)return[];let n=[],r="";for(let s of t.toString().split(/\r?\n/)){r&&n.push(r),r=" ";let a=s.match(/((?:\\%)|[^%])*/);a!==null&&n.push(a[0])}let i=new hC(n.join("")),o=[];do o.push(...pC(i,e));while(!i.end());return o}function Fe(t){let e="",n=[];for(let r of t)r&&(e&&/^[a-zA-Z\*]/.test(r)&&n.push(e),n.push(r),/^\\[a-zA-Z]+\*?[\"\'][^\ ]+$/.test(r)&&n.push(" "),e=/\\[a-zA-Z]+\*?$/.test(r)?" ":"");return n.join("")}function ut(t,...e){return t.startsWith("\\"),e.length===0?t:Fe([t,...e.map(n=>`{${n}}`)])}function co(t){return Fe(t.map(e=>{var n;return(n={"<space>":" ","<$$>":"$$","<$>":"$","<{>":"{","<}>":"}"}[e])!=null?n:e}))}var sx=class Ra{constructor(e){Ra._registry[e]=this}static createAtom(e,n,r){return Ra._registry[e].createAtom(n,Vt(n,e),r)}static serialize(e,n){var r;if(!e||e.length===0)return"";if((r=n.skipStyles)!=null&&r){let i=[];for(let o of ax(e)){let s=Ra._registry[o[0].mode];i.push(...s.serialize(o,n))}return Fe(i)}return Fe(mC(e,n))}static getFont(e,n,r){return Ra._registry[e].getFont(n,r)}};sx._registry={};var In=sx;function ax(t){let e=[],n=[],r="NONE";for(let i of t)i.type!=="first"&&(i.mode!==r?(n.length>0&&e.push(n),n=[i],r=i.mode):n.push(i));return n.length>0&&e.push(n),e}function Lf(t){if(t?.mode!=="math")return"";let{style:e}=t;return!e||!e.variantStyle?"":e.variantStyle==="bold"||e.variantStyle==="bolditalic"?"bold":""}function Tf(t){if(!t)return"";let{style:e}=t;if(!e)return"";let n=e.variant;return n===void 0?"normal":(!["calligraphic","fraktur","double-struck","script","monospace","sans-serif"].includes(n)&&e.variantStyle&&(n+="-"+e.variantStyle),n)}function ti(t,e){let n=[],r=[],i;for(let o of t){if(o.type==="first")continue;let s;e==="variant"?s=Tf(o):e==="bold"?s=Lf(o):s=o.style[e],s===i?r.push(o):(r.length>0&&n.push(r),r=[o],i=s)}return r.length>0&&n.push(r),n}function Xb(t,e){var n;let{parent:r}=t[0],i=r?.style.color,o=[];for(let s of ax(t)){let a=e.defaultMode;for(let l of ti(s,"color")){let u=l[0].style,c=In._registry[l[0].mode].serialize(l,V(O({},e),{defaultMode:a==="text"?"text":"math"}));!e.skipStyles&&u.color&&u.color!=="none"&&(!r||i!==u.color)?o.push(ut("\\textcolor",(n=u.verbatimColor)!=null?n:u.color,Fe(c))):o.push(Fe(c))}}return o}function fC(t,e){let{parent:n}=t[0],r=n?.style.backgroundColor;return ti(t,"backgroundColor").map(i=>{var o;if(i.length>0||i[0].type!=="box"){let s=i[0].style;if(s.backgroundColor&&s.backgroundColor!=="none"&&(!n||r!==s.backgroundColor))return ut("\\colorbox",(o=s.verbatimBackgroundColor)!=null?o:s.backgroundColor,Fe(Xb(i,V(O({},e),{defaultMode:"text"}))))}return Fe(Xb(i,e))})}function mC(t,e){if(t.length===0)return[];let{parent:n}=t[0],r=n?.style.fontSize,i=[];for(let o of ti(t,"fontSize")){let s=o[0].style.fontSize,a=fC(o,e);a&&(s&&s!=="auto"&&(!n||r!==s)?i.push(["","\\tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"][s],...a):i.push(...a))}return i}function Bf(t){return t?{mord:"ord",mbin:"bin",mop:"op",mrel:"rel",mopen:"open",mclose:"close",mpunct:"punct",minner:"inner",spacing:"ignore",latex:"latex",composition:"inner",error:"inner",placeholder:"ord",supsub:"ignore"}[t]:void 0}function Dl(t){if(t.length===0)return"ord";let e=Bf(t[0].type),n=Bf(t[t.length-1].type);return e&&e===n?e:"ord"}function wa(t,e){if(typeof t=="string")return t;if(typeof t=="number"){let n=Math.ceil(100*t)/100;return n===0?"0":n.toString()+(e??"")}return""}var oe=class lx{constructor(e,n){var r,i,o,s,a;if(typeof e=="number"?this.value=String.fromCodePoint(e):typeof e=="string"?this.value=e:Ht(e)?this.children=e.filter(u=>u!==null):e&&e instanceof lx&&(this.children=[e]),this.children)for(let u of this.children)u.parent=this;this.type=(r=n?.type)!=null?r:"ignore",this.isSelected=n?.isSelected===!0,n!=null&&n.caret&&(this.caret=n.caret),this.classes=(i=n?.classes)!=null?i:"",this.isTight=(o=n?.isTight)!=null?o:!1,n!=null&&n.attributes&&(this.attributes=n.attributes);let l=n?.fontFamily;n!=null&&n.style&&this.value&&(l=(a=In.getFont((s=n.mode)!=null?s:"math",this,V(O({variant:"normal"},n.style),{letterShapeStyle:n.letterShapeStyle})))!=null?a:void 0),l||(l="Main-Regular"),this._height=0,this._depth=0,this._width=0,this.hasExplicitWidth=!1,this.skew=0,this.italic=0,this.maxFontSize=0,this.scale=1,n?.maxFontSize!==void 0&&(this.maxFontSize=n.maxFontSize),gC(this,l)}set atomID(e){e===void 0||e.length===0||(this.id=e)}selected(e){if(this.isSelected!==e&&(this.isSelected=e,this.children))for(let n of this.children)n.selected(e)}setStyle(e,n,r){if(n===void 0)return;let i=wa(n,r);i.length>0&&(this.cssProperties||(this.cssProperties={}),this.cssProperties[e]=i)}setTop(e){Number.isFinite(e)&&Math.abs(e)>.01&&(this.cssProperties||(this.cssProperties={}),this.cssProperties.top=wa(e,"em"),this.height-=e,this.depth+=e)}get left(){var e;return(e=this.cssProperties)!=null&&e["margin-left"]?Number.parseFloat(this.cssProperties["margin-left"]):0}set left(e){Number.isFinite(e)&&(e===0?this.cssProperties&&delete this.cssProperties["margin-left"]:(this.cssProperties||(this.cssProperties={}),this.cssProperties["margin-left"]=wa(e,"em")))}set right(e){Number.isFinite(e)&&(e===0?this.cssProperties&&delete this.cssProperties["margin-right"]:(this.cssProperties||(this.cssProperties={}),this.cssProperties["margin-right"]=wa(e,"em")))}set bottom(e){Number.isFinite(e)&&(e===0?this.cssProperties&&delete this.cssProperties["margin-bottom"]:(this.cssProperties||(this.cssProperties={}),this.cssProperties["margin-bottom"]=wa(e,"em")))}get width(){return this._width*this.scale}set width(e){this._width=e,this.hasExplicitWidth=!0}set softWidth(e){}get height(){return this._height*this.scale}set height(e){this._height=e}get depth(){return this._depth*this.scale}set depth(e){this._depth=e}wrap(e){let n=e.parent;if(!n)return this;e.isPhantom&&this.setStyle("opacity",0);let r=e.color;r&&r!==n.color&&this.setStyle("color",r);let i=e.backgroundColor;this.isSelected&&(i=JM(i)),i&&i!==n.backgroundColor&&(this.setStyle("background-color",i),this.setStyle("--bg-color",i),this.setStyle("display","inline-block"),this.setStyle("position","relative"),this.classes=this.classes?`${this.classes} ML__bg`:"ML__bg");let o=e.scalingFactor;return this.scale=o,this.skew*=o,this.italic*=o,this}toMarkup(){var e,n,r,i;let o=(e=this.value)!=null?e:"";if(this.children)for(let f of this.children)o+=f.toMarkup();let s="";if(this.svgBody)s=aC(this.svgBody);else if(this.svgOverlay){s='<span style="',s+="display: inline-block;",s+=`height:${Math.floor(100*(this.height+this.depth))/100}em;`,s+=`vertical-align:${Math.floor(100*this.depth)/100}em;`,s+='">',s+=o,s+="</span>",s+='<svg style="position:absolute;overflow:visible;',s+=`height:${Math.floor(100*(this.height+this.depth))/100}em;`;let f=(n=this.cssProperties)==null?void 0:n.padding;f?(s+=`top:${f};`,s+=`left:${f};`,s+=`width:calc(100% - 2 * ${f} );`):s+="top:0;left:0;width:100%;",s+="z-index:2;",s+='"',this.svgStyle&&(s+=this.svgStyle),s+=` viewBox="0 0 ${Math.floor(100*this.width)/100} ${Math.floor(100*(this.height+this.depth))/100}"`,s+=`>${this.svgOverlay}</svg>`}let a=[],l=this.classes.split(" ");l.push((r={latex:"ML__raw-latex",placeholder:"ML__placeholder",error:"ML__error"}[this.type])!=null?r:""),this.caret==="latex"&&l.push("ML__latex-caret"),this.isSelected&&l.push("ML__selected");let u=l.length===1?l[0]:l.filter((f,g,x)=>f.length>0&&x.indexOf(f)===g).join(" ");if(u.length>0&&a.push(`class=${ys(`"${u}"`)}`),this.id&&a.push(` data-atom-id=${ys(this.id)}`),this.cssId&&a.push(` id=${ys(`"${this.cssId.replace(/ /g,"-")}"`)}`),this.attributes&&a.push(...Object.keys(this.attributes).map(f=>`${xp(f)}=${ys(this.attributes[f])}`)),this.htmlData){let f=this.htmlData.split(",");for(let g of f){let x=g.match(/([^=]+)=(.+$)/);if(x){let w=xp(x[1]);if(w)if(w==="href"){let k=new URL(x[2]);if(k.protocol!=="http:"&&k.protocol!=="https:")throw new Error(`Invalid URL: ${x[2]}`);a.push(`href="${x[2].replace(/"/g,"&quot;")}"`)}else a.push(`data-${w}=${ys(x[2])}`)}else{let w=xp(g);w&&a.push(`data-${w} `)}}}let c=(i=this.cssProperties)!=null?i:{};this.hasExplicitWidth&&c.width===void 0&&(c.width=`${Math.ceil(this._width*100)/100}em`);let d=Object.keys(c).map(f=>`${f}:${c[f]}`);if(this.scale!==void 0&&this.scale!==1&&(o.length>0||s.length>0)&&d.push(`font-size: ${Math.ceil(this.scale*1e4)/100}%`),this.htmlStyle)for(let f of this.htmlStyle.split(";")){let g=f.match(/([^:]+):(.+$)/);if(g){let x=g[1].trim().replace(/ /g,"-");x&&d.push(`${x}:${g[2]}`)}}d.length>0&&a.push(`style=${ys(d.join(";"))}`);let p="";return a.length>0||s.length>0?p=`<span ${a.join(" ")}>${o}${s}</span>`:p=o,this.caret==="text"?p+='<span class="ML__text-caret"></span>':this.caret==="math"&&(p+='<span class="ML__caret"></span>'),p}tryCoalesceWith(e){if(this.svgBody||!this.value||e.svgBody||!e.value)return!1;let n=this.children&&this.children.length>0,r=e.children&&e.children.length>0;if(n||r)return!1;if(e.cssProperties||this.cssProperties){for(let l of["border","border-left","border-right","border-right-width","left","margin","margin-left","margin-right","padding","position","width"])if(e.cssProperties&&l in e.cssProperties||this.cssProperties&&l in this.cssProperties)return!1}let i=this.cssProperties?Object.keys(this.cssProperties).length:0,o=e.cssProperties?Object.keys(e.cssProperties).length:0;if(i!==o)return!1;if(i>0){for(let l of Object.keys(this.cssProperties))if(this.cssProperties[l]!==e.cssProperties[l])return!1}let s=this.classes.trim().replace(/\s+/g," ").split(" "),a=e.classes.trim().replace(/\s+/g," ").split(" ");if(s.length!==a.length)return!1;s.sort(),a.sort();for(let[l,u]of s.entries())if(u==="ML__vertical-separator"||u!==a[l])return!1;return this.value+=e.value,this.height=Math.max(this.height,e.height),this.depth=Math.max(this.depth,e.depth),this._width=this._width+e._width,this.maxFontSize=Math.max(this.maxFontSize,e.maxFontSize),this.italic=e.italic,!0}};function Of(t){if(!t||t.length===0)return[];t[0].children=Of(t[0].children);let e=[t[0]];for(let n=1;n<t.length;n++)e[e.length-1].tryCoalesceWith(t[n])||(t[n].children=Of(t[n].children),e.push(t[n]));return e}function Jd(t){return t.children&&(t.children=Of(t.children)),t}function Gd(t,e){if(!t)return new oe(null,e);let n=new oe(null,{classes:"ML__strut",type:"ignore"});n.setStyle("height",Math.max(0,t.height),"em");let r=[n];if(t.depth!==0){let i=new oe(null,{classes:"ML__strut--bottom",type:"ignore"});i.setStyle("height",t.height+t.depth,"em"),i.setStyle("vertical-align",-t.depth,"em"),r.push(i)}return r.push(t),new oe(r,V(O({},e),{type:"lift"}))}function lc(t){let e=lC(t)/2,n=new oe(null,{maxFontSize:0});return n.height=e+.166,n.depth=e-.166,n.svgBody=t,n}function gC(t,e){var n;if(t.type==="latex"){t.height=.9,t.depth=.2,t._width=1;return}if(t.value){t.height=-1/0,t.depth=-1/0,t._width=0,t.skew=-1/0,t.italic=-1/0;for(let r=0;r<t.value.length;r++){let i=Ts(t.value.codePointAt(r),e);t.height=Math.max(t.height,i.height),t.depth=Math.max(t.depth,i.depth),t._width+=i.width,t.skew=i.skew,t.italic=i.italic}return}if(t.children&&t.children.length>0){let r=-1/0,i=-1/0,o=0;for(let s of t.children)s.height>r&&(r=s.height),s.depth>i&&(i=s.depth),o=Math.max(o,(n=s.maxFontSize)!=null?n:0);t.height=r,t.depth=i,t._width=t.children.reduce((s,a)=>s+a.width,0),t.maxFontSize=o}}function xp(t){if(t=t.trim().replace(/ /g,"-"),t.length===0)throw new Error("Invalid empty attribute name");if(/[\x20\x09\x0a\x0c\x0d"'>/=\x00-\x1f]/.test(t))throw new Error(`Invalid attribute name "${t}"`);return t}function ys(t){if(t=t.trim(),t.startsWith('"')&&t.endsWith('"')){if(/"/.test(t.slice(1,-1)))throw new Error(`Invalid attribute value: ${t}`);return t}if(t.startsWith("'")&&t.endsWith("'")){if(/'/.test(t.slice(1,-1)))throw new Error(`Invalid attribute value: ${t}`);return t}if(t.length===0)throw new Error("Invalid empty attribute value");return`"${t.replace(/"/g,"&quot;")}"`}function yC(t){if("individualShift"in t){let e=t.individualShift,n=e[0];if(n==null)return[null,0];let r=[n],i=-n.shift-n.box.depth,o=i;for(let s=1;s<e.length;s++){let a=e[s],l=-a.shift-o-a.box.depth,u=l-(n.box.height+n.box.depth);o=o+l,r.push(u),r.push(a),n=a}return[r,i]}if("top"in t){let e=t.top;for(let n of t.children)e-=typeof n=="number"?n:n.box.height+n.box.depth;return[t.children,e]}else{if("bottom"in t)return[t.children,-t.bottom];if("firstBaseline"in t){let e=t.firstBaseline[0];if(typeof e=="number")throw new Error("First child must be an element.");return[t.firstBaseline,-e.box.depth]}else if("shift"in t){let e=t.children[0];if(typeof e=="number")throw new Error("First child must be an element.");return[t.children,-e.box.depth-t.shift]}}return[null,0]}function bC(t){var e;let[n,r]=yC(t);if(!n)return[[],0,0];let i=new oe(null,{classes:"ML__pstrut"}),o=0;for(let g of n)if(typeof g!="number"){let x=g.box;o=Math.max(o,x.maxFontSize,x.height)}o+=2,i.height=o,i.setStyle("height",o,"em");let s=[],a=r,l=r,u=r,c=0;for(let g of n){if(typeof g=="number")u+=g;else{let x=g.box,w=(e=g.classes)!=null?e:[],k=new oe([i,x],{classes:w.join(" "),style:g.style});x.setStyle("height",x.height+x.depth,"em"),x.setStyle("display","inline-block"),k.setStyle("top",-o-u-x.depth,"em"),g.marginLeft&&k.setStyle("margin-left",g.marginLeft,"em"),g.marginRight&&k.setStyle("margin-right",g.marginRight,"em"),s.push(k),u+=x.height+x.depth,c=Math.max(c,k.width)}a=Math.min(a,u),l=Math.max(l,u)}s.forEach(g=>{g.softWidth=c});let d=new oe(s,{classes:"ML__vlist"});if(d.softWidth=c,d.height=l,d.setStyle("height",l,"em"),a>=0)return[[new oe(d,{classes:"ML__vlist-r"})],l,-a];let p=new oe(new oe(null),{classes:"ML__vlist"});p.height=-a,p.setStyle("height",-a,"em");let f=new oe(8203,{classes:"ML__vlist-s",maxFontSize:0});return f.softWidth=0,f.height=0,f.depth=0,[[new oe([d,f],{classes:"ML__vlist-r"}),new oe(p,{classes:"ML__vlist-r"})],l,-a]}var It=class extends oe{constructor(t,e){var n;let[r,i,o]=bC(t);super(r.length===1?r[0]:r,{type:e?.type,classes:((n=e?.classes)!=null?n:"")+" ML__vlist-t"+(r.length===2?" ML__vlist-t2":"")}),this.height=i,this.depth=o,this.softWidth=r.reduce((s,a)=>Math.max(s,a.width),0)}};function vC(t,e){var n,r,i,o,s;let a=t.metrics,l=new oe(e.base),u=(n=e.baseShift)!=null?n:0,c=(r=e.slant)!=null?r:0,d=0,p=0;e.above&&(d=(i=e.aboveShift)!=null?i:Math.max(a.bigOpSpacing1,a.bigOpSpacing3-e.above.depth)),e.below&&(p=(o=e.belowShift)!=null?o:Math.max(a.bigOpSpacing2,a.bigOpSpacing4-e.below.height));let f=null;if(e.below&&e.above){let g=a.bigOpSpacing5+e.below.height+e.below.depth+p+l.depth+u;f=new It({bottom:g,children:[a.bigOpSpacing5,{box:e.below,marginLeft:-c,classes:["ML__center"]},p,{box:l,classes:["ML__center"]},d,{box:e.above,marginLeft:c,classes:["ML__center"]},a.bigOpSpacing5]}).wrap(t)}else if(e.below&&!e.above)f=new It({top:l.height-u,children:[a.bigOpSpacing5,{box:e.below,marginLeft:-c,classes:["ML__center"]},p,{box:l,classes:["ML__center"]}]}).wrap(t);else if(!e.below&&e.above){let g=l.depth+u;f=new It({bottom:g,children:[{box:l,classes:["ML__center"]},d,{box:e.above,marginLeft:c,classes:["ML__center"]},a.bigOpSpacing5]}).wrap(t)}else{let g=l.depth+u;f=new It({bottom:g,children:[{box:l},a.bigOpSpacing5]}).wrap(t)}return new oe(f,{type:(s=e.type)!=null?s:"op"})}var Qm=7,md=6,Xd=5,ko=4,Fs=3,Nn=2,Do=1,dn=0,yi=class{constructor(t,e,n){this.id=t,this.sizeDelta=e,this.cramped=n;let r={"-4":2,"-3":1,0:0}[e];this.metrics=Object.keys(Hb).reduce((i,o)=>V(O({},i),{[o]:Hb[o][r]}),{})}getFontSize(t){return Math.max(1,t+this.sizeDelta)}get sup(){return wr[[dn,Do,dn,Do,Nn,Fs,Nn,Fs][this.id]]}get sub(){return wr[[dn,dn,dn,dn,Nn,Nn,Nn,Nn][this.id]]}get fracNum(){return wr[[dn,Do,dn,Do,Nn,Fs,ko,Xd][this.id]]}get fracDen(){return wr[[dn,dn,dn,dn,Nn,Nn,ko,ko][this.id]]}get cramp(){return wr[[dn,dn,Nn,Nn,ko,ko,md,md][this.id]]}get isTight(){return this.sizeDelta<0}},ka={7:new yi(Qm,0,!1),6:new yi(md,0,!0),5:new yi(Xd,0,!1),4:new yi(ko,0,!0),3:new yi(Fs,-3,!1),2:new yi(Nn,-3,!0),1:new yi(Do,-4,!1),0:new yi(dn,-4,!0)},wr=V(O({},ka),{displaystyle:ka[Qm],textstyle:ka[Xd],scriptstyle:ka[Fs],scriptscriptstyle:ka[Do]});function ux(t,e){var n;if(!t)return 0;let r={pt:1,mm:7227/2540,cm:7227/254,ex:35271/8192,px:3/4,em:Ys,bp:803/800,dd:1238/1157,pc:12,in:72.27,mu:10/18}[(n=t.unit)!=null?n:"pt"];if(Number.isFinite(e)){let i=10**e;return Math.round(t.dimension/Ys*r*i)/i}return t.dimension*r}function cx(t,e){if(t===null)return 0;let n=ux(t)/Ys;if(Number.isFinite(e)){let r=10**e;return Math.round(n*r)/r}return n}function wp(t){var e;return`${t.dimension}${(e=t.unit)!=null?e:"pt"}`}function xC(t){let e=wp(t.glue);return t.grow&&t.grow.dimension!==0&&(e+=` plus ${wp(t.grow)}`),t.shrink&&t.shrink.dimension!==0&&(e+=` minus ${wp(t.shrink)}`),e}function Qt(t){var e,n;if(t==null)return null;let r="";if("dimension"in t&&(r=`${t.dimension}${(e=t.unit)!=null?e:"pt"}`),"glue"in t&&(r=xC(t)),"number"in t)if(!("base"in t)||t.base==="decimal")r=Number(t.number).toString();else if(t.base==="alpha")r=`\`${String.fromCodePoint(t.number)}`;else{let i=Math.round(t.number)>>>0;t.base==="hexadecimal"?(r=Number(i).toString(16).toUpperCase(),i<=255?r=r.padStart(2,"0"):i<=65535?r=r.padStart(4,"0"):i<=16777215?r=r.padStart(6,"0"):r=r.padStart(8,"0"),r=`"${r}`):t.base==="octal"&&(r=Number(i).toString(8),i<=63?r=r.padStart(2,"0"):i<=30583?r=r.padStart(4,"0"):r=r.padStart(8,"0"),r=`'${r}`)}return"register"in t&&("factor"in t&&(t.factor===-1?r="-":t.factor!==1&&(r=Number(t.factor).toString())),"global"in t&&t.global&&(r+="\\global"),r+=`\\${t.register}`),"string"in t&&(r=t.string),(n=t.relax)!=null&&n&&(r+="\\relax"),r}function xr(t,e){return t==null?null:"number"in t?V(O({},t),{number:t.number*e}):"register"in t?"factor"in t&&t.factor?V(O({},t),{factor:t.factor*e}):V(O({},t),{factor:e}):"dimension"in t?V(O({},t),{dimension:t.dimension*e}):"glue"in t?t.shrink&&t.grow?{glue:xr(t.glue,e),shrink:xr(t.shrink,e),grow:xr(t.grow,e)}:t.shrink?{glue:xr(t.glue,e),shrink:xr(t.shrink,e)}:t.grow?{glue:xr(t.glue,e),grow:xr(t.grow,e)}:{glue:xr(t.glue,e)}:null}var wC={"p@":{dimension:1},"z@":{dimension:0},maxdimen:{dimension:16383.99999},hfuzz:{dimension:.1},vfuzz:{dimension:.1},overfullrule:{dimension:5},hsize:{dimension:6.5,unit:"in"},vsize:{dimension:8.9,unit:"in"},parindent:{dimension:20},maxdepth:{dimension:4},splitmaxdepth:{register:"maxdimen"},boxmaxdepth:{register:"maxdimen"},delimitershortfall:{dimension:5},nulldelimiterspace:{dimension:1.2,unit:"pt"},scriptspace:{dimension:.5},topskip:{dimension:10},splittopskip:{dimension:10},normalbaselineskip:{dimension:12},normallineskip:{dimension:1},normallineskiplimit:{dimension:0},jot:{dimension:3},doublerulesep:{dimension:2},arrayrulewidth:{dimension:.4},arraycolsep:{dimension:5},fboxsep:{dimension:3},fboxrule:{dimension:.4},"z@skip":{glue:{dimension:0},shrink:{dimension:0},grow:{dimension:0}},hideskip:{glue:{dimension:-1e3},grow:{dimension:1,unit:"fill"}},"@flushglue":{glue:{dimension:0},grow:{dimension:1,unit:"fill"}},parskip:{glue:{dimension:0},grow:{dimension:1}},abovedisplayskip:{glue:{dimension:12},grow:{dimension:3},shrink:{dimension:9}},abovedisplayshortskip:{glue:{dimension:0},grow:{dimension:3}},belowdisplayskip:{glue:{dimension:12},grow:{dimension:3},shrink:{dimension:9}},belowdisplayshortskip:{glue:{dimension:7},grow:{dimension:3},shrink:{dimension:4}},parfillskip:{glue:{dimension:0},grow:{dimension:1,unit:"fil"}},thinmuskip:{glue:{dimension:3,unit:"mu"}},medmuskip:{glue:{dimension:4,unit:"mu"},grow:{dimension:2,unit:"mu"},shrink:{dimension:4,unit:"mu"}},thickmuskip:{glue:{dimension:5,unit:"mu"},grow:{dimension:5,unit:"mu"}},smallskipamount:{glue:{dimension:3},grow:{dimension:1},shrink:{dimension:1}},medskipamount:{glue:{dimension:6},grow:{dimension:2},shrink:{dimension:3}},bigskipamount:{glue:{dimension:12},grow:{dimension:2},shrink:{dimension:4}},pretolerance:100,tolerance:200,hbadness:1e3,vbadness:1e3,linepenalty:10,hyphenpenalty:50,exhyphenpenalty:50,binoppenalty:700,relpenalty:500,clubpenalty:150,widowpenalty:150,displaywidowpenalty:50,brokenpenalty:100,predisplaypenalty:1e4,doublehyphendemerits:1e4,finalhyphendemerits:5e3,adjdemerits:1e4,tracinglostchars:1,uchyph:1,delimiterfactor:901,defaulthyphenchar:"\\-",defaultskewchar:-1,newlinechar:-1,showboxbreadth:5,showboxdepth:3,errorcontextlines:5,interdisplaylinepenalty:100,interfootnotelinepenalty:100,baselineSkip:1.2,arraystretch:1,month:new Date().getMonth()+1,day:new Date().getDate(),year:new Date().getFullYear()};function dx(){return O({},wC)}function hx(){return{registers:dx(),smartFence:!1,renderPlaceholder:void 0,placeholderSymbol:"",letterShapeStyle:qe.locale.startsWith("fr")?"french":"tex",minFontScale:0,maxMatrixCols:10,colorMap:Ud,backgroundColorMap:Um,getMacro:t=>Ym(t,Xm())}}var Ye=class px{constructor(e,n){var r,i,o,s,a,l,u,c,d,p,f,g,x,w,k;let D;e!=null&&e.parent?(this.parent=e.parent,D=e.parent,this.registers={}):(D=O(O({},hx()),(r=e?.from)!=null?r:{}),this.registers=D.registers),D.atomIdsSettings&&(this.atomIdsSettings=O({},D.atomIdsSettings)),this.renderPlaceholder=D.renderPlaceholder,this.isPhantom=(s=(o=e?.isPhantom)!=null?o:(i=this.parent)==null?void 0:i.isPhantom)!=null?s:!1,this.letterShapeStyle=D.letterShapeStyle,this.minFontScale=D.minFontScale,this.maxMatrixCols=D.maxMatrixCols,n!=null&&n.color&&n.color!=="none"?this.color=n.color:this.color=(l=(a=this.parent)==null?void 0:a.color)!=null?l:"",n!=null&&n.backgroundColor&&n.backgroundColor!=="none"?this.backgroundColor=n.backgroundColor:this.backgroundColor=(c=(u=this.parent)==null?void 0:u.backgroundColor)!=null?c:"",n!=null&&n.fontSize&&n.fontSize!=="auto"&&n.fontSize!==((d=this.parent)==null?void 0:d.size)?this.size=n.fontSize:this.size=(f=(p=this.parent)==null?void 0:p.size)!=null?f:Zm;let N=(x=(g=this.parent)==null?void 0:g.mathstyle)!=null?x:wr.displaystyle;if(typeof e?.mathstyle=="string"){if(D instanceof px)switch(e.mathstyle){case"cramp":N=N.cramp;break;case"superscript":N=N.sup;break;case"subscript":N=N.sub;break;case"numerator":N=N.fracNum;break;case"denominator":N=N.fracDen;break}switch(e.mathstyle){case"textstyle":N=wr.textstyle;break;case"displaystyle":N=wr.displaystyle;break;case"scriptstyle":N=wr.scriptstyle;break;case"scriptscriptstyle":N=wr.scriptscriptstyle;break}}this.mathstyle=N,this.smartFence=D.smartFence,this.placeholderSymbol=D.placeholderSymbol,this.colorMap=(w=D.colorMap)!=null?w:(B=>B),this.backgroundColorMap=(k=D.backgroundColorMap)!=null?k:(B=>B),this.getMacro=D.getMacro,this.parent!==void 0||this.registers}makeID(){if(!this.atomIdsSettings)return;if(this.atomIdsSettings.overrideID)return this.atomIdsSettings.overrideID;if(typeof this.atomIdsSettings.seed!="number")return`${Date.now().toString(36).slice(-2)}${Math.floor(Math.random()*1e5).toString(36)}`;let e=this.atomIdsSettings.seed.toString(36);return this.atomIdsSettings.seed+=1,e}scale(e){return e*this.effectiveFontSize}get scalingFactor(){return this.parent?this.effectiveFontSize/this.parent.effectiveFontSize:1}get isDisplayStyle(){return this.mathstyle.id===Qm||this.mathstyle.id===md}get isCramped(){return this.mathstyle.cramped}get isTight(){return this.mathstyle.isTight}get metrics(){return this.mathstyle.metrics}get effectiveFontSize(){return Math.max(Ef[Math.max(1,this.size+this.mathstyle.sizeDelta)],this.minFontScale)}getRegister(e){if(this.registers&&e in this.registers)return this.registers[e];if(this.parent)return this.parent.getRegister(e)}getRegisterAsNumber(e){let n=this.getRegister(e);if(typeof n=="number")return n;if(typeof n=="string")return Number(n)}getRegisterAsGlue(e){if(this.registers&&e in this.registers){let n=this.registers[e];return typeof n=="object"&&"glue"in n?n:typeof n=="object"&&"dimension"in n?{glue:{dimension:n.dimension}}:typeof n=="number"?{glue:{dimension:n}}:void 0}if(this.parent)return this.parent.getRegisterAsGlue(e)}getRegisterAsEm(e,n){return cx(this.getRegisterAsDimension(e),n)}getRegisterAsDimension(e){if(this.registers&&e in this.registers){let n=this.registers[e];return typeof n=="object"&&"glue"in n?n.glue:typeof n=="object"&&"dimension"in n?n:typeof n=="number"?{dimension:n}:void 0}if(this.parent)return this.parent.getRegisterAsDimension(e)}setRegister(e,n){if(n===void 0){delete this.registers[e];return}this.registers[e]=n}evaluate(e){if(!e||!("register"in e))return e;let n=this;if("global"in e&&e.global)for(;n.parent;)n=n.parent;let r=1;"factor"in e&&e.factor!==1&&e.factor!==void 0&&(r=e.factor);let i=n.getRegister(e.register);if(i===void 0)return;if(typeof i=="string")return{string:Number(i).toString()+i};if(typeof i=="number")return{number:r*i};let o=n.evaluate(i);if(o!==void 0)return"string"in o?{string:Number(i).toString()+o.string}:"number"in o?{number:r*o.number}:"dimension"in o?V(O({},o),{dimension:r*o.dimension}):"glue"in o?V(O({},o),{glue:V(O({},o.glue),{dimension:r*o.glue.dimension}),shrink:o.shrink?V(O({},o.shrink),{dimension:r*o.shrink.dimension}):void 0,grow:o.grow?V(O({},o.grow),{dimension:r*o.grow.dimension}):void 0}):e}toDimension(e){let n=this.evaluate(e);if(n===void 0)return null;if("dimension"in n)return n;if("glue"in n)return n.glue;if("number"in n)return{dimension:n.number};if("string"in n){let r=parseFloat(n.string),i=n.string.match(/(mm|cm|ex|px|em|bp|dd|pc|in|mu)$/);return i?{dimension:r,unit:i[0]}:{dimension:r}}return null}toEm(e,n){if(e===null)return 0;let r=this.toDimension(e);return r===null?0:ux(r,n)/Ys}toNumber(e){if(e===null)return null;let n=this.evaluate(e);return n===void 0?null:"number"in n?n.number:"dimension"in n?n.dimension:"glue"in n?n.glue.dimension:"string"in n?Number(n.string):null}toColor(e){var n,r;if(e===null)return null;let i=this.evaluate(e);return i===void 0?null:"string"in i?(r=(n=this.colorMap)==null?void 0:n.call(this,i.string))!=null?r:i.string:null}toBackgroundColor(e){var n,r;if(e===null)return null;let i=this.evaluate(e);return i===void 0?null:"string"in i?(r=(n=this.backgroundColorMap)==null?void 0:n.call(this,i.string))!=null?r:i.string:null}},Zs=["body","above","below","superscript","subscript"];function bo(t){return typeof t=="string"&&Zs.includes(t)}function Yr(t){return t!==void 0&&Array.isArray(t)&&t.length===2}var G=class Rr{constructor(e){this.isRoot=!1;var n,r,i,o,s,a,l;this.type=e.type,typeof e.value=="string"&&(this.value=e.value),this.command=(r=(n=e.command)!=null?n:this.value)!=null?r:"",this.mode=(i=e.mode)!=null?i:"math",e.isFunction&&(this.isFunction=!0),(e.isRoot||this.type==="root")&&(this.isRoot=!0),e.limits&&(this.subsupPlacement=e.limits),this.style=O({},(o=e.style)!=null?o:{}),this.displayContainsHighlight=(s=e.displayContainsHighlight)!=null?s:!1,this.captureSelection=(a=e.captureSelection)!=null?a:!1,this.skipBoundary=(l=e.skipBoundary)!=null?l:!1,e.verbatimLatex!==void 0&&e.verbatimLatex!==null&&(this.verbatimLatex=e.verbatimLatex),e.args&&(this.args=e.args),e.body&&(this.body=e.body),this._changeCounter=0}static createBox(e,n,r){var i;if(!n)return null;let o=kC(n),s=[];for(let l of o){let u=l[0].style,c=SC(e,l,{style:{color:u.color,backgroundColor:u.backgroundColor,fontSize:u.fontSize}});c&&s.push(c)}if(s.length===0)return null;let a=((i=r?.classes)!=null?i:"").trim();return s.length===1&&!a&&!(r!=null&&r.type)?s[0].wrap(e):new oe(s,{classes:a,type:r?.type}).wrap(e)}static serialize(e,n){return In.serialize(e,n)}static commonAncestor(e,n){if(e===n||e.parent===n.parent)return e.parent;let r=new WeakSet,{parent:i}=e;for(;i;)r.add(i),i=i.parent;for(i=n.parent;i;){if(r.has(i))return i;i=i.parent}}static fromJson(e){return typeof e=="string"?new Rr({type:"mord",value:e,mode:"math"}):new Rr(e)}toJson(){if(this._json)return this._json;let e={};if(this.type&&(e.type=this.type),this.mode!=="math"&&(e.mode=this.mode),this.command&&this.command!==this.value&&(e.command=this.command),this.value!==void 0&&(e.value=this.value),this.style&&Object.keys(this.style).length>0&&(e.style=O({},this.style)),this.verbatimLatex!==void 0&&(e.verbatimLatex=this.verbatimLatex),this.subsupPlacement&&(e.subsupPlacement=this.subsupPlacement),this.explicitSubsupPlacement&&(e.explicitSubsupPlacement=!0),this.isFunction&&(e.isFunction=!0),this.displayContainsHighlight&&(e.displayContainsHighlight=!0),this.skipBoundary&&(e.skipBoundary=!0),this.captureSelection&&(e.captureSelection=!0),this.args&&(e.args=_C(this.args)),this._branches)for(let n of Object.keys(this._branches))this._branches[n]&&(e[n]=this._branches[n].filter(r=>r.type!=="first").map(r=>r.toJson()));return e.type==="mord"&&Object.keys(e).length===2&&"value"in e?e.value:(this._json=e,e)}get changeCounter(){return this.parent?this.parent.changeCounter:this._changeCounter}set isDirty(e){e&&(this._json=void 0,this.parent||this._changeCounter++,"verbatimLatex"in this&&(this.verbatimLatex=void 0),this._children=void 0,this.parent&&(this.parent.isDirty=!0))}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);return n!=null&&n.serialize?n.serialize(this,e):this.body&&this.command?Fe([ut(this.command,this.bodyToLatex(e)),this.supsubToLatex(e)]):this.body?Fe([this.bodyToLatex(e),this.supsubToLatex(e)]):!this.value||this.value===""?"":this.command}bodyToLatex(e){var n;let r=(n=e.defaultMode)!=null?n:this.mode==="math"?"math":"text";return In.serialize(this.body,V(O({},e),{defaultMode:r}))}aboveToLatex(e){return In.serialize(this.above,e)}belowToLatex(e){return In.serialize(this.below,e)}supsubToLatex(e){let n="";if(e=V(O({},e),{defaultMode:"math"}),this.branch("subscript")!==void 0){let r=In.serialize(this.subscript,e);r.length===0?n+="_{}":r.length===1?/^[0-9]$/.test(r)?n+=`_${r}`:n+=`_{${r}}`:n+=`_{${r}}`}if(this.branch("superscript")!==void 0){let r=In.serialize(this.superscript,e);r.length===0?n+="^{}":r.length===1?r===""?n+="^\\prime ":r===""?n+="^\\doubleprime ":/^[0-9]$/.test(r)?n+=`^${r}`:n+=`^{${r}}`:n+=`^{${r}}`}return n}get treeDepth(){let e=1,n=this.parent;for(;n;)n=n.parent,e+=1;return e}get inCaptureSelection(){let e=this;for(;e;){if(e.captureSelection)return!0;e=e.parent}return!1}get parentPrompt(){let e=this.parent;for(;e;){if(e.type==="prompt"&&!e.captureSelection)return e;e=e.parent}return null}branch(e){if(bo(e)&&this._branches)return this._branches[e]}get branches(){if(!this._branches)return[];let e=[];for(let n of Zs)this._branches[n]&&e.push(n);return e}createBranch(e){return bo(e),bo(e)?(this._branches?this._branches[e]||(this._branches[e]=[this.makeFirstAtom(e)]):this._branches={[e]:[this.makeFirstAtom(e)]},this.isDirty=!0,this._branches[e]):[]}get row(){return Yr(this.parentBranch)?this.parentBranch[0]:-1}get col(){return Yr(this.parentBranch)?this.parentBranch[1]:-1}get body(){var e;return(e=this._branches)==null?void 0:e.body}set body(e){this.setChildren(e,"body")}get superscript(){var e;return(e=this._branches)==null?void 0:e.superscript}set superscript(e){this.setChildren(e,"superscript")}get subscript(){var e;return(e=this._branches)==null?void 0:e.subscript}set subscript(e){this.setChildren(e,"subscript")}get above(){var e;return(e=this._branches)==null?void 0:e.above}set above(e){this.setChildren(e,"above")}get below(){var e;return(e=this._branches)==null?void 0:e.below}set below(e){this.setChildren(e,"below")}applyStyle(e,n){this.isDirty=!0,n!=null&&n.unstyledOnly?(e.color&&!this.style.color&&(this.style.color=e.color),e.backgroundColor&&!this.style.backgroundColor&&(this.style.backgroundColor=e.backgroundColor),e.fontFamily&&!this.style.fontFamily&&(this.style.fontFamily=e.fontFamily),e.fontShape&&!this.style.fontShape&&(this.style.fontShape=e.fontShape),e.fontSeries&&!this.style.fontSeries&&(this.style.fontSeries=e.fontSeries),e.fontSize&&!this.style.fontSize&&(this.style.fontSize=e.fontSize),e.variant&&!this.style.variant&&(this.style.variant=e.variant),e.variantStyle&&!this.style.variantStyle&&(this.style.variantStyle=e.variantStyle)):this.style=O(O({},this.style),e),this.style.fontFamily==="none"&&delete this.style.fontFamily,this.style.fontShape==="auto"&&delete this.style.fontShape,this.style.fontSeries==="auto"&&delete this.style.fontSeries,this.style.color==="none"&&(delete this.style.color,delete this.style.verbatimColor),this.style.backgroundColor==="none"&&(delete this.style.backgroundColor,delete this.style.verbatimBackgroundColor),this.style.fontSize==="auto"&&delete this.style.fontSize;for(let r of this.children)r.applyStyle(e,n)}getInitialBaseElement(){var e,n,r;return this.hasEmptyBranch("body")?this:((e=this.body)==null||e[0].type,(r=(n=this.body[1])==null?void 0:n.getInitialBaseElement())!=null?r:this)}getFinalBaseElement(){return this.hasEmptyBranch("body")?this:this.body[this.body.length-1].getFinalBaseElement()}isCharacterBox(){return this.type==="leftright"||this.type==="genfrac"||this.type==="subsup"||this.type==="delim"||this.type==="array"||this.type==="surd"?!1:this.getFinalBaseElement().type==="mord"}hasEmptyBranch(e){let n=this.branch(e);return n?(n.length>0,n[0].type,n.length===1):!0}setChildren(e,n){var r;if(!e||(bo(n),!bo(n)))return;let i=((r=e[0])==null?void 0:r.type)==="first"?[...e]:[this.makeFirstAtom(n),...e];this._branches?this._branches[n]=i:this._branches={[n]:i};for(let o of e)o.parent=this,o.parentBranch=n;this.isDirty=!0}makeFirstAtom(e){let n=new Rr({type:"first",mode:this.mode});return n.parent=this,n.parentBranch=e,n}addChild(e,n){e.type,this.createBranch(n).push(e),this.isDirty=!0,e.parent=this,e.parentBranch=n}addChildBefore(e,n){n.parentBranch;let r=this.createBranch(n.parentBranch);r.splice(r.indexOf(n),0,e),this.isDirty=!0,e.parent=this,e.parentBranch=n.parentBranch}addChildAfter(e,n){n.parentBranch;let r=this.createBranch(n.parentBranch);r.splice(r.indexOf(n)+1,0,e),this.isDirty=!0,e.parent=this,e.parentBranch=n.parentBranch}addChildren(e,n){let r=this.createBranch(n);for(let i of e)i.parent=this,i.parentBranch=n,r.push(i);this.isDirty=!0}addChildrenAfter(e,n){e.length===0||e[0].type,n.parentBranch;let r=this.createBranch(n.parentBranch);r.splice(r.indexOf(n)+1,0,...e),this.isDirty=!0;for(let i of e)i.parent=this,i.parentBranch=n.parentBranch;return e[e.length-1]}removeBranch(e){let n=this.branch(e);if(bo(e)&&(this._branches[e]=void 0),!n)return[];for(let o of n)o.parent=void 0,o.parentBranch=void 0;n[0].type;let[r,...i]=n;return this.isDirty=!0,i}removeChild(e){if(e.parent,e.type==="first")return;let n=this.branch(e.parentBranch),r=n.indexOf(e);n.splice(r,1),this.isDirty=!0,e.parent=void 0,e.parentBranch=void 0}get siblings(){return this.parent?this.parent.branch(this.parentBranch):[]}get firstSibling(){return this.siblings[0]}get lastSibling(){let{siblings:e}=this;return e[e.length-1]}get isFirstSibling(){return this===this.firstSibling}get isLastSibling(){return this===this.lastSibling}get hasNoSiblings(){return this.siblings.length===1}get leftSibling(){this.parent;let e=this.parent.branch(this.parentBranch);return e[e.indexOf(this)-1]}get rightSibling(){this.parent;let e=this.parent.branch(this.parentBranch);return e[e.indexOf(this)+1]}get hasChildren(){return!!(this._branches&&this.children.length>0)}get firstChild(){return this.hasChildren,this.children[0]}get lastChild(){this.hasChildren;let{children:e}=this;return e[e.length-1]}get children(){if(this._children)return this._children;if(!this._branches)return[];let e=[];for(let n of Zs)if(this._branches[n])for(let r of this._branches[n])e.push(...r.children),e.push(r);return this._children=e,e}render(e){if(this.type==="first"&&!e.atomIdsSettings)return null;let n=Vt(this.command,this.mode);if(n!=null&&n.render)return n.render(this,e);let r=new Ye({parent:e},this.style),i=this.createBox(r,{classes:this.parent?"":"ML__base"});return i?(!this.subsupPlacement&&(this.superscript||this.subscript)&&(i=this.attachSupsub(r,{base:i})),i.wrap(r)):null}attachSupsub(e,n){var r;let i=n.base,o=this.superscript,s=this.subscript;if(!o&&!s)return i;let a=null,l=null,u=(r=n.isCharacterBox)!=null?r:this.isCharacterBox(),c=0;if(o){let x=new Ye({parent:e,mathstyle:"superscript"});a=Rr.createBox(x,o),u||(c=i.height-e.metrics.supDrop*x.scalingFactor)}let d=0;if(s){let x=new Ye({parent:e,mathstyle:"subscript"});l=Rr.createBox(x,s),u||(d=i.depth+e.metrics.subDrop*x.scalingFactor)}let p;e.isDisplayStyle?p=e.metrics.sup1:e.isCramped?p=e.metrics.sup3:p=e.metrics.sup2;let f=.5/Ys/e.scalingFactor,g=null;if(l&&a){c=Math.max(c,p,a.depth+.25*e.metrics.xHeight),d=Math.max(d,e.metrics.sub2);let x=e.metrics.defaultRuleThickness;if(c-a.depth-(l.height-d)<4*x){d=4*x-(c-a.depth)+l.height;let k=.8*e.metrics.xHeight-(c-a.depth);k>0&&(c+=k,d-=k)}let w=this.type==="extensible-symbol"&&i.italic?-i.italic:0;g=new It({individualShift:[{box:l,shift:d,marginLeft:w},{box:a,shift:-c}]})}else l&&!a?(d=Math.max(d,e.metrics.sub1,l.height-.8*Jr),g=new It({shift:d,children:[{box:l,marginRight:f,marginLeft:this.isCharacterBox()?-i.italic:0}]})):!l&&a&&(c=Math.max(c,p,a.depth+.25*Jr),g=new It({shift:-c,children:[{box:a,marginRight:f}]}));return new oe([i,new oe(g,{caret:this.caret,isSelected:this.isSelected,classes:"ML__msubsup"})],{type:n.type})}attachLimits(e,n){let r=this.superscript?Rr.createBox(new Ye({parent:e,mathstyle:"superscript"},this.style),this.superscript):null,i=this.subscript?Rr.createBox(new Ye({parent:e,mathstyle:"subscript"},this.style),this.subscript):null;return!r&&!i?n.base.wrap(e):vC(e,V(O({},n),{above:r,below:i}))}bind(e,n){if(!n||e.isPhantom||this.value==="")return n;let r=this.parent;for(;r&&!r.captureSelection;)r=r.parent;return r!=null&&r.captureSelection||(this.id||(this.id=e.makeID()),n.atomID=this.id),n}createBox(e,n){var r,i,o,s;let a=(r=this.value)!=null?r:this.body,l=(i=n?.boxType)!=null?i:Bf(this.type),u=(o=n?.classes)!=null?o:"";this.mode==="text"&&(u+=" ML__text");let c=typeof a=="string"||a===void 0?new oe(a??null,{type:l,isSelected:this.isSelected,mode:this.mode,maxFontSize:e.scalingFactor,style:V(O({variant:"normal"},this.style),{fontSize:Math.max(1,e.size+e.mathstyle.sizeDelta)}),letterShapeStyle:e.letterShapeStyle,classes:u}):(s=Rr.createBox(e,a,{type:l,classes:u}))!=null?s:new oe(null);return e.isTight&&(c.isTight=!0),(this.mode!=="math"||this.style.variant==="main")&&(c.italic=0),c.right=c.italic,this.bind(e,c),this.caret&&!this.superscript&&!this.subscript&&(c.caret=this.caret),c}isDigit(){var e;return this.type==="mord"&&this.value?/^[\d,\.]$/.test(this.value):this.type==="group"&&((e=this.body)==null?void 0:e.length)===2?this.body[0].type==="first"&&this.body[1].value===",":!1}asDigit(){var e;return this.type==="mord"&&this.value&&/^[\d,\.]$/.test(this.value)?this.value:this.type==="group"&&((e=this.body)==null?void 0:e.length)===2&&this.body[0].type==="first"&&this.body[1].value===","?".":""}};function kC(t){let e,n=[],r=[];for(let i of t)if(i.type==="first"&&r.push(i),!e&&!i.style)r.push(i);else{let o=i.style;e&&o.color===e.color&&o.backgroundColor===e.backgroundColor&&o.fontSize===e.fontSize?r.push(i):(r.length>0&&n.push(r),r=[i],e=o)}return r.length>0&&n.push(r),n}function SC(t,e,n){var r,i,o,s,a;if(!e||e.length===0)return null;let l=new Ye({parent:t},n.style),u=!((r=l.atomIdsSettings)!=null&&r.groupNumbers),c=[];if(e.length===1){let p=e[0],f=p.render(l);f&&(u&&p.isSelected&&f.selected(!0),c=[f])}else{let p="",f=!0;for(let g of e){(i=l.atomIdsSettings)!=null&&i.groupNumbers&&p&&(f&&g.isDigit()||!f&&kp(g))&&(l.atomIdsSettings.overrideID=p);let x=g.render(l);l.atomIdsSettings&&(l.atomIdsSettings.overrideID=void 0),x&&((o=l.atomIdsSettings)!=null&&o.groupNumbers&&((g.isDigit()||kp(g))&&(!p||f!==g.isDigit())&&(f=g.isDigit(),p=(s=g.id)!=null?s:""),p&&(!(g.isDigit()||kp(g))||!g.hasEmptyBranch("superscript")||!g.hasEmptyBranch("subscript"))&&(p="")),u&&g.isSelected&&x.selected(!0),c.push(x))}}if(c.length===0)return null;let d=new oe(c,V(O({isTight:l.isTight},n),{type:(a=n.type)!=null?a:"lift"}));return d.isSelected=c.every(p=>p.isSelected),d.wrap(l)}function kp(t){return t.mode==="text"}function _C(t){return t.map(e=>e===null?"<null>":Array.isArray(e)&&e[0]instanceof G?{atoms:e.map(n=>n.toJson())}:typeof e=="object"&&"group"in e?{group:e.group.map(n=>n.toJson())}:e)}var na=class fx extends G{constructor(e,n,r){super({type:"text",command:e,mode:"text",displayContainsHighlight:!0}),this.value=n,this.verbatimLatex=n,this.applyStyle(r)}static fromJson(e){return new fx(e.command,e.value,e.style)}render(e){let n=this.createBox(e);return this.caret&&(n.caret=this.caret),n}_serialize(e){var n;return(n=this.verbatimLatex)!=null?n:ix("text",this.value.codePointAt(0))}};function MC(t,e){if(t.direction===e.direction){let n=t.ranges.length;if(e.ranges.length===n){let r=0;for(;r<n&&CC(t.ranges[r],e.ranges[r])==="equal";)r++;return r===n?"equal":"different"}}return"different"}function CC(t,e){return t[0]===e[0]&&t[1]===e[1]?"equal":"different"}function en(t){let e=1/0,n=-1/0;for(let r of t.ranges)e=Math.min(e,r[0],r[1]),n=Math.max(n,r[0],r[1]);return[e,n]}function Li(t){return typeof t=="number"&&!Number.isNaN(t)}function gd(t){return Array.isArray(t)&&t.length===2}function uc(t){return t!=null&&typeof t=="object"&&"ranges"in t&&Array.isArray(t.ranges)}function EC(t,e){let n=t.at(e),r;if(n){r=n.mode;let i=n.parent;for(;!r&&i;)i&&(r=i.mode),i=i.parent}return r}function AC(t,e){if(!e)return"";if(typeof e=="string")return e;if(!t||e.after===void 0)return e.value;let n=!1,r=!1,i=!1,o=!1,s=!1,a=!1,l=!1,u=!1,c=!1,d=!1,p=!1,f=!1,g=!1,x=!1,w=!1,k=t[0],D=0;for(;k!=null&&k.type&&/^(subsup|placeholder)$/.test(k.type);)D+=1,k=t[D];return n=!k||k.type==="first",k&&(x=k.mode==="text",r=!x&&k.type==="mord"&&Mf.test(k.value),i=!x&&k.type==="mord"&&/\d+$/.test(k.value),o=!x&&k.isFunction,s=k.type==="genfrac",a=k.type==="surd",l=k.type==="mbin",u=k.type==="mrel",c=k.type==="mop"||k.type==="operator"||k.type==="extensible-symbol",d=k.type==="mpunct"||k.type==="minner",p=k.type==="array",f=k.type==="mopen",g=k.type==="mclose"||k.type==="leftright",w=k.type==="space"),e.after.includes("nothing")&&n||e.after.includes("letter")&&r||e.after.includes("digit")&&i||e.after.includes("function")&&o||e.after.includes("frac")&&s||e.after.includes("surd")&&a||e.after.includes("binop")&&l||e.after.includes("relop")&&u||e.after.includes("operator")&&c||e.after.includes("punct")&&d||e.after.includes("array")&&p||e.after.includes("openfence")&&f||e.after.includes("closefence")&&g||e.after.includes("text")&&x||e.after.includes("space")&&w?e.value:""}function e0(t,e,n){return n?AC(t,n[e]):""}var mx={"&":"\\&","%":"\\%",$:"\\$","''":"^{\\doubleprime}","'''":"^{\\prime\\prime\\prime}","''''":"^{\\prime\\prime\\prime\\prime}",alpha:"\\alpha",delta:"\\delta",Delta:"\\Delta",pi:"\\pi",Pi:"\\Pi",theta:"\\theta",Theta:"\\Theta",ii:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryI"},jj:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\imaginaryJ"},ee:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\exponentialE"},nabla:"\\nabla",grad:"\\nabla",del:"\\partial",deg:{after:"digit+space",value:"\\degree"},infty:"\\infty","":"\\infty",oo:{after:"nothing+digit+frac+surd+binop+relop+punct+array+openfence+closefence+space",value:"\\infty"},"":"\\sum",sum:"\\sum_{#?}^{#?}",int:"\\int_{#?}^{#?}",prod:"\\prod_{#?}^{#?}",sqrt:"\\sqrt{#?}","":"\\differentialD","":"\\differentialD",sin:"\\sin",cos:"\\cos",tan:"\\tan",arccos:"\\arccos",arcsin:"\\arcsin",arctan:"\\arctan",arctg:"\\operatorname{arctg}",arcsec:"\\operatorname{arcsec}",arccsc:"\\operatorname{arccsc}",arsinh:"\\operatorname{arsinh}",arccosh:"\\operatorname{arccosh}",arcosh:"\\operatorname{arcosh}",artanh:"\\operatorname{artanh}",arctanh:"\\operatorname{arctanh}",arcsech:"\\operatorname{arcsech}",arccsch:"\\operatorname{arccsch}",ch:"\\operatorname{ch}",cosec:"\\operatorname{cosec}",cosh:"\\cosh",cot:"\\cot",cotg:"\\operatorname{cotg}",coth:"\\coth",csc:"\\csc",ctg:"\\operatorname{ctg}",cth:"\\operatorname{cth}",sec:"\\sec",sech:"\\operatorname{sech}",sinh:"\\sinh",sh:"\\operatorname{sh}",tanh:"\\tanh",tg:"\\operatorname{tg}",th:"\\operatorname{th}",arg:"\\arg",lg:"\\lg",lb:"\\operatorname{lb}",log:"\\log_{#?}",ln:"\\ln",exp:"\\exp",lim:"\\lim_{#?\\to#?}",dx:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\differentialD x"},dy:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\differentialD y"},dt:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\differentialD t"},AA:"\\forall",EE:"\\exists","!EE":"\\nexists","&&":"\\land",xin:{after:"nothing+text+relop+punct+openfence+space",value:"x \\in"},sint:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\sin t"},in:{after:"nothing+letter+closefence",value:"\\in"},"!in":"\\notin",NN:"\\mathbb{N}",ZZ:"\\mathbb{Z}",QQ:"\\mathbb{Q}",RR:"\\mathbb{R}",CC:"\\mathbb{C}",xx:"\\times","+-":"\\pm","":"\\ne","!=":"\\ne","":"\\ge",">=":"\\ge","":"\\le","<=":"\\le","<<":"\\ll",">>":"\\gg","~~":"\\approx","":"\\approx","?=":"\\questeq","":"\\div","":"\\neg",":=":"\\coloneq","::":"\\Colon","(:":"\\langle",":)":"\\rangle",beta:"\\beta",chi:"\\chi",epsilon:"\\epsilon",varepsilon:"\\varepsilon",eta:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\eta"},gamma:"\\gamma",Gamma:"\\Gamma",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",Lambda:"\\Lambda",mu:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\mu"},nu:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\nu"},:"\\mu",phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\phi"},Phi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Phi"},varphi:"\\varphi",psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\psi"},Psi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Psi"},rho:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\rho"},sigma:"\\sigma",Sigma:"\\Sigma",tau:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\tau"},vartheta:"\\vartheta",upsilon:"\\upsilon",xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space",value:"\\xi"},Xi:{after:"nothing+digit+function+frac+surd+binop+relop+punct+array+openfence+closefence+space+text",value:"\\Xi"},zeta:"\\zeta",omega:"\\omega",Omega:"\\Omega",:"\\omega",forall:"\\forall",exists:"\\exists","!exists":"\\nexists",":.":"\\therefore",liminf:"\\liminf_{#?}",limsup:"\\limsup_{#?}",argmin:"\\operatorname*{arg~min}_{#?}",argmax:"\\operatorname*{arg~max}_{#?}",det:"\\det",mod:"\\bmod{#?}","(mod":"\\pmod{#?}",max:"\\max",min:"\\min",erf:"\\operatorname{erf}",erfc:"\\operatorname{erfc}",bessel:"\\operatorname{bessel}",mean:"\\operatorname{mean}",median:"\\operatorname{median}",fft:"\\operatorname{fft}",lcm:"\\operatorname{lcm}",gcd:"\\gcd",randomReal:"\\operatorname{randomReal}",randomInteger:"\\operatorname{randomInteger}",Re:"\\operatorname{Re}",Im:"\\operatorname{Im}",mm:{after:"nothing+digit+operator",value:"\\operatorname{mm}"},cm:{after:"nothing+digit+operator",value:"\\operatorname{cm}"},km:{after:"nothing+digit+operator",value:"\\operatorname{km}"},kg:{after:"nothing+digit+operator",value:"\\operatorname{kg}"},ft:{after:"nothing+digit+operator",value:"\\operatorname{ft}"},inch:{after:"nothing+digit+operator",value:"\\operatorname{inch}"},mi:{after:"nothing+digit+operator",value:"\\operatorname{mi}"},"...":"\\ldots","+...":"+\\cdots","-...":"-\\cdots","->...":"\\to\\cdots","-->...":"\\longrightarrow\\cdots","->":"\\to","|->":"\\mapsto","-->":"\\longrightarrow","<--":"\\longleftarrow","=>":"\\Rightarrow","==>":"\\Longrightarrow","<=>":"\\iff","<->":"\\leftrightarrow","(.)":"\\odot","(+)":"\\oplus","(/)":"\\oslash","(*)":"\\otimes","(-)":"\\ominus","||":"\\Vert","*":"\\cdot","**":"\\star","***":"\\ast","//":"\\slash","\\\\":"\\backslash",setminus:"\\backslash","|><":"\\ltimes","><|":"\\rtimes","|><|":"\\bowtie","-:":"\\div",divide:"\\div","@":"\\circ","^^":"\\wedge","^^^":"\\bigwedge",vv:"\\vee",vvv:"\\bigvee",nn:"\\cap",nnn:"\\bigcap",uu:"\\cup",uuu:"\\bigcup","-=":"\\equiv","~=":"\\cong",lt:"<","lt=":"\\leq",gt:">","gt=":"\\geq","-<":"\\prec","-lt":"\\prec","-<=":"\\preceq",">-=":"\\succeq",prop:"\\propto",diamond:"\\diamond",square:"\\square",iff:"\\iff",sub:"\\subset",sup:"\\supset",sube:"\\subseteq",supe:"\\supseteq",uarr:"\\uparrow",darr:"\\downarrow",rarr:"\\rightarrow",rArr:"\\Rightarrow",larr:"\\leftarrow",lArr:"\\Leftarrow",harr:"\\leftrightarrow",hArr:"\\Leftrightarrow",aleph:"\\aleph",and:"\\land",or:"\\lor",not:"\\neg","_|_":"\\bot",TT:"\\top","|--":"\\vdash","|==":"\\models","|__":"\\lfloor","__|":"\\rfloor","|~":"\\lceil","~|":"\\rceil",">->":"\\rightarrowtail","->>":"\\twoheadrightarrow",">->>":"\\twoheadrightarrowtail",times:"\\times",of:"\\circ",infinity:"\\infty",defint:"\\int_{#?}^{#?}",approaches:"\\to",ceil:"\\left\\lceil#?\\right\\rceil",floor:"\\left\\lfloor#?\\right\\rfloor",union:"\\cup",asterisk:"\\ast",frac:"\\frac{#?}{#?}",cbrt:"\\sqrt[3]{#?}",nthroot:"\\sqrt[#?]{#?}"};function yd(t,e){var n;let r=(n=e?.format)!=null?n:"auto";return r==="auto"&&([r,t]=DC(t)),r==="ascii-math"?(t=t.replace(/\u2061/gu,""),t=t.replace(/\u3016/gu,"{"),t=t.replace(/\u3017/gu,"}"),t=t.replace(/([^\\])sinx/g,"$1\\sin x"),t=t.replace(/([^\\])cosx/g,"$1\\cos x "),t=t.replace(/\u2013/g,"-"),["ascii-math",Mn(t,{inlineShortcuts:e?.inlineShortcuts})]):["latex",t]}function Mn(t,e){var n;if(t=t.trim(),!t)return"";let r=(n=e.inlineShortcuts)!=null?n:mx;if(t.startsWith("^")||t.startsWith("_")){let{match:a,rest:l}=ho(t.slice(1),{inlineShortcuts:r,noWrap:!0});return`${t[0]}{${a}}${Mn(l,e)}`}let i=t.match(/^(sqrt|\u221A)(.*)/);if(i){let{match:a,rest:l}=ho(i[2],{inlineShortcuts:r,noWrap:!0});return`\\sqrt{${a??"\\placeholder{}"}}${Mn(l,e)}`}if(i=t.match(/^(\\cbrt|\u221B)(.*)/),i){let{match:a,rest:l}=ho(i[2],{inlineShortcuts:r,noWrap:!0});return`\\sqrt[3]{${a??"\\placeholder{}"}}${Mn(l,e)}`}if(i=t.match(/^abs(.*)/),i){let{match:a,rest:l}=ho(i[1],{inlineShortcuts:r,noWrap:!0});return`\\left|${a??"\\placeholder{}"}\\right|${Mn(l,e)}`}if(i=t.match(/^["](.*?)["](.*)/),i)return`\\text{${i[1]}}${Mn(i[2],e)}`;if(i=t.match(/^([^a-zA-Z0-9\(\{\[\_\^\\\s"]+)(.*)/),i)return`${Zb(i[1],r)}${Mn(i[2],e)}`;if(/^([fgh])[^a-zA-Z]/.test(t)){let{rest:a,match:l}=ho(t.slice(1),{inlineShortcuts:r,noWrap:!0}),u="";return t[1]==="("?u=`${t[0]}\\left(${l}\\right)`:u=t[0]+l,u+Mn(a,e)}if(i=t.match(/^([a-zA-Z]+)(.*)/),i)return Zb(i[1],r)+Mn(i[2],e);let{match:o,rest:s}=ho(t,{inlineShortcuts:r,noWrap:!0});if(o&&s[0]==="/"){let a=ho(s.slice(1),{inlineShortcuts:r,noWrap:!0});if(a.match)return`\\frac{${o}}{${a.match}}${Mn(a.rest,e)}`}else return t.startsWith("(")?"\\left("+o+"\\right)"+Mn(s,e):o+Mn(s,e);return i=t.match(/^(\s+)(.*)$/),i?" "+Mn(i[2],e):t}var Yb={"[":"\\lbrack","]":"\\rbrack","{":"\\lbrace","}":"\\rbrace"};function ho(t,e){var n,r;let i="";t=t.trim();let o=t,s=t.charAt(0),a={"(":")","{":"}","[":"]"}[s];if(a){let l=1,u=1;for(;u<t.length&&l>0;)t[u]===s&&l++,t[u]===a&&l--,u++;if(l===0){let c=Mn(t.substring(1,u-1),e);e.noWrap&&s==="("?i=c:i=`\\left${(n=Yb[s])!=null?n:s}${c}\\right${(r=Yb[a])!=null?r:a}`,o=t.slice(Math.max(0,u))}else i=t.substring(1,u),o=""}else{let l=t.match(/^([a-zA-Z]+)/);if(l){let u=e0(null,t,e.inlineShortcuts);if(u)return u=u.replace("_{#?}",""),u=u.replace("^{#?}",""),{match:u,rest:t.slice(u.length)}}if(l=t.match(/^([a-zA-Z])/),l)return{match:l[1],rest:t.slice(1)};if(l=t.match(/^(-)?\d+(\.\d*)?/),l)return{match:l[0],rest:t.slice(l[0].length)};/^\\(left|right)/.test(t)||(l=t.match(/^(\\[a-zA-Z]+)/),l&&(o=t.slice(l[1].length),i=l[1]))}return{match:i,rest:o}}function Zb(t,e){let n=e0(null,t,e);return n?(n=n.replace("_{#?}",""),n=n.replace("^{#?}",""),n+=" "):n=t,n}var gx=[["\\[","\\]"],["\\(","\\)"],["$$","$$"],["$","$"],["\\begin{math}","\\end{math}"],["\\begin{displaymath}","\\end{displaymath}"],["\\begin{equation}","\\end{equation}"],["\\begin{equation*}","\\end{equation*}"]];function t0(t){let e=t.trim();for(let n of gx)if(e.startsWith(n[0])&&e.endsWith(n[1]))return[!0,e.substring(n[0].length,e.length-n[1].length)];return[!1,t]}function DC(t){if(t=t.trim(),t.length<=1)return["latex",t];let e;return[e,t]=t0(t),e?["latex",t]:t.startsWith("`")&&t.endsWith("`")?(t=t.substring(1,t.length-1),["ascii-math",t]):t.includes("\\")?["latex",t]:/\$.+\$/.test(t)?["latex",`\\text{${t}}`]:[void 0,t]}var LC="$$",TC="$$",BC=(t,e,n)=>(gx.some(r=>e.startsWith(r[0])&&e.endsWith(r[1]))||(e=`${LC} ${e} ${TC}`),e),yx=class cc{constructor(e){cc._modes[e]=this}static onPaste(e,n,r){var i;if(!n.contentEditable&&n.userSelect==="none")return n.model.announce("plonk"),!1;if(typeof r=="string"){let s=new DataTransfer;s.setData("text/plain",r),r=s}let o=new ClipboardEvent("paste",{clipboardData:r,cancelable:!0});return(i=n.host)!=null&&i.dispatchEvent(o)?cc._modes[e].onPaste(n,r):!1}static copyToClipboard(e,n){if(!e.contentEditable&&e.userSelect==="none"){e.model.announce("plonk");return}let r=e.model,i=r.selectionIsCollapsed?[0,r.lastOffset]:en(r.selection),o=r.getValue(i,n);navigator.clipboard.writeText(o).then(()=>{},()=>e.model.announce("plonk"))}static onCopy(e,n){var r;if(!n.clipboardData)return;if(!e.contentEditable&&e.userSelect==="none"){e.model.announce("plonk");return}let i=e.model,o=i.selectionIsCollapsed?[0,i.lastOffset]:en(i.selection),s=i.getAtoms(o);if(s.every(a=>a.mode==="text"||!a.mode))n.clipboardData.setData("text/plain",s.filter(a=>a instanceof na).map(a=>a.value).join(""));else if(s.every(a=>a.mode==="latex"))n.clipboardData.setData("text/plain",i.getAtoms(o,{includeChildren:!0}).map(a=>{var l;return(l=a.value)!=null?l:""}).join(""));else{let a;s.length===1&&s[0].verbatimLatex!==void 0?a=s[0].verbatimLatex:a=i.getValue(o,"latex-expanded"),n.clipboardData.setData("application/x-latex",a);try{n.clipboardData.setData("text/plain",e.options.onExport(e,a,o))}catch{}if(s.length===1){let l=s[0];(l.type==="root"||l.type==="group")&&(s=l.body.filter(u=>u.type!=="first"))}try{n.clipboardData.setData("application/json+mathlive",JSON.stringify(s.map(l=>l.toJson())))}catch{}if((r=window[Symbol.for("io.cortexjs.compute-engine")])!=null&&r.ComputeEngine){let l=globalThis.MathfieldElement.computeEngine;if(l)try{let u=l.jsonSerializationOptions;l.jsonSerializationOptions={metadata:["latex"]};let c=l.parse(i.getValue(o,"latex-unstyled"));l.jsonSerializationOptions=u;let d=JSON.stringify(c.json);d&&n.clipboardData.setData("application/json",d)}catch{}}}n.preventDefault()}static insert(e,n,r={}){var i;let o=r.mode==="auto"?e.mode:(i=r.mode)!=null?i:e.mode;return cc._modes[o].insert(e,n,r)}onPaste(e,n){return!1}insert(e,n,r){return!1}};yx._modes={};var lt=yx,OC=[{key:"left",command:"moveToPreviousChar"},{key:"right",command:"moveToNextChar"},{key:"up",command:"moveUp"},{key:"down",command:"moveDown"},{key:"shift+[ArrowLeft]",command:"extendSelectionBackward"},{key:"shift+[ArrowRight]",command:"extendSelectionForward"},{key:"shift+[ArrowUp]",command:"extendSelectionUpward"},{key:"shift+[ArrowDown]",command:"extendSelectionDownward"},{key:"[Backspace]",command:"deleteBackward"},{key:"[Delete]",command:"deleteForward"},{key:"shift+[Backspace]",command:"deleteForward"},{key:"alt+[Backspace]",command:"deletePreviousWord"},{key:"alt+[Delete]",command:"deleteNextWord"},{key:"ctrl+[Backspace]",command:"deleteToGroupStart"},{key:"ctrl+[Delete]",command:"deleteToGroupEnd"},{key:"ctrl+shift+[Backspace]",command:"deleteToGroupEnd"},{key:"alt+[ArrowLeft]",command:"moveToPreviousWord"},{key:"alt+[ArrowRight]",command:"moveToNextWord"},{key:"shift+alt+[ArrowLeft]",command:"extendToPreviousWord"},{key:"shift+alt+[ArrowRight]",command:"extendToNextWord"},{key:"ctrl+[ArrowLeft]",command:"moveToGroupStart"},{key:"ctrl+[ArrowRight]",command:"moveToGroupEnd"},{key:"shift+ctrl+[ArrowLeft]",command:"extendToGroupStart"},{key:"shift+ctrl+[ArrowRight]",command:"extendToGroupEnd"},{key:"[Home]",command:"moveToMathfieldStart"},{key:"cmd+[ArrowLeft]",command:"moveToMathfieldStart"},{key:"shift+[Home]",command:"extendToMathFieldStart"},{key:"shift+cmd+[ArrowLeft]",command:"extendToMathFieldStart"},{key:"[End]",command:"moveToMathfieldEnd"},{key:"cmd+[ArrowRight]",command:"moveToMathfieldEnd"},{key:"shift+[End]",command:"extendToMathFieldEnd"},{key:"shift+cmd+[ArrowRight]",command:"extendToMathFieldEnd"},{key:"[Pageup]",command:"moveToGroupStart"},{key:"[Pagedown]",command:"moveToGroupEnd"},{key:"[Tab]",command:"moveToNextGroup"},{key:"shift+[Tab]",command:"moveToPreviousGroup"},{key:"[Escape]",ifMode:"math",command:["switchMode","latex"]},{key:"[Escape]",ifMode:"text",command:["switchMode","latex"]},{key:"[Escape]",ifMode:"latex",command:["complete","complete",{selectItem:"true"}]},{key:"\\",ifMode:"math",command:["switchMode","latex","","\\"]},{key:"[IntlBackslash]",ifMode:"math",command:["switchMode","latex","","\\"]},{key:"[Tab]",ifMode:"latex",command:["complete","accept-suggestion"]},{key:"[Return]",ifMode:"latex",command:["complete","accept-all"]},{key:"[Enter]",ifMode:"latex",command:["complete","accept-all"]},{key:"shift+[Escape]",ifMode:"latex",command:["complete","reject"]},{key:"[ArrowDown]",ifMode:"latex",command:"nextSuggestion"},{key:"[ArrowUp]",ifMode:"latex",command:"previousSuggestion"},{key:"ctrl+a",ifPlatform:"!macos",command:"selectAll"},{key:"cmd+a",command:"selectAll"},{key:"[Cut]",command:"cutToClipboard"},{key:"[Copy]",command:"copyToClipboard"},{key:"[Paste]",command:"pasteFromClipboard"},{key:"[Clear]",command:"deleteBackward"},{key:"[Undo]",command:"undo"},{key:"[Redo]",command:"redo"},{key:"[EraseEof]",command:"deleteToGroupEnd"},{key:"ctrl+x",ifPlatform:"ios",command:"cutToClipboard"},{key:"cmd+x",ifPlatform:"ios",command:"cutToClipboard"},{key:"ctrl+c",ifPlatform:"ios",command:"copyToClipboard"},{key:"cmd+c",ifPlatform:"ios",command:"copyToClipboard"},{key:"ctrl+v",ifPlatform:"ios",command:"pasteFromClipboard"},{key:"cmd+v",ifPlatform:"ios",command:"pasteFromClipboard"},{key:"ctrl+z",ifPlatform:"!macos",command:"undo"},{key:"cmd+z",command:"undo"},{key:"ctrl+y",ifPlatform:"!macos",command:"redo"},{key:"shift+cmd+y",command:"redo"},{key:"shift+ctrl+z",ifPlatform:"!macos",command:"redo"},{key:"shift+cmd+z",command:"redo"},{key:"ctrl+b",ifPlatform:"macos",command:"moveToPreviousChar"},{key:"ctrl+f",ifPlatform:"macos",command:"moveToNextChar"},{key:"ctrl+p",ifPlatform:"macos",command:"moveUp"},{key:"ctrl+n",ifPlatform:"macos",command:"moveDown"},{key:"ctrl+a",ifPlatform:"macos",command:"moveToMathfieldStart"},{key:"ctrl+e",ifPlatform:"macos",command:"moveToMathfieldEnd"},{key:"shift+ctrl+b",ifPlatform:"macos",command:"extendSelectionBackward"},{key:"shift+ctrl+f",ifPlatform:"macos",command:"extendSelectionForward"},{key:"shift+ctrl+p",ifPlatform:"macos",command:"extendSelectionUpward"},{key:"shift+ctrl+n",ifPlatform:"macos",command:"extendSelectionDownward"},{key:"shift+ctrl+a",ifPlatform:"macos",command:"extendToMathFieldStart"},{key:"shift+ctrl+e",ifPlatform:"macos",command:"extendToMathFieldEnd"},{key:"alt+ctrl+b",ifPlatform:"macos",command:"moveToPreviousWord"},{key:"alt+ctrl+f",ifPlatform:"macos",command:"moveToNextWord"},{key:"shift+alt+ctrl+b",ifPlatform:"macos",command:"extendToPreviousWord"},{key:"shift+alt+ctrl+f",ifPlatform:"macos",command:"extendToNextWord"},{key:"ctrl+h",ifPlatform:"macos",command:"deleteBackward"},{key:"ctrl+d",ifPlatform:"macos",command:"deleteForward"},{key:"ctrl+l",ifPlatform:"macos",command:"scrollIntoView"},{key:"ctrl+[Digit2]",ifMode:"math",command:["insert","\\sqrt{#0}"]},{key:"ctrl+[Digit5]",ifMode:"math",command:"moveToOpposite"},{key:"ctrl+[Digit6]",ifMode:"math",command:"moveToSuperscript"},{key:"ctrl+[Return]",ifMode:"math",command:"addRowAfter"},{key:"ctrl+[Enter]",ifMode:"math",command:"addRowAfter"},{key:"cmd+[Return]",ifMode:"math",command:"addRowAfter"},{key:"cmd+[Enter]",ifMode:"math",command:"addRowAfter"},{key:"alt+p",ifMode:"math",command:["insert","\\pi"]},{key:"alt+v",ifMode:"math",command:["insert","\\sqrt{#0}"]},{key:"alt+shift+v",ifMode:"math",command:["insert","\\sqrt[#0]{#1}"]},{key:"alt+o",ifMode:"math",command:["insert","\\emptyset"]},{key:"alt+d",ifMode:"math",command:["insert","\\differentialD"]},{key:"shift+alt+o",ifMode:"math",command:["insert","\\varnothing"]},{key:"shift+alt+d",ifMode:"math",command:["insert","\\partial"]},{key:"alt+[Backslash]",ifMode:"math",command:["insert","\\backslash"]},{key:"[NumpadDivide]",ifMode:"math",command:["insert","\\frac{#@}{#?}"]},{key:"alt+[NumpadDivide]",ifMode:"math",command:["insert","\\frac{#?}{#@}"]},{key:"shift+alt+k",command:"toggleKeystrokeCaption"},{key:"alt+[Space]",command:"toggleContextMenu"},{key:"alt+shift+[Space]",command:"toggleVirtualKeyboard"},{key:"alt+ctrl+[ArrowUp]",command:["speak","all",{withHighlighting:!1}]},{key:"alt+ctrl+[ArrowDown]",command:["speak","selection",{withHighlighting:!1}]},{key:"shift+[Quote]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["switchMode","text","",""]},{key:"shift+[Quote]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"text",command:["switchMode","math","",""]},{key:"shift+alt+[KeyT]",ifMode:"math",command:["switchMode","text"]},{key:"shift+alt+[KeyT]",ifMode:"text",command:["switchMode","math"]},{key:"/",ifMode:"math",command:["insert","\\frac{#@}{#?}"]},{key:"alt+/",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","/"]},{key:"alt+shift+/",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","/"]},{key:"alt+[BracketLeft]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","\\left\\lbrack #0 \\right\\rbrack"]},{key:"ctrl+[Minus]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:"moveToSubscript"},{key:"shift+alt+[BracketLeft]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","\\left\\lbrace #0 \\right\\rbrace"]},{key:"ctrl+;",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:"addRowAfter"},{key:"cmd+;",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:"addRowAfter"},{key:"shift+ctrl+;",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:"addRowBefore"},{key:"shift+cmd+;",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:"addRowBefore"},{key:"alt+[Tab]",ifMode:"math",command:"addColumnAfter"},{key:"shift+alt+[Tab]",ifMode:"math",command:"addColumnBefore"},{key:"alt+[Enter]",ifMode:"math",command:"addRowAfter"},{key:"shift+alt+[Enter]",ifMode:"math",command:"addRowBefore"},{key:"alt+[Return]",ifMode:"math",command:"addRowAfter"},{key:"shift+alt+[Return]",ifMode:"math",command:"addRowBefore"},{key:"shift+[Backspace]",ifMode:"math",command:"removeColumn"},{key:"shift+[Delete]",ifMode:"math",command:"removeRow"},{key:"shift+alt+[Backspace]",ifMode:"math",command:"removeRow"},{key:"alt+[Digit5]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","$\\infty"]},{key:"alt+[Digit9]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","("]},{key:"alt+[Digit0]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert",")"]},{key:"alt+|",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","|"]},{key:"shift+[Backquote]",ifLayout:["apple.en-intl","windows.en-intl","linux.en"],ifMode:"math",command:["insert","\\~"]},{key:"[Backquote]",ifLayout:["windows.french","linux.french"],ifMode:"math",command:["insert","^2"]},{key:"[Backquote]",ifLayout:["windows.german","linux.german"],ifMode:"math",command:["insert","^"]},{key:"[IntlBackslash]",ifLayout:["apple.german"],ifMode:"math",command:["insert","^"]}],NC={"\\sqrt":["alt+v","ctrl+[Digit2]"],"\\pi":"alt+p","\\infty":"alt+[Digit5]","\\differentialD":"alt+d","\\partial":"shift+alt+d","\\frac":"Slash","\\emptyset":"alt+o","\\varnothing":"shift+alt+o","\\~":"~"};function jr(t){var e;return((e=t.element)==null?void 0:e.mathfield)===t}function PC(t){var e,n;return(n=(e=t.querySelector(".ML__caret"))!=null?e:t.querySelector(".ML__text-caret"))!=null?n:t.querySelector(".ML__latex-caret")}function dc(t){let e=PC(t);if(!e)return null;let n=e.getBoundingClientRect();return{x:n.right,y:n.bottom,height:n.height}}function IC(t){var e;if(!t.parent)return"root";let n=(e=t.parent.id)!=null?e:"";return n+=typeof t.parentBranch=="string"?"-"+t.parentBranch:`-${t.parentBranch[0]}/${t.parentBranch[0]}`,n}function bx(t,e,n){if(!e)return null;let r=t.field.getBoundingClientRect(),i=e.right-e.left,o=e.bottom-e.top,s=Math.ceil(e.left-r.left+t.field.scrollLeft*n),a=Math.ceil(e.top-r.top);return{left:s,right:s+i,top:a,bottom:a+o}}function Nf(t){let e=t,n=e.getBoundingClientRect();for(;n.bottom===n.top&&e.parentElement instanceof Element&&(e=e.parentElement,n=e.getBoundingClientRect(),n.bottom===n.top););let r=getComputedStyle(e),i=parseInt(r.marginRight),o=n.right-n.left,s=n.bottom-n.top;if(o===0||!Number.isFinite(o)){let l=parseFloat(r.width);Number.isFinite(l)&&l>0?o=l:e instanceof HTMLElement&&e.offsetWidth>0&&(o=e.offsetWidth)}if(s===0||!Number.isFinite(s)){let l=parseFloat(r.height);Number.isFinite(l)&&l>0?s=l:e instanceof HTMLElement&&e.offsetHeight>0&&(s=e.offsetHeight)}let a={top:n.top-1,bottom:n.top-1+s,left:n.left,right:n.left+o-1+i};if(t.children.length===0||t.tagName.toUpperCase()==="SVG")return a;for(let l of t.children)if(l.nodeType===1&&"atomId"in l.dataset&&!l.classList.contains("ML__pstrut")){let u=Nf(l);a.left=Math.min(a.left,u.left),a.right=Math.max(a.right,u.right),a.top=Math.min(a.top,u.top),a.bottom=Math.max(a.bottom,u.bottom)}return a}function Uo(t,e){var n,r;if(!e.id)return null;let i=(r=(n=t.atomBoundsCache)==null?void 0:n.get(e.id))!=null?r:null;if(i!==null)return i;let o=t.field.querySelectorAll(`[data-atom-id="${e.id}"]`),s=Array.from(o);if(e.type==="prompt"){for(let a of s)if(a.classList.contains("ML__prompt-atom")){let l=a.querySelector(".ML__prompt");if(l){let u=Nf(l);i?(i.left=Math.min(i.left,u.left),i.right=Math.max(i.right,u.right),i.top=Math.min(i.top,u.top),i.bottom=Math.max(i.bottom,u.bottom)):i=u}}}for(let a of s){let l=Nf(a);i?(i.left=Math.min(i.left,l.left),i.right=Math.max(i.right,l.right),i.top=Math.min(i.top,l.top),i.bottom=Math.max(i.bottom,l.bottom)):i=l}return t.atomBoundsCache&&(i?t.atomBoundsCache.set(e.id,i):t.atomBoundsCache.delete(e.id)),i??null}function RC(t,e){let[n,r]=e,i=null;for(let o=n;o<=r;o++){let s=Uo(t,t.model.at(o));s&&(i?(i.top=Math.min(i.top,s.top),i.bottom=Math.max(i.bottom,s.bottom),i.left=Math.min(i.left,s.left),i.right=Math.max(i.right,s.right)):i=s)}return i??{top:0,bottom:0,left:0,right:0}}function zC(t,e,n){let r=new Map,i=t.field,o=i.offsetWidth,s=Math.floor(i.getBoundingClientRect().width)/o;s=isNaN(s)?1:s;for(let a of t.model.getAtoms(e,{includeChildren:!0})){if(n!=null&&n.excludeAtomsWithBackground&&a.style.backgroundColor)continue;let l=bx(t,Uo(t,a),s);if(l){let u=IC(a);if(r.has(u)){let c=r.get(u);r.set(u,{left:Math.min(c.left,l.left),right:Math.max(c.right,l.right),top:Math.min(c.top,l.top),bottom:Math.max(c.bottom,l.bottom)})}else r.set(u,l)}}return[...r.values()]}function vx(t,e){return t.model.selection.ranges.reduce((n,r)=>n.concat(...zC(t,r,e)),[])}function n0(t,e){return t==="*"||e==="none"?!0:e==="same-origin"?!window.origin||t===window.origin:typeof e=="function"?e(t):!1}function xx(t){let e=0,n=0,r=t.offsetWidth,i=t.offsetHeight;for(;t instanceof HTMLElement;)e+=t.offsetTop,n+=t.offsetLeft,t=t.offsetParent;return new DOMRect(n,e,r,i)}function wx(t,e){if(!t)return;let n=t.model.at(e);if(!n)return;let r={},i=Uo(t,n);i&&(r.bounds=new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)),r.depth=n.treeDepth-2,r.style=n.style;let o=n;for(;o;){if(o.command==="\\htmlData"&&o.args&&typeof o.args[0]=="string"){let s=o.args[0].split(",");for(let a of s){let l=a.match(/([^=]+)=(.+$)/);if(l){let u=l[1].trim().replace(/ /g,"-");u&&(r.data||(r.data={}),r.data[u]=l[2])}else{let u=a.trim().replace(/ /g,"-");u&&(r.data||(r.data={}),r.data[u]=void 0)}}}(o.command==="\\htmlId"||o.command==="\\cssId")&&!r.id&&o.args&&typeof o.args[0]=="string"&&(r.id=o.args[0]),o=o.parent}return(n.mode==="math"||n.mode==="text")&&(r.latex=G.serialize([n],{defaultMode:"math"})),r}function FC(t,e){let n=t.model.at(e);for(;n;){if(n.command==="\\href"){let r=n.args[0];if(typeof r=="string")return r}n=n.parent}return""}var $C=`@keyframes ML__caret-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}
:host {
  display: block;
}
.ML__container {
  display: inline-flex;
  flex-flow: row;
  justify-content: space-between;
  align-items: flex-end;
  min-height: 39px;
  /* Need some room for the virtual keyboard toggle */
  width: 100%;
  padding: 4px;
  box-sizing: border-box;
  /* This attribute is necessary to work around a Firefox issue where
  where clicking multiple times on the border leads to a focused mathfield that cannot be edited until focus is lost and regained (also fixes the multiple cursor issue on firefox that can occur with the same sequence of events).
  */
  pointer-events: auto;
  /* Prevent the browser from trying to interpret touch gestures in the field */
  /* "Disabling double-tap to zoom removes the need for browsers to
        delay the generation of click events when the user taps the screen." */
  touch-action: none;
  --_caret-color: var(--caret-color, hsl(var(--_hue), 40%, 49%));
  --_selection-color: var(--selection-color, #000);
  --_selection-background-color: var(--selection-background-color, hsl(var(--_hue), 70%, 85%));
  --_text-highlight-background-color: var(--highlight-text, hsla(var(--_hue), 40%, 50%, 0.1));
  --_contains-highlight-background-color: var(--contains-highlight-background-color, hsl(var(--_hue), 40%, 95%));
  --_smart-fence-color: var(--smart-fence-color, currentColor);
  --_smart-fence-opacity: var(--smart-fence-opacity, 0.5);
  --_contains-highlight-color: var(--contains-highlight-color, var(--_caret-color));
  --_latex-color: var(--latex-color, hsl(var(--_hue), 80%, 40%));
  --_correct-color: var(--correct-color, #10a000);
  --_incorrect-color: var(--incorrect-color, #a01b00);
  --_composition-background-color: var(--composition-background-color, #fff1c2);
  --_composition-text-color: var(--composition-text-color, black);
  --_composition-underline-color: var(--composition-underline-color, transparent);
  --_tooltip-border: var(--tooltip-border, 1px solid transparent);
  --_tooltip-border-radius: var(--tooltip-border-radius, 8px);
  --_tooltip-background-color: var(--tooltip-background-color, #616161);
  --_tooltip-color: var(--tooltip-color, #fff);
  --_tooltip-box-shadow: var(--tooltip-box-shadow, 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2));
}
@media (prefers-color-scheme: dark) {
  .ML__container {
    --_contains-highlight-color: var(--contains-highlight-color, hsl(var(--_hue), 85%, 75%));
    --_caret-color: var(--caret-color, hsl(var(--_hue), 65%, 55%));
    --_selection-color: var(--selection-color, #fff);
    --_selection-background-color: var(--selection-background-color, hsl(var(--_hue), 65%, 55%));
    --_text-highlight-background-color: var(--text-highlight-background-color, hsla(var(--_hue), 40%, 50%, 0.6));
    --_contains-highlight-background-color: var(--contains-highlight-background-color, hsl(var(--_hue), 5%, 34%));
    --_latex-color: var(--primary, hsl(var(--_hue), 40%, 50%));
    --_composition-background-color: #69571c;
    --_composition-text-color: white;
    --_placeholder-color: hsl(var(--_hue), 60%, 69%);
    --_smart-fence-color: var(--smart-fence-color, #fff);
    --_smart-fence-opacity: var(--smart-fence-opacity, 0.7);
  }
}
@media (forced-colors: active) {
  .ML__container {
    --_caret-color: white;
    --_selection-color: white;
    --_smart-fence-color: white;
    --_latex-color: white;
    --_correct-color: white;
    --_incorrect-color: white;
    --_composition-text-color: white;
  }
}
@media (hover: none) and (pointer: coarse) {
  :host(:not(:focus)) .ML__container {
    pointer-events: none;
  }
}
/* This is the actual field content (formula) */
.ML__content {
  display: flex;
  align-items: center;
  align-self: center;
  position: relative;
  overflow: hidden;
  padding: 2px 3px 2px 1px;
  width: 100%;
  /* Encourage the browser to use the GPU to render the field.
     Weirdly, this is required for prompts to be rendered correctly. 
   */
  isolation: isolate;
  text-shadow: var(--text-shadow);
}
.ML__content .ML__latex {
  text-shadow: var(--text-shadow);
}
.ML__content .ML__sqrt-line {
  box-shadow: var(--text-shadow);
}
.ML__content .ML__frac-line {
  box-shadow: var(--text-shadow);
}
/* Container for the virtual keyboard toggle and menu toggle buttons */
.ML__toggles {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 0;
  align-self: flex-start;
}
/* Vertical layout modifier */
.ML__toggles--vertical {
  flex-direction: column;
  align-items: center;
  gap: 4px;
}
.ML__toggles--vertical .ML__virtual-keyboard-toggle,
.ML__toggles--vertical .ML__menu-toggle {
  margin-right: 0;
}
.ML__virtual-keyboard-toggle,
.ML__menu-toggle {
  box-sizing: border-box;
  display: flex;
  align-self: center;
  align-items: center;
  flex-shrink: 0;
  flex-direction: column;
  justify-content: center;
  width: 34px;
  height: 34px;
  padding: 0;
  margin-right: 4px;
  cursor: pointer;
  /* Avoid some weird blinking with :hover */
  border-radius: 8px;
  border: 1px solid transparent;
  transition: background 0.2s cubic-bezier(0.64, 0.09, 0.08, 1);
  color: hsl(var(--_hue), 40%, 50%);
  fill: currentColor;
  background: transparent;
}
.ML__virtual-keyboard-toggle:hover,
.ML__menu-toggle:hover {
  background: hsla(0, 0%, 70%, 0.3);
  color: #333;
  fill: currentColor;
}
.ML__virtual-keyboard-toggle > span,
.ML__menu-toggle > span {
  display: flex;
  align-self: center;
  align-items: center;
}
@media (pointer: coarse) {
  .ML__virtual-keyboard-toggle,
  .ML__menu-toggle {
    min-width: 60px;
    min-height: 60px;
  }
}
/* The invisible element used to capture keyboard events. We're just trying
 really hard to make sure it doesn't show. */
.ML__keyboard-sink {
  display: inline-block;
  resize: none;
  outline: none;
  border: none;
  pointer-events: none;
  /* Need these for Microsoft Edge */
  position: fixed;
  clip: rect(0 0 0 0);
  /* Need this to prevent iOS Safari from auto-zooming */
  font-size: 1em;
  font-family: KaTeX_Main;
  line-height: 0.5;
  /* On Chromium, if this is 0, no keyboard events are received */
  /* Preferred over clip */
  clip-path: inset(50%);
}
[part='placeholder'] {
  color: var(--neutral-400);
}
.ML__composition {
  background: var(--_composition-background-color);
  color: var(--_composition-text-color);
  text-decoration: underline var(--_composition-underline-color);
}
.ML__caret {
  display: inline-block;
}
.ML__caret::after {
  content: '';
  visibility: hidden;
  width: 0;
  display: inline-block;
  height: 0.76em;
  --_caret-width: clamp(2px, 0.08em, 10px);
  border: none;
  border-radius: calc(var(--_caret-width) / 2);
  border-right: var(--_caret-width) solid var(--_caret-color);
  margin-right: calc(-1 * var(--_caret-width));
  position: relative;
  left: -0.045em;
  bottom: -0.05em;
  animation: ML__caret-blink 1.05s step-end forwards infinite;
}
.ML__text-caret::after {
  content: '';
  visibility: hidden;
  width: 0;
  display: inline-block;
  height: 0.76em;
  --_caret-width: clamp(2px, 0.08em, 10px);
  border: none;
  border-radius: calc(var(--_caret-width) / 2);
  border-right: var(--_caret-width) solid var(--_caret-color);
  margin-right: calc(-1 * var(--_caret-width));
  position: relative;
  left: -0.045em;
  bottom: -0.05em;
  animation: ML__caret-blink 1.05s step-end forwards infinite;
}
.ML__latex-caret::after {
  content: '';
  visibility: hidden;
  --_caret-width: clamp(2px, 0.08em, 10px);
  border: none;
  border-radius: calc(var(--_caret-width) / 2);
  border-right: var(--_caret-width) solid var(--_latex-color);
  margin-right: calc(-1 * var(--_caret-width));
  position: relative;
  left: -0.019em;
  animation: ML__caret-blink 1.05s step-end forwards infinite;
}
.ML__focused .ML__latex-caret::after,
.ML__focused .ML__text-caret::after,
.ML__focused .ML__caret::after {
  visibility: visible;
}
.ML__focused .ML__text {
  background: var(--_text-highlight-background-color);
}
/* When using smartFence, the anticipated closing fence is displayed
with this style */
.ML__smart-fence__close {
  opacity: var(--_smart-fence-opacity);
  color: var(--_smart-fence-color);
}
.ML__focused .ML__selected,
.ML__focused .ML__selected .ML__contains-caret,
.ML__focused .ML__selected .ML__smart-fence__close,
.ML__focused .ML__selected .ML__placeholder {
  color: var(--_selection-color);
  opacity: 1;
}
.ML__empty-line-anchor::after {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 8px;
  height: 20px;
  border-radius: 2px;
  background: transparent;
  opacity: 0;
  pointer-events: none;
}
.ML__focused .ML__empty-line-anchor.ML__selected::after {
  background: var(--_selection-background-color);
  opacity: 1;
}
.ML__selection {
  box-sizing: border-box;
  background: transparent;
}
:host(:focus) .ML__selection {
  background: var(--_selection-background-color) !important;
}
.ML__contains-caret.ML__close,
.ML__contains-caret.ML__open,
.ML__contains-caret > .ML__close,
.ML__contains-caret > .ML__open,
.ML__contains-caret .ML__sqrt-sign,
.ML__contains-caret .ML__sqrt-line {
  color: var(--_contains-highlight-color);
}
.ML__contains-highlight {
  box-sizing: border-box;
  background: transparent;
}
.ML__focused .ML__contains-highlight {
  background: var(--_contains-highlight-background-color);
}
.ML__raw-latex {
  font-family: 'Berkeley Mono', 'IBM Plex Mono', 'Source Code Pro', Consolas, 'Roboto Mono', Menlo, 'Bitstream Vera Sans Mono', 'DejaVu Sans Mono', Monaco, Courier, monospace;
  font-weight: 400;
  font-size: 0.8em;
  letter-spacing: -0.05em;
  color: var(--_latex-color);
}
.ML__suggestion {
  color: var(--neutral-500);
}
.ML__virtual-keyboard-toggle.is-visible.is-pressed:hover {
  background: hsl(var(--_hue), 25%, 35%);
  color: #fafafa;
  fill: currentColor;
}
.ML__virtual-keyboard-toggle.is-pressed,
.ML__virtual-keyboard-toggle.is-active:hover,
.ML__virtual-keyboard-toggle.is-active {
  background: hsl(var(--_hue), 25%, 35%);
  color: #fafafa;
  fill: currentColor;
}
/* Add an attribute 'data-tooltip' to automatically show a
   tooltip over a element on hover.
*/
[data-tooltip] {
  position: relative;
}
[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  display: block;
  z-index: 2;
  pointer-events: none;
  right: auto;
  top: calc(-100% - 4px);
  width: max-content;
  max-width: 200px;
  padding: 8px 8px;
  border-radius: 4px;
  background: #616161;
  color: #fff;
  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
  text-align: center;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-style: normal;
  font-weight: 400;
  font-size: 13px;
  /* Phone */
  opacity: 0;
  transform: scale(0.5);
}
@media only screen and (max-width: 767px) {
  [data-tooltip]::after {
    padding: 8px 16px;
    font-size: 16px;
  }
}
menu [data-tooltip]::after {
  left: 100%;
  top: 0%;
}
menu .ML__base {
  cursor: default;
}
/** Don't display if we're tracking, i.e. have the pointer down */
.tracking [data-tooltip]:hover::after {
  /* Use visibility, not display. Display will remove the after from the DOM, and the override below will not work */
  visibility: hidden;
}
/** But do display if tracking and inside a menu */
.tracking menu li[data-tooltip]:hover::after,
[data-tooltip]:hover::after {
  visibility: visible;
  opacity: 1;
  transform: scale(1);
  transition-property: opacity, scale;
  transition-duration: 0.15s;
  transition-delay: 1s;
  transition-timing-function: cubic-bezier(0.4, 0, 1, 1);
}
.ML__prompt {
  border-radius: 2px;
}
.ML__editablePromptBox {
  outline: 1px solid #acacac;
  border-radius: 2px;
  z-index: -1;
}
.ML__focused .ML__focusedPromptBox {
  outline: highlight auto 1px;
}
.ML__lockedPromptBox {
  background-color: rgba(142, 142, 141, 0.4);
  z-index: -1;
}
.ML__correctPromptBox {
  outline: 1px solid var(--_correct-color);
  box-shadow: 0 0 5px var(--_correct-color);
}
.ML__incorrectPromptBox {
  outline: 1px solid var(--_incorrect-color);
  box-shadow: 0 0 5px var(--_incorrect-color);
}
.variant-submenu {
  display: flex;
  flex-direction: column;
  padding: 8px;
}
.variant-submenu [part='menu-item'].ML__xl {
  font-size: 2rem;
  text-align: center;
  margin: 0;
}
.ML__center-menu .label {
  text-align: center;
}
.insert-matrix-submenu {
  /* Grid doesn't work on Safari */
  --_menu-item-size: 25px;
  width: calc(5 * var(--_menu-item-size));
  display: flex;
  flex-wrap: wrap;
  padding: 8px;
  align-content: center;
  justify-content: center;
}
.insert-matrix-submenu [part='menu-item'] {
  width: var(--_menu-item-size);
  height: var(--_menu-item-size);
  font-size: 21px;
  border: none;
  border-radius: 0;
  line-height: 21px;
  text-align: center;
  padding: 0;
  margin: 0;
}
.border-submenu [part='menu-item'] {
  font-size: 2rem;
  line-height: 1.2;
  text-align: center;
}
.swatches-submenu {
  --_swatch-size: 2rem;
  --_columns: 4;
  display: flex;
  flex-flow: wrap;
  padding: 8px;
  max-width: calc(var(--_columns) * (var(--_swatch-size) + 18px) + 16px);
  box-sizing: border-box;
}
.menu-swatch {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: fit-content;
  height: fit-content;
  margin: 2px;
  padding: 0;
  background: var(--neutral-200);
}
.menu-swatch > .label {
  padding: 0;
  margin: 0;
  line-height: 0;
}
.menu-swatch > .label > span {
  display: inline-block;
  margin: 6px;
  min-width: var(--_swatch-size);
  min-height: var(--_swatch-size);
  border-radius: 50%;
}
.menu-swatch.active {
  background: var(--neutral-100);
  scale: 1.4;
}
.menu-swatch.active > .label > span {
  border-radius: 2px;
}
.menu-swatch .ui-checkmark,
.menu-swatch .ui-mixedmark {
  position: absolute;
  margin: 0;
  padding: 0;
  color: white;
}
.menu-swatch.dark-contrast .ui-checkmark,
.menu-swatch.dark-contrast .ui-mixedmark {
  color: #000;
}
.ML__insert-template {
  font-size: 1em;
}
.ML__insert-label {
  opacity: 0.5;
  margin-left: 2ex;
}
`,KC=`.ML__container {
  min-height: auto !important;
  --_hue: var(--hue, 212);
  --_placeholder-color: var(--placeholder-color, hsl(var(--_hue), 40%, 49%));
  --_placeholder-opacity: var(--placeholder-opacity, 0.4);
  --_text-font-family: var(--text-font-family, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif);
}
.ML__sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  clip-path: inset(50%);
  white-space: nowrap;
  border: 0;
}
.ML__is-inline {
  display: inline-block;
}
.ML__base {
  visibility: inherit;
  display: inline-block;
  position: relative;
  cursor: text;
  padding: 0;
  margin: 0;
  box-sizing: content-box;
  border: 0;
  outline: 0;
  vertical-align: baseline;
  font-weight: inherit;
  font-family: inherit;
  font-style: inherit;
  text-decoration: none;
  width: min-content;
}
.ML__strut,
.ML__strut--bottom {
  display: inline-block;
  min-height: 0.5em;
}
.ML__small-delim {
  font-family: KaTeX_Main;
}
/* Text mode */
.ML__text {
  font-family: var(--_text-font-family);
  white-space: pre;
}
/* Use cmr for 'math upright' */
.ML__cmr {
  font-family: KaTeX_Main;
  font-style: normal;
}
.ML__mathit {
  font-family: KaTeX_Math;
  /* The KaTeX_Math font is italic by default, so the font-style below is only 
     useful when a fallback font is used
  */
  font-style: italic;
}
.ML__mathbf {
  font-family: KaTeX_Main;
  font-weight: bold;
}
/* Lowercase greek symbols should stick to math font when \\mathbf is applied 
   to match TeX idiosyncratic behavior */
.lcGreek.ML__mathbf {
  font-family: KaTeX_Math;
}
.ML__mathbfit {
  font-family: KaTeX_Math;
  font-weight: bold;
  font-style: italic;
}
.ML__ams {
  font-family: KaTeX_AMS;
}
/* Blackboard */
.ML__bb {
  font-family: KaTeX_AMS;
}
.ML__cal {
  font-family: KaTeX_Caligraphic;
}
.ML__frak {
  font-family: KaTeX_Fraktur;
}
.ML__tt {
  font-family: KaTeX_Typewriter;
}
.ML__script {
  font-family: KaTeX_Script;
}
.ML__sans {
  font-family: KaTeX_SansSerif;
}
.ML__series_ul {
  font-weight: 100;
}
.ML__series_el {
  font-weight: 100;
}
.ML__series_l {
  font-weight: 200;
}
.ML__series_sl {
  font-weight: 300;
}
.ML__series_sb {
  font-weight: 500;
}
.ML__bold {
  font-weight: 700;
}
.ML__series_eb {
  font-weight: 800;
}
.ML__series_ub {
  font-weight: 900;
}
.ML__series_uc {
  font-stretch: ultra-condensed;
}
.ML__series_ec {
  font-stretch: extra-condensed;
}
.ML__series_c {
  font-stretch: condensed;
}
.ML__series_sc {
  font-stretch: semi-condensed;
}
.ML__series_sx {
  font-stretch: semi-expanded;
}
.ML__series_x {
  font-stretch: expanded;
}
.ML__series_ex {
  font-stretch: extra-expanded;
}
.ML__series_ux {
  font-stretch: ultra-expanded;
}
.ML__it {
  font-style: italic;
}
.ML__shape_ol {
  -webkit-text-stroke: 1px black;
  text-stroke: 1px black;
  color: transparent;
}
.ML__shape_sc {
  font-variant: small-caps;
}
.ML__shape_sl {
  font-style: oblique;
}
/* First level emphasis */
.ML__emph {
  color: #bc2612;
}
/* Second level emphasis */
.ML__emph .ML__emph {
  color: #0c7f99;
}
.ML__highlight {
  color: #007cb2;
  background: #edd1b0;
}
.ML__center {
  text-align: center;
}
.ML__left {
  text-align: left;
}
.ML__right {
  text-align: right;
}
.ML__label_padding {
  padding: 0 0.5em;
}
.ML__frac-line {
  width: 100%;
  min-height: 1px;
}
.ML__frac-line:after {
  content: '';
  display: block;
  margin-top: max(-1px, -0.04em);
  min-height: max(1px, 0.04em);
  /* Ensure the line is visible when printing even if "turn off background images" is on*/
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
  /* There's a bug since Chrome 62 where 
      sub-pixel border lines don't draw at some zoom 
      levels (110%, 90%). 
      Setting the min-height used to work around it, but that workaround
      broke in Chrome 84 or so.
      Setting the background (and the min-height) seems to work for now.
      */
  background: currentColor;
  box-sizing: content-box;
  /* Vuetify sets the box-sizing to inherit 
            causes the fraction line to not draw at all sizes (see #26) */
  /* On some versions of Firefox on Windows, the line fails to 
            draw at some zoom levels, but setting the transform triggers
            the hardware accelerated path, which works */
  transform: translate(0, 0);
  forced-color-adjust: preserve-parent-color;
}
@media (forced-colors: active) {
  .ML__frac-line {
    min-height: 0px;
  }
}
.ML__sqrt {
  display: inline-block;
}
.ML__sqrt-sign {
  display: inline-block;
  position: relative;
}
.ML__sqrt-line {
  display: inline-block;
  height: max(1px, 0.04em);
  width: 100%;
}
.ML__sqrt-line:before {
  content: '';
  display: block;
  margin-top: min(-1px, -0.04em);
  min-height: max(1px, 0.04em);
  /* Ensure the line is visible when printing even if "turn off background images" is on*/
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
  background: currentColor;
  /* On some versions of Firefox on Windows, the line fails to 
            draw at some zoom levels, but setting the transform triggers
            the hardware accelerated path, which works */
  transform: translate(0, 0);
  forced-color-adjust: preserve-parent-color;
}
@media (forced-colors: active) {
  .ML__sqrt-line:after {
    background: white !important;
  }
}
.ML__sqrt-line:after {
  border-bottom-width: 1px;
  content: ' ';
  display: block;
  margin-top: -0.1em;
}
.ML__sqrt-index {
  margin-left: 0.27777778em;
  margin-right: -0.55555556em;
}
.ML__delim-size1 {
  font-family: KaTeX_Size1;
}
.ML__delim-size2 {
  font-family: KaTeX_Size2;
}
.ML__delim-size3 {
  font-family: KaTeX_Size3;
}
.ML__delim-size4 {
  font-family: KaTeX_Size4;
}
.ML__delim-mult .delim-size1 > span {
  font-family: KaTeX_Size1;
}
.ML__delim-mult .delim-size4 > span {
  font-family: KaTeX_Size4;
}
.ML__accent-body {
  font-family: KaTeX_Main;
}
.ML__accent-combining-char {
  position: relative;
  left: 0.24em;
}
/** The markup for a LaTeX formula, either in an editable mathfield or 
    in a static display.
*/
.ML__latex {
  display: inline-block;
  direction: ltr;
  text-align: left;
  text-indent: 0;
  text-rendering: auto;
  font-family: inherit;
  font-style: normal;
  font-size-adjust: none;
  font-stretch: normal;
  font-variant-caps: normal;
  letter-spacing: normal;
  line-height: 1.2;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  text-shadow: none;
  -webkit-user-select: none;
  user-select: none;
  width: min-content;
  forced-color-adjust: preserve-parent-color;
}
.ML__latex .style-wrap {
  position: relative;
}
.ML__latex .ML__mfrac {
  display: inline-block;
}
.ML__latex .ML__left-right {
  display: inline-block;
}
.ML__latex .ML__vlist-t {
  display: inline-table;
  table-layout: fixed;
  border-collapse: collapse;
}
.ML__latex .ML__vlist-r {
  display: table-row;
}
.ML__latex .ML__vlist {
  display: table-cell;
  vertical-align: bottom;
  position: relative;
}
.ML__latex .ML__vlist > span {
  display: block;
  height: 0;
  position: relative;
}
.ML__latex .ML__vlist > span > span {
  display: inline-block;
}
.ML__latex .ML__vlist > span > .ML__pstrut {
  overflow: hidden;
  width: 0;
}
.ML__latex .ML__vlist-t2 {
  margin-right: -2px;
}
.ML__latex .ML__vlist-s {
  display: table-cell;
  vertical-align: bottom;
  font-size: 1px;
  width: 2px;
  min-width: 2px;
}
.ML__latex .ML__msubsup {
  text-align: left;
}
.ML__latex .ML__negativethinspace {
  display: inline-block;
  margin-left: -0.16667em;
  height: 0.71em;
}
.ML__latex .ML__thinspace {
  display: inline-block;
  width: 0.16667em;
  height: 0.71em;
}
.ML__latex .ML__mediumspace {
  display: inline-block;
  width: 0.22222em;
  height: 0.71em;
}
.ML__latex .ML__thickspace {
  display: inline-block;
  width: 0.27778em;
  height: 0.71em;
}
.ML__latex .ML__enspace {
  display: inline-block;
  width: 0.5em;
  height: 0.71em;
}
.ML__latex .ML__quad {
  display: inline-block;
  width: 1em;
  height: 0.71em;
}
.ML__latex .ML__qquad {
  display: inline-block;
  width: 2em;
  height: 0.71em;
}
.ML__latex .ML__llap,
.ML__latex .ML__rlap {
  width: 0;
  position: relative;
  display: inline-block;
}
.ML__latex .ML__llap > .ML__inner,
.ML__latex .ML__rlap > .ML__inner {
  position: absolute;
}
.ML__latex .ML__llap > .ML__fix,
.ML__latex .ML__rlap > .ML__fix {
  display: inline-block;
}
.ML__latex .ML__llap > .ML__inner {
  right: 0;
}
.ML__latex .ML__rlap > .ML__inner {
  left: 0;
}
.ML__latex .ML__rule {
  display: inline-block;
  border: solid 0;
  position: relative;
  box-sizing: border-box;
}
.ML__latex .overline .overline-line,
.ML__latex .underline .underline-line {
  width: 100%;
}
.ML__latex .overline .overline-line:before,
.ML__latex .underline .underline-line:before {
  content: '';
  border-bottom-style: solid;
  border-bottom-width: max(1px, 0.04em);
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
  display: block;
}
.ML__latex .overline .overline-line:after,
.ML__latex .underline .underline-line:after {
  border-bottom-style: solid;
  border-bottom-width: max(1px, 0.04em);
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
  content: '';
  display: block;
  margin-top: -1px;
}
.ML__latex .ML__stretchy {
  display: block;
  position: absolute;
  width: 100%;
  left: 0;
  overflow: hidden;
}
.ML__latex .ML__stretchy:before,
.ML__latex .ML__stretchy:after {
  content: '';
}
.ML__latex .ML__stretchy svg {
  display: block;
  position: absolute;
  width: 100%;
  height: inherit;
  fill: currentColor;
  stroke: currentColor;
  fill-rule: nonzero;
  fill-opacity: 1;
  stroke-width: 1;
  stroke-linecap: butt;
  stroke-linejoin: miter;
  stroke-miterlimit: 4;
  stroke-dasharray: none;
  stroke-dashoffset: 0;
  stroke-opacity: 1;
}
.ML__latex .slice-1-of-2 {
  display: inline-flex;
  position: absolute;
  left: 0;
  width: 50.2%;
  overflow: hidden;
}
.ML__latex .slice-2-of-2 {
  display: inline-flex;
  position: absolute;
  right: 0;
  width: 50.2%;
  overflow: hidden;
}
.ML__latex .slice-1-of-3 {
  display: inline-flex;
  position: absolute;
  left: 0;
  width: 25.1%;
  overflow: hidden;
}
.ML__latex .slice-2-of-3 {
  display: inline-flex;
  position: absolute;
  left: 25%;
  width: 50%;
  overflow: hidden;
}
.ML__latex .slice-3-of-3 {
  display: inline-flex;
  position: absolute;
  right: 0;
  width: 25.1%;
  overflow: hidden;
}
.ML__latex .slice-1-of-1 {
  display: inline-flex;
  position: absolute;
  width: 100%;
  left: 0;
  overflow: hidden;
}
.ML__latex .ML__nulldelimiter {
  display: inline-block;
}
.ML__latex .ML__op-group {
  display: inline-block;
}
.ML__latex .ML__op-symbol {
  position: relative;
}
.ML__latex .ML__op-symbol.ML__small-op {
  font-family: KaTeX_Size1;
}
.ML__latex .ML__op-symbol.ML__large-op {
  font-family: KaTeX_Size2;
}
.ML__latex:has(.ML__center_environment),
.ML__latex:has(.ML__multiline_environment),
.ML__latex:has(.ML__align_environment),
.ML__latex:has(.ML__eqnarray_environment),
.ML__latex:has(.ML__gather_environment) {
  width: 100%;
}
.ML__latex .ML__multiline_environment {
  display: inline-flex;
  width: 100%;
}
.ML__latex .ML__center_environment {
  display: inline-flex;
  width: 100%;
  justify-content: center;
}
.ML__latex .ML__align_environment,
.ML__latex .ML__eqnarray_environment,
.ML__latex .ML__gather_environment {
  display: inline-block;
}
.ML__latex .ML__mtable .ML__vertical-separator {
  display: inline-block;
  min-width: 1px;
  box-sizing: border-box;
}
.ML__latex .ML__mtable .ML__arraycolsep {
  display: inline-block;
}
.ML__latex .ML__mtable .col-align-m > .ML__vlist-t {
  text-align: center;
}
.ML__latex .ML__mtable .col-align-c > .ML__vlist-t {
  text-align: center;
}
.ML__latex .ML__mtable .col-align-l > .ML__vlist-t {
  text-align: left;
}
.ML__latex .ML__mtable .col-align-r > .ML__vlist-t {
  text-align: right;
}
[data-href] {
  cursor: pointer;
}
.ML__error {
  display: inline-block;
  background-image: radial-gradient(ellipse at center, hsl(341, 100%, 40%), rgba(0, 0, 0, 0) 70%);
  background-color: hsla(341, 100%, 40%, 0.1);
  background-repeat: repeat-x;
  background-size: 3px 3px;
  padding-bottom: 3px;
  background-position: 0 100%;
}
.ML__error > .ML__error {
  background: transparent;
  padding: 0;
}
.ML__placeholder {
  color: var(--_placeholder-color);
  opacity: var(--_placeholder-opacity);
  padding-left: 0.4ex;
  padding-right: 0.4ex;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
}
.ML__notation {
  position: absolute;
  box-sizing: border-box;
  line-height: 0;
}
/* This class is used to implement the \`\\mathtip\` and \`\\texttip\` commands
   For UI elements, see \`[data-ML__tooltip]\`
*/
.ML__tooltip-container {
  position: relative;
  transform: scale(0);
}
.ML__tooltip-container .ML__tooltip-content {
  position: fixed;
  display: inline-table;
  visibility: hidden;
  z-index: 2;
  width: max-content;
  max-width: 400px;
  padding: 12px 12px;
  border: var(--_tooltip-border);
  border-radius: var(--_tooltip-border-radius);
  background: var(--_tooltip-background-color);
  --_selection-color: var(--_tooltip-color);
  color: var(--_tooltip-color);
  box-shadow: var(--_tooltip-box-shadow);
  opacity: 0;
  transition: opacity 0.15s cubic-bezier(0.4, 0, 1, 1);
}
.ML__tooltip-container .ML__tooltip-content .ML__text {
  white-space: normal;
}
.ML__tooltip-container .ML__tooltip-content .ML__base {
  display: contents;
}
.ML__tooltip-container:hover .ML__tooltip-content {
  visibility: visible;
  opacity: 1;
  font-size: 0.75em;
  transform: scale(1) translate(0, 3em);
}
.ML__bg {
  background-color: transparent !important;
}
.ML__bg::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--bg-color);
  z-index: -1;
  box-sizing: border-box;
}
`,jC=`#mathlive-environment-popover.is-visible {
  visibility: visible;
}
#mathlive-environment-popover {
  --_environment-panel-height: var(--environment-panel-height, 70px);
  --_accent-color: var(--accent-color, #aaa);
  --_background: var(--environment-panel-background, #fff);
  --_button-background: var(--environment-panel-button-background, white);
  --_button-background-hover: var(--environment-panel-button-background-hover, #f5f5f7);
  --_button-background-active: var(--environment-panel-button-background-active, #f5f5f7);
  --_button-text: var(--environment-panel-button-text, #e3e4e8);
  position: absolute;
  width: calc(var(--_environment-panel-height) * 2);
  height: var(--_environment-panel-height);
  border-radius: 4px;
  border: 1.5px solid var(--_accent-color);
  background-color: var(--_background);
  box-shadow: 0 0 30px 0 var(--environment-shadow, rgba(0, 0, 0, 0.4));
  pointer-events: all;
  visibility: hidden;
}
#mathlive-environment-popover .MLEP__array-buttons {
  height: calc(var(--_environment-panel-height) * 5/4);
  width: calc(var(--_environment-panel-height) * 5/4);
  margin-left: calc(0px - var(--_environment-panel-height) * 0.16);
  margin-top: calc(0px - var(--_environment-panel-height) * 0.19);
}
#mathlive-environment-popover .MLEP__array-buttons .font {
  fill: white;
}
#mathlive-environment-popover .MLEP__array-buttons circle {
  fill: #7f7f7f;
  transition: fill 300ms;
}
#mathlive-environment-popover .MLEP__array-buttons .MLEP__array-insert-background {
  fill-opacity: 1;
  fill: var(--_background);
  stroke: var(--_accent-color);
  stroke-width: 3px;
}
#mathlive-environment-popover .MLEP__array-buttons line {
  stroke: var(--_accent-color);
  stroke-opacity: 0;
  stroke-width: 40;
  pointer-events: none;
  transition: stroke-opacity 300ms;
  stroke-linecap: round;
}
#mathlive-environment-popover .MLEP__array-buttons g[data-command]:hover circle {
  fill: var(--_accent-color);
}
#mathlive-environment-popover .MLEP__array-buttons g[data-command]:hover line {
  stroke-opacity: 1;
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls {
  height: 100%;
  width: 50%;
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options {
  width: var(--_environment-panel-height);
  height: var(--_environment-panel-height);
  display: flex;
  flex-wrap: wrap;
  flex-direction: row;
  justify-content: space-around;
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg {
  pointer-events: all;
  margin-top: 2px;
  width: calc(var(--_environment-panel-height) / 3 * 28 / 24);
  height: calc(var(--_environment-panel-height) / 3 - 2px);
  border-radius: calc(var(--_environment-panel-height) / 25);
  background-color: var(--_button-background);
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg:hover {
  background-color: var(--_button-background-hover);
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg path,
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg line {
  stroke: var(--_button-text);
  stroke-width: 2;
  stroke-linecap: round;
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg rect,
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg path {
  fill-opacity: 0;
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg.active {
  pointer-events: none;
  background-color: var(--_button-background-active);
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg.active path,
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg.active line {
  stroke: var(--_accent-color);
}
#mathlive-environment-popover .MLEP__environment-delimiter-controls .MLEP__array-delimiter-options svg.active circle {
  fill: var(--_accent-color);
}
`,qC=`/* The element that display info while in latex mode */
#mathlive-suggestion-popover {
  --_suggestion-zindex: var(--suggestion-zindex, 100);
  background-color: rgba(97, 97, 97);
  color: #fff;
  text-align: center;
  border-radius: 8px;
  position: fixed;
  z-index: var(--_suggestion-zindex);
  display: none;
  flex-direction: column;
  justify-content: center;
  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
}
#mathlive-suggestion-popover.top-tip::after {
  content: '';
  position: absolute;
  top: -15px;
  left: calc(50% - 15px);
  width: 0;
  height: 0;
  border-left: 15px solid transparent;
  border-right: 15px solid transparent;
  border-bottom: 15px solid rgba(97, 97, 97);
  font-size: 1rem;
}
#mathlive-suggestion-popover.bottom-tip::after {
  content: '';
  position: absolute;
  bottom: -15px;
  left: calc(50% - 15px);
  width: 0;
  height: 0;
  border-left: 15px solid transparent;
  border-right: 15px solid transparent;
  border-top: 15px solid rgba(97, 97, 97);
  font-size: 1rem;
}
#mathlive-suggestion-popover.is-animated {
  transition: all 0.2s cubic-bezier(0.64, 0.09, 0.08, 1);
  animation: ML__fade-in cubic-bezier(0, 0, 0.2, 1) 0.15s;
}
#mathlive-suggestion-popover.is-visible {
  display: flex;
}
@keyframes ML__fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/* The wrapper class for the entire content of the popover panel */
#mathlive-suggestion-popover ul {
  display: flex;
  flex-flow: column;
  list-style: none;
  margin: 0;
  padding: 0;
  align-items: flex-start;
  max-height: 400px;
  overflow-y: auto;
}
#mathlive-suggestion-popover li {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  margin: 8px;
  padding: 8px;
  width: calc(100% - 16px - 16px);
  column-gap: 1em;
  border-radius: 8px;
  cursor: pointer;
  /* Since the content can be clicked on, provide feedback on hover */
}
#mathlive-suggestion-popover li a {
  color: #5ea6fd;
  padding-top: 0.3em;
  margin-top: 0.4em;
  display: block;
}
#mathlive-suggestion-popover li a:hover {
  color: #5ea6fd;
  text-decoration: underline;
}
#mathlive-suggestion-popover li:hover,
#mathlive-suggestion-popover li.is-pressed,
#mathlive-suggestion-popover li.is-active {
  background: rgba(255, 255, 255, 0.1);
}
/* The command inside a popover (inside a #mathlive-suggestion-popover) */
.ML__popover__command {
  font-size: 1.6rem;
  font-family: KaTeX_Main;
}
.ML__popover__current {
  background: #5ea6fd;
  color: #fff;
}
.ML__popover__latex {
  font-family: 'IBM Plex Mono', 'Source Code Pro', Consolas, 'Roboto Mono', Menlo, 'Bitstream Vera Sans Mono', 'DejaVu Sans Mono', Monaco, Courier, monospace;
  align-self: center;
}
/* The keyboard shortcuts for a symbol as displayed in the popover */
.ML__popover__keybinding {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-size: 0.8em;
  opacity: 0.7;
}
/* Style for the character that joins the modifiers of a keyboard shortcut 
(usually a "+" sign)*/
.ML__shortcut-join {
  opacity: 0.5;
}
`,VC=`/* The element that displays the keys as the user type them */
#mathlive-keystroke-caption-panel {
  visibility: hidden;
  /*min-width: 160px;*/
  /*background-color: rgba(97, 97, 200, .95);*/
  background: var(--secondary, hsl(var(--_hue), 19%, 26%));
  border-color: var(--secondary-border, hsl(0, 0%, 91%));
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
  text-align: center;
  border-radius: 6px;
  padding: 16px;
  position: absolute;
  z-index: 1;
  display: flex;
  flex-direction: row-reverse;
  justify-content: center;
  --keystroke: white;
  --on-keystroke: #555;
  --keystroke-border: #f7f7f7;
}
@media (prefers-color-scheme: dark) {
  body:not([theme='light']) #mathlive-keystroke-caption-panel {
    --keystroke: hsl(var(--_hue), 50%, 30%);
    --on-keystroke: hsl(0, 0%, 98%);
    --keystroke-border: hsl(var(--_hue), 50%, 25%);
  }
}
body[theme='dark'] #mathlive-keystroke-caption-panel {
  --keystroke: hsl(var(--_hue), 50%, 30%);
  --on-keystroke: hsl(0, 0%, 98%);
  --keystroke-border: hsl(var(--_hue), 50%, 25%);
}
#mathlive-keystroke-caption-panel > span {
  min-width: 14px;
  /*height: 8px;*/
  margin: 0 8px 0 0;
  padding: 4px;
  background-color: var(--keystroke);
  color: var(--on-keystroke);
  fill: currentColor;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-size: 1em;
  border-radius: 6px;
  border: 2px solid var(--keystroke-border);
  /*box-shadow: 0 7px 14px rgba(0,0,0,0.25), 0 5px 5px rgba(0,0,0,0.22);*/
}
`,HC=`.ML__keyboard {
  --_keyboard-height: 0;
  --_keyboard-zindex: var(--keyboard-zindex, 105);
  --_accent-color: var(--keyboard-accent-color, #0c75d8);
  --_background: var(--keyboard-background, #cacfd7);
  --_border: var(--keyboard-border, #ddd);
  --_padding-horizontal: var(--keyboard-padding-horizontal, 0px);
  --_padding-top: var(--keyboard-padding-top, 5px);
  --_padding-bottom: var(--keyboard-padding-bottom, 0px);
  --_row-padding-left: var(--keyboard-row-padding-left, 0px);
  --_row-padding-right: var(--keyboard-row-padding-right, 0px);
  --_toolbar-text: var(--keyboard-toolbar-text, #2c2e2f);
  --_toolbar-text-active: var(--keyboard-toolbar-text-active, var(--_accent-color));
  --_toolbar-background: var(--keyboard-toolbar-background, transparent);
  --_toolbar-background-hover: var(--keyboard-toolbar-background-hover, #eee);
  --_toolbar-background-selected: var(--keyboard-toolbar-background-selected, transparent);
  --_toolbar-font-size: var(--keyboard-toolbar-font-size, '135%');
  --_horizontal-rule: var(--keyboard-horizontal-rule, 1px solid #fff);
  --_keycap-background: var(--keycap-background, #f0f0f0);
  --_keycap-background-hover: var(--keycap-background-hover, #f5f5f7);
  --_keycap-background-active: var(--keycap-background-active, var(--_accent-color));
  --_keycap-background-pressed: var(--keycap-background-pressed, var(--_accent-color));
  --_keycap-border: var(--keycap-border, #e5e6e9);
  --_keycap-border-bottom: var(--keycap-border-bottom, #8d8f92);
  --_keycap-text: var(--keycap-text, #000);
  --_keycap-text-active: var(--keycap-text-active, #fff);
  --_keycap-text-hover: var(--keycap-text-hover, var(--_keycap-text));
  --_keycap-text-pressed: var(--keycap-text-pressed, #fff);
  --_keycap-shift-text: var(--keycap-shift-text, var(--_accent-color));
  --_keycap-primary-background: var(--keycap-primary-background, var(--_accent-color));
  --_keycap-primary-text: var(--keycap-primary-text, #ddd);
  --_keycap-primary-background-hover: var(--keycap-primary-background-hover, #0d80f2);
  --_keycap-secondary-background: var(--keycap-secondary-background, #a0a9b8);
  --_keycap-secondary-background-hover: var(--keycap-secondary-background-hover, #7d8795);
  --_keycap-secondary-text: var(--keycap-secondary-text, #060707);
  --_keycap-secondary-border: var(--keycap-secondary-border, #c5c9d0);
  --_keycap-secondary-border-bottom: var(--keycap-secondary-border-bottom, #989da6);
  --_keycap-height: var(--keycap-height, 60px);
  /* Keycap width (incl. margin) */
  --_keycap-max-width: var(--keycap-max-width, 100px);
  --_keycap-gap: var(--keycap-gap, 8px);
  --_keycap-font-size: var(--keycap-font-size, clamp(16px, 4cqw, 24px));
  --_keycap-small-font-size: var(--keycap-small-font-size, calc(var(--keycap-font-size) * 0.8));
  --_keycap-extra-small-font-size: var(--keycap-extra-small-font-size, calc(var(--keycap-font-size) / 1.42));
  --_variant-panel-background: var(--variant-panel-background, #f0f0f0);
  --_variant-keycap-text: var(--variant-keycap-text, var(--_keycap-text));
  --_variant-keycap-text-active: var(--variant-keycap-text-active, var(--_keycap-text-active));
  --_variant-keycap-background-active: var(--variant-keycap-background-active, var(--_accent-color));
  --_variant-keycap-length: var(--variant-keycap-length, 70px);
  --_variant-keycap-font-size: var(--variant-keycap-font-size, 30px);
  --_variant-keycap-aside-font-size: var(--variant-keycap-aside-font-size, 12px);
  --_keycap-shift-font-size: var(--keycap-shift-font-size, 16px);
  --_keycap-shift-color: var(--keycap-shift-color, var(--_accent-color));
  --_box-placeholder-color: var(--box-placeholder-color, var(--_accent-color));
  --_box-placeholder-pressed-color: var(--box-placeholder-pressed-color, var(--keycap-text-pressed));
  --_keycap-glyph-size: var(--keycap-glyph-size, 20px);
  --_keycap-glyph-size-lg: var(--keycap-glyph-size-lg, 24px);
  --_keycap-glyph-size-xl: var(--keycap-glyph-size-xl, 50px);
}
.is-math-mode .MLK__rows .if-text-mode,
.is-text-mode .MLK__rows .if-math-mode {
  display: none;
}
.if-can-undo,
.if-can-redo,
.if-can-copy,
.if-can-cut,
.if-can-paste {
  opacity: 0.4;
  pointer-events: none;
}
.can-undo .if-can-undo,
.can-redo .if-can-redo,
.can-copy .if-can-copy,
.can-cut .if-can-cut,
.can-paste .if-can-paste {
  opacity: 1;
  pointer-events: all;
}
body > .ML__keyboard {
  position: fixed;
  --_padding-bottom: calc(var(--keyboard-padding-bottom, 0px) + env(safe-area-inset-bottom, 0));
}
body > .ML__keyboard.is-visible > .MLK__backdrop {
  box-shadow: 0 -5px 6px rgba(0, 0, 0, 0.08);
  border-top: 1px solid var(--_border);
}
body > .ML__keyboard.backdrop-is-transparent.is-visible > .MLK__backdrop {
  box-shadow: none;
  border: none;
}
body > .ML__keyboard.is-visible.animate > .MLK__backdrop {
  transition: 0.28s cubic-bezier(0, 0, 0.2, 1);
  transition-property: transform, opacity;
  transition-timing-function: cubic-bezier(0.4, 0, 1, 1);
}
.ML__keyboard {
  position: relative;
  overflow: hidden;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  z-index: var(--_keyboard-zindex);
  box-sizing: border-box;
  outline: none;
  border: none;
  margin: 0;
  padding: 0;
  line-height: 1;
  overflow-wrap: unset;
  text-align: left;
  vertical-align: baseline;
  cursor: auto;
  white-space: pre;
  box-shadow: none;
  opacity: 1;
  transform: none;
  pointer-events: none;
}
.ML__keyboard :where(div) {
  box-sizing: border-box;
  outline: none;
  border: none;
  margin: 0;
  padding: 0;
  line-height: 1;
  overflow-wrap: unset;
  text-align: left;
  vertical-align: baseline;
  cursor: auto;
  white-space: pre;
  box-shadow: none;
  transform: none;
}
.MLK__backdrop {
  position: absolute;
  bottom: calc(-1 * var(--_keyboard-height));
  width: 100%;
  height: var(--_keyboard-height);
  box-sizing: border-box;
  padding-top: var(--_padding-top);
  padding-bottom: var(--_padding-bottom);
  padding-left: var(--_padding-horizontal);
  padding-right: var(--_padding-horizontal);
  opacity: 0;
  visibility: hidden;
  transform: translate(0, 0);
  background: var(--_background);
}
.backdrop-is-transparent .MLK__backdrop {
  background: transparent;
}
/* If a custom layout has a custom container/backdrop
  (backdrop-is-transparent), make sure to let pointer event go through. */
.backdrop-is-transparent .MLK__plate {
  background: transparent;
  pointer-events: none;
}
/* If a custom layout has a custom container/backdrop, make sure to 
   allow pointer events on it. */
.backdrop-is-transparent .MLK__layer > div > div {
  pointer-events: all;
}
.ML__keyboard.is-visible > .MLK__backdrop {
  transform: translate(0, calc(-1 * var(--_keyboard-height)));
  opacity: 1;
  visibility: visible;
}
.caps-lock-indicator {
  display: none;
  width: 8px;
  height: 8px;
  background: #0cbc0c;
  box-shadow: inset 0 0 4px 0 #13ca13, 0 0 4px 0 #a9ef48;
  border-radius: 8px;
  right: 8px;
  top: 8px;
  position: absolute;
}
.ML__keyboard.is-caps-lock .caps-lock-indicator {
  display: block;
}
.ML__keyboard.is-caps-lock .shift {
  background: var(--_keycap-background-active);
  color: var(--_keycap-text-active);
}
.MLK__plate {
  position: absolute;
  top: var(--_padding-top);
  left: var(--_padding-horizontal);
  width: calc(100% - 2 * var(--_padding-horizontal));
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  container-type: inline-size;
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
  pointer-events: all;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-size: 16px;
  /* Size of toolbar labels */
  font-weight: 400;
  text-shadow: none;
}
.ML__box-placeholder {
  color: var(--_box-placeholder-color);
}
.MLK__tex {
  font-family: KaTeX_Main, KaTeX_Math, 'Cambria Math', 'Asana Math', OpenSymbol, Symbola, STIX, Times, serif !important;
}
.MLK__tex-math {
  font-family: KaTeX_Math, KaTeX_Main, 'Cambria Math', 'Asana Math', OpenSymbol, Symbola, STIX, Times, serif !important;
  font-style: italic;
}
.MLK__layer {
  display: none;
  outline: none;
}
.MLK__layer.is-visible {
  display: flex;
  flex-flow: column;
}
/* Keyboard layouts are made or rows of keys... */
.MLK__rows {
  --_keycap-width: var(--keycap-width, min(var(--_keycap-max-width), 10cqw));
  display: flex;
  flex-flow: column;
  align-items: center;
  border-collapse: separate;
  clear: both;
  border: 0;
  margin: 0;
  margin-bottom: var(--_keycap-gap);
  gap: var(--_keycap-gap);
  /* If the styling include, e.g., some shadows, they will be
  cut off by the overflow. In that case, set the padding to 
  compensate. */
  padding-left: var(--_row-padding-left);
  padding-right: var(--_row-padding-right);
  overflow: visible;
  touch-action: none;
}
.MLK__rows > .MLK__row {
  display: flex;
  flex-flow: row;
  justify-content: center;
  width: 100%;
  gap: var(--_keycap-gap);
  margin: 0;
  padding: 0;
  /* For the alignment of the text on some modifiers (e.g. shift) */
  /* Extra spacing between two adjacent keys */
}
.MLK__rows > .MLK__row .tex {
  font-family: KaTeX_Math, KaTeX_Main, 'Cambria Math', 'Asana Math', OpenSymbol, Symbola, STIX, Times, serif !important;
}
.MLK__rows > .MLK__row .tex-math {
  font-family: KaTeX_Math, 'Cambria Math', 'Asana Math', OpenSymbol, Symbola, STIX, Times, serif !important;
}
.MLK__rows > .MLK__row .big-op {
  font-size: calc(1.25 * var(--_keycap-font-size));
}
.MLK__rows > .MLK__row .small {
  font-size: var(--_keycap-small-font-size);
}
.MLK__rows > .MLK__row .bottom {
  justify-content: flex-end;
}
.MLK__rows > .MLK__row .left {
  align-items: flex-start;
  padding-left: 12px;
}
.MLK__rows > .MLK__row .right {
  align-items: flex-end;
  padding-right: 12px;
}
.MLK__rows > .MLK__row .w0 {
  width: 0;
}
.MLK__rows > .MLK__row .w5 {
  width: calc(0.5 * var(--_keycap-width) - var(--_keycap-gap));
}
.MLK__rows > .MLK__row .w15 {
  width: calc(1.5 * var(--_keycap-width) - var(--_keycap-gap));
}
.MLK__rows > .MLK__row .w20 {
  width: calc(2 * var(--_keycap-width) - var(--_keycap-gap));
}
.MLK__rows > .MLK__row .w40 {
  width: calc(4 * var(--_keycap-width) - var(--_keycap-gap));
}
.MLK__rows > .MLK__row .w50 {
  width: calc(5 * var(--_keycap-width) - var(--_keycap-gap));
}
.MLK__rows > .MLK__row .MLK__keycap.w50 {
  font-size: 80%;
  padding-top: 10px;
  font-weight: 100;
}
.MLK__rows > .MLK__row .separator {
  background: transparent;
  border: none;
  pointer-events: none;
}
.MLK__rows > .MLK__row .horizontal-rule {
  height: 6px;
  margin-top: 3px;
  margin-bottom: 0;
  width: 100%;
  border-radius: 0;
  border-top: var(--_horizontal-rule);
}
.MLK__rows > .MLK__row .ghost {
  background: var(--_toolbar-background);
  border: none;
  color: var(--_toolbar-text);
}
.MLK__rows > .MLK__row .ghost:hover {
  background: var(--_toolbar-background-hover);
}
.MLK__rows > .MLK__row .bigfnbutton {
  font-size: var(--_keycap-extra-small-font-size);
}
.MLK__rows > .MLK__row .shift,
.MLK__rows > .MLK__row .action {
  color: var(--_keycap-secondary-text);
  background: var(--_keycap-secondary-background);
  border-color: var(--_keycap-secondary-border);
  border-bottom-color: var(--_keycap-secondary-border-bottom);
  line-height: 0.8;
  font-size: min(1rem, var(--_keycap-small-font-size));
  font-weight: 600;
  padding: 8px 12px 8px 12px;
}
.MLK__rows > .MLK__row .shift:hover,
.MLK__rows > .MLK__row .action:hover {
  background: var(--_keycap-secondary-background-hover);
}
.MLK__rows > .MLK__row .action.primary {
  background: var(--_keycap-primary-background);
  color: var(--_keycap-primary-text);
}
.MLK__rows > .MLK__row .action.primary:hover {
  background: var(--_keycap-primary-background-hover);
  color: var(--_keycap-primary-text);
}
.MLK__rows > .MLK__row .shift.selected,
.MLK__rows > .MLK__row .action.selected {
  color: var(--_toolbar-text-active);
}
.MLK__rows > .MLK__row .shift.selected.is-pressed,
.MLK__rows > .MLK__row .action.selected.is-pressed,
.MLK__rows > .MLK__row .shift.selected.is-active,
.MLK__rows > .MLK__row .action.selected.is-active {
  color: white;
}
.MLK__rows > .MLK__row .warning {
  background: #cd0030;
  color: white;
}
.MLK__rows > .MLK__row .warning svg.svg-glyph {
  width: var(--_keycap-glyph-size-lg);
  height: var(--_keycap-glyph-size-lg);
  min-height: var(--_keycap-glyph-size-lg);
}
/** A regular keycap
 * Use the :where() pseudo-class to give it a very low specifity, 
 * so that it can be overriden by custom style.
 */
:where(.MLK__rows > .MLK__row div) {
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: space-evenly;
  width: calc(var(--_keycap-width) - var(--_keycap-gap));
  height: var(--_keycap-height);
  box-sizing: border-box;
  padding: 0;
  vertical-align: top;
  text-align: center;
  float: left;
  color: var(--_keycap-text);
  fill: currentColor;
  font-size: var(--_keycap-font-size);
  background: var(--_keycap-background);
  border: 1px solid var(--_keycap-border);
  border-bottom-color: var(--_keycap-border-bottom);
  border-radius: 6px;
  cursor: pointer;
  touch-action: none;
  /* Keys with a variants panel */
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}
:where(.MLK__rows > .MLK__row div):hover {
  overflow: visible;
  background: var(--_keycap-background-hover);
  color: var(--_keycap-text-hover);
}
:where(.MLK__rows > .MLK__row div) .ML__latex {
  pointer-events: none;
  touch-action: none;
}
:where(.MLK__rows > .MLK__row div) svg.svg-glyph {
  margin: 8px 0;
  width: var(--_keycap-glyph-size);
  height: var(--_keycap-glyph-size);
  min-height: var(--_keycap-glyph-size);
}
:where(.MLK__rows > .MLK__row div) svg.svg-glyph-lg {
  margin: 8px 0;
  width: var(--_keycap-glyph-size-lg);
  height: var(--_keycap-glyph-size-lg);
  min-height: var(--_keycap-glyph-size-lg);
}
:where(.MLK__rows > .MLK__row div).MLK__tex-math {
  font-size: 25px;
}
:where(.MLK__rows > .MLK__row div).is-pressed {
  background: var(--_keycap-background-pressed);
  color: var(--_keycap-text-pressed);
  --_box-placeholder-color: var(--_box-placeholder-pressed-color);
}
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-active,
:where(.MLK__rows > .MLK__row div).action.is-active,
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-pressed,
:where(.MLK__rows > .MLK__row div).action.is-pressed {
  z-index: calc(var(--_keyboard-zindex) - 5);
}
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-active aside,
:where(.MLK__rows > .MLK__row div).action.is-active aside,
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-pressed aside,
:where(.MLK__rows > .MLK__row div).action.is-pressed aside {
  display: none;
}
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-active .MLK__shift,
:where(.MLK__rows > .MLK__row div).action.is-active .MLK__shift,
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-pressed .MLK__shift,
:where(.MLK__rows > .MLK__row div).action.is-pressed .MLK__shift {
  display: none;
}
:where(.MLK__rows > .MLK__row div).shift.is-pressed,
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-pressed,
:where(.MLK__rows > .MLK__row div).action.is-pressed {
  background: var(--_keycap-background-pressed);
  color: var(--_keycap-text-pressed);
}
:where(.MLK__rows > .MLK__row div).shift.is-active,
:where(.MLK__rows > .MLK__row div).MLK__keycap.is-active,
:where(.MLK__rows > .MLK__row div).action.is-active {
  background: var(--_keycap-background-active);
  color: var(--_keycap-text-active);
  --_box-placeholder-color: var(--_box-placeholder-pressed-color);
}
:where(.MLK__rows > .MLK__row div) small {
  color: var(--_keycap-secondary-text);
}
:where(.MLK__rows > .MLK__row div) aside {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-size: 10px;
  line-height: 10px;
  color: var(--_keycap-secondary-text);
}
/* Add an attribute 'data-tooltip' to display a tooltip on hover.
Note there are a different set of tooltip rules for the keyboard toggle
(it's in a different CSS tree) */
.ML__keyboard [data-tooltip] {
  position: relative;
}
.ML__keyboard [data-tooltip]::after {
  position: absolute;
  display: inline-table;
  content: attr(data-tooltip);
  top: inherit;
  bottom: 100%;
  width: max-content;
  max-width: 200px;
  padding: 8px 8px;
  background: #616161;
  color: #fff;
  text-align: center;
  z-index: 2;
  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
  border-radius: 2px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-weight: 400;
  font-size: 12px;
  transition: all 0.15s cubic-bezier(0.4, 0, 1, 1) 1s;
  opacity: 0;
  transform: scale(0.5);
}
.ML__keyboard [data-tooltip]:hover {
  position: relative;
}
.ML__keyboard [data-tooltip]:hover::after {
  opacity: 1;
  transform: scale(1);
}
.MLK__toolbar {
  align-self: center;
  display: flex;
  flex-flow: row;
  justify-content: space-between;
  width: 100%;
  max-width: 996px;
  min-height: 32px;
  /* Icons for undo/redo, etc. */
}
.MLK__toolbar svg {
  height: 20px;
  width: 20px;
}
.MLK__toolbar > .left {
  position: relative;
  display: flex;
  justify-content: flex-start;
  flex-flow: row;
}
.MLK__toolbar > .right {
  display: flex;
  justify-content: flex-end;
  flex-flow: row;
}
.MLK__toolbar > div > div {
  /* "button" in the toolbar */
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--_toolbar-text);
  fill: currentColor;
  background: var(--_toolbar-background);
  font-size: var(--_toolbar-font-size);
  padding: 4px 15px;
  cursor: pointer;
  width: max-content;
  min-width: 42px;
  min-height: 34px;
  border: none;
  padding-left: 10px;
  padding-right: 10px;
  padding-bottom: 8px;
  padding-top: 8px;
  margin-top: 0;
  margin-bottom: 4px;
  margin-left: 4px;
  margin-right: 4px;
  border-radius: 8px;
  box-shadow: none;
  border-bottom: 2px solid transparent;
}
.MLK__toolbar > div > div:not(.disabled):not(.selected):hover {
  background: var(--_toolbar-background-hover);
}
.MLK__toolbar > div > div.disabled svg,
.MLK__toolbar > div > div.disabled:hover svg,
.MLK__toolbar > div > div.disabled.is-pressed svg {
  color: var(--_toolbar-text);
  opacity: 0.2;
}
.MLK__toolbar > div > div:hover,
.MLK__toolbar > div > div:active,
.MLK__toolbar > div > div.is-pressed,
.MLK__toolbar > div > div.is-active {
  color: var(--_toolbar-text-active);
}
.MLK__toolbar > div > div.selected {
  color: var(--_toolbar-text-active);
  background: var(--_toolbar-background-selected);
  border-radius: 0;
  border-bottom-color: var(--_toolbar-text-active);
  padding-bottom: 4px;
  margin-bottom: 8px;
}
/* This is the element that displays variants on press+hold */
.MLK__variant-panel {
  visibility: hidden;
  position: fixed;
  display: flex;
  flex-flow: row wrap-reverse;
  justify-content: center;
  align-content: center;
  margin: 0;
  padding: 0;
  bottom: auto;
  top: 0;
  box-sizing: content-box;
  transform: none;
  z-index: calc(var(--_keyboard-zindex) + 1);
  touch-action: none;
  max-width: 350px;
  background: var(--_variant-panel-background);
  text-align: center;
  border-radius: 6px;
  padding: 6px;
  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
  transition: none;
}
.MLK__variant-panel.is-visible {
  visibility: visible;
}
.MLK__variant-panel.compact {
  --_variant-keycap-length: var(--variant-keycap-length, 50px);
  --_variant-keycap-font-size: var(--variant-keycap-font-size, 24px);
  --_variant-keycap-aside-font-size: var(--variant-keycap-aside-font-size, 10px);
}
.MLK__variant-panel .item {
  display: flex;
  flex-flow: column;
  align-items: center;
  justify-content: center;
  font-size: var(--_variant-keycap-font-size);
  height: var(--_variant-keycap-length);
  width: var(--_variant-keycap-length);
  margin: 0;
  box-sizing: border-box;
  border-radius: 5px;
  border: 1px solid transparent;
  background: transparent;
  pointer-events: all;
  cursor: pointer;
  color: var(--_variant-keycap-text);
  fill: currentColor;
}
@media (max-height: 412px) {
  .MLK__variant-panel .item {
    --_variant-keycap-font-size: var(--variant-keycap-font-size, 24px);
    --_variant-keycap-length: var(--variant-keycap-length, 50px);
  }
}
.MLK__variant-panel .item .ML__latex {
  pointer-events: none;
}
.MLK__variant-panel .item:hover {
  color: var(--_keycap-text-hover);
}
.MLK__variant-panel .item.is-active {
  background: var(--_variant-keycap-background-active);
  color: var(--_variant-keycap-text-active);
  --_box-placeholder-color: var(--_box-placeholder-pressed-color);
}
.MLK__variant-panel .item.is-pressed {
  background: var(--_variant-keycap-background-pressed);
  color: var(--_variant-keycap-text-pressed);
  --_box-placeholder-color: var(--_box-placeholder-pressed-color);
}
.MLK__variant-panel .item.small {
  font-size: var(--_keycap-small-font-size);
}
.MLK__variant-panel .item.swatch-button {
  box-sizing: border-box;
  background: #fbfbfb;
}
.MLK__variant-panel .item.swatch-button > span {
  display: inline-block;
  margin: 6px;
  width: calc(100% - 12px);
  height: calc(100% - 12px);
  border-radius: 50%;
}
.MLK__variant-panel .item.swatch-button:hover {
  background: #f0f0f0;
}
.MLK__variant-panel .item.swatch-button:hover > span {
  border-radius: 2px;
}
.MLK__variant-panel .item.box > div,
.MLK__variant-panel .item.box > span {
  border: 1px dashed rgba(0, 0, 0, 0.24);
}
.MLK__variant-panel .item .warning {
  min-height: 60px;
  min-width: 60px;
  background: #cd0030;
  color: white;
  padding: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 5px;
}
.MLK__variant-panel .item .warning.is-pressed,
.MLK__variant-panel .item .warning.is-active {
  background: red;
}
.MLK__variant-panel .item .warning svg.svg-glyph {
  width: var(--_keycap-glyph-size-xl);
  height: var(--_keycap-glyph-size-xl);
}
.MLK__variant-panel .item aside {
  font-size: var(--_variant-keycap-aside-font-size);
  line-height: 12px;
  opacity: 0.78;
  padding-top: 2px;
  width: 100%;
  text-align: center;
  text-wrap: wrap;
}
.MLK__keycap {
  position: relative;
}
.MLK__shift {
  display: block;
  position: absolute;
  right: 4px;
  top: 4px;
  font-size: var(--_keycap-shift-font-size);
  color: var(--_keycap-shift-color);
}
.hide-shift .MLK__shift {
  display: none;
}
@media (max-width: 414px) {
  .MLK__variant-panel {
    max-width: 350px;
    --_variant-keycap-font-size: var(--variant-keycap-font-size, 24px);
    --_variant-keycap-length: var(--variant-keycap-length, 50px);
  }
}
/* @xs breakpoint: iPhone 5 */
@container (max-width: 414px) {
  .MLK__rows {
    --_keycap-gap: max(var(--_keycap-gap, 2px), 2px);
    --_keycap-height: var(--keycap-height, 42px);
    --_keycap-width: var(--keycap-width, min(min(var(--_keycap-max-width)), 10cqw), 62px));
  }
  .MLK__toolbar > div > div {
    font-size: 100%;
    margin-left: 2px;
    margin-right: 2px;
  }
  .MLK__rows .shift,
  .MLK__rows .action {
    font-size: 65%;
  }
  .MLK__rows .warning svg.svg-glyph {
    width: 14px;
    height: 14px;
    min-height: 14px;
  }
}
@container (max-width: 744px) {
  .MLK__rows {
    --_keycap-gap: max(var(--keycap-gap, 2px), 2px);
    --_keycap-height: var(--keycap-height, 52px);
    --_keycap-width: var(--keycap-width, min(min(var(--_keycap-max-width), 10cqw), 62px));
  }
  .MLK__toolbar > div > div {
    padding-left: 0;
    padding-right: 0;
  }
  .MLK__tooltip::after {
    padding: 8px 16px;
    font-size: 16px;
  }
  .MLK__rows > .MLK__row > div.fnbutton {
    font-size: 16px;
  }
  .MLK__rows > .MLK__row > div.bigfnbutton {
    font-size: calc(var(--_keycap-extra-small-font-size) / 1.55);
  }
  .MLK__rows > .MLK__row > div.small {
    font-size: 13px;
  }
  .MLK__rows > .MLK__row > div > aside {
    display: none;
  }
  .MLK__shift {
    display: none;
  }
}
/* Medium breakpoint: larger phones */
@container (max-width: 768px) {
  .MLK__rows {
    --_keycap-height: var(--keycap-height, 42px);
  }
  .MLK__rows > .MLK__row > div > small {
    font-size: 14px;
  }
}
@media (max-height: 768px) {
  .MLK__rows {
    --_keycap-height: var(--keycap-height, 42px);
  }
  .MLK__rows > .MLK__row > div > small {
    font-size: 14px;
  }
}
@container (max-width: 1444px) {
  .MLK__rows .if-wide {
    display: none;
  }
}
@media (prefers-color-scheme: dark) {
  .ML__keyboard {
    --_accent-color: var(--keyboard-accent-color, #0b5c9c);
    --_background: var(--keyboard-background, #151515);
    --_border: var(--keyboard-border, transparent);
    --_toolbar-text: var(--keyboard-toolbar-text, #e3e4e8);
    --_toolbar-background-hover: var(--keyboard-toolbar-background-hover, #303030);
    --keyboard-toolbar-background-hover: #303030;
    --_horizontal-rule: var(--keyboard-horizontal-rule, 1px solid #303030);
    --_keycap-background: var(--keycap-background, #1f2022);
    --_keycap-background-hover: var(--keycap-background-hover, #2f3032);
    --_keycap-border: var(--_keycap-border, transparent);
    --_keycap-border-bottom: var(--_keycap-border-bottom, transparent);
    --_keycap-text: var(--keycap-text, #e3e4e8);
    --_keycap-secondary-background: var(--keycap-secondary-background, #3d4144);
    --_keycap-secondary-background-hover: var(--keycap-secondary-background-hover, #4d5154);
    --_keycap-secondary-text: var(--keycap-secondary-text, #e7ebee);
    --keycap-secondary-border: transparent;
    --keycap-secondary-border-bottom: transparent;
    --_keycap-secondary-border: var(--keycap-secondary-border, transparent);
    --_keycap-secondary-border-bottom: var(--keycap-secondary-border-bottom, transparent);
    --_variant-panel-background: var(--variant-panel-background, #303030);
    --_variant-keycap-text-active: var(--variant-keycap-text-active, #fff);
  }
}
/* Same as the media query, but with a class */
[theme='dark'] .ML__keyboard {
  --_accent-color: var(--keyboard-accent-color, #0b5c9c);
  --_background: var(--keyboard-background, #151515);
  --_border: var(--keyboard-border, transparent);
  --_toolbar-text: var(--keyboard-toolbar-text, #e3e4e8);
  --_toolbar-background-hover: var(--keyboard-toolbar-background-hover, #303030);
  --keyboard-toolbar-background-hover: #303030;
  --_horizontal-rule: var(--keyboard-horizontal-rule, 1px solid #303030);
  --_keycap-background: var(--keycap-background, #1f2022);
  --_keycap-background-hover: var(--keycap-background-hover, #2f3032);
  --_keycap-border: var(--_keycap-border, transparent);
  --_keycap-border-bottom: var(--_keycap-border-bottom, transparent);
  --_keycap-text: var(--keycap-text, #e3e4e8);
  --_keycap-secondary-background: var(--keycap-secondary-background, #3d4144);
  --_keycap-secondary-background-hover: var(--keycap-secondary-background-hover, #4d5154);
  --_keycap-secondary-text: var(--keycap-secondary-text, #e7ebee);
  --keycap-secondary-border: transparent;
  --keycap-secondary-border-bottom: transparent;
  --_keycap-secondary-border: var(--keycap-secondary-border, transparent);
  --_keycap-secondary-border-bottom: var(--keycap-secondary-border-bottom, transparent);
  --_variant-panel-background: var(--variant-panel-background, #303030);
  --_variant-keycap-text-active: var(--variant-keycap-text-active, #fff);
}
[theme='light'] .ML__keyboard {
  --_accent-color: var(--keyboard-accent-color, #0c75d8);
  --_background: var(--keyboard-background, #cacfd7);
  --_border: var(--keyboard-border, #ddd);
  --_toolbar-text: var(--keyboard-toolbar-text, #2c2e2f);
  --_toolbar-background: var(--keyboard-toolbar-background, transparent);
  --_toolbar-background-hover: var(--keyboard-toolbar-background-hover, #eee);
  --_toolbar-background-selected: var(--keyboard-toolbar-background-selected, transparent);
  --_horizontal-rule: var(--keyboard-horizontal-rule, 1px solid #fff);
  --_keycap-background: var(--keycap-background, white);
  --_keycap-background-hover: var(--keycap-background-hover, #f5f5f7);
  --_keycap-background-active: var(--keycap-background-active, var(--_accent-color));
  --_keycap-background-pressed: var(--keycap-background-pressed, var(--_accent-color));
  --_keycap-border: var(--_keycap-border, #e5e6e9);
  --_keycap-border-bottom: var(--_keycap-border-bottom, #8d8f92);
  --_keycap-text: var(--keycap-text, #000);
  --_keycap-text-active: var(--keycap-text-active, #fff);
  --_keycap-text-hover: var(--keycap-text-hover, var(--_keycap-text));
  --_keycap-text-pressed: var(--keycap-text-pressed, #fff);
  --_keycap-shift-text: var(--keycap-shift-text, var(--_accent-color));
  --_keycap-secondary-background: var(--keycap-secondary-background, #a0a9b8);
  --_keycap-secondary-background-hover: var(--keycap-secondary-background-hover, #7d8795);
  --_keycap-secondary-text: var(--keycap-secondary-text, #060707);
  --_keycap-secondary-border: var(--keycap-secondary-border, #c5c9d0);
  --_keycap-secondary-border-bottom: var(--keycap-secondary-border-bottom, #989da6);
  --_variant-panel-background: var(--variant-panel-background, #f0f0f0);
  --_variant-keycap-text: var(--variant-keycap-textvar, var(--_keycap-text));
  --_variant-keycap-text-active: var(--variant-keycap-text-active, var(--_keycap-text-active));
  --_variant-keycap-background-active: var(--variant-keycap-background-active, var(--_accent-color));
}
`,WC=`:host {
  --primary-color: #5898ff;
  --primary-color-dimmed: #c0c0f0;
  --primary-color-dark: var(--blue-500);
  --primary-color-light: var(--blue-100);
  --primary-color-reverse: #ffffff;
  --secondary-color: #ff8a65;
  --secondary-color-dimmed: #f0d5c5;
  --secondary-color-dark: var(--orange-500);
  --secondary-color-light: var(--orange-100);
  --secondary-color-reverse: #ffffff;
  --link-color: #5898ff;
  --link-color-dimmed: #c5c5c5;
  --link-color-dark: #121212;
  --link-color-light: #e2e2e2;
  --link-color-reverse: #ffffff;
  --semantic-blue: var(--blue-700);
  --semantic-red: var(--red-400);
  --semantic-orange: var(--orange-400);
  --semantic-green: var(--green-700);
  --neutral-100: #f5f5f5;
  --neutral-200: #eeeeee;
  --neutral-300: #e0e0e0;
  --neutral-400: #bdbdbd;
  --neutral-500: #9e9e9e;
  --neutral-600: #757575;
  --neutral-700: #616161;
  --neutral-800: #424242;
  --neutral-900: #212121;
  --red-25: #fff8f7;
  --red-50: #fff1ef;
  --red-100: #ffeae6;
  --red-200: #ffcac1;
  --red-300: #ffa495;
  --red-400: #ff7865;
  --red-500: #f21c0d;
  --red-600: #e50018;
  --red-700: #d30024;
  --red-800: #bd002c;
  --red-900: #a1002f;
  --orange-25: #fffbf8;
  --orange-50: #fff7f1;
  --orange-100: #fff3ea;
  --orange-200: #ffe1c9;
  --orange-300: #ffcca2;
  --orange-400: #ffb677;
  --orange-500: #fe9310;
  --orange-600: #f58700;
  --orange-700: #ea7c00;
  --orange-800: #dc6d00;
  --orange-900: #ca5b00;
  --brown-25: #fff8ef;
  --brown-50: #fff1df;
  --brown-100: #ffe9ce;
  --brown-200: #ebcca6;
  --brown-300: #cdaf8a;
  --brown-400: #af936f;
  --brown-500: #856a47;
  --brown-600: #7f5e34;
  --brown-700: #78511f;
  --brown-800: #6e4200;
  --brown-900: #593200;
  --yellow-25: #fffdf9;
  --yellow-50: #fffcf2;
  --yellow-100: #fffaec;
  --yellow-200: #fff2ce;
  --yellow-300: #ffe8ab;
  --yellow-400: #ffdf85;
  --yellow-500: #ffcf33;
  --yellow-600: #f1c000;
  --yellow-700: #dfb200;
  --yellow-800: #c9a000;
  --yellow-900: #ad8a00;
  --lime-25: #f4ffee;
  --lime-50: #e9ffdd;
  --lime-100: #ddffca;
  --lime-200: #a8fb6f;
  --lime-300: #94e659;
  --lime-400: #80d142;
  --lime-500: #63b215;
  --lime-600: #45a000;
  --lime-700: #268e00;
  --lime-800: #007417;
  --lime-900: #005321;
  --green-25: #f5fff5;
  --green-50: #ebffea;
  --green-100: #e0ffdf;
  --green-200: #a7ffa7;
  --green-300: #5afa65;
  --green-400: #45e953;
  --green-500: #17cf36;
  --green-600: #00b944;
  --green-700: #00a34a;
  --green-800: #008749;
  --green-900: #00653e;
  --teal-25: #f3ffff;
  --teal-50: #e6fffe;
  --teal-100: #d9fffe;
  --teal-200: #8dfffe;
  --teal-300: #57f4f4;
  --teal-400: #43e5e5;
  --teal-500: #17cfcf;
  --teal-600: #00c2c0;
  --teal-700: #00b5b1;
  --teal-800: #00a49e;
  --teal-900: #009087;
  --cyan-25: #f7fcff;
  --cyan-50: #eff8ff;
  --cyan-100: #e7f5ff;
  --cyan-200: #c2e6ff;
  --cyan-300: #95d5ff;
  --cyan-400: #61c4ff;
  --cyan-500: #13a7ec;
  --cyan-600: #069eda;
  --cyan-700: #0095c9;
  --cyan-800: #0088b2;
  --cyan-900: #0a7897;
  --blue-25: #f7faff;
  --blue-50: #eef5ff;
  --blue-100: #e5f1ff;
  --blue-200: #bfdbff;
  --blue-300: #92c2ff;
  --blue-400: #63a8ff;
  --blue-500: #0d80f2;
  --blue-600: #0077db;
  --blue-700: #006dc4;
  --blue-800: #0060a7;
  --blue-900: #005086;
  --indigo-25: #f8f7ff;
  --indigo-50: #f1efff;
  --indigo-100: #eae7ff;
  --indigo-200: #ccc3ff;
  --indigo-300: #ac99ff;
  --indigo-400: #916aff;
  --indigo-500: #63c;
  --indigo-600: #5a21b2;
  --indigo-700: #4e0b99;
  --indigo-800: #3b0071;
  --indigo-900: #220040;
  --purple-25: #fbf7ff;
  --purple-50: #f8f0ff;
  --purple-100: #f4e8ff;
  --purple-200: #e4c4ff;
  --purple-300: #d49aff;
  --purple-400: #c36aff;
  --purple-500: #a219e6;
  --purple-600: #9000c4;
  --purple-700: #7c009f;
  --purple-800: #600073;
  --purple-900: #3d0043;
  --magenta-25: #fff8fb;
  --magenta-50: #fff2f6;
  --magenta-100: #ffebf2;
  --magenta-200: #ffcddf;
  --magenta-300: #ffa8cb;
  --magenta-400: #ff7fb7;
  --magenta-500: #eb4799;
  --magenta-600: #da3689;
  --magenta-700: #c82179;
  --magenta-800: #b00065;
  --magenta-900: #8a004c;
}
@media (prefers-color-scheme: dark) {
  :host {
    --semantic-blue: var(--blue-700);
    --semantic-red: var(--red-400);
    --semantic-orange: var(--orange-400);
    --semantic-green: var(--green-700);
    --semantic-bg-blue: var(--blue-25);
    --semantic-bg-red: var(--red-25);
    --semantic-bg-orange: var(--orange-25);
    --semantic-bg-green: var(--green-25);
    --neutral-100: #121212;
    --neutral-200: #424242;
    --neutral-300: #616161;
    --neutral-400: #757575;
    --neutral-500: #9e9e9e;
    --neutral-600: #bdbdbd;
    --neutral-700: #e0e0e0;
    --neutral-800: #eeeeee;
    --neutral-900: #f5f5f5;
  }
}
:host([theme='dark']) {
  --semantic-blue: var(--blue-700);
  --semantic-red: var(--red-400);
  --semantic-orange: var(--orange-400);
  --semantic-green: var(--green-700);
  --semantic-bg-blue: var(--blue-25);
  --semantic-bg-red: var(--red-25);
  --semantic-bg-orange: var(--orange-25);
  --semantic-bg-green: var(--green-25);
  --neutral-100: #121212;
  --neutral-200: #424242;
  --neutral-300: #616161;
  --neutral-400: #757575;
  --neutral-500: #9e9e9e;
  --neutral-600: #bdbdbd;
  --neutral-700: #e0e0e0;
  --neutral-800: #eeeeee;
  --neutral-900: #f5f5f5;
}
/* @media (prefers-color-scheme: dark) {
  :host {
      --label-color: #fff;
      --active-label-color: #000;
      --menu-bg: #525252;
      --active-bg: #5898ff;
      --active-bg-dimmed: #5c5c5c;
  }
} */
:host {
  --ui-font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
  --ui-font-size: 14px;
  --ui-line-height: 1.5;
  --ui-letter-spacing: 0.007em;
  --mono-font-family: 'Berkeley Mono', 'JetBrains Mono', 'IBM Plex Mono', 'Source Code Pro', Menlo, Monaco, 'Courier New', monospace;
  --ui-layer-1: var(--neutral-100);
  --ui-layer-2: var(--neutral-200);
  --ui-layer-3: var(--neutral-300);
  --ui-layer-4: var(--neutral-400);
  --ui-layer-5: var(--neutral-500);
  --ui-layer-6: var(--neutral-600);
  --ui-border-color: var(--primary-color);
  --ui-border-radius: 4px;
  --ui-text: var(--neutral-900);
  --ui-text-secondary: var(--neutral-700);
  --ui-text-placeholder: var(--neutral-500);
  --ui-text-muted: var(--neutral-300);
  /** A field is a UI element in which a user can type data, for
  * example an input or textarea element.
  */
  --ui-field-bg: var(--neutral-100);
  --ui-field-bg-hover: var(--neutral-100);
  --ui-field-bg-disabled: var(--neutral-300);
  --ui-field-bg-invalid: var(--red-100);
  --ui-field-bg-focus: var(--neutral-100);
  --ui-field-border: 0.5px solid var(--border-color);
  --ui-field-border-hover: 0.5px solid var(--border-color);
  --ui-field-border-disabled: 0.5px solid var(--border-color);
  --ui-field-border-invalid: 0.5px solid var(--border-color);
  --ui-field-border-focus: 0.5px solid var(--border-color);
  --ui-menu-bg: var(--neutral-100);
  --ui-menu-text: var(--neutral-900);
  --ui-menu-bg-hover: var(--neutral-200);
  --ui-menu-text-hover: var(--neutral-900);
  /** The \`active\` state is used for the state of menu items
  * when they are selected.
  */
  --ui-menu-bg-active: var(--primary-color);
  --ui-menu-text-active: var(--primary-color-reverse);
  /** The \`active-muted\` set is used for the state of
  * submenus when they are open.
  */
  --ui-menu-bg-active-muted: var(--neutral-300);
  --ui-menu-text-active-muted: var(--neutral-900);
  /* --ui-menu-shadow: 0 1px 2px 0 rgba(60, 64, 67, 0.302),
0 2px 6px 2px rgba(60, 64, 67, 0.149); */
  --ui-menu-shadow: 0 0 2px rgba(0, 0, 0, 0.5), 0 0 20px rgba(0, 0, 0, 0.2);
  --ui-menu-divider: 0.5px solid #c7c7c7;
  /* var(--neutral-300); */
  --ui-menu-z-index: 10000;
  --page-bg: var(--neutral-100);
  --content-bg: var(--neutral-200);
}
@media (prefers-color-scheme: dark) {
  :host {
    --ui-menu-bg: var(--neutral-200);
  }
}
:host([theme='dark']) {
  --ui-menu-bg: var(--neutral-200);
}
/* PingFang SC is a macOS font. Microsoft Yahei is a Windows font. 
  Noto  is a Linux/Android font.
*/
:lang(zh-cn),
:lang(zh-sg),
:lang(zh-my),
:lang(zh) {
  --ui-font-family: -apple-system, system-ui, 'PingFang SC', 'Hiragino Sans GB', 'Noto Sans CJK SC', 'Noto Sans SC', 'Noto Sans', 'Microsoft Yahei UI', 'Microsoft YaHei New', 'Microsoft Yahei', '', SimSun, '', STXihei, '', sans-serif;
}
:lang(zh-tw),
:lang(zh-hk),
:lang(zh-mo) {
  --ui-font-family: -apple-system, system-ui, 'Noto Sans', 'Microsoft JhengHei UI', 'Microsoft JhengHei', '', '', 'PMingLiU', '', 'MingLiU', sans-serif;
}
:lang(ja),
:lang(ja-jp),
:lang(ja-jp-mac) {
  --ui-font-family: -apple-system, system-ui, 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans CJK JP', 'Noto Sans JP', 'Noto Sans', '', '', YuGothic, 'Yu Gothic', '', Meiryo, ' ', 'MS PGothic', sans-serif;
}
:lang(ko),
:lang(ko-kr),
:lang(ko-kr-std) {
  --ui-font-family: -apple-system, system-ui, 'Noto Sans CJK KR', 'Noto Sans KR', 'Noto Sans', 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', ' SD  Neo', 'Apple SD  Neo', '', Dotum, sans-serif;
}
:lang(ko-kr-apple) {
  --ui-font-family: -apple-system, system-ui, 'Noto Sans CJK KR', 'Noto Sans KR', 'Noto Sans', 'Apple SD Gothic Neo', ' SD  Neo', 'Apple SD  Neo', '', Dotum, sans-serif;
}
:lang(zh-cn),
:lang(zh-sg),
:lang(zh-my),
:lang(zh),
:lang(zh-tw),
:lang(zh-hk),
:lang(zh-mo),
:lang(ja),
:lang(ja-jp),
:lang(ja-jp-mac),
:lang(ko),
:lang(ko-kr),
:lang(ko-kr-std),
:lang(ko-kr-apple) {
  --ui-font-size: 1rem;
  --ui-line-height: 1.7;
  --ui-letter-spacing: 0;
}
:dir(rtl) {
  --ui-line-height: auto;
  --ui-letter-spacing: 0;
}
`,UC=`.ui-menu *,
.ui-menu ::before,
.ui-menu ::after {
  box-sizing: border-box;
}
.ui-menu {
  display: none;
  color-scheme: light dark;
  -webkit-user-select: none;
  /* Important: Safari iOS doesn't respect user-select */
  user-select: none;
  cursor: default;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: rgba(0 0 0 0);
  --active-label-color: #fff;
  /* ui-menu-text-active */
  --label-color: #121212;
  /* ui-menu-text */
  --menu-bg: #e2e2e2;
  /* ui-menu-background */
  --active-bg: #5898ff;
  /* ui-menu-background-active */
  --active-bg-dimmed: #c5c5c5;
  /* ui-menu-background-active-muted */
}
/** Use the :where pseudo selector to make the specificity of the
 * selector 0, so that it can be overridden by the user.
 */
:where(.ui-menu-container) {
  position: absolute;
  overflow: visible;
  width: auto;
  height: auto;
  z-index: 10000;
  border-radius: 8px;
  background: var(--ui-menu-bg);
  box-shadow: var(--ui-menu-shadow);
  list-style: none;
  padding: 6px 0 6px 0;
  margin: 0;
  user-select: none;
  cursor: default;
  color: var(--ui-menu-text);
  font-weight: normal;
  font-style: normal;
  text-shadow: none;
  text-transform: none;
  letter-spacing: 0;
  outline: none;
  opacity: 1;
  /* The [popover] elements have a 1px solid black border. Ugh. */
  border: none;
  width: fit-content;
  height: fit-content;
}
:where(.ui-menu-container > li) {
  display: flex;
  flex-flow: row;
  align-items: center;
  padding: 1px 7px 1px 7px;
  margin-top: 0;
  margin-left: 6px;
  margin-right: 6px;
  border-radius: 4px;
  white-space: nowrap;
  position: relative;
  outline: none;
  fill: currentColor;
  user-select: none;
  cursor: default;
  text-align: left;
  color: inherit;
  font-family: var(--ui-font-family);
  font-size: var(--ui-font-size);
  line-height: var(--ui-line-height);
  letter-spacing: var(--ui-letter-spacing);
}
:where(.ui-menu-container > li > .label) {
  display: flex;
  align-items: center;
  justify-content: space-between;
  appearance: none;
  background: none;
  outline: none;
  width: 100%;
  margin: 0;
  padding: 1px 2px 1px 1px;
  overflow: visible;
  border: 1px solid transparent;
  white-space: nowrap;
  text-align: start;
  align-content: center;
}
:where(.ui-menu-container > li:has(.heading)) {
  margin-top: 0.5em;
}
:where(.ui-menu-container > li > .label.heading) {
  font-weight: bold;
  opacity: 0.4;
}
:where(.ui-menu-container > li.indent > .label) {
  margin-inline-start: 12px;
}
:where(.ui-menu-container > li > .label.indent) {
  margin-inline-start: 12px;
}
:where(.ui-menu-container > li[role='divider']) {
  border-bottom: 1px solid var(--ui-menu-divider);
  border-radius: 0;
  padding: 0;
  margin-left: 15px;
  margin-right: 15px;
  padding-top: 5px;
  margin-bottom: 5px;
  width: calc(100% - 30px);
  /** 100% - (margin-left + margin-right) */
}
:where(.ui-menu-container > li[aria-disabled='true']) {
  opacity: 0.5;
}
:where(.ui-menu-container > li.active) {
  background: var(--ui-menu-bg-active);
  background: -apple-system-control-accent;
  color: var(--ui-menu-text-active);
}
:where(.ui-menu-container > li.active.is-submenu-open) {
  background: var(--ui-menu-bg-active-muted);
  color: inherit;
}
:where(.ui-menu-container > li[aria-haspopup='true'] > .label) {
  padding-inline-end: 0;
}
:where(.ui-menu-container > li[aria-haspopup='true'].active::after) {
  color: var(--ui-menu-text-active);
}
/** Keyboard shortcut */
:where(.ui-menu-container > li > kbd) {
  font-family: var(--ui-font-family);
  margin-inline-start: 12px;
  opacity: 0.4;
}
:where(.ui-menu-container > li.active > kbd) {
  opacity: 0.85;
}
.ui-trailing-chevron {
  display: flex;
  margin-inline-start: 24px;
  width: 10px;
  height: 10px;
  margin-bottom: 4px;
}
.ui-trailing-chevron:dir(rtl) {
  transform: scaleX(-1);
}
.ui-checkmark {
  display: flex;
  margin-inline-end: -11px;
  margin-inline-start: -4px;
  margin-top: 2px;
  width: 16px;
  height: 16px;
}
.ui-mixedmark {
  display: flex;
  margin-inline-end: -11px;
  margin-inline-start: -4px;
  margin-top: 2px;
  width: 16px;
  height: 16px;
}
`,vo;function Oi(t){let e="";switch(t){case"mathfield-element":e=`
    :host { display: inline-block; background-color: field; color: fieldtext; border-width: 1px; border-style: solid; border-color: #acacac; border-radius: 2px;}
    :host([hidden]) { display: none; }
    :host([disabled]), :host([disabled]:focus), :host([disabled]:focus-within) { outline: none; opacity:  .5; }
    :host(:focus), :host(:focus-within) {
      outline: Highlight auto 1px;    /* For Firefox */
      outline: -webkit-focus-ring-color auto 1px;
    }
    :host([readonly]:focus), :host([readonly]:focus-within),
    :host([read-only]:focus), :host([read-only]:focus-within) {
      outline: none;
    }`;break;case"core":e=KC;break;case"mathfield":e=$C;break;case"environment-popover":e=jC;break;case"suggestion-popover":e=qC;break;case"keystroke-caption":e=VC;break;case"virtual-keyboard":e=HC;break;case"ui":e=WC;break;case"menu":e=UC;break}return e}function So(t){return vo||(vo={}),vo[t]||(vo[t]=new CSSStyleSheet,vo[t].replaceSync(Oi(t))),vo[t]}var Vr;function Ji(t){var e;try{if(!("adoptedStyleSheets"in document)){if(window.document.getElementById(`mathlive-style-${t}`))return;let n=window.document.createElement("style");n.id=`mathlive-style-${t}`,n.append(window.document.createTextNode(Oi(t))),window.document.head.appendChild(n);return}if(Vr||(Vr={}),((e=Vr[t])!=null?e:0)!==0)Vr[t]+=1;else{let n=So(t);document.adoptedStyleSheets=[...document.adoptedStyleSheets,n],Vr[t]=1}}catch(n){console.error("Error injecting stylesheet",t,n)}}function Gi(t){if("adoptedStyleSheets"in document&&Vr!=null&&Vr[t]&&(Vr[t]-=1,Vr[t]<=0)){let e=vo[t];document.adoptedStyleSheets=document.adoptedStyleSheets.filter(n=>n!==e)}}var Yd=class kx extends G{constructor(e){var n;super(V(O({},e),{type:"accent",body:(n=e.body)!=null?n:void 0})),e.accentChar?this.accent=e.accentChar:this.svgAccent=e?.svgAccent,this.skipBoundary=!0,this.captureSelection=!0}static fromJson(e){return new kx(e)}toJson(){return V(O({},super.toJson()),{accentChar:this.accent,svgAccent:this.svgAccent})}render(e){var n;let r=new Ye({parent:e,mathstyle:"cramp"},this.style),i=(n=G.createBox(r,this.body))!=null?n:new oe("",{style:this.style}),o=0;!this.hasEmptyBranch("body")&&this.body.length===2&&this.body[1].isCharacterBox()&&(o=i.skew);let s=Math.min(i.height,Jr),a;if(this.svgAccent)a=lc(this.svgAccent),s=r.metrics.bigOpSpacing1-s;else if(this.accent){let c=new oe(this.accent,{fontFamily:"Main-Regular"});c.italic=0;let d=this.accent===8407||this.accent===8411||this.accent===8412?" ML__accent-combining-char":"";a=new oe(c,{classes:"ML__accent-body"+d})}let l=(i.width-a.width)/2+i.left+2*o;a=new It({shift:0,children:[{box:new oe(i)},-s,{box:a,marginLeft:l,classes:["ML__center"]}]});let u=new oe(a,{type:"lift"});return this.caret&&(u.caret=this.caret),this.bind(r,u.wrap(r)),this.attachSupsub(r,{base:u})}},Zd={"(":")","{":"}","[":"]","|":"|","\\lbrace":"\\rbrace","\\lparen":"\\rparen","\\{":"\\}","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},bd=Object.fromEntries(Object.entries(Zd).map(([t,e])=>[e,t]));function Qd(t){var e;return(e={"[":91,"]":93,"(":40,")":41,"\\mid":8739,"|":8739,"":8739,"":8741,"\\|":8739,"\\{":123,"\\}":125,"\\lbrace":123,"\\rbrace":125,"\\lparen":40,"\\rparen":41,"\\lbrack":91,"\\rbrack":93,"\\vert":8739,"\\lvert":8739,"\\mvert":8739,"\\rvert":8739,"\\Vert":8741,"\\lVert":8741,"\\mVert":8741,"\\rVert":8741,"\\parallel":8741,"\\shortparallel":8741,"\\langle":10216,"\\rangle":10217,"\\lfloor":8970,"\\rfloor":8971,"\\lceil":8968,"\\rceil":8969,"\\ulcorner":9484,"\\urcorner":9488,"\\llcorner":9492,"\\lrcorner":9496,"\\lgroup":10222,"\\rgroup":10223,"\\lmoustache":9136,"\\rmoustache":9137,"\\surd":8730}[t])!=null?e:t.codePointAt(0)}function JC(t,e,n,r){var i;let o=new oe(Qd(t),{fontFamily:"Main-Regular",isSelected:r.isSelected,classes:"ML__small-delim "+((i=r.classes)!=null?i:"")}).wrap(e);return n&&o.setTop((1-e.scalingFactor)*lr),o}function Sx(t,e,n,r,i){var o,s;let a=new Ye({parent:r,mathstyle:"textstyle"},i?.style),l=new oe(Qd(t),{fontFamily:`Size${e}-Regular`,isSelected:i.isSelected,classes:((o=i.classes)!=null?o:"")+` ML__delim-size${e}`,type:(s=i.type)!=null?s:"ignore"}).wrap(a);return n&&l.setTop((1-a.scalingFactor)*lr),l}function _x(t,e,n,r,i){var o;let s,a,l,u;s=l=u=Qd(t),a=null;let c="Size1-Regular";t==="\\vert"||t==="\\lvert"||t==="\\rvert"||t==="\\mvert"||t==="\\mid"?l=s=u=8739:t==="\\Vert"||t==="\\lVert"||t==="\\rVert"||t==="\\mVert"||t==="\\|"?l=s=u=8741:t==="\\uparrow"?l=u=9168:t==="\\Uparrow"?l=u=8214:t==="\\downarrow"?s=l=9168:t==="\\Downarrow"?s=l=8214:t==="\\updownarrow"?(s=8593,l=9168,u=8595):t==="\\Updownarrow"?(s=8657,l=8214,u=8659):t==="["||t==="\\lbrack"?(s=9121,l=9122,u=9123,c="Size4-Regular"):t==="]"||t==="\\rbrack"?(s=9124,l=9125,u=9126,c="Size4-Regular"):t==="\\lfloor"||t===""?(l=s=9122,u=9123,c="Size4-Regular"):t==="\\lceil"||t===""?(s=9121,l=u=9122,c="Size4-Regular"):t==="\\rfloor"||t===""?(l=s=9125,u=9126,c="Size4-Regular"):t==="\\rceil"||t===""?(s=9124,l=u=9125,c="Size4-Regular"):t==="("||t==="\\lparen"?(s=9115,l=9116,u=9117,c="Size4-Regular"):t===")"||t==="\\rparen"?(s=9118,l=9119,u=9120,c="Size4-Regular"):t==="\\{"||t==="\\lbrace"?(s=9127,a=9128,u=9129,l=9130,c="Size4-Regular"):t==="\\}"||t==="\\rbrace"?(s=9131,a=9132,u=9133,l=9130,c="Size4-Regular"):t==="\\lgroup"||t===""?(s=9127,u=9129,l=9130,c="Size4-Regular"):t==="\\rgroup"||t===""?(s=9131,u=9133,l=9130,c="Size4-Regular"):t==="\\lmoustache"||t===""?(s=9127,u=9133,l=9130,c="Size4-Regular"):t==="\\rmoustache"||t===""?(s=9131,u=9129,l=9130,c="Size4-Regular"):t==="\\surd"?(s=57345,u=9143,l=57344,c="Size4-Regular"):t==="\\ulcorner"?(s=9484,l=u=32):t==="\\urcorner"?(s=9488,l=u=32):t==="\\llcorner"?(u=9492,l=s=32):t==="\\lrcorner"&&(s=9496,l=s=32);let d=Ts(s,c),p=d.height+d.depth,f=Ts(l,c),g=f.height+f.depth,x=Ts(u,c),w=x.height+x.depth,k=0,D=1;if(a!==null){let ae=Ts(a,c);k=ae.height+ae.depth,D=2}let N=p+w+k,B=Math.max(0,Math.ceil((e-N)/(D*g))),T=N+B*D*g,R=lr;n&&(R=R*r.scalingFactor);let L=T/2-R,P=[];P.push({box:new oe(u,{fontFamily:c})}),P.push(-.008);let W=new oe(l,{fontFamily:c});if(a===null)for(let ae=0;ae<B;ae++)P.push({box:W});else{for(let ae=0;ae<B;ae++)P.push({box:W});P.push(-.008),P.push({box:new oe(a,{fontFamily:c})}),P.push(-.008);for(let ae=0;ae<B;ae++)P.push({box:W})}P.push(-.008),P.push({box:new oe(s,{fontFamily:c})});let de="";c==="Size1-Regular"?de=" delim-size1":c==="Size4-Regular"&&(de=" delim-size4");let q=new It({bottom:L,children:P},{classes:de});return new oe(q,V(O({},i??{}),{classes:((o=i?.classes)!=null?o:"")+" ML__delim-mult"}))}var Mx=new Set(["(",")","\\lparen","\\rparen","[","]","\\lbrack","\\rbrack","\\{","\\}","\\lbrace","\\rbrace","\\lfloor","\\rfloor","\\lceil","\\rceil","\\surd","","","",""]),GC=new Set(["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\mvert","\\mid","\\lgroup","\\rgroup","\\lmoustache","\\rmoustache","","","",""]),Cx=new Set(["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"]),XC=[0,1.2,1.8,2.4,3];function YC(t,e,n,r){return t===void 0||t==="."?Jo(n,r.classes):(t==="<"||t==="\\lt"||t===""?t="\\langle":(t===">"||t==="\\gt"||t==="")&&(t="\\rangle"),Mx.has(t)||Cx.has(t)?Sx(t,e,!1,n,r):GC.has(t)?_x(t,XC[e],!1,n,r):null)}var ZC=[{type:"small",mathstyle:"scriptscriptstyle"},{type:"small",mathstyle:"scriptstyle"},{type:"small",mathstyle:"textstyle"},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],QC=[{type:"small",mathstyle:"scriptscriptstyle"},{type:"small",mathstyle:"scriptscriptstyle"},{type:"small",mathstyle:"textstyle"},{type:"stack"}],eE=[{type:"small",mathstyle:"scriptscriptstyle"},{type:"small",mathstyle:"scriptstyle"},{type:"small",mathstyle:"textstyle"},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}];function tE(t){return t.type==="small"?"Main-Regular":t.type==="large"?"Size"+t.size+"-Regular":(t.type,"Size4-Regular")}function nE(t,e,n,r){let i={"-4":0,"-3":1,0:2}[r.mathstyle.sizeDelta];for(let o=i;o<n.length&&n[o].type!=="stack";o++){let s=Ts(t,tE(n[o]));if(s.defaultMetrics)return{type:"small",mathstyle:"scriptstyle"};let a=s.height+s.depth;if(n[o].type==="small"&&(n[o].mathstyle==="scriptscriptstyle"?a*=Math.max(Ef[Math.max(1,r.size-2)],r.minFontScale):n[o].mathstyle==="scriptstyle"&&(a*=Math.max(Ef[Math.max(1,r.size-1)],r.minFontScale))),a>e)return n[o]}return n[n.length-1]}function vd(t,e,n,r,i,o){if(!e||e.length===0||e===".")return Jo(i);e==="<"||e==="\\lt"?e="\\langle":(e===">"||e==="\\gt")&&(e="\\rangle");let s;Cx.has(e)?s=ZC:Mx.has(e)?s=eE:s=QC;let a=nE(Qd(e),n,s,i),l=new Ye({parent:i,mathstyle:a.mathstyle},o?.style);return a.type==="small"?JC(e,l,r,V(O({},o),{type:t})):a.type==="large"?Sx(e,a.size,r,l,V(O({},o),{type:t})):(a.type,_x(e,n,r,l,V(O({},o),{type:t})))}function vl(t,e,n,r,i,o){if(e===".")return Jo(i,o?.classes);let s=lr*i.scalingFactor,a=901,l=5/Ys,u=Math.max(n-s,r+s),c=Math.max(u/500*a,2*u-l);return vd(t,e,c,!0,i,o)}function Jo(t,e){let n=new oe(null,{classes:" ML__nulldelimiter "+(e??""),type:"ignore"});return n.width=t.getRegisterAsEm("nulldelimiterspace"),n.wrap(new Ye({parent:t,mathstyle:"textstyle"}))}var ur=class Ex extends G{constructor(e){var n;super({type:"placeholder",command:"\\placeholder",mode:(n=e?.mode)!=null?n:"math",style:e?.style}),this.captureSelection=!0}static fromJson(e){return new Ex(e)}toJson(){return super.toJson()}render(e){let n;return this.value=e.placeholderSymbol,typeof e.renderPlaceholder=="function"?n=e.renderPlaceholder(e):n=this.createBox(e),this.caret&&(n.classes+=" ML__placeholder-selected"),n}_serialize(e){return e.skipPlaceholders?"":"\\placeholder{}"}},Ax=["matrix","matrix*","pmatrix","pmatrix*","bmatrix","bmatrix*","Bmatrix","Bmatrix*","vmatrix","vmatrix*","Vmatrix","Vmatrix*"],Pf=["cases","dcases","rcases"],Dx=["align","align*","aligned","gather","gather*","gathered","split"],rE=["array","subequations","eqnarray"];function iE(t){return Dx.includes(t)||Pf.includes(t)||Pf.includes(t)||Ax.includes(t)||rE.includes(t)}function Lx(t){return Ax.includes(t)}function oE(t){return Pf.includes(t)}function sE(t){return Dx.includes(t)}function aE(t,e,n){let r=0;for(let u of n.columns)"align"in u&&(r+=1);r=Math.max(r,n.minColumns);let i=0,o=[];for(let u of e){i=Math.max(i,Math.min(u.length,r));let c=0;for(;c<u.length;){let d=[],p=Math.min(u.length,c+r);for(;c<p;)d.push(cE(u[c],t.mode)),c+=1;if(d.length<n.minColumns)for(;d.length<n.minColumns;)d.push([new G({type:"first",mode:t.mode})]);o.push(d)}}!t.isMultiline&&o.length>0&&o[o.length-1].length===1&&dE(o[o.length-1][0])&&o.pop();let s=[];for(let u of o){if(u.length!==i)for(let c=u.length;c<i;c++)t.isMultiline?u.push([new G({type:"first",mode:t.mode})]):u.push([new G({type:"first",mode:t.mode}),new ur]);s.push(u)}let a=0,l=0;for(let u of s){l=0;for(let c of u){for(let d of c)d.parent=t,d.parentBranch=[a,l];l+=1}a+=1}return t.isDirty=!0,s}function lE(t){return t.length>0&&t.every(e=>e.type==="first")}function uE(t,e,n){let r=new oe(null,{classes:"ML__empty-line-anchor"}),i=t[0];i&&(i.id||(i.id=e.makeID()),r.atomID=i.id),r.setStyle("display","inline-block"),r.setStyle("width",0),r.setStyle("position","relative"),r.setStyle("height",Math.max(0,n.height+n.depth),"em"),r.setStyle("vertical-align",-n.depth,"em"),r.height=n.height,r.depth=n.depth;let o=t.find(s=>s.caret);return o!=null&&o.caret&&(r.caret=o.caret),t.some(s=>s.isSelected)&&r.selected(!0),r}function cE(t,e){return t.length===0?[new G({type:"first",mode:e})]:t[0].type!=="first"?[new G({type:"first",mode:e}),...t]:(t.slice(1).some(n=>n.type==="first"),t)}function dE(t){return t.length===1&&t[0].type==="first"}var He=class Tx extends G{get isMultiline(){let e=this.environmentName;return["lines","multline","multline*","align","split","gather","gathered"].includes(e)}constructor(e,n,r,i={}){var o,s,a,l;if(super({type:"array",isRoot:i.isRoot}),this.environmentName=e,i.columns)i.columns.length===0?this.colFormat=[{align:"l"}]:this.colFormat=[...i.columns];else if(i.minColumns){let u=[];for(let c=0;c<i.minColumns;c++)u.push({align:"l"});this.colFormat=u}else this.colFormat=[{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"},{align:"l"}];this.minColumns=(o=i.minColumns)!=null?o:1,this.minRows=(s=i.minRows)!=null?s:1,this.maxRows=(a=i.maxRows)!=null?a:1/0,this._rows=aE(this,n,{columns:this.colFormat,minColumns:this.minColumns,minRows:this.minRows,maxRows:this.maxRows}),this.rowGaps=r,i.arraycolsep!==void 0&&(this.arraycolsep=i.arraycolsep),this.colSeparationType=i.colSeparationType,i.arraystretch!==void 0&&(this.arraystretch=i.arraystretch),i.mathstyleName&&(this.mathstyleName=i.mathstyleName),i.leftDelim&&(this.leftDelim=i.leftDelim),i.rightDelim&&(this.rightDelim=i.rightDelim),this.classes=(l=i.classes)!=null?l:[]}static fromJson(e){return new Tx(e.environmentName,e.array,e.rowGaps,e)}toJson(){let e=V(O({},super.toJson()),{environmentName:this.environmentName,array:this._rows.map(n=>n.map(r=>r.map(i=>i.toJson()))),rowGaps:this.rowGaps,columns:this.colFormat,colSeparationType:this.colSeparationType,minColumns:this.minColumns,minRows:this.minRows,maxRows:this.maxRows});return this.arraystretch!==void 0&&(e.arraystretch=this.arraystretch),this.arraycolsep!==void 0&&(e.arraycolsep=this.arraycolsep),this.leftDelim&&(e.leftDelim=this.leftDelim),this.rightDelim&&(e.rightDelim=this.rightDelim),this.isRoot&&(e.isRoot=!0),e.minColumns=this.minColumns,e.minRows=this.minRows,e.maxRows=this.maxRows,this.mathstyleName&&(e.mathstyleName=this.mathstyleName),this.classes.length>0&&(e.classes=this.classes),e}branch(e){var n;if(Yr(e))return(n=this._rows[e[0]][e[1]])!=null?n:void 0}createBranch(e){var n;return Yr(e)?(this.isDirty=!0,(n=this.branch(e))!=null?n:[]):[]}get rowCount(){return this._rows.length}get colCount(){return this._rows[0].length}get maxColumns(){return this.colFormat.filter(e=>!!e.align).length}removeBranch(e){if(bo(e))return super.removeBranch(e);let[n,...r]=this.branch(e);return n.type,this._rows[e[0]][e[1]]=void 0,r.forEach(i=>{i.parent=void 0,i.parentBranch=void 0}),this.isDirty=!0,r}get hasChildren(){return this.children.length>0}get children(){let e=[];for(let n of this._rows)for(let r of n)if(r)for(let i of r)e.push(...i.children),e.push(i);return[...e,...super.children]}render(e){var n,r,i,o,s,a;let l=new Ye({parent:e,mathstyle:this.mathstyleName},this.style),u=l.getRegisterAsEm("arrayrulewidth"),c=l.getRegisterAsEm("arraycolsep"),d=l.getRegisterAsEm("doublerulesep"),p=(r=(n=this.arraystretch)!=null?n:l.getRegisterAsNumber("arraystretch"))!=null?r:1,f=typeof this.arraycolsep=="number"?this.arraycolsep:c;this.colSeparationType==="small"&&(f=.2778*(new Ye({parent:e,mathstyle:"scriptstyle"}).scalingFactor/e.scalingFactor));let g=p*sC,x=.7*g,w=.3*g,k=0,D=[],N=0,B=this._rows.length;for(let xe=0;xe<B;++xe){let De=this._rows[xe];N=Math.max(N,De.length);let We=new Ye({parent:l,mathstyle:this.mathstyleName},this.style),et=x/We.scalingFactor,Ae=w/We.scalingFactor,Ke={cells:[],height:0,depth:0,pos:0};for(let Bt of De){let Ot=this.isMultiline&&Bt&&lE(Bt)?uE(Bt,We,{height:x/We.scalingFactor,depth:w/We.scalingFactor}):(i=G.createBox(We,Bt,{type:"ignore"}))!=null?i:new oe(null,{type:"ignore"});Ae=Math.max(Ae,Ot.depth),et=Math.max(et,Ot.height),Ke.cells.push(Ot)}let ot=(o=cx(this.rowGaps[xe]))!=null?o:0;ot>0&&(ot+=w,Ae=Math.max(Ae,ot),ot=0),xe<B-1&&!Lx(this.environmentName)&&this.environmentName!=="cases"&&this.environmentName!=="array"&&(Ae+=l.getRegisterAsEm("jot")),Ke.height=et,Ke.depth=Ae,k+=et,Ke.pos=k,k+=Ae+ot,D.push(Ke)}let T=this.environmentName==="array"&&!this.isMultiline?D[0].height:k/2+lr,R=[];for(let xe=0;xe<N;xe++){let De=[];for(let We of D){let et=We.cells[xe];et&&(et.depth=We.depth,et.height=We.height,De.push({box:et,shift:We.pos-T}))}De.length>0&&R.push(new It({individualShift:De}))}let L=[],P=!1,W=!1,de=0,q=!this.leftDelim,{colFormat:ae}=this;for(let xe of ae){if("align"in xe&&de>=R.length)break;if("align"in xe)P?L.push(Ru(2*f)):(W||q)&&L.push(Ru(f)),L.push(new oe(R[de],{classes:"col-align-"+xe.align})),de++,P=!0,W=!1,q=!1;else if("gap"in xe){if(typeof xe.gap=="number")L.push(Ru(xe.gap));else{let De=hE(e,D,T,xe.gap);De&&L.push(De)}P=!1,W=!1,q=!1}else if("separator"in xe){let De=new oe(null,{classes:"ML__vertical-separator"});De.height=k,De.setStyle("height",k,"em"),De.setStyle("border-right",`${u}em ${xe.separator} currentColor`),De.setStyle("vertical-align",-(k-T),"em");let We=0;W?We=d-u:P&&(We=f-u),De.left=We,L.push(De),P=!1,W=!0,q=!1}}P&&!this.rightDelim&&L.push(Ru(f));let be=new oe(L,{classes:["ML__mtable",...this.classes].join(" ")});if(this.environmentName==="array"&&!this.isMultiline&&(be.height=D[0].height,be.depth=k-D[0].height),(!this.leftDelim||this.leftDelim===".")&&(!this.rightDelim||this.rightDelim==="."))return this.caret&&(be.caret=this.caret),this.bind(e,be);let re=be.height,ce=be.depth,ge=this.bind(e,new oe([this.bind(e,vl("open",(s=this.leftDelim)!=null?s:".",re,ce,l,{isSelected:this.isSelected})),be,this.bind(e,vl("close",(a=this.rightDelim)!=null?a:".",re,ce,l,{isSelected:this.isSelected}))],{type:"ord"}));return ge?(ge.setStyle("display","inline-block"),this.caret&&(ge.caret=this.caret),this.bind(e,this.attachSupsub(e,{base:ge}))):null}_serialize(e){var n;let r=[];if(this.environmentName==="lines"&&this._rows.length>1?r.push("\\displaylines{"):this.environmentName!=="lines"&&r.push(`\\begin{${this.environmentName}}`),this.environmentName==="array"){if(r.push("{"),this.colFormat!==void 0)for(let i of this.colFormat)"align"in i&&typeof i.align=="string"?r.push(i.align):"separator"in i&&i.separator==="solid"?r.push("|"):"separator"in i&&i.separator==="dashed"&&r.push(":");r.push("}")}for(let i=0;i<this._rows.length;i++){for(let o=0;o<this._rows[i].length;o++)o>0&&r.push(" & "),r.push(G.serialize(this._rows[i][o],e));if(i<this._rows.length-1){let o=this.rowGaps[i];o!=null&&o.dimension?r.push(`\\\\[${o.dimension} ${(n=o.unit)!=null?n:"pt"}] `):r.push("\\\\ ")}}return this.environmentName==="lines"&&this._rows.length>1?r.push("}"):this.environmentName!=="lines"&&r.push(`\\end{${this.environmentName}}`),Fe(r)}forEachCell(e){for(let n=0;n<this.rowCount;n++)for(let r=0;r<this.colCount;r++)e(this._rows[n][r],n,r)}getCell(e,n){var r;return(r=this._rows[e])==null?void 0:r[n]}setCell(e,n,r){this.type==="array"&&Array.isArray(this._rows)&&this._rows[e][n];for(let o of this._rows[e][n])o.parent=void 0,o.parentBranch=void 0;let i=[new G({type:"first",mode:this.mode}),...r.filter(o=>o.type!=="first")];this._rows[e][n]=i,po(this),this.isDirty=!0}addRowBefore(e){this.type==="array"&&Array.isArray(this._rows),this._rows.splice(e,0,Array.from({length:this.colCount},()=>Iu(this,!this.isMultiline))),po(this),this.isDirty=!0}addRowAfter(e){this.type==="array"&&Array.isArray(this._rows),this._rows.splice(e+1,0,Array.from({length:this.colCount},()=>Iu(this,!this.isMultiline))),po(this),this.isDirty=!0}removeRow(e){this.type==="array"&&Array.isArray(this._rows)&&this.rowCount>e;let n=this._rows.splice(e,1);for(let r of n)for(let i of r)if(i)for(let o of i)o.parent=void 0,o.parentBranch=void 0;po(this),this.isDirty=!0}addColumnBefore(e){this.type==="array"&&Array.isArray(this._rows);for(let n of this._rows)n.splice(e,0,Iu(this));po(this),this.isDirty=!0}addColumnAfter(e){this.type==="array"&&Array.isArray(this._rows);for(let n of this._rows)n.splice(e+1,0,Iu(this));po(this),this.isDirty=!0}addColumn(){this.addColumnAfter(this.colCount-1)}removeColumn(e){this.type==="array"&&Array.isArray(this._rows)&&this.colCount>e;for(let n of this._rows){let r=n.splice(e,1);for(let i of r)if(i)for(let o of i)o.parent=void 0,o.parentBranch=void 0}po(this),this.isDirty=!0}get cells(){let e=[];for(let n of this._rows)for(let r of n)r&&e.push(r.filter(i=>i.type!=="first"));return e}get rows(){return this._rows}};function Iu(t,e=!1){let n=new G({type:"first",mode:t.mode});n.parent=t;let r=[n];if(e){let i=new ur;i.parent=t,r.push(i)}return r}function po(t){for(let e=0;e<t.rowCount;e++)for(let n=0;n<t.colCount;n++){let r=t.getCell(e,n);if(r)for(let i of r)i&&(i.parent=t,i.parentBranch=[e,n])}}function Ru(t){let e=new oe(null,{classes:"ML__arraycolsep"});return e.width=t,e}function hE(t,e,n,r){if(!r)return null;let i=[];for(let o of e){let s=G.createBox(t,r,{type:"ignore"});s&&(s.depth=o.depth,s.height=o.height,i.push({box:s,shift:o.pos-n}))}return new It({individualShift:i}).wrap(t)}var Xi=class Bx extends G{constructor(e){super({mode:e.mode,command:e.command,style:e.style,body:e.body,type:"box"}),this.framecolor=e.framecolor,this.backgroundcolor=e.backgroundcolor,this.padding=e.padding,this.offset=e.offset,this.border=e.border}static fromJson(e){return new Bx(e)}toJson(){return V(O({},super.toJson()),{framecolor:this.framecolor,backgroundcolor:this.backgroundcolor,padding:this.padding,offset:this.offset,border:this.border})}render(e){var n,r,i,o;let s=G.createBox(e,this.body,{type:"lift"});if(!s)return null;let a=e.toEm((n=this.offset)!=null?n:{dimension:0});s.depth+=a,s.setStyle("display","inline-block"),s.setStyle("position","relative"),s.setStyle("height",Math.floor(100*s.height+s.depth)/100,"em"),s.setStyle("vertical-align",-Math.floor(100*s.height)/100,"em");let l=new Ye({parent:e},this.style),u=l.toEm((r=this.padding)!=null?r:{register:"fboxsep"}),c=new oe(null,{classes:"ML__box"});c.height=s.height+u,c.depth=s.depth+u,c.setStyle("box-sizing","border-box"),c.setStyle("position","absolute"),c.setStyle("top",-u+.3,"em"),c.setStyle("left",0),c.setStyle("height",c.height+c.depth,"em"),c.setStyle("width","100%"),this.backgroundcolor&&c.setStyle("background-color",(i=l.toBackgroundColor(this.backgroundcolor))!=null?i:"transparent"),this.framecolor&&c.setStyle("border",`${l.getRegisterAsEm("fboxrule",2)}em solid ${(o=l.toColor(this.framecolor))!=null?o:"black"}`),this.border&&c.setStyle("border",this.border);let d=new oe([c,s],{type:"lift"});return d.setStyle("display","inline-block"),d.setStyle("position","relative"),d.setStyle("line-height",0),d.height=s.height+u+(a>0?a:0),d.depth=s.depth+u+(a<0?-a:0),d.setStyle("padding-left",u,"em"),d.setStyle("padding-right",u,"em"),d.setStyle("height",Math.floor(100*(s.height+s.depth+2*u+Math.abs(a)))/100,"em"),d.setStyle("margin-top",-u,"em"),d.setStyle("top",Math.floor(100*(s.depth-s.height+2*u-a))/100,"em"),d.setStyle("vertical-align",Math.floor(100*(s.depth+2*u))/100,"em"),this.caret&&(d.caret=this.caret),this.attachSupsub(e,{base:d})}_serialize(e){return e.skipStyles?Fe([this.bodyToLatex(e),this.supsubToLatex(e)]):super._serialize(e)}},Ox=class Nx extends G{constructor(e,n){var r;super({type:"composition",mode:(r=n?.mode)!=null?r:"math",value:e})}static fromJson(e){return new Nx(e.value,e)}toJson(){return super.toJson()}render(e){let n=new oe(this.value,{classes:"ML__composition",type:"composition"});return this.bind(e,n),this.caret&&(n.caret=this.caret),n}_serialize(e){return""}},xo=class Px extends G{constructor(e){super({type:"error",value:e,command:e,mode:"math"}),this.verbatimLatex=e}static fromJson(e){return new Px(e.command)}toJson(){return super.toJson()}render(e){let n=this.createBox(e,{classes:"ML__error"});return this.caret&&(n.caret=this.caret),n}},Ix=class Rx extends G{constructor(e,n){super({type:"group",mode:n}),this.body=e,this.boxType=e.length>1?"ord":"ignore",this.skipBoundary=!0,this.displayContainsHighlight=!1,e?.length===1&&e[0].command===","&&(this.captureSelection=!0)}static fromJson(e){return new Rx(e.body,e.mode)}render(e){let n=G.createBox(e,this.body,{type:this.boxType});return n?(this.caret&&(n.caret=this.caret),this.bind(e,n)):null}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);return n!=null&&n.serialize?n.serialize(this,e):`{${this.bodyToLatex(e)}}`}},kt=class zx extends G{constructor(e,n,r){super({type:"leftright",style:r.style,displayContainsHighlight:!0}),this.variant=e,this.body=n,this.leftDelim=r.leftDelim,this.rightDelim=r.rightDelim}static fromJson(e){var n;return new zx((n=e.variant)!=null?n:"",e.body,e)}toJson(){let e=super.toJson();return this.variant&&(e.variant=this.variant),this.leftDelim&&(e.leftDelim=this.leftDelim),this.rightDelim&&(e.rightDelim=this.rightDelim),e}_serialize(e){var n,r;let i=this.matchingRightDelim();return this.variant==="left...right"?Fe(["\\left",(n=this.leftDelim)!=null?n:".",this.bodyToLatex(e),"\\right",i]):this.variant==="mleft...mright"?Fe(["\\mleft",(r=this.leftDelim)!=null?r:".",this.bodyToLatex(e),"\\mright",i]):Fe([!this.leftDelim||this.leftDelim==="."?"":this.leftDelim,this.bodyToLatex(e),i])}matchingRightDelim(){var e,n;if(this.rightDelim&&this.rightDelim!=="?")return this.rightDelim;let r=(e=this.leftDelim)!=null?e:".";return(n=Zd[r])!=null?n:r}render(e){var n,r;let i=new Ye({parent:e},this.style);this.body;let o=new Ye({parent:e,mathstyle:"textstyle"},this.style),s=(n=G.createBox(i,this.body,{type:"inner"}))!=null?n:new oe(null,{type:"inner"}),a=s.height/o.scalingFactor,l=s.depth/o.scalingFactor,u=[];if(this.leftDelim&&u.push(this.bind(o,vl("open",this.leftDelim,a,l,o,{isSelected:this.isSelected,classes:"ML__open"+(this.containsCaret?" ML__contains-caret":""),mode:this.mode,style:this.style}))),s&&(Fx(s.children,this,i,a,l),u.push(s)),this.rightDelim){let f=this.containsCaret?" ML__contains-caret":"",g=this.rightDelim;g==="?"&&(i.smartFence?(g=this.matchingRightDelim(),f+=" ML__smart-fence__close"):g="."),u.push(this.bind(o,vl("close",g,a,l,o,{isSelected:this.isSelected,classes:f+" ML__close",mode:this.mode,style:this.style})))}let c=this.variant==="mleft...mright",d=this.leftSibling;d&&(!c&&d.isFunction&&(c=!0),!c&&d.type==="subsup"&&(r=d.leftSibling)!=null&&r.isFunction&&(c=!0));let p=new oe(u,{type:c?"close":"inner",classes:"ML__left-right"});return p.setStyle("margin-top",`${-s.depth}em`),p.setStyle("height",`${s.height+s.depth}em`),this.caret&&(p.caret=this.caret),this.bind(i,p.wrap(i))}};function Fx(t,e,n,r,i){if(t)for(let o=0;o<t.length;o++){let s=t[o];s.type==="middle"?(t[o]=e.bind(n,vl("inner",s.value,r,i,n,{isSelected:e.isSelected})),t[o].caret=s.caret,t[o].isSelected=s.isSelected,t[o].cssId=s.cssId,t[o].htmlData=s.htmlData,t[o].htmlStyle=s.htmlStyle,t[o].attributes=s.attributes,t[o].cssProperties=s.cssProperties):s.children&&Fx(s.children,e,n,r,i)}}var $x=class Kx extends G{constructor(e,n){var r;super({type:"macro",command:e,style:n.style}),this.body=n.body,n.captureSelection===void 0?n.args?this.captureSelection=!1:this.captureSelection=!0:this.captureSelection=n.captureSelection,this.macroArgs=n.args,this.expand=(r=n.expand)!=null?r:!1}static fromJson(e){return new Kx(e.command,e)}toJson(){let e=super.toJson();return this.expand&&(e.expand=!0),this.captureSelection!==void 0&&(e.captureSelection=this.captureSelection),this.macroArgs&&(e.args=this.macroArgs),e}_serialize(e){var n;return e.expandMacro&&this.expand?this.bodyToLatex(e):this.command+((n=this.macroArgs)!=null?n:"")}applyStyle(e,n){let r={};e.color&&(r.color=e.color),e.backgroundColor&&(r.backgroundColor=e.backgroundColor),super.applyStyle(r,n)}render(e){let n=G.createBox(e,this.body,{type:"lift"});return n?(this.caret&&(n.caret=this.caret),this.bind(e,n)):null}},pE=class jx extends G{constructor(){super({type:"macro-argument"})}static fromJson(e){return new jx}toJson(){return super.toJson()}_serialize(e){return""}render(e){return null}},qx=class Vx extends G{constructor(e,n,r=!1,i,o){var s;super({type:"prompt",mode:(s=o?.mode)!=null?s:"math",style:o?.style,command:"\\placeholder"}),this.body=i,this.correctness=n,this.placeholderId=e,this.locked=r,this.captureSelection=this.locked}static fromJson(e){return new Vx(e.placeholderId,e.correctness,e.locked,e.body,e)}toJson(){let e=super.toJson();return this.placeholderId&&(e.placeholderId=this.placeholderId),this.body||delete e.body,this.body&&(e.body=this.body.filter(n=>n.type!=="first").map(n=>n.toJson())),this.correctness&&(e.correctness=this.correctness),e.locked=this.locked,e}render(e){var n,r;let i=new Ye({parent:e}),o=i.getRegisterAsEm("fboxsep"),s=o,a=o,l=G.createBox(e,this.body);if(!l)return null;let u=!this.body||this.body.length===0||this.body.every(L=>L.type==="first"),c=u?new ur({mode:this.mode,style:this.style}).render(new Ye({parent:e,isPhantom:!0})):null;c?.height,c?.depth;let d=(n=c?.height)!=null?n:i.metrics.xHeight,p=(r=c?.depth)!=null?r:d/2;l.height||(l.height=u?d:i.metrics.xHeight),l.depth||(l.depth=u?p:i.metrics.defaultRuleThickness);let f=u?p-d:l.depth-l.height;l.setStyle("vertical-align",f,"em"),this.correctness==="correct"?l.setStyle("color","var(--correct-color, var(--ML__correct-color))"):this.correctness==="incorrect"&&l.setStyle("color","var(--incorrect-color, var(--ML__incorrect-color))");let g=new oe(l,{type:"ord"});g.height=l.height,g.depth=l.depth,g.setStyle("display","inline-block"),g.setStyle("height",l.height+l.depth,"em"),g.setStyle("vertical-align",-a,"em"),g.setStyle("position","relative"),g.setStyle("z-index",1);let x="ML__prompt ";this.locked?x+=" ML__lockedPromptBox ":x+=" ML__editablePromptBox ",this.correctness==="correct"?x+=" ML__correctPromptBox ":this.correctness==="incorrect"&&(x+=" ML__incorrectPromptBox "),this.containsCaret&&(x+=" ML__focusedPromptBox ");let w=new oe(null,{classes:x,attributes:{part:"prompt"}});w.height=g.height+a,w.depth=g.depth+a,w.width=g.width+2*s,w.setStyle("position","absolute"),w.setStyle("z-index",0),w.setStyle("display","block"),w.setStyle("pointer-events","auto");let k=g.height+g.depth+2*a;w.setStyle("height",Math.max(k,.6),"em");let D=g.width+2*s;u&&(D=Math.max(D,3*s||.8)),w.setStyle("width",Math.max(D,.6),"em"),w.setStyle("top",o+a,"em"),u?w.setStyle("left",-1.5*s,"em"):s!==0&&w.setStyle("left",-s,"em");let N="";this.correctness==="incorrect"&&(N+='<line x1="3%"  y1="97%" x2="97%" y2="3%" stroke-width="0.5" stroke="var(--incorrect-color, var(--ML__incorrect-color))" stroke-linecap="round" />'),N&&(w.svgOverlay=N);let B=new oe([w,g],{classes:"ML__prompt-atom"});g.setStyle("line-height",1),B.setStyle("position","relative"),B.setStyle("display","inline-block"),B.setStyle("line-height",0),B.height=g.height+a+.2,B.depth=g.depth+a,B.left=s,B.right=s,B.setStyle("height",g.height+2*a,"em"),B.setStyle("top",g.depth-g.height-a/2,"em"),B.setStyle("vertical-align",g.depth+a/2,"em"),B.setStyle("margin-left",.5,"em"),B.setStyle("margin-right",.5,"em"),this.caret&&(B.caret=this.caret);let T=this.attachSupsub(e,{base:B}),R=this.bind(i,T);return R&&this.id&&(w.atomID=this.id,g.atomID=this.id,B.atomID=this.id),R}_serialize(e){var n;let r=(n=this.bodyToLatex(e))!=null?n:"";if(e.skipPlaceholders)return r;let i="\\placeholder";return this.placeholderId&&(i+=`[${this.placeholderId}]`),this.correctness==="correct"?i+="[correct]":this.correctness==="incorrect"&&(i+="[incorrect]"),this.locked&&(i+="[locked]"),ut(i,r)}},eh=class Hx extends G{constructor(e){super({type:"subsup",style:e?.style}),this.subsupPlacement="auto"}get children(){if(!this._children){let e=[],n=this.branch("subscript");if(n)for(let i of n)e.push(...i.children),e.push(i);let r=this.branch("superscript");if(r)for(let i of r)e.push(...i.children),e.push(i);this._children=e}return this._children}static fromJson(e){let n=new Hx(e);for(let r of Zs)e[r]&&n.setChildren(e[r],r);return n}render(e){var n;let r=new Ye({parent:e,isPhantom:!0}),i=this.leftSibling,o=(n=i.render(r))!=null?n:new oe(null),s=new oe(null);return s.height=o.height,s.depth=o.depth,this.attachSupsub(e,{base:s,isCharacterBox:i.isCharacterBox(),type:"ignore"})}_serialize(e){return this.supsubToLatex(e)}};function bs(t){return t?!/^(<$$>|<$>|<space>|<{>|<}>|#[0-9\?]|\\.+)$/.test(t):!1}var Wx=class{constructor(t,e,n){this.errors=[],this.index=0,this.endCount=0;var r,i,o,s;n!=null||(n={}),this.tokens=t,this.context=e instanceof Ye&&!(n!=null&&n.parseMode)&&!n.mathstyle?e:new Ye({from:e,mathstyle:n.mathstyle},n.style),this.args=(r=n.args)!=null?r:void 0,this.smartFence=this.context.smartFence,this.parsingContext={parent:void 0,mathlist:[],style:(i=n.style)!=null?i:{},parseMode:(o=n.parseMode)!=null?o:"math",mathstyle:(s=n.mathstyle)!=null?s:"displaystyle",tabular:!1}}beginContext(t){var e,n,r,i,o,s;if(t!=null&&t.root){this.parsingContext={parent:this.parsingContext.parent,mathlist:[],style:{},parseMode:(e=t?.mode)!=null?e:"math",mathstyle:(n=t?.mathstyle)!=null?n:"displaystyle",tabular:(r=t?.tabular)!=null?r:!1};return}let a=this.parsingContext,l={parent:a,mathlist:[],style:O({},a.style),parseMode:(i=t?.mode)!=null?i:a.parseMode,mathstyle:(o=t?.mathstyle)!=null?o:a.mathstyle,tabular:(s=t?.tabular)!=null?s:!1};this.parsingContext=l}endContext(){this.parsingContext=this.parsingContext.parent}onError(t){this.errors.push(O({before:co(this.tokens.slice(this.index,this.index+10)),after:co(this.tokens.slice(Math.max(0,this.index-10),this.index))},t))}get mathlist(){return this.parsingContext.mathlist}set mathlist(t){this.parsingContext.mathlist=t}get parseMode(){return this.parsingContext.parseMode}set parseMode(t){this.parsingContext.parseMode=t}get tabularMode(){return this.parsingContext.tabular}get style(){let t=this.parsingContext;for(;t;){if(t.style)return O({},t.style);t=t.parent}return{}}set style(t){this.parsingContext.style=t}end(){return this.endCount++,this.index>=this.tokens.length||this.endCount>1e3}next(){this.index+=1}get(){return this.endCount=0,this.index<this.tokens.length?this.tokens[this.index++]:""}peek(){return this.tokens[this.index]}expandUnicode(){if(!this.peek()||this.parseMode!=="math")return;let t=XM(this.peek());t&&this.tokens.splice(this.index,1,...bl(t))}match(t){return this.tokens[this.index]===t?(this.index++,!0):!1}lastSubsupAtom(){let t;return this.mathlist.length>0&&(t=this.mathlist[this.mathlist.length-1],t.type==="subsup"||t.subsupPlacement!==void 0)||(t=new eh({style:this.style}),this.mathlist.push(t)),t}hasPattern(t){return t.test(this.tokens[this.index])}hasInfixCommand(){var t;let{index:e}=this;if(e<this.tokens.length&&this.tokens[e].startsWith("\\")){let n=Vt(this.tokens[e],this.parseMode);return!n||n.definitionType==="symbol"||n.ifMode&&!n.ifMode.includes(this.parseMode)?!1:(t=n.infix)!=null?t:!1}return!1}matchColumnSeparator(){return!this.tabularMode||this.peek()!=="&"?!1:(this.index++,!0)}matchRowSeparator(){if(!this.tabularMode)return!1;let t=this.peek();return t!=="\\\\"&&t!=="\\cr"&&t!=="\\tabularnewline"?!1:(this.index++,!0)}placeholder(){var t;let e=(t=this.args)==null?void 0:t.call(this,"?");return e?wn(e,{parseMode:this.parseMode,mathstyle:"textstyle"}):[new ur({mode:this.parseMode,style:this.style})]}skipWhitespace(){for(;this.match("<space>"););}skipUntilToken(t){let e=this.tokens[this.index];for(;e&&e!==t;)e=this.tokens[++this.index];e===t&&this.index++}skipFiller(){for(;this.match("\\relax")||this.match("<space>"););}matchKeyword(t){let e=this.index,n=this.end(),r="";for(;!n;){let o=this.get();bs(o)?(r+=o,n=this.end()||r.length>=t.length):n=!0}let i=t.toUpperCase()===r.toUpperCase();return i||(this.index=e),i}scanString(){let t="";for(;!this.end();){let e=this.peek();if(e==="]")return t;if(e==="<space>")t+=" ";else if(e.startsWith("\\"))this.onError({code:"unexpected-command-in-string"}),t+=e.substring(1);else if(bs(e))t+=e;else return t;this.next()}return t}scanBalancedString(){let t="",e=this.end(),n=1;for(;!e;){let r=this.get();r==="<space>"?t+=" ":r==="<{>"?(t+="{",n+=1):r==="<}>"?(n-=1,n>0?t+="}":this.index-=1):r==="<$>"?t+="$":r==="<$$>"?t+="$$":t+=r,e=n===0||this.end()}return t}scanLiteralGroup(){var t;if(!this.match("<{>"))return"";let e="",n=1;for(;n>0&&!this.end();){let r=this.get();r==="<}>"?(n-=1,n>0&&(e+="}")):r==="<{>"?(n+=1,e+="{"):(/\\[a-zA-Z]+$/.test(e)&&/^[a-zA-Z]/.test(r)&&(e+=" "),e+=(t={"<space>":" ","<$$>":"$$","<$>":"$"}[r])!=null?t:r)}return e}scanNumber(t=!0){var e,n;let r=!1,i=this.peek();for(;i==="<space>"||i==="+"||i==="-";)this.get(),i==="-"&&(r=!r),i=this.peek();t=!!t;let o=10,s=/\d/;if(this.match("'"))o=8,s=/[0-7]/,t=!0;else if(this.match('"'))o=16,s=/[\dA-F]/,t=!0;else if(this.match("x"))o=16,s=/[\dA-Fa-f]/,t=!0;else if(this.match("`"))return i=this.get(),i?i.length===2&&i.startsWith("\\")?{number:(r?-1:1)*((e=i.codePointAt(1))!=null?e:0),base:"alpha"}:{number:(r?-1:1)*((n=i.codePointAt(0))!=null?n:0),base:"alpha"}:null;let a="";for(;this.hasPattern(s);)a+=this.get();if(!t&&(this.match(".")||this.match(",")))for(a+=".";this.hasPattern(s);)a+=this.get();let l=t?Number.parseInt(a,o):Number.parseFloat(a);return Number.isNaN(l)?null:{number:r?-l:l,base:o===16?"hexadecimal":o===8?"octal":"decimal"}}scanRegister(){var t;let e=this.index,n=this.scanNumber(!1);if(this.skipWhitespace(),this.match("\\relax"))return n;let r=!1;if(n===null)for(;;){let o=this.peek();if(o==="-")r=!r;else if(o!=="+")break;this.next(),this.skipWhitespace()}if(this.match("\\global")){this.skipWhitespace();let o=this.get();return o.startsWith("\\")?n?{register:o,global:!0,factor:(r?-1:1)*n.number}:r?{register:o,global:!0,factor:-1}:{register:o,global:!0}:(this.index=e,null)}let i=this.get();return i!=null&&i.startsWith("\\")?(i=i.substring(1),this.context.registers[i]?!r||n!==null?{register:i,factor:(r?-1:1)*((t=n?.number)!=null?t:1)}:{register:i}:(this.index=e,null)):(this.index=e,null)}scanValue(){let t=this.scanRegister();if(t)return t;let e=this.index,n=this.scanGlueOrDimen();if(n&&("unit"in n||"glue"in n&&"unit"in n.glue))return n;this.index=e;let r=this.scanNumber();if(r)return r;if(this.end()||!bs(this.peek()))return null;let i=this.scanString();return i.length>0?{string:i}:null}scanDimen(){let t=this.scanNumber(!1);if(t===null)return null;let e=t.number;this.skipWhitespace(),this.matchKeyword("true"),this.skipWhitespace();let n;return this.matchKeyword("pt")?n="pt":this.matchKeyword("mm")?n="mm":this.matchKeyword("cm")?n="cm":this.matchKeyword("ex")?n="ex":this.matchKeyword("px")?n="px":this.matchKeyword("em")?n="em":this.matchKeyword("bp")?n="bp":this.matchKeyword("dd")?n="dd":this.matchKeyword("pc")?n="pc":this.matchKeyword("in")?n="in":this.matchKeyword("mu")&&(n="mu"),n?{dimension:e,unit:n}:{dimension:e}}scanGlueOrDimen(){let t=this.scanDimen();if(t===null)return null;if(this.skipWhitespace(),this.match("\\relax"))return t;let e={glue:t};if(this.matchKeyword("plus")){let n=this.scanDimen();if(n)e.grow=n;else return e}if(this.skipWhitespace(),this.match("\\relax"))return e;if(this.skipWhitespace(),this.matchKeyword("minus")){let n=this.scanDimen();if(n)e.shrink=n;else return e}return!e.grow&&!e.shrink?t:e}scanColspec(){this.skipWhitespace();let t=[];for(;!this.end()&&!(this.peek()==="<}>"||this.peek()==="]");){let e=this.get();e==="c"||e==="r"||e==="l"?t.push({align:e}):e==="|"?t.push({separator:"solid"}):e===":"?t.push({separator:"dashed"}):e==="@"&&(this.match("<{>")&&(this.beginContext({mode:"math"}),t.push({gap:this.scan(n=>n==="<}>")}),this.endContext()),this.match("<}>")||this.onError({code:"unbalanced-braces"}))}return t}scanModeSet(){let t;if(this.match("\\(")&&(t="textstyle"),!t&&this.match("\\[")&&(t="displaystyle"),!t)return null;this.beginContext({mode:"math",mathstyle:t});let e=this.scan(n=>n===(t==="displaystyle"?"\\]":"\\)"));return this.match(t==="displaystyle"?"\\]":"\\)")||this.onError({code:"unbalanced-mode-shift"}),this.endContext(),e}scanModeShift(){let t="";if(this.match("<$>")&&(t="<$>"),!t&&this.match("<$$>")&&(t="<$$>"),!t)return null;this.beginContext({mode:"math",mathstyle:t==="<$>"?"textstyle":"displaystyle"});let e=this.scan(n=>n===t);return this.match(t)||this.onError({code:"unbalanced-mode-shift"}),this.endContext(),e}scanEnvironment(){if(!this.match("\\begin"))return null;let t=this.scanArgument("string");if(!t)return null;let e=nC(t);if(!e)return this.onError({code:"unknown-environment",arg:t}),null;let n=[];if(e.params)for(let a of e.params)if(a.isOptional)n.push(this.scanOptionalArgument(a.type));else{let l=this.scanArgument(a.type);l||this.onError({code:"missing-argument",arg:t}),n.push(l)}this.beginContext({tabular:e.tabular,root:e.rootOnly});let r=[],i=[],o=[],s=!1;do if(this.end()&&(this.onError({code:"unbalanced-environment",arg:t}),s=!0),!s&&this.match("\\end")&&(this.scanArgument("string")!==t&&this.onError({code:"unbalanced-environment",arg:t}),s=!0),!s)if(this.matchColumnSeparator())o.push(this.mathlist),this.mathlist=[];else if(this.matchRowSeparator()){o.push(this.mathlist),this.mathlist=[];let a=null;this.skipWhitespace(),this.match("[")&&(a=this.scanDimen(),this.skipWhitespace(),this.match("]")),i.push(a??{dimension:0}),r.push(o),o=[]}else this.mathlist.push(...this.scan(a=>["<}>","&","\\end","\\cr","\\\\","\\tabularnewline"].includes(a)));while(!s);return o.push(this.mathlist),o.length>0&&r.push(o),this.endContext(),e.rootOnly&&(this.index=this.tokens.length),e.createAtom(t,r,i,n,this.context.maxMatrixCols)}scanExpression(){let t=this.mathlist;if(this.mathlist=[],this.parseExpression()){let e=this.mathlist;return this.mathlist=t,e}return this.mathlist=t,null}scan(t){this.beginContext(),t||(t=s=>s==="<}>");let e="",n=null,r=[],i=null;for(;!this.end()&&!t(this.peek());)this.hasInfixCommand()&&!e?(e=this.get(),n=Vt(e,"math"),n&&(r=this.scanArguments(n)[1]),i=this.mathlist,this.mathlist=[]):this.parseExpression();let o;return e?(r.unshift(this.mathlist),i&&r.unshift(i),o=[n.createAtom({command:e,args:r,style:this.style,mode:this.parseMode})]):o=this.mathlist,this.endContext(),o}scanGroup(){let t=this.index;if(!this.match("<{>"))return null;let e=this.scan(r=>r==="<}>");if(this.match("<}>")||this.onError({code:"unbalanced-braces"}),e.length===1&&e[0].type==="placeholder")return e[0];let n=new Ix(e,this.parseMode);return n.verbatimLatex=co(this.tokens.slice(t,this.index)),n}scanSmartFence(){if(this.skipWhitespace(),!this.match("("))return null;this.beginContext();let t=1;for(;!this.end()&&t!==0;)this.match("(")&&(t+=1),this.match(")")&&(t-=1),t!==0&&this.parseExpression();let e=new kt("",this.mathlist,{leftDelim:"(",rightDelim:t===0?")":"?"});return this.endContext(),e}scanDelim(){this.skipWhitespace();let t=this.peek();if(!t)return this.onError({code:"unexpected-end-of-string"}),null;if(!bs(t)&&!t.startsWith("\\"))return null;this.next();let e=Vt(t,"math");return e?e.definitionType==="function"&&e.ifMode&&!e.ifMode.includes(this.parseMode)?(this.onError({code:"unexpected-delimiter",arg:t}),null):e.definitionType==="symbol"&&(e.type==="mopen"||e.type==="mclose")||/^(\.|\?|\||<|>|\\vert|\\Vert|\\\||\\surd|\\uparrow|\\downarrow|\\Uparrow|\\Downarrow|\\updownarrow|\\Updownarrow|\\mid|\\mvert|\\mVert)$/.test(t)?t:(this.onError({code:"unexpected-delimiter",arg:t}),null):(this.onError({code:"unknown-command",arg:t}),null)}scanLeftRight(){var t;if(this.match("\\right"))return this.onError({code:"unbalanced-braces"}),new xo("\\right");if(this.match("\\mright"))return this.onError({code:"unbalanced-braces"}),new xo("\\mright");let e="\\right";if(!this.match("\\left")){if(!this.match("\\mleft"))return null;e="\\mright"}let n=this.scanDelim();if(!n)return this.onError({code:"unexpected-delimiter"}),new xo(e==="\\right"?"\\left":"\\mleft");for(this.beginContext();!this.end()&&!this.match(e);)this.parseExpression();let r=this.mathlist;this.endContext();let i=(t=this.scanDelim())!=null?t:".";return new kt(e==="\\right"?"left...right":"mleft...mright",r,{leftDelim:n,rightDelim:i,style:this.style})}parseSupSub(){if(this.parseMode!=="math")return!1;let t=this.peek();if(t!=="^"&&t!=="_"&&t!=="'")return!1;let e=this.lastSubsupAtom();for(;t==="^"||t==="_"||t==="'";)this.match("'")?this.match("'")?e.addChild(new G({type:"mord",command:"\\doubleprime",mode:"math",value:""}),"superscript"):e.addChild(new G({type:"mord",command:"\\prime",mode:"math",value:""}),"superscript"):(this.match("^")||this.match("_"))&&e.addChildren(pe(this.scanArgument("expression")),t==="_"?"subscript":"superscript"),t=this.peek();return!0}parseLimits(){if(this.parseMode!=="math")return!1;let t=this.match("\\limits"),e=!t&&this.match("\\nolimits"),n=!e&&!t&&this.match("\\displaylimits");if(!t&&!e&&!n)return!1;let r=this.mathlist.length>0?this.mathlist[this.mathlist.length-1]:null;return r===null?!1:(r.explicitSubsupPlacement=!0,t&&(r.subsupPlacement="over-under"),e&&(r.subsupPlacement="adjacent"),n&&(r.subsupPlacement="auto"),!0)}scanArguments(t){if(!(t!=null&&t.params))return[void 0,[]];let e,n=[],r=t.infix?2:0;for(;r<t.params.length;){let i=t.params[r];i.type==="rest"?n.push(this.scan(o=>["<}>","&","\\end","\\cr","\\\\","\\tabularnewline","\\right"].includes(o))):i.isOptional?n.push(this.scanOptionalArgument(i.type)):i.type.endsWith("*")?e=i.type.slice(0,-1):n.push(this.scanArgument(i.type)),r+=1}return[e,n]}scanSymbolOrLiteral(){let t=this.peek();if(!t)return null;this.next();let e;if(bs(t)){let n=In.createAtom(this.parseMode,t,O({},this.style));return n?[n]:null}if(e=this.scanMacro(t),e)return[e];if(t.startsWith("\\")){let n=Vt(t,this.parseMode);if(!n)return this.onError({code:"unknown-command",arg:t}),[new xo(t)];if(n.definitionType==="symbol"){let r=O({},this.style);n.variant&&(r.variant=n.variant),e=new G({type:n.type,command:t,style:r,value:String.fromCodePoint(n.codepoint),mode:this.parseMode,verbatimLatex:t})}else{if(n.applyMode||n.applyStyle||n.infix)return this.onError({code:"invalid-command",arg:t}),[new xo(t)];n.createAtom&&(e=n.createAtom({command:t,args:[],style:this.style,mode:this.parseMode}))}}return e?[e]:null}scanArgument(t){var e;this.skipFiller();let n=this.parseMode;if(t==="auto"&&(t=n),!this.match("<{>")){if(t==="string")return this.scanString();if(t==="value")return this.scanValue();if(t==="delim")return(e=this.scanDelim())!=null?e:".";if(t==="expression")return this.scanExpression();if(t==="math"){t!==n&&this.beginContext({mode:"math"});let i=this.scanSymbolOrLiteral();return t!==n&&this.endContext(),i}if(t==="text"){t!==n&&this.beginContext({mode:"text"});let i=this.scanSymbolOrLiteral();return t!==n&&this.endContext(),i}return t==="balanced-string"?null:t==="rest"?this.scan(i=>["<}>","&","\\end","\\cr","\\\\","\\tabularnewline","\\right"].includes(i)):null}if(t==="text"){this.beginContext({mode:"text"});do this.mathlist.push(...this.scan());while(!this.match("<}>")&&!this.end());let i=this.mathlist;return this.endContext(),{group:i}}if(t==="math"){this.beginContext({mode:"math"});do this.mathlist.push(...this.scan());while(!this.match("<}>")&&!this.end());let i=this.mathlist;return this.endContext(),{group:i}}if(t==="rest"){let i=this.scan();return this.match("<}>")||this.onError({code:"unbalanced-braces"}),{group:i}}let r=null;if(t==="expression"){this.beginContext({mode:"math"});do this.mathlist.push(...this.scan());while(!this.match("<}>")&&!this.end());let i=this.mathlist;return this.endContext(),{group:i}}return t==="string"?r=this.scanString():t==="balanced-string"?r=this.scanBalancedString():t==="colspec"?r=this.scanColspec():t==="value"&&(r=this.scanValue()),this.skipUntilToken("<}>"),r}scanOptionalArgument(t){if(t=t==="auto"?this.parseMode:t,this.skipFiller(),!this.match("["))return null;let e=null;for(;!this.end()&&!this.match("]");)if(t==="string")e=this.scanString();else if(t==="value")e=this.scanValue();else if(t==="colspec")e=this.scanColspec();else if(t==="bbox"){let n={},r=this.scanString().toLowerCase().trim().split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(let i of r){let o=i.match(/^\s*([\d.]+)\s*([a-z]{2})/);if(o)n.padding={dimension:Number.parseFloat(o[1]),unit:o[2]};else{let s=i.match(/^\s*border\s*:\s*(.*)/);s?n.border=s[1]:n.backgroundcolor={string:i}}}e=n}else t==="math"&&(this.beginContext({mode:"math"}),e=this.mathlist.concat(this.scan(n=>n==="]")),this.endContext());return e}scanSymbolOrCommand(t){var e,n,r;if(t==="\\placeholder"){let a=this.scanOptionalArgument("string"),l=this.scanOptionalArgument("math"),u=G.serialize(l,{defaultMode:"math"}),c=[],d;!d&&u==="correct"?d="correct":!d&&u==="incorrect"?d="incorrect":u!==""&&(c=l);let p=this.scanOptionalArgument("string")==="locked",f=this.scanArgument("auto"),g;return f&&Array.isArray(f)&&f.length>0?g=f:f&&typeof f=="object"&&"group"in f?g=f.group:g=c,a?[new qx(a,d,p,g??c,{mode:this.parseMode,style:this.style})]:[new ur({mode:this.parseMode,style:this.style})]}if(t==="\\renewcommand"||t==="\\newcommand"||t==="\\providecommand"||t==="\\def"){let a=this.index,l=this.scanLiteralGroup()||this.next();if(!l)return null;if(this.context.registers[l.substring(1)]){let u=this.scanArgument("string");u!==null&&(this.context.registers[l.substring(1)]=u);let c=Fe([t,co(this.tokens.slice(a,this.index))]);return[new G({type:"text",value:"",verbatimLatex:c})]}}let i=this.scanMacro(t);if(i)return[i];let o=Vt(t,this.parseMode);if(!o)return this.parseMode==="text"?(/[a-zA-Z]/.test((e=this.peek())!=null?e:"")&&(t+=" "),[...t].map(a=>new G({type:"text",value:a,mode:"text",style:this.style}))):(this.onError({code:"unknown-command",arg:t}),[new xo(t)]);let s=this.index;if(o.definitionType==="symbol"){let a=O({},this.style);o.variant&&(a.variant=o.variant),i=new G({type:o.type,command:t,style:a,value:String.fromCodePoint(o.codepoint),mode:this.parseMode})}else{if(o.ifMode&&!o.ifMode.includes(this.parseMode))return[];let a=this.parseMode;o.applyMode&&(this.parseMode=o.applyMode);let l,u=[];if(o.parse?u=o.parse(this):[l,u]=this.scanArguments(o),this.parseMode=a,o.applyMode&&!o.applyStyle&&!o.createAtom)return pe(u[0]);if(o.infix)return this.onError({code:"too-many-infix-commands",arg:t}),null;if(typeof o.createAtom=="function")i=o.createAtom({command:t,args:u,style:this.style,mode:this.parseMode}),l&&(i.body=pe(this.scanArgument(l)));else if(typeof o.applyStyle=="function"){let c=o.applyStyle(this.style,t,u,this.context),d=this.parseMode;if(o.applyMode&&(this.parseMode=o.applyMode),l){let p=this.style;this.style=c;let f=this.scanArgument(l);return this.style=p,this.parseMode=d,pe(f)}this.style=c}else i=new G({type:"mord",command:(n=o.command)!=null?n:t,style:O({},this.style),value:t,mode:(r=o.applyMode)!=null?r:this.parseMode})}if(!i)return null;if(i instanceof G&&i.verbatimLatex===void 0&&!/^\\(llap|rlap|class|cssId|htmlData)$/.test(t)){let a=Fe([t,co(this.tokens.slice(s,this.index))]);a&&(i.verbatimLatex=a)}if(i.verbatimLatex===null&&(i.verbatimLatex=void 0),i.isFunction&&this.smartFence){let a=this.scanSmartFence();if(a)return[i,a]}return[i]}scanSymbolCommandOrLiteral(){this.expandUnicode();let t=this.get();if(!t)return null;if(bs(t)){let e=In.createAtom(this.parseMode,t,O({},this.style));if(!e)return null;if(e.isFunction&&this.smartFence){let n=this.scanSmartFence();if(n)return[e,n]}return[e]}return t.startsWith("\\")?this.scanSymbolOrCommand(t):t==="<space>"?this.parseMode==="text"?[new na(" "," ",this.style)]:null:(t==="<}>"?this.onError({latex:"",code:"unbalanced-braces"}):this.onError({latex:"",code:"unexpected-token",arg:t}),null)}scanMacro(t){var e;let n=this.context.getMacro(t);if(!n)return null;let r=this.index,i=n.args,o={"?":(e=this.args)==null?void 0:e.call(this,"?")};for(let s=1;s<=i;s++){let a=this.scanLiteralGroup();if(!a){let l=this.index;this.scanExpression(),a=co(this.tokens.slice(l,this.index))}o[s]=a}return new $x(t,{expand:n.expand,captureSelection:n.captureSelection,args:r===this.index?null:co(this.tokens.slice(r,this.index)),style:this.parsingContext.style,body:wn(n.def,{context:this.context,parseMode:this.parseMode,args:s=>o[s],mathstyle:this.parsingContext.mathstyle,style:this.parsingContext.style})})}parseExpression(){var t,e,n,r;let i=(r=(n=(e=(t=this.scanEnvironment())!=null?t:this.scanModeShift())!=null?e:this.scanModeSet())!=null?n:this.scanGroup())!=null?r:this.scanLeftRight();if(i===null){if(this.parseSupSub()||this.parseLimits())return!0;i=this.scanSymbolCommandOrLiteral()}return i?(Ht(i)?this.mathlist.push(...i):this.mathlist.push(i),!0):!1}};function wn(t,e){var n,r,i,o;let s=(n=e?.args)!=null?n:void 0,a=new Wx(bl(t,s),e?.context,{args:s,mathstyle:(r=e?.mathstyle)!=null?r:"displaystyle",parseMode:(i=e?.parseMode)!=null?i:"math",style:(o=e?.style)!=null?o:{}}),l=[];for(;!a.end();)l.push(...a.scan(()=>!1));return l}function fE(t,e){var n;let r=new Wx(bl(t,null),e?.context,{mathstyle:"displaystyle",parseMode:(n=e?.parseMode)!=null?n:"math"});for(;!r.end();)r.scan();return r.errors}var Ux=class Jx extends G{constructor(e,n){super({type:"chem"},{command:e,mode:"math"});let r=mt.go(ee.go(n,e==="\\pu"?"pu":"ce"),!1);this.body=wn(r),this._verbatimLatex=e+"{"+n+"}",this.arg=n,this.captureSelection=!0}static fromJson(e){return new Jx(e.command,e.arg)}set verbatimLatex(e){}get verbatimLatex(){return this._verbatimLatex}toJson(){return V(O({},super.toJson()),{arg:this.arg})}render(e){let n=G.createBox(e,this.body,{type:"inner"});return this.caret&&(n.caret=this.caret),this.bind(e,n)}_serialize(e){return this.verbatimLatex,this.verbatimLatex}};Z(["ce","pu"],"{chemformula:balanced-string}",{createAtom:t=>{var e;return new Ux(t.command,(e=t.args[0])!=null?e:"")}});var ee={go:function(t,e){if(!t)return[];e===void 0&&(e="ce");var n="0",r={};r.parenthesisLevel=0,t=t.replace(/\n/g," "),t=t.replace(/[\u2212\u2013\u2014\u2010]/g,"-"),t=t.replace(/[\u2026]/g,"...");for(var i,o=10,s=[];;){i!==t?(o=10,i=t):o--;var a=ee.stateMachines[e],l=a.transitions[n]||a.transitions["*"];e:for(var u=0;u<l.length;u++){var c=ee.patterns.match_(l[u].pattern,t);if(c){for(var d=l[u].task,p=0;p<d.action_.length;p++){var f;if(a.actions[d.action_[p].type_])f=a.actions[d.action_[p].type_](r,c.match_,d.action_[p].option);else if(ee.actions[d.action_[p].type_])f=ee.actions[d.action_[p].type_](r,c.match_,d.action_[p].option);else throw["MhchemBugA","mhchem bug A. Please report. ("+d.action_[p].type_+")"];ee.concatArray(s,f)}if(n=d.nextState||n,t.length>0){if(d.revisit||(t=c.remainder),!d.toContinue)break e}else return s}}if(o<=0)throw["MhchemBugU","mhchem bug U. Please report."]}},concatArray:function(t,e){if(e)if(Object.prototype.toString.call(e)==="[object Array]")for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e)},patterns:{patterns:{empty:/^$/,else:/^./,else2:/^./,space:/^\s/,"space A":/^\s(?=[A-Z\\$])/,space$:/^\s$/,"a-z":/^[a-z]/,x:/^x/,x$:/^x$/,i$:/^i$/,letters:/^(?:[a-zA-Z\u03B1-\u03C9\u0391-\u03A9?@]|(?:\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))))+/,"\\greek":/^\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))/,"one lowercase latin letter $":/^(?:([a-z])(?:$|[^a-zA-Z]))$/,"$one lowercase latin letter$ $":/^\$(?:([a-z])(?:$|[^a-zA-Z]))\$$/,"one lowercase greek letter $":/^(?:\$?[\u03B1-\u03C9]\$?|\$?\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\s*\$?)(?:\s+|\{\}|(?![a-zA-Z]))$/,digits:/^[0-9]+/,"-9.,9":/^[+\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))/,"-9.,9 no missing 0":/^[+\-]?[0-9]+(?:[.,][0-9]+)?/,"(-)(9.,9)(e)(99)":function(t){var e=t.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))?(\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))\))?(?:(?:([eE])|\s*(\*|x|\\times|\u00D7)\s*10\^)([+\-]?[0-9]+|\{[+\-]?[0-9]+\}))?/);return e&&e[0]?{match_:e.slice(1),remainder:t.substr(e[0].length)}:null},"(-)(9)^(-9)":function(t){var e=t.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+)?)\^([+\-]?[0-9]+|\{[+\-]?[0-9]+\})/);return e&&e[0]?{match_:e.slice(1),remainder:t.substr(e[0].length)}:null},"state of aggregation $":function(t){var e=ee.patterns.findObserveGroups(t,"",/^\([a-z]{1,3}(?=[\),])/,")","");if(e&&e.remainder.match(/^($|[\s,;\)\]\}])/))return e;var n=t.match(/^(?:\((?:\\ca\s?)?\$[amothc]\$\))/);return n?{match_:n[0],remainder:t.substr(n[0].length)}:null},"_{(state of aggregation)}$":/^_\{(\([a-z]{1,3}\))\}/,"{[(":/^(?:\\\{|\[|\()/,")]}":/^(?:\)|\]|\\\})/,", ":/^[,;]\s*/,",":/^[,;]/,".":/^[.]/,". ":/^([.\u22C5\u00B7\u2022])\s*/,"...":/^\.\.\.(?=$|[^.])/,"* ":/^([*])\s*/,"^{(...)}":function(t){return ee.patterns.findObserveGroups(t,"^{","","","}")},"^($...$)":function(t){return ee.patterns.findObserveGroups(t,"^","$","$","")},"^a":/^\^([0-9]+|[^\\_])/,"^\\x{}{}":function(t){return ee.patterns.findObserveGroups(t,"^",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"^\\x{}":function(t){return ee.patterns.findObserveGroups(t,"^",/^\\[a-zA-Z]+\{/,"}","")},"^\\x":/^\^(\\[a-zA-Z]+)\s*/,"^(-1)":/^\^(-?\d+)/,"'":/^'/,"_{(...)}":function(t){return ee.patterns.findObserveGroups(t,"_{","","","}")},"_($...$)":function(t){return ee.patterns.findObserveGroups(t,"_","$","$","")},_9:/^_([+\-]?[0-9]+|[^\\])/,"_\\x{}{}":function(t){return ee.patterns.findObserveGroups(t,"_",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"_\\x{}":function(t){return ee.patterns.findObserveGroups(t,"_",/^\\[a-zA-Z]+\{/,"}","")},"_\\x":/^_(\\[a-zA-Z]+)\s*/,"^_":/^(?:\^(?=_)|\_(?=\^)|[\^_]$)/,"{}":/^\{\}/,"{...}":function(t){return ee.patterns.findObserveGroups(t,"","{","}","")},"{(...)}":function(t){return ee.patterns.findObserveGroups(t,"{","","","}")},"$...$":function(t){return ee.patterns.findObserveGroups(t,"","$","$","")},"${(...)}$":function(t){return ee.patterns.findObserveGroups(t,"${","","","}$")},"$(...)$":function(t){return ee.patterns.findObserveGroups(t,"$","","","$")},"=<>":/^[=<>]/,"#":/^[#\u2261]/,"+":/^\+/,"-$":/^-(?=[\s_},;\]/]|$|\([a-z]+\))/,"-9":/^-(?=[0-9])/,"- orbital overlap":/^-(?=(?:[spd]|sp)(?:$|[\s,;\)\]\}]))/,"-":/^-/,"pm-operator":/^(?:\\pm|\$\\pm\$|\+-|\+\/-)/,operator:/^(?:\+|(?:[\-=<>]|<<|>>|\\approx|\$\\approx\$)(?=\s|$|-?[0-9]))/,arrowUpDown:/^(?:v|\(v\)|\^|\(\^\))(?=$|[\s,;\)\]\}])/,"\\bond{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\bond{","","","}")},"->":/^(?:<->|<-->|->|<-|<=>>|<<=>|<=>|[\u2192\u27F6\u21CC])/,CMT:/^[CMT](?=\[)/,"[(...)]":function(t){return ee.patterns.findObserveGroups(t,"[","","","]")},"1st-level escape":/^(&|\\\\|\\hline)\s*/,"\\,":/^(?:\\[,\ ;:])/,"\\x{}{}":function(t){return ee.patterns.findObserveGroups(t,"",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"\\x{}":function(t){return ee.patterns.findObserveGroups(t,"",/^\\[a-zA-Z]+\{/,"}","")},"\\ca":/^\\ca(?:\s+|(?![a-zA-Z]))/,"\\x":/^(?:\\[a-zA-Z]+\s*|\\[_&{}%])/,orbital:/^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/,others:/^[\/~|]/,"\\frac{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\frac{","","","}","{","","","}")},"\\overset{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\overset{","","","}","{","","","}")},"\\underset{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\underset{","","","}","{","","","}")},"\\underbrace{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\underbrace{","","","}_","{","","","}")},"\\color{(...)}0":function(t){return ee.patterns.findObserveGroups(t,"\\color{","","","}")},"\\color{(...)}{(...)}1":function(t){return ee.patterns.findObserveGroups(t,"\\color{","","","}","{","","","}")},"\\color(...){(...)}2":function(t){return ee.patterns.findObserveGroups(t,"\\color","\\","",/^(?=\{)/,"{","","","}")},"\\ce{(...)}":function(t){return ee.patterns.findObserveGroups(t,"\\ce{","","","}")},oxidation$:/^(?:[+-][IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"d-oxidation$":/^(?:[+-]?\s?[IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"roman numeral":/^[IVX]+/,"1/2$":/^[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+(?:\$[a-z]\$|[a-z])?$/,amount:function(t){var e;if(e=t.match(/^(?:(?:(?:\([+\-]?[0-9]+\/[0-9]+\)|[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+|[+\-]?[0-9]+[.,][0-9]+|[+\-]?\.[0-9]+|[+\-]?[0-9]+)(?:[a-z](?=\s*[A-Z]))?)|[+\-]?[a-z](?=\s*[A-Z])|\+(?!\s))/),e)return{match_:e[0],remainder:t.substr(e[0].length)};var n=ee.patterns.findObserveGroups(t,"","$","$","");return n&&(e=n.match_.match(/^\$(?:\(?[+\-]?(?:[0-9]*[a-z]?[+\-])?[0-9]*[a-z](?:[+\-][0-9]*[a-z]?)?\)?|\+|-)\$$/),e)?{match_:e[0],remainder:t.substr(e[0].length)}:null},amount2:function(t){return this.amount(t)},"(KV letters),":/^(?:[A-Z][a-z]{0,2}|i)(?=,)/,formula$:function(t){if(t.match(/^\([a-z]+\)$/))return null;var e=t.match(/^(?:[a-z]|(?:[0-9\ \+\-\,\.\(\)]+[a-z])+[0-9\ \+\-\,\.\(\)]*|(?:[a-z][0-9\ \+\-\,\.\(\)]+)+[a-z]?)$/);return e?{match_:e[0],remainder:t.substr(e[0].length)}:null},uprightEntities:/^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,"/":/^\s*(\/)\s*/,"//":/^\s*(\/\/)\s*/,"*":/^\s*[*.]\s*/},findObserveGroups:function(t,e,n,r,i,o,s,a,l,u){var c=function(k,D){if(typeof D=="string")return k.indexOf(D)!==0?null:D;var N=k.match(D);return N?N[0]:null},d=function(k,D,N){for(var B=0;D<k.length;){var T=k.charAt(D),R=c(k.substr(D),N);if(R!==null&&B===0)return{endMatchBegin:D,endMatchEnd:D+R.length};if(T==="{")B++;else if(T==="}"){if(B===0)throw["ExtraCloseMissingOpen","Extra close brace or missing open brace"];B--}D++}return null},p=c(t,e);if(p===null||(t=t.substr(p.length),p=c(t,n),p===null))return null;var f=d(t,p.length,r||i);if(f===null)return null;var g=t.substring(0,r?f.endMatchEnd:f.endMatchBegin);if(o||s){var x=this.findObserveGroups(t.substr(f.endMatchEnd),o,s,a,l);if(x===null)return null;var w=[g,x.match_];return{match_:u?w.join(""):w,remainder:x.remainder}}else return{match_:g,remainder:t.substr(f.endMatchEnd)}},match_:function(t,e){var n=ee.patterns.patterns[t];if(n===void 0)throw["MhchemBugP","mhchem bug P. Please report. ("+t+")"];if(typeof n=="function")return ee.patterns.patterns[t](e);var r=e.match(n);if(r){var i;return r[2]?i=[r[1],r[2]]:r[1]?i=r[1]:i=r[0],{match_:i,remainder:e.substr(r[0].length)}}return null}},actions:{"a=":function(t,e){t.a=(t.a||"")+e},"b=":function(t,e){t.b=(t.b||"")+e},"p=":function(t,e){t.p=(t.p||"")+e},"o=":function(t,e){t.o=(t.o||"")+e},"q=":function(t,e){t.q=(t.q||"")+e},"d=":function(t,e){t.d=(t.d||"")+e},"rm=":function(t,e){t.rm=(t.rm||"")+e},"text=":function(t,e){t.text_=(t.text_||"")+e},insert:function(t,e,n){return{type_:n}},"insert+p1":function(t,e,n){return{type_:n,p1:e}},"insert+p1+p2":function(t,e,n){return{type_:n,p1:e[0],p2:e[1]}},copy:function(t,e){return e},rm:function(t,e){return{type_:"rm",p1:e||""}},text:function(t,e){return ee.go(e,"text")},"{text}":function(t,e){var n=["{"];return ee.concatArray(n,ee.go(e,"text")),n.push("}"),n},"tex-math":function(t,e){return ee.go(e,"tex-math")},"tex-math tight":function(t,e){return ee.go(e,"tex-math tight")},bond:function(t,e,n){return{type_:"bond",kind_:n||e}},"color0-output":function(t,e){return{type_:"color0",color:e[0]}},ce:function(t,e){return ee.go(e)},"1/2":function(t,e){var n=[];e.match(/^[+\-]/)&&(n.push(e.substr(0,1)),e=e.substr(1));var r=e.match(/^([0-9]+|\$[a-z]\$|[a-z])\/([0-9]+)(\$[a-z]\$|[a-z])?$/);return r[1]=r[1].replace(/\$/g,""),n.push({type_:"frac",p1:r[1],p2:r[2]}),r[3]&&(r[3]=r[3].replace(/\$/g,""),n.push({type_:"tex-math",p1:r[3]})),n},"9,9":function(t,e){return ee.go(e,"9,9")}},createTransitions:function(t){var e,n,r,i,o={};for(e in t)for(n in t[e])for(r=n.split("|"),t[e][n].stateArray=r,i=0;i<r.length;i++)o[r[i]]=[];for(e in t)for(n in t[e])for(r=t[e][n].stateArray||[],i=0;i<r.length;i++){var s=t[e][n];if(s.action_){s.action_=[].concat(s.action_);for(var a=0;a<s.action_.length;a++)typeof s.action_[a]=="string"&&(s.action_[a]={type_:s.action_[a]})}else s.action_=[];for(var l=e.split("|"),u=0;u<l.length;u++)if(r[i]==="*")for(var c in o)o[c].push({pattern:l[u],task:s});else o[r[i]].push({pattern:l[u],task:s})}return o},stateMachines:{}};ee.stateMachines={ce:{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},else:{"0|1|2":{action_:"beginsWithBond=false",revisit:!0,toContinue:!0}},oxidation$:{0:{action_:"oxidation-output"}},CMT:{r:{action_:"rdt=",nextState:"rt"},rd:{action_:"rqt=",nextState:"rdt"}},arrowUpDown:{"0|1|2|as":{action_:["sb=false","output","operator"],nextState:"1"}},uprightEntities:{"0|1|2":{action_:["o=","output"],nextState:"1"}},orbital:{"0|1|2|3":{action_:"o=",nextState:"o"}},"->":{"0|1|2|3":{action_:"r=",nextState:"r"},"a|as":{action_:["output","r="],nextState:"r"},"*":{action_:["output","r="],nextState:"r"}},"+":{o:{action_:"d= kv",nextState:"d"},"d|D":{action_:"d=",nextState:"d"},q:{action_:"d=",nextState:"qd"},"qd|qD":{action_:"d=",nextState:"qd"},dq:{action_:["output","d="],nextState:"d"},3:{action_:["sb=false","output","operator"],nextState:"0"}},amount:{"0|2":{action_:"a=",nextState:"a"}},"pm-operator":{"0|1|2|a|as":{action_:["sb=false","output",{type_:"operator",option:"\\pm"}],nextState:"0"}},operator:{"0|1|2|a|as":{action_:["sb=false","output","operator"],nextState:"0"}},"-$":{"o|q":{action_:["charge or bond","output"],nextState:"qd"},d:{action_:"d=",nextState:"d"},D:{action_:["output",{type_:"bond",option:"-"}],nextState:"3"},q:{action_:"d=",nextState:"qd"},qd:{action_:"d=",nextState:"qd"},"qD|dq":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},"-9":{"3|o":{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"3"}},"- orbital overlap":{o:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},d:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"}},"-":{"0|1|2":{action_:[{type_:"output",option:1},"beginsWithBond=true",{type_:"bond",option:"-"}],nextState:"3"},3:{action_:{type_:"bond",option:"-"}},a:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},as:{action_:[{type_:"output",option:2},{type_:"bond",option:"-"}],nextState:"3"},b:{action_:"b="},o:{action_:{type_:"- after o/d",option:!1},nextState:"2"},q:{action_:{type_:"- after o/d",option:!1},nextState:"2"},"d|qd|dq":{action_:{type_:"- after o/d",option:!0},nextState:"2"},"D|qD|p":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},amount2:{"1|3":{action_:"a=",nextState:"a"}},letters:{"0|1|2|3|a|as|b|p|bp|o":{action_:"o=",nextState:"o"},"q|dq":{action_:["output","o="],nextState:"o"},"d|D|qd|qD":{action_:"o after d",nextState:"o"}},digits:{o:{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},q:{action_:["output","o="],nextState:"o"},a:{action_:"o=",nextState:"o"}},"space A":{"b|p|bp":{}},space:{a:{nextState:"as"},0:{action_:"sb=false"},"1|2":{action_:"sb=true"},"r|rt|rd|rdt|rdq":{action_:"output",nextState:"0"},"*":{action_:["output","sb=true"],nextState:"1"}},"1st-level escape":{"1|2":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}]},"*":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}],nextState:"0"}},"[(...)]":{"r|rt":{action_:"rd=",nextState:"rd"},"rd|rdt":{action_:"rq=",nextState:"rdq"}},"...":{"o|d|D|dq|qd|qD":{action_:["output",{type_:"bond",option:"..."}],nextState:"3"},"*":{action_:[{type_:"output",option:1},{type_:"insert",option:"ellipsis"}],nextState:"1"}},". |* ":{"*":{action_:["output",{type_:"insert",option:"addition compound"}],nextState:"1"}},"state of aggregation $":{"*":{action_:["output","state of aggregation"],nextState:"1"}},"{[(":{"a|as|o":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"0|1|2|3":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"*":{action_:["output","o=","output","parenthesisLevel++"],nextState:"2"}},")]}":{"0|1|2|3|b|p|bp|o":{action_:["o=","parenthesisLevel--"],nextState:"o"},"a|as|d|D|q|qd|qD|dq":{action_:["output","o=","parenthesisLevel--"],nextState:"o"}},", ":{"*":{action_:["output","comma"],nextState:"0"}},"^_":{"*":{}},"^{(...)}|^($...$)":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"D"},q:{action_:"d=",nextState:"qD"},"d|D|qd|qD|dq":{action_:["output","d="],nextState:"D"}},"^a|^\\x{}{}|^\\x{}|^\\x|'":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"d"},q:{action_:"d=",nextState:"qd"},"d|qd|D|qD":{action_:"d="},dq:{action_:["output","d="],nextState:"d"}},"_{(state of aggregation)}$":{"d|D|q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"_{(...)}|_($...$)|_9|_\\x{}{}|_\\x{}|_\\x":{"0|1|2|as":{action_:"p=",nextState:"p"},b:{action_:"p=",nextState:"bp"},"3|o":{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},"q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"=<>":{"0|1|2|3|a|as|o|q|d|D|qd|qD|dq":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"#":{"0|1|2|3|a|as|o":{action_:[{type_:"output",option:2},{type_:"bond",option:"#"}],nextState:"3"}},"{}":{"*":{action_:{type_:"output",option:1},nextState:"1"}},"{...}":{"0|1|2|3|a|as|b|p|bp":{action_:"o=",nextState:"o"},"o|d|D|q|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"$...$":{a:{action_:"a="},"0|1|2|3|as|b|p|bp|o":{action_:"o=",nextState:"o"},"as|o":{action_:"o="},"q|d|D|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"\\bond{(...)}":{"*":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"\\frac{(...)}":{"*":{action_:[{type_:"output",option:1},"frac-output"],nextState:"3"}},"\\overset{(...)}":{"*":{action_:[{type_:"output",option:2},"overset-output"],nextState:"3"}},"\\underset{(...)}":{"*":{action_:[{type_:"output",option:2},"underset-output"],nextState:"3"}},"\\underbrace{(...)}":{"*":{action_:[{type_:"output",option:2},"underbrace-output"],nextState:"3"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:[{type_:"output",option:2},"color-output"],nextState:"3"}},"\\color{(...)}0":{"*":{action_:[{type_:"output",option:2},"color0-output"]}},"\\ce{(...)}":{"*":{action_:[{type_:"output",option:2},"ce"],nextState:"3"}},"\\,":{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"1"}},"\\x{}{}|\\x{}|\\x":{"0|1|2|3|a|as|b|p|bp|o|c0":{action_:["o=","output"],nextState:"3"},"*":{action_:["output","o=","output"],nextState:"3"}},others:{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"3"}},else2:{a:{action_:"a to o",nextState:"o",revisit:!0},as:{action_:["output","sb=true"],nextState:"1",revisit:!0},"r|rt|rd|rdt|rdq":{action_:["output"],nextState:"0",revisit:!0},"*":{action_:["output","copy"],nextState:"3"}}}),actions:{"o after d":function(t,e){var n;if((t.d||"").match(/^[0-9]+$/)){var r=t.d;t.d=void 0,n=this.output(t),t.b=r}else n=this.output(t);return ee.actions["o="](t,e),n},"d= kv":function(t,e){t.d=e,t.dType="kv"},"charge or bond":function(t,e){if(t.beginsWithBond){var n=[];return ee.concatArray(n,this.output(t)),ee.concatArray(n,ee.actions.bond(t,e,"-")),n}else t.d=e},"- after o/d":function(t,e,n){var r=ee.patterns.match_("orbital",t.o||""),i=ee.patterns.match_("one lowercase greek letter $",t.o||""),o=ee.patterns.match_("one lowercase latin letter $",t.o||""),s=ee.patterns.match_("$one lowercase latin letter$ $",t.o||""),a=e==="-"&&(r&&r.remainder===""||i||o||s);a&&!t.a&&!t.b&&!t.p&&!t.d&&!t.q&&!r&&o&&(t.o="$"+t.o+"$");var l=[];return a?(ee.concatArray(l,this.output(t)),l.push({type_:"hyphen"})):(r=ee.patterns.match_("digits",t.d||""),n&&r&&r.remainder===""?(ee.concatArray(l,ee.actions["d="](t,e)),ee.concatArray(l,this.output(t))):(ee.concatArray(l,this.output(t)),ee.concatArray(l,ee.actions.bond(t,e,"-")))),l},"a to o":function(t){t.o=t.a,t.a=void 0},"sb=true":function(t){t.sb=!0},"sb=false":function(t){t.sb=!1},"beginsWithBond=true":function(t){t.beginsWithBond=!0},"beginsWithBond=false":function(t){t.beginsWithBond=!1},"parenthesisLevel++":function(t){t.parenthesisLevel++},"parenthesisLevel--":function(t){t.parenthesisLevel--},"state of aggregation":function(t,e){return{type_:"state of aggregation",p1:ee.go(e,"o")}},comma:function(t,e){var n=e.replace(/\s*$/,""),r=n!==e;return r&&t.parenthesisLevel===0?{type_:"comma enumeration L",p1:n}:{type_:"comma enumeration M",p1:n}},output:function(t,e,n){var r;if(!t.r)r=[],!t.a&&!t.b&&!t.p&&!t.o&&!t.q&&!t.d&&!n||(t.sb&&r.push({type_:"entitySkip"}),!t.o&&!t.q&&!t.d&&!t.b&&!t.p&&n!==2?(t.o=t.a,t.a=void 0):!t.o&&!t.q&&!t.d&&(t.b||t.p)?(t.o=t.a,t.d=t.b,t.q=t.p,t.a=t.b=t.p=void 0):t.o&&t.dType==="kv"&&ee.patterns.match_("d-oxidation$",t.d||"")?t.dType="oxidation":t.o&&t.dType==="kv"&&!t.q&&(t.dType=void 0),r.push({type_:"chemfive",a:ee.go(t.a,"a"),b:ee.go(t.b,"bd"),p:ee.go(t.p,"pq"),o:ee.go(t.o,"o"),q:ee.go(t.q,"pq"),d:ee.go(t.d,t.dType==="oxidation"?"oxidation":"bd"),dType:t.dType}));else{var i;t.rdt==="M"?i=ee.go(t.rd,"tex-math"):t.rdt==="T"?i=[{type_:"text",p1:t.rd||""}]:i=ee.go(t.rd);var o;t.rqt==="M"?o=ee.go(t.rq,"tex-math"):t.rqt==="T"?o=[{type_:"text",p1:t.rq||""}]:o=ee.go(t.rq),r={type_:"arrow",r:t.r,rd:i,rq:o}}for(var s in t)s!=="parenthesisLevel"&&s!=="beginsWithBond"&&delete t[s];return r},"oxidation-output":function(t,e){var n=["{"];return ee.concatArray(n,ee.go(e,"oxidation")),n.push("}"),n},"frac-output":function(t,e){return{type_:"frac-ce",p1:ee.go(e[0]),p2:ee.go(e[1])}},"overset-output":function(t,e){return{type_:"overset",p1:ee.go(e[0]),p2:ee.go(e[1])}},"underset-output":function(t,e){return{type_:"underset",p1:ee.go(e[0]),p2:ee.go(e[1])}},"underbrace-output":function(t,e){return{type_:"underbrace",p1:ee.go(e[0]),p2:ee.go(e[1])}},"color-output":function(t,e){return{type_:"color",color1:e[0],color2:ee.go(e[1])}},"r=":function(t,e){t.r=e},"rdt=":function(t,e){t.rdt=e},"rd=":function(t,e){t.rd=e},"rqt=":function(t,e){t.rqt=e},"rq=":function(t,e){t.rq=e},operator:function(t,e,n){return{type_:"operator",kind_:n||e}}}},a:{transitions:ee.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},"$(...)$":{"*":{action_:"tex-math tight",nextState:"1"}},",":{"*":{action_:{type_:"insert",option:"commaDecimal"}}},else2:{"*":{action_:"copy"}}}),actions:{}},o:{transitions:ee.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},letters:{"*":{action_:"rm"}},"\\ca":{"*":{action_:{type_:"insert",option:"circa"}}},"\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"{text}"}},else2:{"*":{action_:"copy"}}}),actions:{}},text:{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},"{...}":{"*":{action_:"text="}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"\\greek":{"*":{action_:["output","rm"]}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:["output","copy"]}},else:{"*":{action_:"text="}}}),actions:{output:function(t){if(t.text_){var e={type_:"text",p1:t.text_};for(var n in t)delete t[n];return e}}}},pq:{transitions:ee.createTransitions({empty:{"*":{}},"state of aggregation $":{"*":{action_:"state of aggregation"}},i$:{0:{nextState:"!f",revisit:!0}},"(KV letters),":{0:{action_:"rm",nextState:"0"}},formula$:{0:{nextState:"f",revisit:!0}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"!f",revisit:!0}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"a-z":{f:{action_:"tex-math"}},letters:{"*":{action_:"rm"}},"-9.,9":{"*":{action_:"9,9"}},",":{"*":{action_:{type_:"insert+p1",option:"comma enumeration S"}}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"state of aggregation":function(t,e){return{type_:"state of aggregation subscript",p1:ee.go(e,"o")}},"color-output":function(t,e){return{type_:"color",color1:e[0],color2:ee.go(e[1],"pq")}}}},bd:{transitions:ee.createTransitions({empty:{"*":{}},x$:{0:{nextState:"!f",revisit:!0}},formula$:{0:{nextState:"f",revisit:!0}},else:{0:{nextState:"!f",revisit:!0}},"-9.,9 no missing 0":{"*":{action_:"9,9"}},".":{"*":{action_:{type_:"insert",option:"electron dot"}}},"a-z":{f:{action_:"tex-math"}},x:{"*":{action_:{type_:"insert",option:"KV x"}}},letters:{"*":{action_:"rm"}},"'":{"*":{action_:{type_:"insert",option:"prime"}}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"color-output":function(t,e){return{type_:"color",color1:e[0],color2:ee.go(e[1],"bd")}}}},oxidation:{transitions:ee.createTransitions({empty:{"*":{}},"roman numeral":{"*":{action_:"roman-numeral"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},else:{"*":{action_:"copy"}}}),actions:{"roman-numeral":function(t,e){return{type_:"roman numeral",p1:e||""}}}},"tex-math":{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},else:{"*":{action_:"o="}}}),actions:{output:function(t){if(t.o){var e={type_:"tex-math",p1:t.o};for(var n in t)delete t[n];return e}}}},"tex-math tight":{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},"-|+":{"*":{action_:"tight operator"}},else:{"*":{action_:"o="}}}),actions:{"tight operator":function(t,e){t.o=(t.o||"")+"{"+e+"}"},output:function(t){if(t.o){var e={type_:"tex-math",p1:t.o};for(var n in t)delete t[n];return e}}}},"9,9":{transitions:ee.createTransitions({empty:{"*":{}},",":{"*":{action_:"comma"}},else:{"*":{action_:"copy"}}}),actions:{comma:function(){return{type_:"commaDecimal"}}}},pu:{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},space$:{"*":{action_:["output","space"]}},"{[(|)]}":{"0|a":{action_:"copy"}},"(-)(9)^(-9)":{0:{action_:"number^",nextState:"a"}},"(-)(9.,9)(e)(99)":{0:{action_:"enumber",nextState:"a"}},space:{"0|a":{}},"pm-operator":{"0|a":{action_:{type_:"operator",option:"\\pm"},nextState:"0"}},operator:{"0|a":{action_:"copy",nextState:"0"}},"//":{d:{action_:"o=",nextState:"/"}},"/":{d:{action_:"o=",nextState:"/"}},"{...}|else":{"0|d":{action_:"d=",nextState:"d"},a:{action_:["space","d="],nextState:"d"},"/|q":{action_:"q=",nextState:"q"}}}),actions:{enumber:function(t,e){var n=[];return e[0]==="+-"||e[0]==="+/-"?n.push("\\pm "):e[0]&&n.push(e[0]),e[1]&&(ee.concatArray(n,ee.go(e[1],"pu-9,9")),e[2]&&(e[2].match(/[,.]/)?ee.concatArray(n,ee.go(e[2],"pu-9,9")):n.push(e[2])),(e[3]||e[4])&&(e[3]==="e"||e[4]==="*"?n.push({type_:"cdot"}):n.push({type_:"times"}))),e[5]&&n.push("10^{"+e[5]+"}"),n},"number^":function(t,e){var n=[];return e[0]==="+-"||e[0]==="+/-"?n.push("\\pm "):e[0]&&n.push(e[0]),ee.concatArray(n,ee.go(e[1],"pu-9,9")),n.push("^{"+e[2]+"}"),n},operator:function(t,e,n){return{type_:"operator",kind_:n||e}},space:function(){return{type_:"pu-space-1"}},output:function(t){var e,n=ee.patterns.match_("{(...)}",t.d||"");n&&n.remainder===""&&(t.d=n.match_);var r=ee.patterns.match_("{(...)}",t.q||"");if(r&&r.remainder===""&&(t.q=r.match_),t.d&&(t.d=t.d.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),t.d=t.d.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F")),t.q){t.q=t.q.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),t.q=t.q.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F");var i={d:ee.go(t.d,"pu"),q:ee.go(t.q,"pu")};t.o==="//"?e={type_:"pu-frac",p1:i.d,p2:i.q}:(e=i.d,i.d.length>1||i.q.length>1?e.push({type_:" / "}):e.push({type_:"/"}),ee.concatArray(e,i.q))}else e=ee.go(t.d,"pu-2");for(var o in t)delete t[o];return e}}},"pu-2":{transitions:ee.createTransitions({empty:{"*":{action_:"output"}},"*":{"*":{action_:["output","cdot"],nextState:"0"}},"\\x":{"*":{action_:"rm="}},space:{"*":{action_:["output","space"],nextState:"0"}},"^{(...)}|^(-1)":{1:{action_:"^(-1)"}},"-9.,9":{0:{action_:"rm=",nextState:"0"},1:{action_:"^(-1)",nextState:"0"}},"{...}|else":{"*":{action_:"rm=",nextState:"1"}}}),actions:{cdot:function(){return{type_:"tight cdot"}},"^(-1)":function(t,e){t.rm+="^{"+e+"}"},space:function(){return{type_:"pu-space-2"}},output:function(t){var e=[];if(t.rm){var n=ee.patterns.match_("{(...)}",t.rm||"");n&&n.remainder===""?e=ee.go(n.match_,"pu"):e={type_:"rm",p1:t.rm}}for(var r in t)delete t[r];return e}}},"pu-9,9":{transitions:ee.createTransitions({empty:{0:{action_:"output-0"},o:{action_:"output-o"}},",":{0:{action_:["output-0","comma"],nextState:"o"}},".":{0:{action_:["output-0","copy"],nextState:"o"}},else:{"*":{action_:"text="}}}),actions:{comma:function(){return{type_:"commaDecimal"}},"output-0":function(t){var e=[];if(t.text_=t.text_||"",t.text_.length>4){var n=t.text_.length%3;n===0&&(n=3);for(var r=t.text_.length-3;r>0;r-=3)e.push(t.text_.substr(r,3)),e.push({type_:"1000 separator"});e.push(t.text_.substr(0,n)),e.reverse()}else e.push(t.text_);for(var i in t)delete t[i];return e},"output-o":function(t){var e=[];if(t.text_=t.text_||"",t.text_.length>4){for(var n=t.text_.length-3,r=0;r<n;r+=3)e.push(t.text_.substr(r,3)),e.push({type_:"1000 separator"});e.push(t.text_.substr(r))}else e.push(t.text_);for(var i in t)delete t[i];return e}}}};var mt={go:function(t,e){if(!t)return"";for(var n="",r=!1,i=0;i<t.length;i++){var o=t[i];typeof o=="string"?n+=o:(n+=mt._go2(o),o.type_==="1st-level escape"&&(r=!0))}return!e&&!r&&n&&(n="{"+n+"}"),n},_goInner:function(t){return t&&mt.go(t,!0)},_go2:function(t){var e;switch(t.type_){case"chemfive":e="";var n={a:mt._goInner(t.a),b:mt._goInner(t.b),p:mt._goInner(t.p),o:mt._goInner(t.o),q:mt._goInner(t.q),d:mt._goInner(t.d)};n.a&&(n.a.match(/^[+\-]/)&&(n.a="{"+n.a+"}"),e+=n.a+"\\,"),(n.b||n.p)&&(e+="{\\vphantom{X}}",e+="^{\\hphantom{"+(n.b||"")+"}}_{\\hphantom{"+(n.p||"")+"}}",e+="{\\vphantom{X}}",e+="^{\\smash[t]{\\vphantom{2}}\\llap{"+(n.b||"")+"}}",e+="_{\\vphantom{2}\\llap{\\smash[t]{"+(n.p||"")+"}}}"),n.o&&(n.o.match(/^[+\-]/)&&(n.o="{"+n.o+"}"),e+=n.o),t.dType==="kv"?((n.d||n.q)&&(e+="{\\vphantom{X}}"),n.d&&(e+="^{"+n.d+"}"),n.q&&(e+="_{\\smash[t]{"+n.q+"}}")):t.dType==="oxidation"?(n.d&&(e+="{\\vphantom{X}}",e+="^{"+n.d+"}"),n.q&&(e+="{\\vphantom{X}}",e+="_{\\smash[t]{"+n.q+"}}")):(n.q&&(e+="{\\vphantom{X}}",e+="_{\\smash[t]{"+n.q+"}}"),n.d&&(e+="{\\vphantom{X}}",e+="^{"+n.d+"}"));break;case"rm":e="\\mathrm{"+t.p1+"}";break;case"text":t.p1.match(/[\^_]/)?(t.p1=t.p1.replace(" ","~").replace("-","\\text{-}"),e="\\mathrm{"+t.p1+"}"):e="\\text{"+t.p1+"}";break;case"roman numeral":e="\\mathrm{"+t.p1+"}";break;case"state of aggregation":e="\\mskip2mu "+mt._goInner(t.p1);break;case"state of aggregation subscript":e="\\mskip1mu "+mt._goInner(t.p1);break;case"bond":if(e=mt._getBond(t.kind_),!e)throw["MhchemErrorBond","mhchem Error. Unknown bond type ("+t.kind_+")"];break;case"frac":var r="\\frac{"+t.p1+"}{"+t.p2+"}";e="\\mathchoice{\\textstyle"+r+"}{"+r+"}{"+r+"}{"+r+"}";break;case"pu-frac":var i="\\frac{"+mt._goInner(t.p1)+"}{"+mt._goInner(t.p2)+"}";e="\\mathchoice{\\textstyle"+i+"}{"+i+"}{"+i+"}{"+i+"}";break;case"tex-math":e=t.p1+" ";break;case"frac-ce":e="\\frac{"+mt._goInner(t.p1)+"}{"+mt._goInner(t.p2)+"}";break;case"overset":e="\\overset{"+mt._goInner(t.p1)+"}{"+mt._goInner(t.p2)+"}";break;case"underset":e="\\underset{"+mt._goInner(t.p1)+"}{"+mt._goInner(t.p2)+"}";break;case"underbrace":e="\\underbrace{"+mt._goInner(t.p1)+"}_{"+mt._goInner(t.p2)+"}";break;case"color":e="{\\color{"+t.color1+"}{"+mt._goInner(t.color2)+"}}";break;case"color0":e="\\color{"+t.color+"}";break;case"arrow":var o={rd:mt._goInner(t.rd),rq:mt._goInner(t.rq)},s=mt._getArrow(t.r);o.rd||o.rq?t.r==="<=>"||t.r==="<=>>"||t.r==="<<=>"||t.r==="<-->"?(s="\\long"+s,o.rd&&(s="\\overset{"+o.rd+"}{"+s+"}"),o.rq&&(t.r==="<-->"?s="\\underset{\\lower2mu{"+o.rq+"}}{"+s+"}":s="\\underset{\\lower6mu{"+o.rq+"}}{"+s+"}"),s=" {}\\mathrel{"+s+"}{} "):(o.rq&&(s+="[{"+o.rq+"}]"),s+="{"+o.rd+"}",s=" {}\\mathrel{\\x"+s+"}{} "):s=" {}\\mathrel{\\long"+s+"}{} ",e=s;break;case"operator":e=mt._getOperator(t.kind_);break;case"1st-level escape":e=t.p1+" ";break;case"space":e=" ";break;case"entitySkip":e="~";break;case"pu-space-1":e="~";break;case"pu-space-2":e="\\mkern3mu ";break;case"1000 separator":e="\\mkern2mu ";break;case"commaDecimal":e="{,}";break;case"comma enumeration L":e="{"+t.p1+"}\\mkern6mu ";break;case"comma enumeration M":e="{"+t.p1+"}\\mkern3mu ";break;case"comma enumeration S":e="{"+t.p1+"}\\mkern1mu ";break;case"hyphen":e="\\text{-}";break;case"addition compound":e="\\,{\\cdot}\\,";break;case"electron dot":e="\\mkern1mu \\bullet\\mkern1mu ";break;case"KV x":e="{\\times}";break;case"prime":e="\\prime ";break;case"cdot":e="\\cdot ";break;case"tight cdot":e="\\mkern1mu{\\cdot}\\mkern1mu ";break;case"times":e="\\times ";break;case"circa":e="{\\sim}";break;case"^":e="uparrow";break;case"v":e="downarrow";break;case"ellipsis":e="\\ldots ";break;case"/":e="/";break;case" / ":e="\\,/\\,";break;default:throw["MhchemBugT","mhchem bug T. Please report."]}return e},_getArrow:function(t){switch(t){case"->":return"rightarrow";case"":return"rightarrow";case"":return"rightarrow";case"<-":return"leftarrow";case"<->":return"leftrightarrow";case"<-->":return"leftrightarrows";case"<=>":return"rightleftharpoons";case"":return"rightleftharpoons";case"<=>>":return"Rightleftharpoons";case"<<=>":return"Leftrightharpoons";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getBond:function(t){switch(t){case"-":return"{-}";case"1":return"{-}";case"=":return"{=}";case"2":return"{=}";case"#":return"{\\equiv}";case"3":return"{\\equiv}";case"~":return"{\\tripledash}";case"~-":return"{\\rlap{\\lower.1em{-}}\\raise.1em{\\tripledash}}";case"~=":return"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{\\tripledash}}-}";case"~--":return"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{\\tripledash}}-}";case"-~-":return"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{-}}\\tripledash}";case"...":return"{{\\cdot}{\\cdot}{\\cdot}}";case"....":return"{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}";case"->":return"{\\rightarrow}";case"<-":return"{\\leftarrow}";case"<":return"{<}";case">":return"{>}";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getOperator:function(t){switch(t){case"+":return" {}+{} ";case"-":return" {}-{} ";case"=":return" {}={} ";case"<":return" {}<{} ";case">":return" {}>{} ";case"<<":return" {}\\ll{} ";case">>":return" {}\\gg{} ";case"\\pm":return" {}\\pm{} ";case"\\approx":return" {}\\approx{} ";case"$\\approx$":return" {}\\approx{} ";case"v":return" \\downarrow{} ";case"(v)":return" \\downarrow{} ";case"^":return" \\uparrow{} ";case"(^)":return" \\uparrow{} ";default:throw["MhchemBugT","mhchem bug T. Please report."]}}},Gx=class Xx extends G{constructor(e){super(V(O({},e),{type:"delim"})),this.value=e.delim,this.size=e.size}static fromJson(e){return new Xx(e)}toJson(){return V(O({},super.toJson()),{delim:this.value,size:this.size})}render(e){return new oe(this.value,{type:"middle"})}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);return n!=null&&n.serialize?n.serialize(this,e):ut(this.command,this.value)}},Yx=class Zx extends G{constructor(e){super(V(O({},e),{type:"sizeddelim",value:e.delim})),this.delimType=e.delimType,this.size=e.size}static fromJson(e){return new Zx(e)}toJson(){return V(O({},super.toJson()),{delim:this.value,size:this.size,delimType:this.delimType})}render(e){let n=YC(this.value,this.size,e,{classes:{open:"ML__open",close:"ML__close"}[this.delimType],type:this.delimType,isSelected:this.isSelected});return n?(n=this.bind(e,n),this.caret&&(n.caret=this.caret),n):null}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);return n!=null&&n.serialize?n.serialize(this,e):ut(this.command,this.value)}},Ll=class Qx extends G{constructor(e,n,r,i){var o,s;super({type:"enclose",command:e,style:i.style}),this.body=n,this.backgroundcolor=i.backgroundcolor,r.updiagonalarrow&&(r.updiagonalstrike=!1),r.box&&(r.left=!1,r.right=!1,r.bottom=!1,r.top=!1),this.notation=r,this.shadow=(o=i.shadow)!=null?o:"none",this.strokeWidth=(s=i.strokeWidth)!=null?s:"0.06em",this.strokeWidth||(this.strokeWidth="0.06em"),this.strokeStyle=i.strokeStyle,this.svgStrokeStyle=i.svgStrokeStyle,this.strokeColor=i.strokeColor,this.borderStyle=i.borderStyle,this.padding=i.padding,this.captureSelection=!1}static fromJson(e){return new Qx(e.command,e.body,e.notation,e)}toJson(){return V(O({},super.toJson()),{notation:this.notation,shadow:this.shadow,strokeWidth:this.strokeWidth,strokeStyle:this.strokeStyle,svgStrokeStyle:this.svgStrokeStyle,strokeColor:this.strokeColor,borderStyle:this.borderStyle,padding:this.padding})}_serialize(e){var n;if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let r=Vt(this.command,this.mode);if(r!=null&&r.serialize)return r.serialize(this,e);let i=(n=this.command)!=null?n:"";if(this.command==="\\enclose"){i+="{"+Object.keys(this.notation).join(" ")+"}";let o="",s="";this.backgroundcolor&&this.backgroundcolor!=="transparent"&&(o+=s+'mathbackground="'+this.backgroundcolor+'"',s=","),this.shadow&&this.shadow!=="auto"&&(o+=s+'shadow="'+this.shadow+'"',s=","),this.strokeWidth||this.strokeStyle!=="solid"?(o+=s+this.borderStyle,s=","):this.strokeColor&&this.strokeColor!=="currentColor"&&(o+=s+'mathcolor="'+this.strokeColor+'"',s=","),o&&(i+=`[${o}]`)}return ut(i,this.bodyToLatex(e))}render(e){let n=new Ye({parent:e},this.style),r=G.createBox(n,this.body);if(!r)return null;let i=mE(this.borderStyle),o=n.toEm(!this.padding||this.padding==="auto"?{register:"fboxsep"}:{string:this.padding});r.setStyle("position","relative"),r.setStyle("display","inline-block"),r.setStyle("height",r.height+r.depth,"em"),r.setStyle("width",r.width,"em");let s=new oe(null,{classes:"ML__notation"}),a=r.height+r.depth+2*o,l=r.width+2*o,u="",c=Math.min(o*.2,.05);if(this.notation.horizontalstrike){let f=2*o+r.height-Jr/2;u+=this.line((o+c).toString(),f.toString(),(o+r.width-c).toString(),f.toString())}if(this.notation.verticalstrike){let f=o+r.width/2;u+=this.line(f.toString(),(o+c).toString(),f.toString(),(a-o-c).toString())}if(this.notation.updiagonalstrike&&(u+=this.line((o+c).toString(),(a-o-c).toString(),(o+r.width-c).toString(),(o+c).toString())),this.notation.downdiagonalstrike&&(u+=this.line((o+c).toString(),(o+c).toString(),(o+r.width-c).toString(),(a-o-c).toString())),this.notation.updiagonalarrow){u+=this.line(o.toString(),(2*o+r.depth+r.height).toString(),(o+r.width).toString(),o.toString());let f=.03*Math.sqrt(l*l+a*a)*1,g=r.width*f,x=(r.depth+r.height)*f,w=o+r.width,k=o;k+x-.4*g<0&&(k=.4*g-x),u+='<polygon points="',u+=`${w},${k} ${w-g-.4*x},${k+x-.4*g} `,u+=`${w-.7*g},${k+.7*x} ${w-g+.4*x},${k+x+.4*g} `,u+=`${w},${k}`,u+=`" stroke='none' fill="${this.strokeColor}"`,u+="/>"}let d=0;if(this.notation.phasorangle){let f=Qb(n),g=(r.height+r.depth+2*f+2*o).toString(),x=(r.height+r.depth)/2;u+=this.line(o.toString(),g,(o+x+r.width).toString(),g),u+=this.line(o.toString(),g,(o+x).toString(),(o-f).toString()),a+=f,d=x,r.left+=a/2-o}if(this.notation.longdiv){let f=Qb(n);a+=f,u+=this.line(o.toString(),o.toString(),(o+r.width).toString(),o.toString());let g=.3;d=g+f,r.left+=g+f,r.setTop(o+f),u+='<path d="',u+=`M ${o} ${o}  a${g} ${(r.depth+r.height+2*f)/2}, 0, 1, 1, 0 ${r.depth+r.height+2*f} "`,u+=` stroke-width="${gE(n)}" stroke="${this.strokeColor}" fill="none"`,u+="/>"}if(s.width=r.width+2*o+d,s.height=r.height+2*o,s.depth=r.depth,s.setStyle("box-sizing","border-box"),s.setStyle("left",`calc(-1 * ${i} - ${o}em)`),s.setStyle("height",`calc( ${r.height+r.depth+2*o}em + ${i})`),s.setStyle("top","0em"),s.setStyle("width",`calc(${r.width+2*o}em + ${i})`),this.backgroundcolor&&s.setStyle("background-color",this.backgroundcolor),this.notation.box&&s.setStyle("border","1px solid red"),this.notation.actuarial&&(s.setStyle("border-top",this.borderStyle),s.setStyle("border-right",this.borderStyle)),this.notation.madruwb&&(s.setStyle("border-bottom",this.borderStyle),s.setStyle("border-right",this.borderStyle)),this.notation.roundedbox&&(s.setStyle("border-radius","8px"),s.setStyle("border",this.borderStyle)),this.notation.circle&&(s.setStyle("border-radius","50%"),s.setStyle("border",this.borderStyle)),this.notation.top&&s.setStyle("border-top",this.borderStyle),this.notation.left&&s.setStyle("border-left",this.borderStyle),this.notation.right&&s.setStyle("border-right",this.borderStyle),this.notation.bottom&&s.setStyle("border-bottom",this.borderStyle),u){let f="";this.shadow==="auto"&&(f+="filter: drop-shadow(0 0 .5px rgba(255, 255, 255, .7)) drop-shadow(1px 1px 2px #333)"),this.shadow!=="none"&&(f+=`filter: drop-shadow(${this.shadow})`),f+=` stroke-width="${this.strokeWidth}" stroke="${this.strokeColor}"`,f+=' stroke-linecap="round"',this.svgStrokeStyle&&(f+=` stroke-dasharray="${this.svgStrokeStyle}"`),s.svgStyle=f,s.svgOverlay=u}let p=new oe([s,r]);return p.setStyle("position","relative"),p.setStyle("height",`${Math.floor(100*(s.depth+s.height))/100}em`),p.setStyle("display","inline-block"),p.height=s.height,p.depth=s.depth,p.width=s.width-2*o,p.left=o,p.right=o,this.caret&&(p.caret=this.caret),p.wrap(n)}line(e,n,r,i){return`<line x1="${zu(e)}"  y1="${zu(n)}" x2="${zu(r)}" y2="${zu(i)}" vector-effect="non-scaling-stroke"></line>`}};function zu(t){return typeof t=="number"?`${Math.floor(100*t)/100}%`:t}function mE(t){if(!t)return"1px";let e=t.match(/([0-9][a-zA-Z\%]+)/);return e===null?"1px":e[1]}function gE(t){return(Math.floor(100*t.metrics.sqrtRuleThickness/t.scalingFactor)/100/10).toString()+"em"}function Qb(t){let e=t.isDisplayStyle?Jr:t.metrics.defaultRuleThickness;return t.metrics.defaultRuleThickness+t.scalingFactor*e/4}var hc={fractionNavigationOrder:"numerator-denominator"},Zo=class e5 extends G{constructor(e,n,r){var i,o,s;super(V(O({},r),{type:"genfrac",displayContainsHighlight:!0})),this.above=e,this.below=n,this.hasBarLine=(i=r?.hasBarLine)!=null?i:!0,this.continuousFraction=(o=r?.continuousFraction)!=null?o:!1,this.align=(s=r?.align)!=null?s:"center",this.numerPrefix=r?.numerPrefix,this.denomPrefix=r?.denomPrefix,this.mathstyleName=r?.mathstyleName,this.leftDelim=r?.leftDelim,this.rightDelim=r?.rightDelim}static fromJson(e){return new e5(e.above,e.below,e)}toJson(){let e={};return this.continuousFraction&&(e.continuousFraction=!0),this.align!=="center"&&(e.align=this.align),this.numerPrefix&&(e.numerPrefix=this.numerPrefix),this.denomPrefix&&(e.denomPrefix=this.denomPrefix),this.leftDelim&&(e.leftDelim=this.leftDelim),this.rightDelim&&(e.rightDelim=this.rightDelim),this.hasBarLine||(e.hasBarLine=!1),this.mathstyleName&&(e.mathstyleName=this.mathstyleName),O(O({},super.toJson()),e)}get children(){if(this._children)return this._children;let e=[];if(hc.fractionNavigationOrder==="denominator-numerator"){for(let n of this.below)e.push(...n.children),e.push(n);for(let n of this.above)e.push(...n.children),e.push(n)}else{for(let n of this.above)e.push(...n.children),e.push(n);for(let n of this.below)e.push(...n.children),e.push(n)}return this._children=e,e}render(e){var n,r;let i=new Ye({parent:e,mathstyle:this.mathstyleName},this.style),o=i.metrics,s=new Ye({parent:i,mathstyle:this.continuousFraction?"":"numerator"},this.style),a=this.numerPrefix?new oe([new oe(this.numerPrefix),G.createBox(s,this.above)],{isTight:s.isTight,type:"ignore"}):(n=G.createBox(s,this.above,{type:"ignore"}))!=null?n:new oe(null,{type:"ignore"}),l=new Ye({parent:i,mathstyle:this.continuousFraction?"":"denominator"},this.style),u=this.denomPrefix?new oe([new oe(this.denomPrefix),G.createBox(l,this.below,{type:"ignore"})]):(r=G.createBox(l,this.below,{type:"ignore"}))!=null?r:new oe(null,{type:"ignore"}),c=this.hasBarLine?o.defaultRuleThickness:0,d,p=0,f;i.isDisplayStyle?(d=s.metrics.num1,p=c>0?3*c:7*c,f=l.metrics.denom1):(c>0?(d=s.metrics.num2,p=c):(d=s.metrics.num3,p=3*o.defaultRuleThickness),f=l.metrics.denom2);let g=[];this.isSelected&&g.push("ML__selected");let x=a.depth,w=u.height,k;if(c<=0){let L=d-x-(w-f);L<p&&(d+=(p-L)/2,f+=(p-L)/2),k=new It({individualShift:[{box:a,shift:-d,classes:[...g,Fu(this.align)]},{box:u,shift:f,classes:[...g,Fu(this.align)]}]}).wrap(i)}else{let L=new oe(null,{classes:"ML__frac-line",mode:this.mode,style:this.style});L.softWidth=Math.max(a.width,u.width),L.height=c/2,L.depth=c/2;let P=lr+c/2;d<p+x+P&&(d=p+x+P);let W=lr-c/2;f<p+w-W&&(f=p+w-W),k=new It({individualShift:[{box:u,shift:f,classes:[...g,Fu(this.align)]},{box:L,shift:-W,classes:g},{box:a,shift:-d,classes:[...g,Fu(this.align)]}]}).wrap(i)}let D=i.isDisplayStyle?o.delim1:o.delim2,N=this.leftDelim?this.bind(e,vd("open",this.leftDelim,D,!0,e,{style:this.style,mode:this.mode,isSelected:this.isSelected})):Jo(i,"ML__open"),B=null;this.continuousFraction?B=new oe(null,{type:"close"}):this.rightDelim?B=this.bind(e,vd("close",this.rightDelim,D,!0,e,{style:this.style,mode:this.mode,isSelected:this.isSelected})):B=Jo(i,"ML__close");let T=new oe([N,k,B],{isTight:i.isTight,type:"inner",classes:"ML__mfrac"}),R=this.bind(e,T);return this.caret&&(R.caret=this.caret),this.attachSupsub(e,{base:R})}};function Fu(t){var e;return(e={left:"ML__left",right:"ML__right",center:"ML__center"}[t])!=null?e:"ML__center"}var qt=class t5 extends G{constructor(e,n){var r;super({type:"latex",value:e,mode:"latex"}),this.isSuggestion=(r=n?.isSuggestion)!=null?r:!1,this.isError=!1}static fromJson(e){let n=new t5(e.value);return e.isSuggestion&&(n.isSuggestion=!0),e.isError&&(n.isError=!0),n}toJson(){let e={};return this.isSuggestion&&(e.isSuggestion=!0),this.isError&&(e.isError=!0),O({type:"latex",value:this.value},e)}render(e){let n=new oe(this.value,{classes:this.isSuggestion?"ML__suggestion":this.isError?"ML__error":"",type:"latex",maxFontSize:1});return n?(this.caret&&(n.caret=this.caret),this.bind(e,n)):null}},Ya=class n5 extends G{constructor(e=""){super({type:"latexgroup",mode:"latex"}),this.body=[...e].map(n=>new qt(n)),this.skipBoundary=!0}static fromJson(e){return new n5}toJson(){return super.toJson()}render(e){let n=G.createBox(e,this.body);return n?(this.caret&&(n.caret=this.caret),this.bind(e,n)):null}_serialize(e){var n,r;return(r=(n=this.body)==null?void 0:n.map(i=>i.value).join(""))!=null?r:""}},r0=class r5 extends G{constructor(e,n){super(V(O({},n),{type:"extensible-symbol",isFunction:n?.isFunction})),this.value=e,this.variant=n?.variant,this.subsupPlacement=n?.limits}static fromJson(e){return new r5(e.symbol,e)}toJson(){let e=super.toJson();return this.variant&&(e.variant=this.variant),this.subsupPlacement&&(e.limits=this.subsupPlacement),this.value&&(e.symbol=this.value),e}render(e){var n;let r=e.isDisplayStyle&&this.value!=="\\smallint",i=new oe(this.value,{fontFamily:r?"Size2-Regular":"Size1-Regular",classes:"ML__op-symbol "+(r?"ML__large-op":"ML__small-op"),type:"op",maxFontSize:e.scalingFactor,isSelected:this.isSelected});if(!i)return null;i.right=i.italic;let o=(i.height-i.depth)/2-lr*e.scalingFactor,s=i.italic;i.setTop(o);let a=i;if(this.superscript||this.subscript){let l=(n=this.subsupPlacement)!=null?n:"auto";l==="auto"&&e.isDisplayStyle&&(l="over-under"),a=l==="over-under"?this.attachLimits(e,{base:i,baseShift:o,slant:s}):this.attachSupsub(e,{base:i})}return new oe(this.bind(e,a),{type:"op",caret:this.caret,isSelected:this.isSelected,classes:"ML__op-group"}).wrap(e)}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);if(n!=null&&n.serialize)return n.serialize(this,e);let r=[];return r.push(this.command),this.explicitSubsupPlacement&&(this.subsupPlacement==="over-under"&&r.push("\\limits"),this.subsupPlacement==="adjacent"&&r.push("\\nolimits"),this.subsupPlacement==="auto"&&r.push("\\displaylimits")),r.push(this.supsubToLatex(e)),Fe(r)}},Qo=class i5 extends G{constructor(e){let n=e.body;super(V(O({},e),{type:"overlap",body:typeof n=="string"?[new G({value:n})]:n,style:e?.style})),this.skipBoundary=!0,this.align=e?.align,this.boxType=e?.boxType}static fromJson(e){return new i5(e)}toJson(){let e={};return this.align&&(e.align=this.align),this.boxType&&(e.boxType=this.boxType),O(O({},super.toJson()),e)}render(e){let n=G.createBox(e,this.body,{classes:"ML__inner"});return n?(this.caret&&(n.caret=this.caret),this.bind(e,new oe([n,new oe(null,{classes:"ML__fix"})],{classes:this.align==="right"?"ML__rlap":"ML__llap",type:this.boxType}))):null}},Yn=class o5 extends G{constructor(e){var n,r,i,o;super({type:"overunder",command:e.command,style:e.style,mode:e.mode,body:e.body,skipBoundary:(n=e.skipBoundary)!=null?n:!0}),this.subsupPlacement=e.supsubPlacement,this.svgAbove=e.svgAbove,this.svgBelow=e.svgBelow,this.svgBody=e.svgBody,this.above=e.above,this.below=e.below,this.boxType=(r=e.boxType)!=null?r:"ord",this.paddedBody=(i=e.paddedBody)!=null?i:!1,this.paddedLabels=(o=e.paddedLabels)!=null?o:!1}static fromJson(e){return new o5(e)}toJson(){let e=super.toJson();return this.skipBoundary||(e.skipBoundary=!1),this.subsupPlacement&&(e.subsupPlacement=this.subsupPlacement),this.svgAbove&&(e.svgAbove=this.svgAbove),this.svgBelow&&(e.svgBelow=this.svgBelow),this.svgBody&&(e.svgBody=this.svgBody),this.boxType!=="ord"&&(e.boxType=this.boxType),this.paddedBody&&(e.paddedBody=!0),this.paddedLabels&&(e.paddedLabels=!0),e}render(e){let n=this.svgBody?lc(this.svgBody):G.createBox(e,this.body,{type:"ignore"}),r=new Ye({parent:e,mathstyle:"scriptstyle"},this.style),i=null;this.svgAbove?i=lc(this.svgAbove):this.above&&(i=G.createBox(r,this.above,{type:"ignore"}));let o=null;this.svgBelow?o=lc(this.svgBelow):this.below&&(o=G.createBox(r,this.below,{type:"ignore"})),this.paddedBody&&(n=new oe([Jo(e,"ML__open"),n,Jo(e,"ML__close")],{type:"ignore"}));let s=yE(e,{base:n,above:i,below:o,type:this.boxType==="bin"||this.boxType==="rel"?this.boxType:"ord",paddedAboveBelow:this.paddedLabels});return s?(this.subsupPlacement==="over-under"?s=this.attachLimits(e,{base:s,type:s.type}):s=this.attachSupsub(e,{base:s}),this.caret&&(s.caret=this.caret),this.bind(e,s)):null}};function yE(t,e){if(!e.base)return null;if(!e.above&&!e.below){let a=new oe(e.base,{type:e.type});return a.setStyle("position","relative"),a}let n=0;e.above&&(n=t.metrics.bigOpSpacing5);let r=null,i=e.base,o=0,s=["ML__center"];if(e.paddedAboveBelow&&s.push("ML__label_padding"),e.below&&e.above){let a=t.metrics.bigOpSpacing5+e.below.height+e.below.depth+i.depth+o;r=new It({bottom:a,children:[t.metrics.bigOpSpacing5,{box:e.below,classes:s},{box:i,classes:["ML__center"]},n,{box:e.above,classes:s},t.metrics.bigOpSpacing5]})}else e.below?r=new It({top:i.height-o,children:[t.metrics.bigOpSpacing5,{box:e.below,classes:s},{box:i,classes:["ML__center"]}]}):e.above&&(r=new It({bottom:i.depth+o,children:[{box:i,classes:["ML__center"]},n,{box:e.above,classes:s},t.metrics.bigOpSpacing5]}));return new oe(r,{type:e.type})}var ra=class s5 extends G{constructor(e){var n,r,i,o;super(V(O({},e),{type:"phantom"})),this.captureSelection=!0,this.isInvisible=(n=e.isInvisible)!=null?n:!1,this.smashDepth=(r=e.smashDepth)!=null?r:!1,this.smashHeight=(i=e.smashHeight)!=null?i:!1,this.smashWidth=(o=e.smashWidth)!=null?o:!1}static fromJson(e){return new s5(e)}toJson(){let e={};return this.isInvisible&&(e.isInvisible=!0),this.smashDepth&&(e.smashDepth=!0),this.smashHeight&&(e.smashHeight=!0),this.smashWidth&&(e.smashWidth=!0),O(O({},super.toJson()),e)}render(e){let n=new Ye({parent:e,isPhantom:!0});if(!this.smashDepth&&!this.smashHeight&&!this.smashWidth)return this.isInvisible,G.createBox(n,this.body,{classes:"ML__inner"});let r=G.createBox(this.isInvisible?n:e,this.body);if(!r)return null;if(this.smashWidth){let i=new oe(null,{classes:"ML__fix"});return new oe([r,i],{classes:"ML__rlap"}).wrap(e)}if(!this.smashHeight&&!this.smashDepth)return r;if(this.smashHeight&&(r.height=0),this.smashDepth&&(r.depth=0),r.children)for(let i of r.children)this.smashHeight&&(i.height=0),this.smashDepth&&(i.depth=0);return new It({firstBaseline:[{box:r}]},{type:r.type}).wrap(e)}},Tl=class a5 extends G{constructor(e){var n;super(O({type:"spacing"},e)),this.width=e?.width,this._braced=(n=e?.braced)!=null?n:!1}static fromJson(e){return new a5(e)}toJson(){let e=super.toJson();return this.width!==void 0&&(e.width=this.width),this._braced&&(e.braced=!0),e}render(e){var n;if(this.command==="space")return new oe(this.mode==="math"?null:" ");let r;if(this.width!==void 0)r=new oe(null,{classes:"ML__mspace"}),r.left=e.toEm(this.width);else{let i=(n={"\\qquad":"ML__qquad","\\quad":"ML__quad","\\enspace":"ML__enspace","\\;":"ML__thickspace","\\:":"ML__mediumspace","\\>":"ML__mediumspace","\\,":"ML__thinspace","\\!":"ML__negativethinspace"}[this.command])!=null?n:"ML__mediumspace";r=new oe(null,{classes:i})}return r=this.bind(e,r),this.caret&&(r.caret=this.caret),r}_serialize(e){var n;if(!e.expandMacro&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let r=Vt(this.command,this.mode);if(r!=null&&r.serialize)return r.serialize(this,e);let i=(n=this.command)!=null?n:"";return this.width===void 0?i:this._braced&&!("register"in this.width)?`${i}{${Qt(this.width)}}`:`${i}${Qt(this.width)}`}},l5=class u5 extends G{constructor(e){var n;super(V(O({},e),{type:"surd",mode:(n=e.mode)!=null?n:"math",style:e.style,displayContainsHighlight:!0,body:e.body})),this.above=e.index}static fromJson(e){return new u5(V(O({},e),{index:e.above}))}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);if(n!=null&&n.serialize)return n.serialize(this,e);let r=this.command,i=this.bodyToLatex(e);return this.above&&!this.hasEmptyBranch("above")?ut(`${r}[${this.aboveToLatex(e)}]`,i):/^[0-9]$/.test(i)?`${r}${i}`:ut(r,i)}get children(){if(this._children)return this._children;let e=[];if(this.above)for(let n of this.above)e.push(...n.children),e.push(n);if(this.body)for(let n of this.body)e.push(...n.children),e.push(n);return this._children=e,e}render(e){var n;let r=new Ye({parent:e,mathstyle:"cramp"},this.style),i=(n=G.createBox(r,this.body,{type:"inner"}))!=null?n:new oe(null),o=r.scalingFactor,s=r.metrics.defaultRuleThickness/o,a=e.isDisplayStyle?Jr:s,l=new oe(null,{classes:"ML__sqrt-line",style:this.style});l.height=s,l.softWidth=i.width;let u=o*(s+a/4),c=Math.max(o*2*a,i.height+i.depth)+u+s,d=new Ye({parent:e},this.style),p=this.bind(d,new oe(vd("inner","\\surd",c,!1,d,{isSelected:this.isSelected}),{isSelected:this.isSelected,classes:"ML__sqrt-sign",style:this.style}));if(!p)return null;let f=p.height+p.depth-s;f>i.height+i.depth+u&&(u=(u+f-(i.height+i.depth))/2),p.setTop(p.height-i.height-u);let g=this.bind(e,new It({firstBaseline:[{box:new oe(i)},u-2*s,{box:l},s]})),x=G.createBox(new Ye({parent:e,mathstyle:"scriptscriptstyle"}),this.above,{type:"ignore"});if(!x){let D=new oe([p,g],{classes:this.containsCaret?"ML__contains-caret":"",type:"inner"});return D.setStyle("display","inline-block"),D.setStyle("height",D.height+D.depth,"em"),this.caret&&(D.caret=this.caret),this.bind(e,D)}let w=new It({shift:-.6*(Math.max(p.height,g.height)-Math.max(p.depth,g.depth)),children:[{box:x}]}),k=new oe([new oe(w,{classes:"ML__sqrt-index",type:"ignore"}),p,g],{type:"inner",classes:this.containsCaret?"ML__contains-caret":""});return k.height=p.height,k.depth=p.depth,this.caret&&(k.caret=this.caret),this.bind(e,k)}},bE=class extends oe{constructor(t){super(null,{type:"skip"}),this._width=t}toMarkup(){return`<span style="display:inline-block;width:${Math.ceil(this.width*100)/100}em"></span>`}};function pc(t,e){if(!t.parent)return;let n=t.parent.children,r=n.indexOf(t),i=r-1;for(;i>=0&&n[i].type==="ignore";)i-=1;if(i<0&&t.parent.parent&&t.parent.type==="lift"){pc(t.parent,e);return}r>0&&n[r-1].type==="skip"?n[r-1].width+=e:n.splice(r,0,new bE(e))}var vE={ord:{op:3,bin:4,rel:5,inner:3},op:{ord:3,op:3,rel:5,inner:3},bin:{ord:4,op:4,open:4,inner:4},rel:{ord:5,op:5,open:5,inner:5},close:{op:3,bin:4,rel:5,inner:3},punct:{ord:3,op:3,rel:3,open:3,punct:3,inner:3},inner:{ord:3,op:3,bin:4,rel:5,open:3,punct:3,inner:3}},xE={ord:{op:3},op:{ord:3,op:3},close:{op:3},inner:{op:3}};function wE(t){Za(t,(e,n)=>{n.type==="bin"&&(!e||/^(middle|bin|op|rel|open|punct)$/.test(e.type))&&(n.type="ord"),e?.type==="bin"&&/^(rel|close|punct)$/.test(n.type)&&(e.type="ord"),n.type!=="ignore"&&(e=n)})}function Bl(t,e){if(!t.children)return t;let n=t.children;wE(n);let r=e.getRegisterAsEm("thinmuskip"),i=e.getRegisterAsEm("medmuskip"),o=e.getRegisterAsEm("thickmuskip");return Za(n,(s,a)=>{var l,u,c;if(!s)return;let d=s.type,p=a.isTight?(l=xE[d])!=null?l:null:(u=vE[d])!=null?u:null,f=(c=p?.[a.type])!=null?c:null;f===3&&pc(a,r),f===4&&pc(a,i),f===5&&pc(a,o)}),t}function Za(t,e,n=void 0){if(!t)return n;t=[...t];for(let r of t)r.type==="lift"?n=Za(r.children,e,n):r.type==="ignore"?Za(r.children,e):(e(n,r),Za(r.children,e),n=r);return n}var i0=class c5 extends G{constructor(e){super({type:"tooltip",command:e.command,mode:e.mode,style:e.style,body:e.body,displayContainsHighlight:!0}),this.tooltip=new G({type:"root",mode:e.content,body:e.tooltip,style:{}}),this.skipBoundary=!0,this.captureSelection=!1}static fromJson(e){return new c5(V(O({},e),{tooltip:Hi(e.tooltip)}))}toJson(){var e;let n=(e=this.tooltip.body)==null?void 0:e.filter(r=>r.type!=="first").map(r=>r.toJson());return V(O({},super.toJson()),{tooltip:n})}render(e){let n=G.createBox(e,this.body);if(!n)return null;let r=new Ye({parent:e,mathstyle:"displaystyle"},{fontSize:Zm}),i=Jd(Bl(new oe(this.tooltip.render(r),{classes:"ML__tooltip-content"}),r)),o=new oe([i,n],{classes:"ML__tooltip-container"});return this.caret&&(o.caret=this.caret),this.bind(e,o)}},es=class d5 extends G{constructor(e,n){super(V(O({},n),{type:"operator",isFunction:n?.isFunction})),this.value=e,this.variant=n?.variant,this.variantStyle=n?.variantStyle,this.subsupPlacement=n?.limits}static fromJson(e){return new d5(e.symbol,e)}toJson(){let e=super.toJson();return this.variant&&(e.variant=this.variant),this.variantStyle&&(e.variantStyle=this.variantStyle),this.subsupPlacement&&(e.limits=this.subsupPlacement),this.value&&(e.symbol=this.value),e}render(e){var n;let r=new oe(this.value,{type:"op",mode:"math",maxFontSize:e.scalingFactor,style:{variant:this.variant,variantStyle:this.variantStyle},isSelected:this.isSelected,letterShapeStyle:e.letterShapeStyle}),i=r;if(this.superscript||this.subscript){let o=(n=this.subsupPlacement)!=null?n:"auto";i=o==="over-under"||o==="auto"&&e.isDisplayStyle?this.attachLimits(e,{base:r}):this.attachSupsub(e,{base:r})}return new oe(this.bind(e,i),{type:"op",caret:this.caret,isSelected:this.isSelected,classes:"ML__op-group"}).wrap(e)}_serialize(e){if(!(e.expandMacro||e.skipStyles||e.skipPlaceholders)&&typeof this.verbatimLatex=="string")return this.verbatimLatex;let n=Vt(this.command,this.mode);if(n!=null&&n.serialize)return n.serialize(this,e);let r=[this.command];return this.explicitSubsupPlacement&&(this.subsupPlacement==="over-under"&&r.push("\\limits"),this.subsupPlacement==="adjacent"&&r.push("\\nolimits"),this.subsupPlacement==="auto"&&r.push("\\displaylimits")),r.push(this.supsubToLatex(e)),Fe(r)}};function Hi(t){if(Ht(t))return t.map(r=>Hi(r));if(typeof t=="string")return G.fromJson(t);t=O({},t);for(let r of Zs)t[r]&&(t[r]=Hi(t[r]));t.args&&(t.args=kE(t.args)),t.array&&(t.array=Hi(t.array));let e=t.type,n;e==="accent"&&(n=Yd.fromJson(t)),e==="array"&&(n=He.fromJson(t)),e==="box"&&(n=Xi.fromJson(t)),e==="chem"&&(n=Ux.fromJson(t)),e==="composition"&&(n=Ox.fromJson(t)),e==="delim"&&(n=Gx.fromJson(t)),e==="enclose"&&(n=Ll.fromJson(t)),e==="error"&&(n=xo.fromJson(t)),e==="extensible-symbol"&&(n=r0.fromJson(t)),e==="genfrac"&&(n=Zo.fromJson(t)),e==="group"&&(n=Ix.fromJson(t)),e==="latex"&&(n=qt.fromJson(t)),e==="latexgroup"&&(n=Ya.fromJson(t)),e==="leftright"&&(n=kt.fromJson(t)),e==="macro"&&(n=$x.fromJson(t)),e==="macro-argument"&&(n=pE.fromJson(t)),e==="operator"&&(n=es.fromJson(t)),e==="overlap"&&(n=Qo.fromJson(t)),e==="overunder"&&(n=Yn.fromJson(t)),e==="placeholder"&&(n=ur.fromJson(t)),e==="prompt"&&(n=qx.fromJson(t)),e==="phantom"&&(n=ra.fromJson(t)),e==="sizeddelim"&&(n=Yx.fromJson(t)),e==="spacing"&&(n=Tl.fromJson(t)),e==="subsup"&&(n=eh.fromJson(t)),e==="surd"&&(n=l5.fromJson(t)),e==="text"&&(n=na.fromJson(t)),e==="tooltip"&&(n=i0.fromJson(t)),n||(n=G.fromJson(t));for(let r of Zs)t[r]&&n.setChildren(t[r],r);return t.verbatimLatex!==void 0&&(n.verbatimLatex=t.verbatimLatex),t.subsupPlacement&&(n.subsupPlacement=t.subsupPlacement),t.explicitSubsupPlacement&&(n.explicitSubsupPlacement=!0),t.isFunction&&(n.isFunction=!0),t.skipBoundary&&(n.skipBoundary=!0),t.captureSelection&&(n.captureSelection=!0),n}function kE(t){if(t){if(typeof t=="string")return t;if(Array.isArray(t))return t.map(e=>e==="<null>"?null:typeof e=="object"&&"group"in e?{group:e.group.map(n=>Hi(n))}:typeof e=="object"&&"atoms"in e?e.atoms.map(n=>Hi(n)):e)}}function o0(t,e){!t||!e||(Ht(t)?t.forEach(n=>o0(n,e)):typeof t=="object"&&t.applyStyle(e,{unstyledOnly:!0}))}function If(t,e,n,r){function i(s,a){for(let l of o)if(l.style[s]!==a)return!1;return!0}if(e=t.normalizeRange(e),e[0]===e[1])return!1;let o=t.getAtoms(e,{includeChildren:!0});r.operation==="toggle"&&(n.color&&i("color",n.color)&&(n.color="none",delete n.verbatimColor),n.backgroundColor&&i("backgroundColor",n.backgroundColor)&&(n.backgroundColor="none",delete n.verbatimBackgroundColor),n.fontFamily&&i("fontFamily",n.fontFamily)&&(n.fontFamily="none"),n.fontSeries&&i("fontSeries",n.fontSeries)&&(n.fontSeries="auto"),n.fontShape&&i("fontShape",n.fontShape)&&(n.fontShape="auto"),n.fontSize&&i("fontSize",n.fontSize)&&(n.fontSize=Zm),n.variant&&i("variant",n.variant)&&(n.variant="normal"),n.variantStyle&&i("variantStyle",n.variantStyle)&&(n.variantStyle=""));for(let s of o)s.applyStyle(n);return!0}function SE(t){return{up:"italic",bold:"bolditalic",italic:"italic",bolditalic:"bolditalic","":"italic"}[t??""]}function th(t){return{up:"up",bold:"bold",italic:void 0,bolditalic:"bold","":void 0}[t??""]}var ev={acute:714,grave:715,dot:729,ddot:168,dddot:8411,ddddot:8412,mathring:730,tilde:126,bar:713,breve:728,check:711,hat:94,vec:8407};Z(Object.keys(ev),"{body:auto}",{createAtom:t=>new Yd(V(O({},t),{body:pe(t.args[0]),accentChar:ev[t.command.slice(1)]}))});Z(["widehat","widecheck","widetilde"],"{body:auto}",{createAtom:t=>{let e=rx(pe(t.args[0]));return new Yd(V(O({},t),{body:pe(t.args[0]),svgAccent:t.command.slice(1)+(e.length>5?"4":["1","1","2","2","3","3"][e.length])}))}});Z(["overarc","overparen","wideparen"],"{body:auto}",{createAtom:t=>new Yd(V(O({},t),{body:pe(t.args[0]),svgAccent:"overarc"}))});Z(["underarc","underparen"],"{body:auto}",{createAtom:t=>new Yn(V(O({},t),{body:pe(t.args[0]),svgBelow:"underarc"}))});Z("utilde","{body:auto}",{createAtom:t=>{let e=pe(t.args[0]),n=rx(e),r="widetilde"+(n.length>5?"4":["1","1","2","2","3","3"][n.length]);return new Yn(V(O({},t),{body:e,svgBelow:r,boxType:Dl(e)}))}});Z("^","{:string}",{createAtom:t=>{var e;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:t.args[0]&&(e={a:"",e:"",i:"",o:"",u:"",A:"",E:"",I:"",O:"",U:""}[t.args[0]])!=null?e:"^"}))}});Z("`","{:string}",{createAtom:t=>{var e;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:t.args[0]&&(e={a:"",e:"",i:"",o:"",u:"",A:"",E:"",I:"",O:"",U:""}[t.args[0]])!=null?e:"`"}))}});Z("'","{:string}",{createAtom:t=>{var e;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:t.args[0]&&(e={a:"",e:"",i:"",o:"",u:"",A:"",E:"",I:"",O:"",U:""}[t.args[0]])!=null?e:"'"}))}});Z('"',"{:string}",{createAtom:t=>{var e,n;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:(e=t.args)!=null&&e[0]?(n={a:"",e:"",i:"",o:"",u:"",A:"",E:"",I:"",O:"",U:""}[t.args[0]])!=null?n:'"'+t.args[0]:'"'}))}});Z(".","{:string}",{createAtom:t=>{var e,n;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:(e=t.args)!=null&&e[0]?(n={a:"",e:"",i:"i",o:"",u:"u",A:"",E:"",I:"",O:"",U:"U"}[t.args[0]])!=null?n:"."+t.args[0]:"."}))}});Z("=","{:string}",{createAtom:t=>{var e,n;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:(e=t.args)!=null&&e[0]?(n={a:"",e:"",i:"",o:"",u:"",A:"",E:"",I:"",O:"",U:""}[t.args[0]])!=null?n:"="+t.args[0]:"="}))}});Z("~","{:string}",{createAtom:t=>{var e;return new G(V(O({type:"mord"},t),{isFunction:!1,limits:"adjacent",value:t.args[0]&&(e={n:"",N:"",a:"",o:"",A:"",O:""}[t.args[0]])!=null?e:""}))}});Z("c","{:string}",{createAtom:t=>{var e;return new G(V(O({},t),{type:"mord",isFunction:!1,limits:"adjacent",value:t.args[0]&&(e={c:"",C:""}[t.args[0]])!=null?e:""}))}});Z("enclose","{notation:string}[style:string]{body:auto}",{createAtom:t=>{var e,n;let r=t.args,i={strokeColor:"currentColor",strokeWidth:"",strokeStyle:"solid",backgroundcolor:"transparent",padding:"auto",shadow:"none",svgStrokeStyle:void 0,borderStyle:void 0,style:(e=t.style)!=null?e:{}};if(r[1]){let s=r[1].split(/,(?![^(]*\)(?:(?:[^(]*\)){2})*[^"]*$)/);for(let a of s){let l=a.match(/\s*(\S+)\s+(\S+)\s+(.*)/);if(l)i.strokeWidth=l[1],i.strokeStyle=l[2],i.strokeColor=l[3];else{let u=a.match(/\s*([a-z]*)\s*=\s*"(.*)"/);u&&(u[1]==="mathbackground"?i.backgroundcolor=u[2]:u[1]==="mathcolor"?i.strokeColor=u[2]:u[1]==="padding"?i.padding=u[2]:u[1]==="shadow"&&(i.shadow=u[2]))}}i.strokeStyle==="dashed"?i.svgStrokeStyle="5,5":i.strokeStyle==="dotted"&&(i.svgStrokeStyle="1,5")}i.borderStyle=`${i.strokeWidth} ${i.strokeStyle} ${i.strokeColor}`;let o={};return((n=r[0])!=null?n:"").split(/[, ]/).filter(s=>s.length>0).forEach(s=>{o[s.toLowerCase()]=!0}),new Ll(t.command,pe(r[2]),o,i)}});Z("cancel","{body:auto}",{createAtom:t=>{var e;return new Ll(t.command,pe(t.args[0]),{updiagonalstrike:!0},{strokeColor:"currentColor",strokeWidth:"",strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"none",style:(e=t.style)!=null?e:{}})}});Z("bcancel","{body:auto}",{createAtom:t=>{var e;return new Ll(t.command,pe(t.args[0]),{downdiagonalstrike:!0},{strokeColor:"currentColor",strokeWidth:"",strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"none",style:(e=t.style)!=null?e:{}})}});Z("xcancel","{body:auto}",{createAtom:t=>{var e;return new Ll(t.command,pe(t.args[0]),{updiagonalstrike:!0,downdiagonalstrike:!0},{strokeColor:"currentColor",strokeWidth:"",strokeStyle:"solid",borderStyle:"1px solid currentColor",backgroundcolor:"transparent",padding:"auto",shadow:"none",style:(e=t.style)!=null?e:{}})}});Gm(["math","displaymath"],Dn);Gm("center",Dn);ei(["multline","multline*"],"",Dn);Z("displaylines","",{parse:t=>{if(t.skipWhitespace(),!t.match("<{>"))return[];let e=[],n=[];t.mathlist.length>0&&e.push([t.mathlist]),t.beginContext({tabular:!0,root:!0});do{if(t.end()||t.match("<}>"))break;t.matchColumnSeparator()||t.matchRowSeparator()?(e.push([n]),n=[]):n.push(...t.scan(i=>["<}>","&","\\cr","\\\\","\\tabularnewline"].includes(i)))}while(!0);t.endContext(),e.push([n]);let r=t.scan();return r.length>0&&e.push([r]),e},createAtom:t=>new He("lines",t.args,[],{leftDelim:".",rightDelim:".",columns:[{align:"l"}],classes:["ML__multiline_environment"],isRoot:!0,minColumns:1,maxColumns:1,minRows:1})});ei("split","",Dn);ei(["gather","gather*","gathered"],"",Dn);ei(["equation","equation*","subequations"],"",Dn);Gm(["align","align*","eqnarray"],Dn,{tabular:!0});ei(["aligned"],"",Dn);ei("array","{columns:colspec}",(t,e,n,r)=>new He(t,e,n,{columns:r[0],mathstyleName:"textstyle"}));ei(["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],"[columns:colspec]",Dn);ei(["smallmatrix","smallmatrix*"],"[columns:colspec]",Dn);ei(["cases","dcases","rcases"],"",Dn);function Dn(t,e=[[[]]],n=[],r=[],i){switch(t){case"math":return new He(t,e,n,{mathstyleName:"textstyle",isRoot:!0,minColumns:1,maxColumns:1,minRows:1,maxRows:1});case"displaymath":return new He(t,e,n,{mathstyleName:"textstyle",isRoot:!0,minColumns:1,maxColumns:1,minRows:1,maxRows:1});case"center":return new He(t,e,n,{columns:[{align:"c"}],classes:["ML__center_environment"],isRoot:!0,minColumns:1,maxColumns:1,minRows:1,maxRows:1});case"multline":case"multline*":return new He(t,e,n,{columns:[{align:"m"}],leftDelim:".",rightDelim:".",isRoot:!0,minColumns:1,maxColumns:1,minRows:1});case"split":return new He(t,e,n,{columns:[{align:"r"},{align:"l"}],minColumns:2,minRows:1,isRoot:!1});case"gather":case"gather*":return new He(t,e,n,{columns:[{gap:.25},{align:"c"},{gap:0}],minColumns:1,maxColumns:1,minRows:1,isRoot:!0,classes:["ML__gather_environment"]});case"gathered":return new He(t,e,n,{columns:[{gap:.25},{align:"c"},{gap:0}],minColumns:1,maxColumns:1,minRows:1});case"equation":case"equation*":case"subequations":return new He(t,e,n,{columns:[{align:"c"}],isRoot:!0,minColumns:1,maxColumns:1,minRows:1});case"aligned":{let o=0;for(let l of e)o=Math.max(o,l.length);let s=[{gap:0},{align:"r"},{gap:.25},{align:"l"}],a=2;for(;a<o;)s.push({gap:1},{align:"r"},{gap:.25},{align:"l"}),a+=2;return s.push({gap:0}),new He(t,e,n,{arraycolsep:0,columns:s,minColumns:2,minRows:1,isRoot:t!=="aligned"})}case"eqnarray":return new He(t,e,n,{arraycolsep:0,columns:[{gap:0},{align:"r"},{align:"c"},{align:"l"}],minColumns:3,maxColumns:3,minRows:1,isRoot:!0,classes:["ML__eqnarray_environment"]});case"align":case"align*":return new He(t,e,n,{arraycolsep:0,columns:[{gap:0},{align:"r"},{gap:.25},{align:"l"}],minColumns:2,maxColumns:2,minRows:1,isRoot:!0,classes:["ML__align_environment"]});case"pmatrix":case"pmatrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:"(",rightDelim:")",columns:fo(r[0],i)});case"bmatrix":case"bmatrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:"[",rightDelim:"]",columns:fo(r[0],i)});case"Bmatrix":case"Bmatrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:"\\lbrace",rightDelim:"\\rbrace",columns:fo(r[0],i)});case"vmatrix":case"vmatrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:"\\vert",rightDelim:"\\vert",columns:fo(r[0],i)});case"Vmatrix":case"Vmatrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:"\\Vert",rightDelim:"\\Vert",columns:fo(r[0],i)});case"matrix":case"matrix*":return new He(t,e,n,{mathstyleName:"textstyle",leftDelim:".",rightDelim:".",columns:fo(r?.[0],i)});case"smallmatrix":case"smallmatrix*":return new He(t,e,n,{mathstyleName:"scriptstyle",columns:fo(r?.[0],i),colSeparationType:"small",arraystretch:.5});case"cases":case"dcases":return new He(t,e,n,{mathstyleName:t==="dcases"?"displaystyle":"textstyle",arraystretch:1.2,leftDelim:"\\lbrace",rightDelim:".",columns:tv()});case"rcases":return new He(t,e,n,{arraystretch:1.2,leftDelim:".",rightDelim:"\\rbrace",columns:tv()});case"lines":return new He(t,e,n,{leftDelim:".",rightDelim:".",columns:[{align:"l"}],isRoot:!0,minColumns:1,maxColumns:1,minRows:1})}return new He(t,e,n,{mathstyleName:"textstyle"})}function fo(t,e=10){return t??Array(e).fill({align:"c"})}function tv(t=10){let e=[];for(let n=0;n<t;n++)n>0&&e.push({gap:1}),e.push({align:"l"});return e}Z(["overrightarrow","overleftarrow","Overrightarrow","overleftharpoon","overrightharpoon","overleftrightarrow","overlinesegment","overgroup"],"{:auto}",{createAtom:t=>{var e;return new Yn(V(O({},t),{body:pe((e=t.args)==null?void 0:e[0]),skipBoundary:!1,supsubPlacement:"over-under",paddedBody:!0,boxType:"rel",svgAbove:t.command.slice(1)}))}});Z("overbrace","{:auto}",{createAtom:t=>new Yn(V(O({},t),{body:pe(t.args[0]),skipBoundary:!1,supsubPlacement:"over-under",paddedBody:!0,boxType:"ord",svgAbove:t.command.slice(1)}))});Z(["underrightarrow","underleftarrow","underleftrightarrow","underlinesegment","undergroup"],"{:auto}",{createAtom:t=>new Yn(V(O({},t),{body:pe(t.args[0]),skipBoundary:!1,supsubPlacement:"over-under",paddedBody:!0,boxType:"rel",svgBelow:t.command.slice(1)}))});Z(["underbrace"],"{:auto}",{createAtom:t=>new Yn(V(O({},t),{body:pe(t.args[0]),skipBoundary:!1,supsubPlacement:"over-under",paddedBody:!0,boxType:"ord",svgBelow:t.command.slice(1)}))});Z(["xrightarrow","longrightarrow","xleftarrow","longleftarrow","xRightarrow","xLeftarrow","xleftharpoonup","xleftharpoondown","xrightharpoonup","xrightharpoondown","xlongequal","xtwoheadleftarrow","xtwoheadrightarrow","xleftrightarrow","longleftrightarrow","xLeftrightarrow","xrightleftharpoons","longrightleftharpoons","xleftrightharpoons","xhookleftarrow","xhookrightarrow","xmapsto","xtofrom","xleftrightarrows","longleftrightarrows","xRightleftharpoons","longRightleftharpoons","xLeftrightharpoons","longLeftrightharpoons"],"[:auto]{:auto}",{createAtom:t=>{var e,n,r,i,o;return new Yn(V(O({},t),{svgBody:t.command.slice(1),above:((n=pe((e=t.args)==null?void 0:e[1]))==null?void 0:n.length)===0?void 0:pe((r=t.args)==null?void 0:r[1]),below:(o=pe((i=t.args)==null?void 0:i[0]))!=null?o:null,skipBoundary:!1,supsubPlacement:"over-under",paddedBody:!0,paddedLabels:!0,boxType:"rel"}))},serialize:(t,e)=>t.command+(t.hasEmptyBranch("below")?"":`[${t.belowToLatex(e)}]`)+`{${t.aboveToLatex(e)}}${t.supsubToLatex(e)}`});Z(["arccos","arcsin","arctan","arctg","arcctg","arg","ch","cos","cosh","cot","cotg","coth","ctg","cth","csc","cosec","deg","dim","exp","gcd","hom","inf","ker","lb","lg","ln","log","Pr","sec","sh","sin","sinh","sup","tan","tanh","tg","th","arcsec","arccsc","arsinh","arcosh","artanh","arcsech","arccsch"],"",{isFunction:!0,ifMode:"math",createAtom:t=>new es(t.command.slice(1),V(O({},t),{limits:"adjacent",isFunction:!0,variant:"main",variantStyle:"up"}))});Z(["liminf","limsup"],"",{ifMode:"math",createAtom:t=>new es({"\\liminf":"lim inf","\\limsup":"lim sup"}[t.command],V(O({},t),{limits:"over-under",variant:"main"}))});Z(["lim","mod"],"",{ifMode:"math",createAtom:t=>new es(t.command.slice(1),V(O({},t),{limits:"over-under",variant:"main"}))});Z(["det","max","min"],"",{ifMode:"math",isFunction:!0,createAtom:t=>new es(t.command.slice(1),V(O({},t),{limits:"over-under",isFunction:!0,variant:"main"}))});Z("ang","{:math}",{ifMode:"math",createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),serialize:(t,e)=>`\\ang{${t.bodyToLatex(e)}}`,render:(t,e)=>{let n=t.createBox(e),r=n.caret;n.caret=void 0;let i=new oe("",{style:V(O({},t.style),{variant:"normal",variantStyle:"up"})});return new oe([n,i],{type:"inner",isSelected:t.isSelected,caret:r})}});Z("sqrt","[index:auto]{radicand:expression}",{ifMode:"math",createAtom:t=>new l5(V(O({},t),{body:pe(t.args[1]),index:t.args[0]?pe(t.args[0]):void 0}))});Z(["frac","dfrac","tfrac","binom","dbinom","tbinom"],"{:expression}{:expression}",{ifMode:"math",createAtom:t=>{let e=O({},t),n=t.command,r=t.args;switch(n){case"\\dfrac":case"\\frac":case"\\tfrac":e.hasBarLine=!0;break;case"\\atopfrac":e.hasBarLine=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":e.hasBarLine=!1,e.leftDelim="(",e.rightDelim=")";break;case"\\cfrac":e.hasBarLine=!0,e.continuousFraction=!0;break}switch(n){case"\\dfrac":case"\\dbinom":e.mathstyleName="displaystyle";break;case"\\tfrac":case"\\tbinom":e.mathstyleName="textstyle";break}return new Zo(r[0]?pe(r[0]):[new ur],r[1]?pe(r[1]):[new ur],e)},serialize:(t,e)=>{let n=t.aboveToLatex(e),r=t.belowToLatex(e);return/^[0-9]$/.test(n)&&/^[0-9]$/.test(r)?`${t.command}${n}${r}`:ut(t.command,n,r)}});Z(["cfrac"],"[:string]{:expression}{:expression}",{ifMode:"math",createAtom:t=>{let e=O({},t),n=t.args;return e.hasBarLine=!0,e.continuousFraction=!0,n[0]==="r"&&(e.align="right"),n[0]==="l"&&(e.align="left"),new Zo(n[1]?pe(n[1]):[new ur],n[2]?pe(n[2]):[new ur],e)},serialize:(t,e)=>{let n=t.aboveToLatex(e),r=t.belowToLatex(e);return ut(t.command,n,r)}});Z(["brace","brack"],"",{infix:!0,createAtom:t=>new Zo(pe(t.args[0]),pe(t.args[1]),V(O({},t),{hasBarLine:!1,leftDelim:t.command==="\\brace"?"\\lbrace":"\\lbrack",rightDelim:t.command==="\\brace"?"\\rbrace":"\\rbrack"})),serialize:(t,e)=>Fe([t.aboveToLatex(e),t.command,t.belowToLatex(e)])});Z(["over","atop","choose"],"",{infix:!0,createAtom:t=>{let e,n,r=t.args;return t.command==="\\choose"&&(e="(",n=")"),new Zo(pe(r[0]),pe(r[1]),V(O({},t),{hasBarLine:t.command==="\\over",leftDelim:e,rightDelim:n}))},serialize:(t,e)=>Fe([t.aboveToLatex(e),t.command,t.belowToLatex(e)])});Z(["overwithdelims","atopwithdelims"],"{numer:auto}{denom:auto}{left-delim:delim}{right-delim:delim}",{infix:!0,createAtom:t=>{var e,n;let r=t.args;return new Zo(pe(r[0]),pe(r[1]),V(O({},t),{leftDelim:(e=r[2])!=null?e:".",rightDelim:(n=r[3])!=null?n:".",hasBarLine:!1}))},serialize:(t,e)=>`${t.aboveToLatex(e)} ${t.command}${t.leftDelim}${t.rightDelim}${t.belowToLatex(e)}`});Z("pdiff","{numerator}{denominator}",{ifMode:"math",createAtom:t=>new Zo(pe(t.args[0]),pe(t.args[1]),V(O({},t),{hasBarLine:!0,numerPrefix:"",denomPrefix:""})),serialize:(t,e)=>Fe([t.aboveToLatex(e),t.command,t.belowToLatex(e)])});Z(["sum","prod","bigcup","bigcap","coprod","bigvee","bigwedge","biguplus","bigotimes","bigoplus","bigodot","bigsqcup","intop"],"",{ifMode:"math",createAtom:t=>new r0({coprod:"",bigvee:"",bigwedge:"",biguplus:"",bigcap:"",bigcup:"",intop:"",prod:"",sum:"",bigotimes:"",bigoplus:"",bigodot:"",bigsqcup:"",smallint:""}[t.command.slice(1)],V(O({},t),{limits:"auto",variant:"main"}))});Z("smallint","",{ifMode:"math",createAtom:t=>new es("",V(O({},t),{limits:"adjacent",variant:"main"}))});var nv={int:"",iint:"",iiint:"",oint:"",oiint:"",oiiint:"",intclockwise:"",varointclockwise:"",ointctrclockwise:"",intctrclockwise:"",sqcup:"",sqcap:"",uplus:"",wr:"",amalg:"",Cap:"",Cup:"",doublecap:"",doublecup:""};Z(Object.keys(nv),"",{ifMode:"math",createAtom:t=>{let e=t.command,n=nv[e.slice(1)];return new r0(n,V(O({},t),{limits:"adjacent",variant:{"":"ams","":"ams"}[n]}))}});Z(["Re","Im"],"",{ifMode:"math",createAtom:t=>new es({"\\Re":"","\\Im":""}[t.command],V(O({},t),{limits:"adjacent",isFunction:!0,variant:"fraktur"}))});Z("middle","{:delim}",{ifMode:"math",createAtom:t=>{var e;return new Gx(V(O({},t),{delim:(e=t.args[0])!=null?e:"|",size:1}))}});Z("the","{:value}",{createAtom:t=>new G(V(O({},t),{captureSelection:!0,verbatimLatex:null})),render:(t,e)=>{var n;let r=new Ye({parent:e},t.style),i="";t.isSelected&&(i+=" ML__selected");let o=r.evaluate(t.args[0]);return new oe(((n=Qt(o))!=null?n:"").split("").map(s=>new oe(s,{type:"ord",classes:i,mode:t.mode,isSelected:t.isSelected,style:O({variant:"main"},t.style)})),{type:"lift",style:t.style,caret:t.caret,isSelected:t.isSelected,classes:i}).wrap(r)},serialize:t=>{var e;return`\\the${(e=Qt(t.args[0]))!=null?e:"\\relax"}`}});Z("mathtip","{:auto}{:math}",{createAtom:t=>new i0(V(O({},t),{body:pe(t.args[0]),tooltip:pe(t.args[1]),content:"math"})),serialize:(t,e)=>e.skipStyles?t.bodyToLatex(e):`\\mathtip{${t.bodyToLatex(e)}}{${G.serialize([t.tooltip],V(O({},e),{defaultMode:"math"}))}}`});Z("texttip","{:auto}{:text}",{createAtom:t=>new i0(V(O({},t),{body:pe(t.args[0]),tooltip:pe(t.args[1]),content:"text"})),serialize:(t,e)=>e.skipStyles?t.bodyToLatex(e):`\\texttip{${t.bodyToLatex(e)}}{${G.serialize([t.tooltip],V(O({},e),{defaultMode:"text"}))}}`});Z("error","{:math}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),serialize:(t,e)=>`\\error{${t.bodyToLatex(e)}}`,render:(t,e)=>t.createBox(e,{classes:"ML__error"})});Z("ensuremath","{:math}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),serialize:(t,e)=>`${t.command}{${t.bodyToLatex(V(O({},e),{defaultMode:"math"}))}}`});Z("color","{:value}",{applyStyle:(t,e,n,r)=>{var i,o;return V(O({},t),{verbatimColor:(i=Qt(n[0]))!=null?i:void 0,color:r.toColor((o=n[0])!=null?o:{string:"red"})})}});Z("textcolor","{:value}{content:auto*}",{applyStyle:(t,e,n,r)=>{var i,o;return V(O({},t),{verbatimColor:(i=Qt(n[0]))!=null?i:void 0,color:r.toColor((o=n[0])!=null?o:{string:"red"})})}});Z("boxed","{content:math}",{createAtom:t=>new Xi(V(O({},t),{body:pe(t.args[0]),framecolor:{string:"black"}}))});Z("colorbox","{:value}{:text*}",{applyStyle:(t,e,n,r)=>{var i,o;return V(O({},t),{verbatimBackgroundColor:(i=Qt(n[0]))!=null?i:void 0,backgroundColor:r.toBackgroundColor((o=n[0])!=null?o:{string:"yellow"})})}});Z("fcolorbox","{frame-color:value}{background-color:value}{content:text}",{applyMode:"text",createAtom:t=>{var e,n;return new Xi(V(O({},t),{body:pe(t.args[2]),framecolor:(e=t.args[0])!=null?e:{string:"blue"},backgroundcolor:(n=t.args[1])!=null?n:{string:"yellow"}}))},serialize:(t,e)=>{var n,r;return e.skipStyles?t.bodyToLatex(V(O({},e),{defaultMode:"text"})):ut(t.command,(n=Qt(t.framecolor))!=null?n:"",(r=Qt(t.backgroundcolor))!=null?r:"",t.bodyToLatex(V(O({},e),{defaultMode:"text"})))}});Z("bbox","[:bbox]{body:auto}",{createAtom:t=>{var e;let n=t.args[0],r=pe(t.args[1]);return n?new Xi(V(O({},t),{body:r,padding:n.padding,border:n.border,backgroundcolor:(e=n.backgroundcolor)!=null?e:void 0})):new Xi(V(O({},t),{body:r}))},serialize:(t,e)=>{var n,r;if(e.skipStyles)return t.bodyToLatex(e);let i=t.command;if(Number.isFinite(t.padding)||t.border!==void 0||t.backgroundcolor!==void 0){let o=[];t.padding&&o.push((n=Qt(t.padding))!=null?n:""),t.border&&o.push(`border: ${t.border}`),t.backgroundcolor&&o.push((r=Qt(t.backgroundcolor))!=null?r:""),i+=`[${o.join(",")}]`}return ut(i,t.bodyToLatex(e))}});Z(["displaystyle","textstyle","scriptstyle","scriptscriptstyle"],"{:rest}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),render:(t,e)=>{let n=new Ye({parent:e,mathstyle:t.command.slice(1)},t.style),r=G.createBox(n,t.body,{type:"lift"});return t.caret&&(r.caret=t.caret),t.bind(e,r)},serialize:(t,e)=>e.skipStyles?t.bodyToLatex(e):`{${Fe([t.command,t.bodyToLatex(e)])}}`});Z(["tiny","scriptsize","footnotesize","small","normalsize","large","Large","LARGE","huge","Huge"],"",{applyStyle:(t,e)=>V(O({},t),{fontSize:{"\\tiny":1,"\\scriptsize":2,"\\footnotesize":3,"\\small":4,"\\normalsize":5,"\\large":6,"\\Large":7,"\\LARGE":8,"\\huge":9,"\\Huge":10}[e]})});Z("fontseries","{:string}",{ifMode:"text",applyStyle:(t,e,n)=>{var r;return V(O({},t),{fontSeries:(r=n[0])!=null?r:"auto"})}});Z("fontshape","{:string}",{ifMode:"text",applyStyle:(t,e,n)=>{var r;return V(O({},t),{fontShape:(r=n[0])!=null?r:"auto"})}});Z("fontfamily","{:string}",{ifMode:"text",applyStyle:(t,e,n)=>{var r;return V(O({},t),{fontFamily:(r=n[0])!=null?r:"roman"})}});Z("selectfont","",{ifMode:"text",applyStyle:t=>t});Z("bf","{:rest*}",{applyStyle:t=>V(O({},t),{fontSeries:"b",fontShape:"n",fontFamily:"roman"})});Z(["boldsymbol","bm","bold"],"{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variantStyle:"bold"})});Z("bfseries","{:rest*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontSeries:"b"})});Z("mdseries","{:rest*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontSeries:"m"})});Z("upshape","{:rest*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"n"})});Z("slshape","{:rest*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"sl"})});Z("scshape","{:rest*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"sc"})});Z("textbf","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontSeries:"b"})});Z("textmd","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontSeries:"m"})});Z("textup","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"n"})});Z("textnormal","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"n",fontSeries:"m"})});Z("textsl","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"sl"})});Z("textit","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"it"})});Z("textsc","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontShape:"sc"})});Z("textrm","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontFamily:"roman"})});Z("textsf","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontFamily:"sans-serif"})});Z("texttt","{:text*}",{applyMode:"text",applyStyle:t=>V(O({},t),{fontFamily:"monospace"})});Z("mathbf","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"normal",variantStyle:"bold"})});Z("mathit","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"main",variantStyle:"italic"})});Z("mathnormal","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"normal",variantStyle:"italic"})});Z("mathbfit","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"main",variantStyle:"bolditalic"})});Z("mathrm","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"normal",variantStyle:"up"})});Z("mathsf","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"sans-serif",variantStyle:"up"})});Z("mathtt","{:math*}",{applyMode:"math",applyStyle:t=>V(O({},t),{variant:"monospace",variantStyle:"up"})});Z("it","{:rest*}",{applyStyle:t=>V(O({},t),{fontSeries:"m",fontShape:"it",fontFamily:"roman",variantStyle:"italic"})});Z("rmfamily","{:rest*}",{applyStyle:t=>V(O({},t),{fontFamily:"roman"})});Z("sffamily","{:rest*}",{applyStyle:t=>V(O({},t),{fontFamily:"sans-serif"})});Z("ttfamily","{:rest*}",{applyStyle:t=>V(O({},t),{fontFamily:"monospace"})});Z(["Bbb","mathbb"],"{:math*}",{applyStyle:t=>V(O({},t),{variant:"double-struck",variantStyle:th(t.variantStyle)})});Z(["frak","mathfrak"],"{:math*}",{applyStyle:t=>V(O({},t),{variant:"fraktur",variantStyle:th(t.variantStyle)})});Z("mathcal","{:math*}",{applyStyle:t=>V(O({},t),{variant:"calligraphic",variantStyle:th(t.variantStyle)})});Z("mathscr","{:math*}",{applyStyle:t=>V(O({},t),{variant:"script",variantStyle:th(t.variantStyle)})});Z("mbox","{:text}",{ifMode:"math",createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[0]),mode:"math"})),serialize:(t,e)=>ut("\\mbox",t.bodyToLatex(V(O({},e),{defaultMode:"text"})))});Z("text","{:text}",{ifMode:"math",applyMode:"text"});Z(["class","htmlClass"],"{name:string}{content:auto*}",{createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[1])})),serialize:(t,e)=>!t.args[0]||e.skipStyles?t.bodyToLatex(e):`${t.command}{${t.args[0]}}{${t.bodyToLatex(e)}}`,render:(t,e)=>{var n;return t.createBox(e,{classes:(n=t.args[0])!=null?n:"",boxType:"lift"})}});Z(["cssId","htmlId"],"{id:string}{content:auto*}",{createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[1])})),serialize:(t,e)=>{var n;return!((n=t.args)!=null&&n[0])||e.skipStyles?t.bodyToLatex(e):`${t.command}{${t.args[0]}}{${t.bodyToLatex(e)}}`},render:(t,e)=>{var n;let r=t.createBox(e);return r.cssId=(n=t.args[0])!=null?n:"",r}});Z("htmlData","{data:string}{content:auto*}",{createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[1])})),serialize:(t,e)=>{var n;return!((n=t.args)!=null&&n[0])||e.skipStyles?t.bodyToLatex(e):`\\htmlData{${t.args[0]}}{${t.bodyToLatex(e)}}`},render:(t,e)=>{var n;let r=t.createBox(e);return r.htmlData=(n=t.args[0])!=null?n:"",r}});Z(["style","htmlStyle"],"{data:string}{content:auto*}",{createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[1])})),serialize:(t,e)=>{var n;return!((n=t.args)!=null&&n[0])||e.skipStyles?t.bodyToLatex(e):`${t.command}{${t.args[0]}}{${t.bodyToLatex(e)}}`},render:(t,e)=>{var n;let r=t.createBox(e);return r.htmlStyle=(n=t.args[0])!=null?n:"",r}});Z("href","{url:string}{content:auto*}",{createAtom:t=>new G(V(O({},t),{type:"mord",body:pe(t.args[1])})),render:(t,e)=>{var n;let r=t.createBox(e),i=(n=t.args[0])!=null?n:"";return i&&(r.htmlData=`href=${i}`),r}});Z("em","{:rest}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),serialize:(t,e)=>e.skipStyles?t.bodyToLatex(e):`{\\em ${t.bodyToLatex(e)}}`,render:(t,e)=>t.createBox(e,{classes:"ML__emph",boxType:"lift"})});Z("emph","{:auto}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[1])})),serialize:(t,e)=>e.skipStyles?t.bodyToLatex(e):`\\emph{${t.bodyToLatex(e)}}`,render:(t,e)=>t.createBox(e,{classes:"ML__emph",boxType:"lift"})});var rv={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}};Z(["bigl","Bigl","biggl","Biggl","bigr","Bigr","biggr","Biggr","bigm","Bigm","biggm","Biggm","big","Big","bigg","Bigg"],"{:delim}",{createAtom:t=>{var e;return new Yx(V(O({},t),{delim:(e=t.args[0])!=null?e:".",size:rv[t.command].size,delimType:rv[t.command].mclass}))},serialize:(t,e)=>Fe([t.command,/^[a-zA-Z]/.test(t.value)?`{${t.value}}`:t.value])});Z(["hspace","hspace*"],"{width:value}",{createAtom:t=>{var e;return new Tl(V(O({},t),{width:(e=t.args[0])!=null?e:{dimension:0}}))}});Z(["mkern","kern","mskip","hskip","mspace"],"{width:value}",{createAtom:t=>{var e;return new Tl(V(O({},t),{width:(e=t.args[0])!=null?e:{dimension:0}}))}});Z("mathchoice","{:math}{:math}{:math}{:math}",{createAtom:t=>new G(t),render:(t,e)=>{let n=0,r=e.mathstyle.id;(r===Xd||r===ko)&&(n=1),(r===Fs||r===Nn)&&(n=2),(r===Do||r===dn)&&(n=3);let i=pe(t.args[n]);return G.createBox(e,i)},serialize:(t,e)=>`\\mathchoice{${G.serialize(t.args[0],e)}}{${G.serialize(t.args[1],e)}}{${G.serialize(t.args[2],e)}}{${G.serialize(t.args[3],e)}}`});Z("mathop","{:auto}",{createAtom:t=>new G(V(O({},t),{type:"mop",body:pe(t.args[0]),limits:"over-under",isFunction:!0,captureSelection:!0})),render:(t,e)=>{var n;let r=G.createBox(e,t.body);if(t.superscript||t.subscript){let i=(n=t.subsupPlacement)!=null?n:"auto";r=i==="over-under"||i==="auto"&&e.isDisplayStyle?t.attachLimits(e,{base:r}):t.attachSupsub(e,{base:r})}return t.caret&&(r.caret=t.caret),new oe(t.bind(e,r),{type:"op",isSelected:t.isSelected,classes:"ML__op-group"})},serialize:(t,e)=>{let n=[ut(t.command,t.bodyToLatex(e))];return t.explicitSubsupPlacement&&(t.subsupPlacement==="over-under"&&n.push("\\limits"),t.subsupPlacement==="adjacent"&&n.push("\\nolimits"),t.subsupPlacement==="auto"&&n.push("\\displaylimits")),n.push(t.supsubToLatex(e)),Fe(n)}});Z(["mathbin","mathrel","mathopen","mathclose","mathpunct","mathord","mathinner"],"{:auto}",{createAtom:t=>new G(V(O({},t),{type:{"\\mathbin":"mbin","\\mathrel":"mrel","\\mathopen":"mopen","\\mathclose":"mclose","\\mathpunct":"mpunct","\\mathord":"mord","\\mathinner":"minner"}[t.command],body:pe(t.args[0])}))});Z(["operatorname","operatorname*"],"{operator:math}",{createAtom:t=>{let e=pe(t.args[0]).map(n=>{var r;return n.type!=="first"&&(n.type="mord",n.value=(r={"":"*","":"-"}[n.value])!=null?r:n.value,n.isFunction=!1,!n.style.variant&&!n.style.variantStyle&&(n.style.variant="main",n.style.variantStyle="up")),n});return new G(V(O({},t),{type:"mop",body:e,isFunction:!0,limits:t.command==="\\operatorname"?"adjacent":"over-under"}))},render:(t,e)=>{var n;let r=G.createBox(e,t.body);if(t.superscript||t.subscript){let i=(n=t.subsupPlacement)!=null?n:"auto";r=i==="over-under"||i==="auto"&&e.isDisplayStyle?t.attachLimits(e,{base:r}):t.attachSupsub(e,{base:r})}return t.caret&&(r.caret=t.caret),new oe(t.bind(e,r),{type:"op",isSelected:t.isSelected,classes:"ML__op-group"})},serialize:(t,e)=>{let n=[ut(t.command,t.bodyToLatex(e))];return t.explicitSubsupPlacement&&(t.subsupPlacement==="over-under"&&n.push("\\limits"),t.subsupPlacement==="adjacent"&&n.push("\\nolimits"),t.subsupPlacement==="auto"&&n.push("\\displaylimits")),n.push(t.supsubToLatex(e)),Fe(n)}});Z(["char","unicode"],"{charcode:value}",{createAtom:t=>new G(V(O({},t),{type:t.mode==="text"?"text":"mord"})),serialize:t=>{var e;return`${t.command}${Qt((e=t.args[0])!=null?e:{number:10067,base:"hexadecimal"})}`},render:(t,e)=>{let n=e.evaluate(t.args[0]);return(!n||!("number"in n))&&(n={number:10067,base:"hexadecimal"}),t.value=String.fromCodePoint(n.number),t.createBox(e)}});Z("rule","[raise:value]{width:value}{thickness:value}",{createAtom:t=>new G(t),render:(t,e)=>{var n,r,i;let o=new Ye({parent:e,mathstyle:"textstyle"},t.style),s=o.toEm((n=t.args[0])!=null?n:{dimension:0}),a=o.toEm((r=t.args[1])!=null?r:{dimension:10}),l=o.toEm((i=t.args[2])!=null?i:{dimension:10}),u=new oe(null,{classes:"ML__rule",type:"ord"});return u.width=a,u.height=l+s,u.depth=-s,u.setStyle("border-right-width",a,"em"),u.setStyle("border-top-width",l,"em"),u.setStyle("border-color",t.style.color),u.setStyle("vertical-align",s,"em"),t.isSelected&&u.setStyle("opacity","50%"),t.bind(o,u),t.caret&&(u.caret=t.caret),u.wrap(e)},serialize:t=>`\\rule${t.args[0]?`[${Qt(t.args[0])}]`:""}{${Qt(t.args[1])}}{${Qt(t.args[2])}}`});Z(["overline","underline"],"{:auto}",{createAtom:t=>new G(V(O({},t),{body:pe(t.args[0])})),render:(t,e)=>{let n=t.command.substring(1),r=new Ye({parent:e,mathstyle:"cramp"},t.style),i=G.createBox(r,t.body);if(!i)return null;let o=r.metrics.defaultRuleThickness/r.scalingFactor,s=new oe(null,{classes:n+"-line"});s.height=o,s.maxFontSize=o*1.125*r.scalingFactor;let a;return n==="overline"?a=new It({shift:0,children:[{box:i},3*o,{box:s},o]}):a=new It({top:i.height,children:[o,{box:s},3*o,{box:i}]}),t.caret&&(a.caret=t.caret),new oe(a,{classes:n,type:"ignore"})}});Z("overset","{:auto}{base:auto}",{createAtom:t=>{let e=pe(t.args[1]);return new Yn(V(O({},t),{above:pe(t.args[0]),body:e,skipBoundary:!1,boxType:Dl(e)}))},serialize:(t,e)=>ut(t.command,t.aboveToLatex(e),t.bodyToLatex(e))});Z("underset","{:auto}{base:auto}",{createAtom:t=>{let e=pe(t.args[1]);return new Yn(V(O({},t),{below:pe(t.args[0]),body:e,skipBoundary:!1,boxType:Dl(e)}))},serialize:(t,e)=>ut(t.command,t.belowToLatex(e),t.bodyToLatex(e))});Z("overunderset","{above:auto}{below:auto}{base:auto}",{createAtom:t=>{let e=pe(t.args[2]);return new Yn(V(O({},t),{above:pe(t.args[0]),below:pe(t.args[1]),body:e,skipBoundary:!1,boxType:Dl(e)}))},serialize:(t,e)=>ut(t.command,t.belowToLatex(e),t.bodyToLatex(e))});Z(["stackrel","stackbin"],"[below:auto]{above:auto}{base:auto}",{createAtom:t=>new Yn(V(O({},t),{body:pe(t.args[2]),above:pe(t.args[1]),below:pe(t.args[0]),skipBoundary:!1,boxType:t.command==="\\stackrel"?"rel":"bin"})),serialize:(t,e)=>ut(t.command,t.aboveToLatex(e),t.bodyToLatex(e))});Z("smash","[:string]{:auto}",{createAtom:t=>{var e,n,r,i;return new ra(V(O({},t),{body:pe(t.args[1]),smashHeight:(n=(e=t.args[0])==null?void 0:e.includes("t"))!=null?n:!0,smashDepth:(i=(r=t.args[0])==null?void 0:r.includes("b"))!=null?i:!0}))}});Z("vphantom","{:auto}",{createAtom:t=>new ra(V(O({},t),{body:pe(t.args[0]),isInvisible:!0,smashWidth:!0}))});Z("hphantom","{:auto}",{createAtom:t=>new ra(V(O({},t),{body:pe(t.args[0]),isInvisible:!0,smashHeight:!0,smashDepth:!0}))});Z("phantom","{:auto}",{createAtom:t=>new ra(V(O({},t),{body:pe(t.args[0]),isInvisible:!0}))});Z("mathstrut","",{createAtom:t=>new ra(V(O({},t),{body:[new G({value:"("})],isInvisible:!0}))});Z("not","{:math}",{createAtom:t=>{let e=pe(t.args[0]);return e.length===0?new G(V(O({},t),{type:"mrel",value:""})):new G(V(O({},t),{body:[new Qo(V(O({},t),{body:"",align:"right"})),...e],captureSelection:!0}))},serialize:(t,e)=>{let n=t.args[0],r=n&&typeof n=="object"&&"group"in n;return t.value!==""?r?`\\not{${G.serialize(n.group,e)}}`:`\\not${G.serialize(n,e)}`:r?"\\not{}":"\\not"},render:(t,e)=>{if(t.value)return t.createBox(e);let n=t.args[0]&&typeof t.args[0]=="object"&&"group"in t.args[0]?"ord":Dl(pe(t.args[0])),r=G.createBox(e,t.body,{type:n});return t.caret&&(r.caret=t.caret),t.bind(e,r)}});Z(["ne","neq"],"",{createAtom:t=>new G(V(O({},t),{type:"mrel",body:[new Qo(V(O({},t),{body:"",align:"right",boxType:"rel"})),new G(V(O({},t),{value:"="}))],captureSelection:!0})),serialize:t=>t.command});Z("rlap","{:auto}",{createAtom:t=>new Qo(V(O({},t),{body:pe(t.args[0]),align:"right"}))});Z("llap","{:auto}",{createAtom:t=>new Qo(V(O({},t),{body:pe(t.args[0]),align:"left"}))});Z("mathrlap","{:math}",{createAtom:t=>new Qo(V(O({},t),{body:pe(t.args[0]),align:"right"}))});Z("mathllap","{:math}",{createAtom:t=>new Qo(V(O({},t),{body:pe(t.args[0]),align:"left"}))});Z("raisebox","{:value}{:text}",{createAtom:t=>{var e;return new Xi(V(O({},t),{body:pe(t.args[1]),padding:{dimension:0},offset:(e=t.args[0])!=null?e:{dimension:0}}))},serialize:(t,e)=>{var n;return ut("\\raisebox",(n=Qt(t.offset))!=null?n:"0pt",t.bodyToLatex(e))}});Z("raise","{:value}{:auto}",{createAtom:t=>{var e;return new Xi(V(O({},t),{body:pe(t.args[1]),padding:{dimension:0},offset:(e=t.args[0])!=null?e:{dimension:0}}))},serialize:(t,e)=>{var n;return ut("\\raise",(n=Qt(t.offset))!=null?n:"0pt",t.bodyToLatex(e))}});Z("lower","{:value}{:auto}",{createAtom:t=>{var e;return new Xi(V(O({},t),{body:pe(t.args[1]),padding:{dimension:0},offset:(e=xr(t.args[0],-1))!=null?e:{dimension:0}}))},serialize:(t,e)=>{var n,r;return ut("\\lower",(r=Qt(xr((n=t.offset)!=null?n:{dimension:0},-1)))!=null?r:"0pt",t.bodyToLatex(e))}});Ut("0123456789/@.?!");nx(65,90);nx(97,122);Ut([["\\forall",8704],["\\exists",8707],["\\nexists",8708,"mord","ams"],["\\mid",8739,"mrel"],["\\top",8868],["\\bot",8869]]);Ut([["\\#",35],["\\&",38],["\\parallelogram",9649],["\\spadesuit",9824],["\\heartsuit",9825],["\\diamondsuit",9826],["\\clubsuit",9827],["\\flat",9837],["\\natural",9838],["\\sharp",9839]]);Ut([["\\backslash",92],["\\nabla",8711],["\\partial",8706],["\\ell",8467],["\\hbar",8463],["\\pounds",163],["\\euro",8364]]);Ut([["\\rightarrow",8594],["\\to",8594],["\\leftarrow",8592],["\\gets",8592],["\\Rightarrow",8658],["\\Leftarrow",8656],["\\longrightarrow",10230],["\\longleftarrow",10229],["\\Longrightarrow",10233],["\\implies",10233],["\\Longleftarrow",10232],["\\impliedby",10232],["\\longleftrightarrow",10231],["\\biconditional",10231],["\\Longleftrightarrow",10234],["\\mapsto",8614],["\\longmapsto",10236],["\\uparrow",8593],["\\downarrow",8595],["\\Uparrow",8657],["\\Downarrow",8659],["\\updownarrow",8597],["\\Updownarrow",8661],["\\hookrightarrow",8618],["\\hookleftarrow",8617],["\\rightharpoonup",8640],["\\leftharpoonup",8636],["\\rightharpoondown",8641],["\\leftharpoondown",8637],["\\searrow",8600],["\\nearrow",8599],["\\swarrow",8601],["\\nwarrow",8598],["\\originalof",8886],["\\laplace",8886],["\\imageof",8887],["\\Laplace",8887]],"mrel");Ut([["\\mapsfrom",8612,"mrel"],["\\Mapsfrom",10502,"mrel"],["\\MapsTo",10503,"mrel"],["\\Yup",8516,"mord"],["\\lightning",8623,"mrel"],["\\leftarrowtriangle",8701,"mrel"],["\\rightarrowtriangle",8702,"mrel"],["\\leftrightarrowtriangle",8703,"mrel"],["\\boxdot",8865,"mbin"],["\\bigtriangleup",9651,"mbin"],["\\bigtriangledown",9661,"mbin"],["\\boxbar",9707,"mbin"],["\\Lbag",10181,"mopen"],["\\Rbag",10182,"mclose"],["\\llbracket",10214,"mopen"],["\\rrbracket",10215,"mclose"],["\\longmapsfrom",10235,"mrel"],["\\Longmapsfrom",10237,"mrel"],["\\Longmapsto",10238,"mrel"],["\\boxslash",10692,"mbin"],["\\boxbslash",10693,"mbin"],["\\boxast",10694,"mbin"],["\\boxcircle",10695,"mbin"],["\\boxbox",10696,"mbin"],["\\fatsemi",10783,"mop"],["\\leftslice",10918,"mrel"],["\\rightslice",10919,"mrel"],["\\interleave",10996,"mbin"],["\\biginterleave",11004,"mop"],["\\sslash",11005,"mbin"],["\\talloblong",11006,"mbin"]]);Ut([["\\lbrace",123,"mopen"],["\\rbrace",125,"mclose"],["\\lparen",40,"mopen"],["\\rparen",41,"mclose"],["\\langle",10216,"mopen"],["\\rangle",10217,"mclose"],["\\lfloor",8970,"mopen"],["\\rfloor",8971,"mclose"],["\\lceil",8968,"mopen"],["\\rceil",8969,"mclose"],["\\vert",8739],["\\lvert",8739,"mopen"],["\\rvert",8739,"mclose"],["\\|",8741],["\\Vert",8741],["\\mVert",8741],["\\lVert",8741,"mopen"],["\\rVert",8741,"mclose"],["\\lbrack",91,"mopen"],["\\rbrack",93,"mclose"],["\\{",123,"mopen"],["\\}",125,"mclose"],["(",40,"mopen"],[")",41,"mclose"],["[",91,"mopen"],["]",93,"mclose"],["\\ulcorner",9484,"mopen","ams"],["\\urcorner",9488,"mclose","ams"],["\\llcorner",9492,"mopen","ams"],["\\lrcorner",9496,"mclose","ams"],["\\lgroup",10222,"mopen"],["\\rgroup",10223,"mclose"],["\\lmoustache",9136,"mopen"],["\\rmoustache",9137,"mclose"]]);Ut([["\\dashrightarrow",8674],["\\dashleftarrow",8672],["\\Rrightarrow",8667],["\\Lleftarrow",8666],["\\leftrightarrows",8646],["\\rightleftarrows",8644],["\\curvearrowright",8631],["\\curvearrowleft",8630],["\\rightrightarrows",8649],["\\leftleftarrows",8647],["\\upuparrows",8648],["\\downdownarrows",8650],["\\vartriangle",9651],["\\triangleq",8796],["\\vartriangleleft",8882],["\\trianglelefteq",8884],["\\ntriangleleft",8938],["\\ntrianglelefteq",8940],["\\vartriangleright",8883],["\\trianglerighteq",8885],["\\ntriangleright",8939],["\\ntrianglerighteq",8941],["\\blacktriangleleft",9664],["\\blacktriangleright",9654],["\\leftarrowtail",8610],["\\rightarrowtail",8611],["\\looparrowright",8620],["\\looparrowleft",8619],["\\twoheadleftarrow",8606],["\\twoheadrightarrow",8608],["\\twoheadrightarrowtail",10518],["\\rightleftharpoons",8652],["\\leftrightharpoons",8651],["\\Rsh",8625],["\\Lsh",8624],["\\circlearrowright",8635],["\\circlearrowleft",8634],["\\restriction",8638],["\\upharpoonright",8638],["\\upharpoonleft",8639],["\\downharpoonright",8642],["\\downharpoonleft",8643],["\\rightsquigarrow",8669],["\\leadsto",8669],["\\leftrightsquigarrow",8621],["\\multimap",8888],["\\nleftarrow",8602],["\\nrightarrow",8603],["\\nRightarrow",8655],["\\nLeftarrow",8653],["\\nleftrightarrow",8622],["\\nLeftrightarrow",8654],["\\nvrightarrow",8696],["\\nvtwoheadrightarrow",10496],["\\nvrightarrowtail",10516],["\\nvtwoheadrightarrowtail",10519],["\\shortparallel",8741],["\\nless",8814],["\\nleqslant",57360],["\\lneq",10887],["\\lneqq",8808],["\\nleqq",57361],["\\lvertneqq",57356],["\\lnsim",8934],["\\lnapprox",10889],["\\nprec",8832],["\\npreceq",8928],["\\precnsim",8936],["\\precnapprox",10937],["\\nsim",8769],["\\nshortmid",57350],["\\nmid",8740],["\\nvdash",8876],["\\nvDash",8877],["\\ngtr",8815],["\\ngeqslant",57359],["\\ngeqq",57358],["\\gneq",10888],["\\gneqq",8809],["\\gvertneqq",57357],["\\gnsim",8935],["\\gnapprox",10890],["\\nsucc",8833],["\\nsucceq",8929],["\\succnsim",8937],["\\succnapprox",10938],["\\ncong",8774],["\\nshortparallel",57351],["\\nparallel",8742],["\\nVDash",8879],["\\nsupseteqq",57368],["\\supsetneq",8843],["\\varsupsetneq",57371],["\\supsetneqq",10956],["\\varsupsetneqq",57369],["\\nVdash",8878],["\\precneqq",10933],["\\succneqq",10934],["\\nsubseteqq",57366],["\\leqslant",10877],["\\geqslant",10878],["\\gtrsim",8819],["\\approxeq",8778],["\\thickapprox",8776],["\\lessapprox",10885],["\\gtrapprox",10886],["\\precapprox",10935],["\\succapprox",10936],["\\thicksim",8764],["\\succsim",8831],["\\precsim",8830],["\\backsim",8765],["\\eqsim",8770],["\\backsimeq",8909],["\\lesssim",8818],["\\nleq",8816],["\\ngeq",8817],["\\smallsmile",8995],["\\smallfrown",8994],["\\leqq",8806],["\\eqslantless",10901],["\\lll",8920],["\\lessgtr",8822],["\\lesseqgtr",8922],["\\lesseqqgtr",10891],["\\risingdotseq",8787],["\\fallingdotseq",8786],["\\subseteqq",10949],["\\Subset",8912],["\\sqsubset",8847],["\\preccurlyeq",8828],["\\curlyeqprec",8926],["\\vDash",8872],["\\Vvdash",8874],["\\bumpeq",8783],["\\Bumpeq",8782],["\\geqq",8807],["\\eqslantgtr",10902],["\\ggg",8921],["\\gtrless",8823],["\\gtreqless",8923],["\\gtreqqless",10892],["\\supseteqq",10950],["\\Supset",8913],["\\sqsupset",8848],["\\succcurlyeq",8829],["\\curlyeqsucc",8927],["\\Vdash",8873],["\\shortmid",8739],["\\between",8812],["\\pitchfork",8916],["\\varpropto",8733],["\\backepsilon",8717],["\\llless",8920],["\\gggtr",8921],["\\doteqdot",8785],["\\Doteq",8785],["\\eqcirc",8790],["\\circeq",8791],["\\therefore",8756],["\\because",8757]],"mrel","ams");Ut([["+",43],["-",8722],["",8722],["\\pm",177],["\\mp",8723],["*",8727],["\\times",215],["\\div",247],["\\divides",8739],["\\cdot",8901],["\\cap",8745],["\\cup",8746],["\\setminus",8726],["\\land",8743],["\\wedge",8743],["\\lor",8744],["\\vee",8744],["\\circ",8728],["\\bigcirc",9711],["\\bullet",8729],["\\oplus",8853],["\\ominus",8854],["\\otimes",8855],["\\odot",8857],["\\oslash",8856],["\\bigtriangleup",9651],["\\bigtriangledown",9661],["\\triangleleft",9667],["\\triangleright",9657],["\\And",38],["\\dagger",8224],["\\dag",8224],["\\ddag",8225],["\\ddagger",8225],["\\ast",8727],["\\star",8902],["\\bigstar",9733],["\\diamond",8900]],"mbin");Ut([["\\lhd",8882],["\\rhd",8883],["\\lessdot",8918],["\\gtrdot",8919],["\\ltimes",8905],["\\rtimes",8906],["\\leftthreetimes",8907],["\\rightthreetimes",8908],["\\intercal",8890],["\\dotplus",8724],["\\doublebarwedge",10846],["\\divideontimes",8903],["\\centerdot",8901],["\\smallsetminus",8726],["\\barwedge",8892],["\\veebar",8891],["\\nor",8891],["\\curlywedge",8911],["\\curlyvee",8910],["\\boxminus",8863],["\\boxplus",8862],["\\boxtimes",8864],["\\boxdot",8865],["\\circleddash",8861],["\\circledast",8859],["\\circledcirc",8858],["\\unlhd",8884],["\\unrhd",8885]],"mbin","ams");Ut([["\\surd",8730],["\\S",167],["\\infty",8734],["\\prime",8242],["\\doubleprime",8243],["\\angle",8736],["`",8216],["\\$",36],["\\%",37],["\\_",95],["\\alpha",945],["\\beta",946],["\\gamma",947],["\\delta",948],["\\epsilon",1013],["\\varepsilon",949],["\\zeta",950],["\\eta",951],["\\theta",952],["\\vartheta",977],["\\iota",953],["\\kappa",954],["\\varkappa",1008,"mord","ams"],["\\lambda",955],["\\mu",956],["\\nu",957],["\\xi",958],["\\omicron",111],["\\pi",960],["\\varpi",982],["\\rho",961],["\\varrho",1009],["\\sigma",963],["\\varsigma",962],["\\tau",964],["\\phi",981],["\\varphi",966],["\\upsilon",965],["\\chi",967],["\\psi",968],["\\omega",969],["\\Gamma",915],["\\Delta",916],["\\Theta",920],["\\Lambda",923],["\\Xi",926],["\\Pi",928],["\\Sigma",931],["\\Upsilon",933],["\\Phi",934],["\\Psi",936],["\\Omega",937],["\\digamma",989,"mord","ams"],["\\varkappa",1008,"mord","ams"],["\\coppa",985,"mord","ams"],["\\koppa",985,"mord","ams"],["\\Coppa",984,"mord","ams"],["\\Koppa",984,"mord","ams"],["\\sampi",993,"mord","ams"],["\\Sampi",992,"mord","ams"],["\\emptyset",8709]]);Ut([["=",61],["<",60],["\\lt",60],[">",62],["\\gt",62],["\\le",8804],["\\leq",8804],["\\ge",8805],["\\geq",8805],["\\ll",8810],["\\gg",8811],["\\coloneq",8788],["\\coloneqq",8788],["\\colonequals",8788],["\\measeq",8797],["\\eqdef",8798],["\\questeq",8799],[":",58],["\\cong",8773],["\\equiv",8801],["\\prec",8826],["\\preceq",10927],["\\succ",8827],["\\succeq",10928],["\\perp",10178],["\\propto",8733],["\\Colon",8759],["\\smile",8995],["\\frown",8994],["\\sim",8764],["\\doteq",8784],["\\bowtie",8904],["\\Join",8904],["\\asymp",8781],["\\sqsubseteq",8849],["\\sqsupseteq",8850],["\\approx",8776],["\\~",126],["\\leftrightarrow",8596],["\\Leftrightarrow",8660],["\\models",8872],["\\vdash",8866],["\\dashv",8867],["\\roundimplies",10608],["\\in",8712],["\\notin",8713],["\\ni",8715],["\\owns",8715],["\\subset",8834],["\\supset",8835],["\\subseteq",8838],["\\supseteq",8839],["\\differencedelta",8710],["\\mvert",8739],["\\parallel",8741],["\\simeq",8771]],"mrel");Ut([["\\lnot",172],["\\neg",172],["\\triangle",9651],["\\subsetneq",8842],["\\varsubsetneq",57370],["\\subsetneqq",10955],["\\varsubsetneqq",57367],["\\nsubset",8836],["\\nsupset",8837],["\\nsubseteq",8840],["\\nsupseteq",8841]],"mrel","ams");Ut([["\\wp",8472],["\\aleph",8501]]);Ut([["\\blacktriangle",9650],["\\hslash",8463],["\\Finv",8498],["\\Game",8513],["\\eth",240],["\\mho",8487],["\\Bbbk",107],["\\yen",165],["\\square",9633],["\\Box",9633],["\\blacksquare",9632],["\\circledS",9416],["\\circledR",174],["\\triangledown",9661],["\\blacktriangledown",9660],["\\checkmark",10003],["\\diagup",9585],["\\measuredangle",8737],["\\sphericalangle",8738],["\\backprime",8245],["\\backdoubleprime",8246],["\\Diamond",9674],["\\lozenge",9674],["\\blacklozenge",10731],["\\varnothing",8709],["\\complement",8705],["\\maltese",10016],["\\beth",8502],["\\daleth",8504],["\\gimel",8503]],"mord","ams");Ut([["\\ ",160],["~",160]],"space");Z(["!",",",":",";",">","enskip","enspace","quad","qquad"],"",{createAtom:t=>new Tl(t)});Z("space","",{createAtom:t=>new Tl(t)});Ut([["\\colon",58],["\\cdotp",8901],["\\vdots",8942,"mord"],["\\ldotp",46],[",",44],[";",59]],"mpunct");Ut([["\\cdots",8943],["\\ddots",8945],["\\ldots",8230],["\\mathellipsis",8230]],"minner");Ut([["\\/",47],["|",8739,"mord"],["\\imath",305],["\\jmath",567],["\\degree",176],["'",8242],['"',8221]]);var Sp={main:["Main-Regular","ML__cmr"],"main-italic":["Main-Italic","ML__cmr ML__it"],"main-bold":["Main-Bold","ML__cmr ML__bold"],"main-bolditalic":["Main-BoldItalic","ML__cmr ML__bold ML__it"],normal:["Main-Regular","ML__cmr"],"normal-bold":["Main-Bold","ML__mathbf"],"normal-italic":["Math-Italic","ML__mathit"],"normal-bolditalic":["Math-BoldItalic","ML__mathbfit"],roman:["Main-Regular","ML__cmr"],"roman-bold":["Main-Bold","ML__mathbf"],"roman-italic":["Math-Italic","ML__mathit"],"roman-bolditalic":["Math-BoldItalic","ML__mathbfit"],ams:["AMS-Regular","ML__ams"],"ams-bold":["AMS-Regular","ML__ams ML__bold"],"ams-italic":["AMS-Regular","ML__ams ML__it"],"ams-bolditalic":["AMS-Regular","ML__ams ML__bold ML__it"],"sans-serif":["SansSerif-Regular","ML__sans"],"sans-serif-bold":["SansSerif-Regular","ML__sans ML__bold"],"sans-serif-italic":["SansSerif-Regular","ML__sans ML__it"],"sans-serif-bolditalic":["SansSerif-Regular","ML__sans ML__bold ML__it"],calligraphic:["Caligraphic-Regular","ML__cal"],"calligraphic-bold":["Caligraphic-Regular","ML__cal ML__bold"],"calligraphic-italic":["Caligraphic-Regular","ML__cal ML__it"],"calligraphic-bolditalic":["Caligraphic-Regular","ML__cal ML__bold ML__it"],script:["Script-Regular","ML__script"],"script-bold":["Script-Regular","ML__script ML__bold"],"script-italic":["Script-Regular","ML__script ML__it"],"script-bolditalic":["Script-Regular","ML__script ML__bold ML__it"],fraktur:["Fraktur-Regular","ML__frak"],"fraktur-bold":["Fraktur-Regular","ML__frak ML__bold"],"fraktur-italic":["Fraktur-Regular","ML__frak ML__it"],"fraktur-bolditalic":["Fraktur-Regular","ML__frak ML__bold ML__it"],monospace:["Typewriter-Regular","ML__tt"],"monospace-bold":["Typewriter-Regular","ML__tt ML__bold"],"monospace-italic":["Typewriter-Regular","ML__tt ML__it"],"monospace-bolditalic":["Typewriter-Regular","ML__tt ML__bold ML__it"],"double-struck":["AMS-Regular","ML__bb"],"double-struck-bold":["AMS-Regular","ML__bb ML__bold"],"double-struck-italic":["AMS-Regular","ML__bb ML_italic"],"double-struck-bolditalic":["AMS-Regular","ML__bb ML_bolditalic"]},Rf={"double-struck":/^[A-Z ]$/,script:/^[A-Z ]$/,calligraphic:/^[\dA-Z ]$/,fraktur:/^[\dA-Za-z ]$|^[!"#$%&'()*+,\-./:;=?[]^]$/,monospace:/^[\dA-Za-z ]$|^[!"&'()*+,\-./:;=?@[\]^_~\u0131\u0237\u0393\u0394\u0398\u039B\u039E\u03A0\u03A3\u03A5\u03A8\u03A9]$/,"sans-serif":/^[\dA-Za-z ]$|^[!"&'()*+,\-./:;=?@[\]^_~\u0131\u0237\u0393\u0394\u0398\u039B\u039E\u03A0\u03A3\u03A5\u03A8\u03A9]$/},h5=/^[\u03B1-\u03C9]|\u03D1|\u03D5|\u03D6|\u03F1|\u03F5]$/,_E=/^[\u0393|\u0394\u0398\u039B\u039E\u03A0\u03A3\u03A5\u03A6\u03A8\u03A9]$/,ME=[/^[a-z]$/,/^[A-Z]$/,h5,_E],CE={iso:["it","it","it","it"],tex:["it","it","it","up"],french:["it","up","up","up"],upright:["up","up","up","up"]},EE=class extends In{constructor(){super("math")}createAtom(t,e,n){var r,i,o,s,a,l;if(e===null)return new G({type:"mord",mode:"math",command:t,value:t,style:n});let u;try{u=(o=(i=globalThis.MathfieldElement)==null?void 0:i.isFunction((r=e.command)!=null?r:t))!=null?o:!1}catch{u=!1}if(e.definitionType==="symbol"){let d=new G({type:(s=e.type)!=null?s:"mord",mode:"math",command:(a=e.command)!=null?a:t,value:String.fromCodePoint(e.codepoint),isFunction:u,style:n});return t.startsWith("\\")&&(d.verbatimLatex=t),d}let c=new G({type:"mord",mode:"math",command:(l=e.command)!=null?l:t,value:t,isFunction:u,style:n});return t.startsWith("\\")&&(c.verbatimLatex=t),c}serialize(t,e){let n=AE(t,V(O({},e),{defaultMode:"math"}));return n.length===0||e.defaultMode!=="text"?n:["$ ",...n," $"]}getFont(t,e){var n,r,i;if(e.variant,e.fontFamily){let c=e.fontFamily;e.fontSeries==="b"&&e.fontShape==="it"?c+="-bolditalic":e.fontSeries==="b"?c+="-bold":e.fontShape==="it"&&(c+="-italic");let d=(n=Sp[c])!=null?n:Sp[e.fontFamily];if(!d)return console.error(`Unknown font family variant: ${c}`),null;let[p,f]=d;return f&&(t.classes+=" "+f),p}let{variant:o}=e,{variantStyle:s}=e;if(o==="normal"&&!s&&/[\u00A3\u0131\u0237]/.test(t.value)&&(o="main",s="italic"),o==="normal"&&!s&&t.value.length===1){let c=!1;ME.forEach((d,p)=>{var f;d.test(t.value)&&CE[(f=e.letterShapeStyle)!=null?f:"tex"][p]==="it"&&(c=!0)}),c&&(s=SE(s))}s==="up"&&(s=void 0);let a=s?o+"-"+s:o,[l,u]=Sp[a];if(Rf[o]&&!Rf[o].test(t.value)){let c=_f(t.value,o,s);return c||(c=(r=_f(t.value,o))!=null?r:t.value,t.classes+=(i={bold:" ML__bold",italic:" ML__it","bold-italic":" ML__bold ML__it"}[s??""])!=null?i:""),t.value=c,null}return h5.test(t.value)&&(t.classes+=" lcGreek"),u&&(t.classes+=" "+u),l}};function AE(t,e){return ti(t,"bold").map(n=>{if(Lf(n[0])!=="bold"||Lf(n[0].parent)==="bold")return Fe($u(n,e));let r=Fe(n.map(i=>{var o;return(o=i.value)!=null?o:""}));return/^[a-zA-Z0-9]+$/.test(r)?ut("\\mathbf",Fe($u(n,e))):ut("\\bm",Fe($u(n,e)))})}function $u(t,e){let{parent:n}=t[0],r=Tf(n);return ti(t,"variant").map(i=>{let o=Tf(i[0]),s="";o&&o!==r&&(s={calligraphic:"\\mathcal","calligraphic-uo":"\\mathcal",fraktur:"\\mathfrak","fraktur-uo":"\\mathfrak","double-struck":"\\mathbb","double-struck-uo":"\\mathbb",script:"\\mathscr","script-uo":"\\mathscr",monospace:"\\mathtt","monospace-uo":"\\mathtt","sans-serif":"\\mathsf","sans-serif-uo":"\\mathsf",normal:"","normal-up":"\\mathrm","normal-italic":"\\mathnormal","normal-bold":"","normal-bolditalic":"\\mathbfit",ams:"","ams-up":"\\mathrm","ams-italic":"\\mathit","ams-bold":"","ams-bolditalic":"\\mathbfit",main:"","main-up":"\\mathrm","main-italic":"\\mathit","main-bold":"","main-bolditalic":"\\mathbfit"}[o]);let a="",l=i[i.length-1],u=s&&i.length>0&&(l.branch("subscript")!==void 0||l.branch("superscript")!==void 0);u&&(a=l.supsubToLatex(e));let c=Fe(i.map((d,p)=>{if(u&&p===i.length-1){let f=Vt(d.command,d.mode);return f!=null&&f.serialize?f.serialize(d,e):d.body&&d.command?ut(d.command,d.bodyToLatex(e)):d.body?d.bodyToLatex(e):!d.value||d.value===""?"":d.command||d.value}return d._serialize(e)}));return s?ut(s,c)+a:c})}new EE;function DE(t,e){return t.map(n=>n._serialize(e))}function LE(t,e){return ti(t,"fontShape").map(n=>{let r=DE(n,e),{fontShape:i}=n[0].style,o="";return i==="it"&&(o="\\textit"),i==="sl"&&(o="\\textsl"),i==="sc"&&(o="\\textsc"),i==="n"&&(o="\\textup"),!o&&i?`{${ut("\\fontshape",i)}${Fe(r)}}`:o?ut(o,Fe(r)):Fe(r)})}function TE(t,e){return ti(t,"fontSeries").map(n=>{let r=LE(n,e),{fontSeries:i}=n[0].style,o="";return i==="b"&&(o="\\textbf"),i==="l"&&(o="\\textlf"),i==="m"&&(o="\\textmd"),i&&!o?`{${ut("\\fontseries",i)}${Fe(r)}}`:o?ut(o,Fe(r)):Fe(r)})}function BE(t,e){return ti(t,"fontSize").map(n=>{var r,i;let o=TE(n,e),s=(i=["","\\tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"][(r=n[0].style.fontSize)!=null?r:""])!=null?i:"";return s?`${s} ${Fe(o)}`:Fe(o)})}function OE(t,e,n){return ti(t,"fontFamily").map(r=>{var i;n=n&&!r.every(l=>l.style.fontFamily||l.style.fontShape||l.style.fontSeries||l.style.fontSize);let o=BE(r,e),{fontFamily:s}=r[0].style,a=(i={roman:"textrm",monospace:"texttt","sans-serif":"textsf"}[s??""])!=null?i:"";return a?`\\${a}{${Fe(o)}}`:s?`{\\fontfamily{${r[0].style.fontFamily}} ${Fe(o)}}`:n?`\\text{${Fe(o)}}`:Fe(o)})}var iv={roman:"","sans-serif":"ML__sans",monospace:"ML__tt"},NE=class extends In{constructor(){super("text")}createAtom(t,e,n){return e&&e.definitionType==="symbol"?new na(t,String.fromCodePoint(e.codepoint),n??{}):null}serialize(t,e){return OE(t,V(O({},e),{defaultMode:"text"}),e.defaultMode!=="text")}getFont(t,e){var n,r,i,o,s;let{fontFamily:a}=e;if(iv[a]?t.classes+=" "+iv[a]:a&&t.setStyle("font-family",a),e.fontShape&&(t.classes+=" ",t.classes+=(n={it:"ML__it",sl:"ML__shape_sl",sc:"ML__shape_sc",ol:"ML__shape_ol"}[e.fontShape])!=null?n:""),e.fontSeries){let l=e.fontSeries.match(/(.?[lbm])?(.?[cx])?/);l&&(t.classes+=" ",t.classes+=(i={ul:"ML__series_ul",el:"ML__series_el",l:"ML__series_l",sl:"ML__series_sl",m:"",sb:"ML__series_sb",b:"ML__bold",eb:"ML__series_eb",ub:"ML__series_ub"}[(r=l[1])!=null?r:""])!=null?i:"",t.classes+=" ",t.classes+=(s={uc:"ML__series_uc",ec:"ML__series_ec",c:"ML__series_c",sc:"ML__series_sc",n:"",sx:"ML__series_sx",x:"ML__series_x",ex:"ML__series_ex",ux:"ML__series_ux"}[(o=l[2])!=null?o:""])!=null?s:"")}return"Main-Regular"}};new NE;var PE=class extends In{constructor(){super("latex")}createAtom(t){return new qt(t)}serialize(t,e){return t.filter(n=>n instanceof qt&&!n.isSuggestion).map(n=>n.value)}getFont(){return null}};new PE;function s0(t){var e;let n=/macos|ios/.test(ta()),r=t.split("+"),i="";for(let o of r)i&&(i+=n?"":'<span class="ML__shortcut-join">+</span>'),o.startsWith("[Key")?i+=o.slice(4,5):o.startsWith("Key")?i+=o.slice(3,4):o.startsWith("[Digit")?i+=o.slice(6,7):o.startsWith("Digit")?i+=o.slice(5,6):i+=(e={cmd:"",meta:n?"":"Ctrl",shift:n?"":"Shift",alt:n?"":"Alt",ctrl:n?"":"Ctrl","\n":n?"":"Return","[return]":n?"":"Return","[enter]":n?"":"Enter","[tab]":n?"":"Tab","[escape]":"Esc","[backspace]":n?"":"Backspace","[delete]":n?"":"Del","[pageup]":n?"":"Page Up","[pagedown]":n?"":"Page Down","[home]":n?"":"Home","[end]":n?"":"End","[space]":"Space","[equal]":"=","[minus]":"-","[comma]":",","[slash]":"/","[backslash]":"\\","[bracketleft]":"[","[bracketright]":"]",semicolon:";",period:".",comma:",",minus:"-",equal:"=",quote:"'",backslash:"\\",intlbackslash:"\\",backquote:"`",slash:"/",numpadmultiply:"* &#128290;",numpaddivide:"/ &#128290;",numpadsubtract:"- &#128290;",numpadadd:"+ &#128290;",numpaddecimal:". &#128290;",numpadcomma:", &#128290;",help:"help",left:"",up:"",right:"",down:"","[arrowleft]":"","[arrowup]":"","[arrowright]":"","[arrowdown]":""}[o.toLowerCase()])!=null?e:o.toUpperCase();return i}function xd(t){if(t instanceof MouseEvent||t instanceof PointerEvent)return{x:t.clientX,y:t.clientY};if(typeof TouchEvent<"u"&&t instanceof TouchEvent){let e=[...t.touches].reduce((r,i)=>({x:r.x+i.clientX,y:r.y+i.clientY}),{x:0,y:0}),n=t.touches.length;return{x:e.x/n,y:e.y/n}}}function Lo(t){let e={alt:!1,control:!1,shift:!1,meta:!1};return(t instanceof MouseEvent||t instanceof PointerEvent||typeof TouchEvent<"u"&&t instanceof TouchEvent||t instanceof KeyboardEvent)&&(t.altKey&&(e.alt=!0),t.ctrlKey&&(e.control=!0),t.metaKey&&(e.meta=!0),t.shiftKey&&(e.shift=!0)),e}function IE(t,e){return!t&&e||t&&!e?!1:!t||!e?!0:t.alt===e.alt&&t.control===e.control&&t.shift===e.shift&&t.meta===e.meta}var RE=new Set(["Backquote","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Minus","Equal","IntlYen","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","IntlRo","Space","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadAdd","NumpadComma","NumpadDecimal","NumpadDivide","NumpadEqual","NumpadHash","NumpadMultiply","NumpadParenLeft","NumpadParenRight","NumpadStar","NumpadSubstract"]);function xl(t){return t.ctrlKey||t.metaKey||["Dead","Process"].includes(t.key)?!1:t.code===""?!0:RE.has(t.code)}function wd(){var t;let e=document.activeElement;for(;(t=e?.shadowRoot)!=null&&t.activeElement;)e=e.shadowRoot.activeElement;return e}var sr=class zr{static get scrim(){return zr._scrim||(zr._scrim=new zr),zr._scrim}static open(e){zr.scrim.open(e)}static close(){zr.scrim.close()}static get state(){return zr.scrim.state}static get element(){return zr.scrim.element}constructor(e){var n,r;this.lightDismiss=(n=e?.lightDismiss)!=null?n:!0,this.translucent=(r=e?.translucent)!=null?r:!1,this.state="closed"}get element(){if(this._element)return this._element;let e=document.createElement("div");return e.setAttribute("role","presentation"),e.style.position="fixed",e.style.contain="content",e.style.top="0",e.style.left="0",e.style.right="0",e.style.bottom="0",e.style.zIndex="var(--scrim-zindex, 10099)",e.style.outline="none",this.translucent?(e.style.background="rgba(255, 255, 255, .2)",e.style.backdropFilter="contrast(40%)"):e.style.background="transparent",this._element=e,e}open(e){var n;if(this.state!=="closed")return;this.state="opening",this.onDismiss=e?.onDismiss,this.savedActiveElement=wd();let{element:r}=this;((n=e?.root)!=null?n:document.body).appendChild(r),r.addEventListener("click",this),document.addEventListener("touchmove",this,!1),document.addEventListener("scroll",this,!1);let i=window.innerWidth-document.documentElement.clientWidth;this.savedMarginRight=document.body.style.marginRight,this.savedOverflow=document.body.style.overflow,document.body.style.overflow="hidden";let o=Number.parseFloat(getComputedStyle(document.body).marginRight);document.body.style.marginRight=`${o+i}px`;let s=document.querySelector(".MLK__plate");if(s instanceof HTMLElement){this.savedMlkPaddingRight=s.style.paddingRight;let a=Number.parseFloat(getComputedStyle(s).paddingRight);s.style.paddingRight=`${a+i}px`}e!=null&&e.child&&r.append(e.child),this.state="open"}close(){var e,n,r,i,o;if(this.state!=="open"){this.element.parentElement;return}this.state="closing",typeof this.onDismiss=="function"&&this.onDismiss(),this.onDismiss=void 0;let{element:s}=this;s.removeEventListener("click",this),document.removeEventListener("touchmove",this,!1),document.removeEventListener("scroll",this,!1),s.remove(),document.body.style.overflow=(e=this.savedOverflow)!=null?e:"",document.body.style.marginRight=(n=this.savedMarginRight)!=null?n:"";let a=document.querySelector(".MLK__plate");a instanceof HTMLElement&&(a.style.paddingRight=(r=this.savedMlkPaddingRight)!=null?r:""),wd()!==this.savedActiveElement&&((o=(i=this.savedActiveElement)==null?void 0:i.focus)==null||o.call(i)),s.innerHTML="",this.state="closed"}handleEvent(e){this.lightDismiss&&(e.target===this._element&&e.type==="click"?(this.close(),e.preventDefault(),e.stopPropagation()):e.target===document&&(e.type==="touchmove"||e.type==="scroll")&&(this.close(),e.preventDefault(),e.stopPropagation()))}};function zE(t,e,n){let r=null,i=null,o=!1,s=!1,a=!1,l=new AbortController,u=l.signal;return t.addEventListener("keydown",c=>{if(o||c.key==="Process"||c.code==="CapsLock"||/(Control|Meta|Alt|Shift)(Left|Right)/.test(c.code)){r=null;return}r=c,i=null,n.onKeystroke(c)?t.textContent="":r=null},{capture:!0,signal:u}),t.addEventListener("keypress",c=>{o||(r&&i&&n.onKeystroke(r),i=c)},{capture:!0,signal:u}),t.addEventListener("compositionstart",c=>{t.textContent="",o=!0,n.onCompositionStart(c.data)},{capture:!0,signal:u}),t.addEventListener("compositionupdate",c=>{o&&n.onCompositionUpdate(c.data)},{capture:!0,signal:u}),t.addEventListener("compositionend",c=>{t.textContent="",o&&(o=!1,n.onCompositionEnd(c.data))},{capture:!0,signal:u}),t.addEventListener("beforeinput",c=>c.stopImmediatePropagation(),{signal:u}),t.addEventListener("input",c=>{var d;if(!o&&(t.textContent="",c.inputType!=="insertCompositionText")){if(c.inputType==="insertFromPaste"){c.preventDefault(),c.stopPropagation();return}n.onInput((d=c.data)!=null?d:""),c.preventDefault(),c.stopPropagation()}},{signal:u}),t.addEventListener("paste",c=>{t.focus({preventScroll:!0}),t.textContent="",n.onPaste(c)||c.preventDefault(),c.stopImmediatePropagation()},{signal:u}),t.addEventListener("cut",c=>n.onCut(c),{capture:!0,signal:u}),t.addEventListener("copy",c=>n.onCopy(c),{capture:!0,signal:u}),t.addEventListener("blur",c=>{var d,p;if(((p=(d=c.relatedTarget)==null?void 0:d._mathfield)==null?void 0:p.element)===e){t.focus({preventScroll:!0}),c.preventDefault(),c.stopPropagation();return}let f=!1,g=c.relatedTarget;for(;g;){if(g.classList.contains("ML__keyboard")){f=!0;break}g=g.parentElement}if(f){t.focus({preventScroll:!0}),c.preventDefault(),c.stopPropagation();return}let x=sr.state;if(x==="open"||x==="opening"){c.preventDefault(),c.stopPropagation();return}if(c.relatedTarget===c.target.getRootNode().host){c.preventDefault(),c.stopPropagation();return}a||s||(a=!0,r=null,i=null,n.onBlur(),a=!1)},{capture:!0,signal:u}),t.addEventListener("focus",c=>{a||s||(s=!0,n.onFocus(),s=!1)},{capture:!0,signal:u}),{dispose:()=>l.abort(),cancelComposition:()=>{o&&(typeof t.blur=="function"&&t.blur(),requestAnimationFrame(()=>t.focus({preventScroll:!0})))},blur:()=>{typeof t.blur=="function"&&(a=!0,t.blur(),a=!1)},focus:()=>{!s&&typeof t.focus=="function"&&(s=!0,t.focus({preventScroll:!0}),s=!1)},hasFocus:()=>wd()===t,setAriaLabel:c=>t.setAttribute("aria-label",c),setValue:c=>{var d;t.textContent!==c&&(t.textContent=c,t.style.left="-1000px",(d=window.getSelection())==null||d.selectAllChildren(t))},moveTo:(c,d)=>{t.style.top=`${d}px`,t.style.left=`${c}px`}}}function Es(t){var e;if(!t||!xl(t))return"";let n;return t.key==="Unidentified"&&t.target&&(n=t.target.value),n=(e=n??t.key)!=null?e:t.code,/^(Dead|Return|Enter|Tab|Escape|Delete|PageUp|PageDown|Home|End|Help|ArrowLeft|ArrowRight|ArrowUp|ArrowDown)$/.test(n)&&(n=""),n}function p5(t){t=RM(t);let e=[];return t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),t.altKey&&e.push("alt"),t.shiftKey&&e.push("shift"),e.length===0?`[${t.code}]`:(e.push(`[${t.code}]`),e.join("+"))}function FE(t){if(Xn()){let e=ta(),n=t.startsWith("!"),r=t.endsWith(e);if(n&&!r||!n&&r)return!0}return t==="!other"?!1:t==="other"}function $E(t,e,n){if(t.length===0)return"";let r=Ds(Z3(p5(n))),i=Ds({key:n.key,shift:n.shiftKey,alt:n.altKey,ctrl:n.ctrlKey,meta:n.metaKey||n.ctrlKey&&/macos|ios/.test(ta()),cmd:!1,win:!1});for(let o=t.length-1;o>=0;o--)if((t[o].key===r||t[o].key===i)&&(!t[o].ifMode||t[o].ifMode===e))return t[o].command;return""}function ov(t){let e=t;return Ht(e)&&(e=e.length>0?e[0]+"("+e.slice(1).join("")+")":""),e}function KE(t,e){let n=[];if(typeof e=="string"){let o=NC[e];Ht(o)?n=o.slice():o&&n.push(o)}let r=ov(e),i=new RegExp("^"+r.replace("\\","\\\\").replace("|","\\|").replace("*","\\*").replace("$","\\$").replace("^","\\^")+"([^*a-zA-Z]|$)");for(let o of t)i.test(ov(o.command))&&n.push(o.key);return n.map(s0)}function jE(t,e){if(t.ifPlatform&&!/^!?(macos|windows|android|ios|chromeos|other)$/.test(t.ifPlatform))throw new Error(`Unexpected platform "${t.ifPlatform}" for keybinding ${t.key}`);if(t.ifLayout!==void 0&&(e.score===0||!t.ifLayout.includes(e.id)))return;let n=Z3(t.key),r=t.ifPlatform;if(n.cmd){if(r&&r!=="macos"&&r!=="ios")throw new Error('Unexpected "cmd" modifier with platform "'+r+`"
"cmd" modifier can only be used with macOS or iOS platform.`);r||(r=ta()==="ios"?"ios":"macos"),n.win=!1,n.cmd=!1,n.meta=!0}if(n.win){if(r&&r!=="windows")throw new Error('Unexpected "win" modifier with platform "'+r+`"
"win" modifier can only be used with Windows platform.`);r="windows",n.win=!1,n.cmd=!1,n.meta=!0}if(r&&!FE(r))return;if(/^\[.+\]$/.test(n.key))return V(O({},t),{key:Ds(n)});let i=IM(n.key,e);if(!i)return V(O({},t),{key:Ds(n)});if(i.shift&&n.shift||i.alt&&n.alt)throw new Error(`The keybinding ${t.key} (${zf(t.command)}) is conflicting with the key combination ${Ds(i)} using the ${e.displayName} keyboard layout`);return i.shift=i.shift||n.shift,i.alt=i.alt||n.alt,i.meta=n.meta,i.ctrl=n.ctrl,V(O({},t),{key:Ds(i)})}function zf(t){if(Array.isArray(t)){let e=[...t];return e.shift()+"("+e.map(n=>typeof n=="string"?`"${n}"`:n.toString()).join(", ")+")"}return t}function qE(t,e){let n=[],r=[];for(let i of t)try{let o=jE(i,e);if(!o)continue;let s=r.find(a=>a.key===o.key&&a.ifMode===o.ifMode);if(s)throw new Error(`Ambiguous key binding ${i.key} (${zf(i.command)}) matches ${s.key} (${zf(s.command)}) with the ${e.displayName} keyboard layout`);r.push(o)}catch(o){o instanceof Error&&n.push(o.message)}return[r,n]}var VE=class extends lt{constructor(){super("latex")}createAtom(t){return new qt(t)}onPaste(t,e){if(!e)return!1;let n=typeof e=="string"?e:e.getData("application/x-latex")||e.getData("text/plain");return n&&t.model.contentWillChange({inputType:"insertFromPaste",data:n})?(t.stopCoalescingUndo(),t.stopRecording(),this.insert(t.model,n)&&(t.startRecording(),t.snapshot("paste"),t.model.contentDidChange({inputType:"insertFromPaste"}),vt(t)),t.startRecording(),!0):!1}insert(t,e,n){if(!t.contentWillChange({data:e,inputType:"insertText"}))return!1;n||(n={}),n.insertionMode||(n.insertionMode="replaceSelection"),n.selectionMode||(n.selectionMode="placeholder");let{silenceNotifications:r}=t;n.silenceNotifications&&(t.silenceNotifications=!0);let i=t.silenceNotifications;t.silenceNotifications=!0,n.insertionMode==="replaceSelection"&&!t.selectionIsCollapsed?t.deleteAtoms(en(t.selection)):n.insertionMode==="replaceAll"?(t.root.setChildren([],"body"),t.position=0):n.insertionMode==="insertBefore"?t.collapseSelection("backward"):n.insertionMode==="insertAfter"&&t.collapseSelection("forward");let o=[];for(let l of e)tC.test(l)&&o.push(new qt(l));let s=t.at(t.position);if(s instanceof Ya&&(s=s.lastChild),!(s.parent instanceof Ya)){let l=new Ya;s.parent.addChildAfter(l,s),s=l.firstChild}let a=s.parent.addChildrenAfter(o,s);return t.silenceNotifications=i,n.selectionMode==="before"||(n.selectionMode==="item"?t.setSelection(t.anchor,t.offsetOf(a)):a&&(t.position=t.offsetOf(a))),t.contentDidChange({data:e,inputType:"insertText"}),t.silenceNotifications=r,!0}};function a0(t){return t.atoms.find(e=>e.type==="latexgroup")}function wl(t){var e,n;let r=a0(t);return(n=(e=r?.body)==null?void 0:e.filter(i=>i.type==="latex"))!=null?n:[]}function f5(t,e){var n;let r=0,i=!1,o=Number.isFinite(e?.before)?(n=e?.before)!=null?n:0:t.lastOffset;for(;r<=o&&!i;){let l=t.at(r);i=l instanceof qt&&l.isSuggestion,i||r++}if(!i)return[void 0,void 0];let s=r,a=!1;for(;s<=o&&!a;){let l=t.at(s);a=!(l instanceof qt&&l.isSuggestion),a||s++}return[r-1,s-1]}new VE;function HE(t,e){t.flushInlineShortcutBuffer(),t.stopCoalescingUndo();let n=Ff(t,e),{model:r}=t;return r.selectionIsCollapsed?(t.defaultStyle.fontSeries&&n.fontSeries===t.defaultStyle.fontSeries&&(n.fontSeries="auto"),n.fontShape&&n.fontShape===t.defaultStyle.fontShape&&(n.fontShape="auto"),n.color&&n.color===t.defaultStyle.color&&(n.color="none"),n.backgroundColor&&n.backgroundColor===t.defaultStyle.backgroundColor&&(n.backgroundColor="none"),n.fontSize&&n.fontSize===t.defaultStyle.fontSize&&(n.fontSize="auto"),t.defaultStyle=O(O({},t.defaultStyle),n)):t.model.deferNotifications({content:!0,type:"insertText"},()=>{r.selection.ranges.forEach(i=>If(r,i,n,{operation:"toggle"})),t.snapshot("style-change")}),!0}ln({applyStyle:HE},{target:"mathfield",canUndo:!0,changeContent:!0});function Ff(t,e){var n,r,i,o,s,a,l,u,c,d;let p={};if(typeof e.color=="string"){let g=(r=t.colorMap((n=e.color)!=null?n:e.verbatimColor))!=null?r:"none";g!==e.color&&(p.verbatimColor=(i=e.verbatimColor)!=null?i:e.color),p.color=g}if(typeof e.backgroundColor=="string"){let g=(s=t.backgroundColorMap((o=e.backgroundColor)!=null?o:e.verbatimBackgroundColor))!=null?s:"none";g!==e.backgroundColor&&(p.verbatimBackgroundColor=(a=e.verbatimBackgroundColor)!=null?a:e.backgroundColor),p.backgroundColor=g}typeof e.fontFamily=="string"&&(p.fontFamily=e.fontFamily),typeof e.series=="string"&&(p.fontSeries=e.series),typeof e.fontSeries=="string"&&(p.fontSeries=e.fontSeries.toLowerCase()),p.fontSeries&&(p.fontSeries=(l={bold:"b",medium:"m",normal:"m"}[p.fontSeries])!=null?l:p.fontSeries),typeof e.shape=="string"&&(p.fontShape=e.shape),typeof e.fontShape=="string"&&(p.fontShape=e.fontShape.toLowerCase()),p.fontShape&&(p.fontShape=(u={italic:"it",up:"n",upright:"n",normal:"n"}[p.fontShape])!=null?u:p.fontShape),e.variant&&(p.variant=e.variant.toLowerCase()),e.variantStyle!==void 0&&(p.variantStyle=typeof e.variantStyle=="string"&&e.variantStyle!==""?e.variantStyle.toLowerCase():e.variantStyle);let f=(c=e.size)!=null?c:e.fontSize;return typeof f=="number"?p.fontSize=Math.max(1,Math.min(10,f)):typeof f=="string"&&(p.fontSize=(d={size1:1,size2:2,size3:3,size4:4,size5:5,size6:6,size7:7,size8:8,size9:9,size10:10}[f.toLowerCase()])!=null?d:{tiny:1,scriptsize:2,footnotesize:3,small:4,normal:5,normalsize:5,large:6,Large:7,LARGE:8,huge:9,Huge:10}[f]),p}function l0(t,e,n){var r,i;let o=t.model;if(o.mode==="latex")return{};let s=t.styleBias;if(s==="none")return t.defaultStyle;if(o.mode==="text")return(i=(r=o.at(s==="right"?n.after:n.before))==null?void 0:r.style)!=null?i:t.defaultStyle;if(o.mode==="math"){let a=o.at(s==="right"?n.after:n.before);return a?O(V(O({},a.style),{variant:"normal"}),t.defaultStyle):t.defaultStyle}return{}}function zo(t){let e=t.options.onInsertStyle;if(e===null)return{};e===void 0&&(e=l0);let n=t.model,r=t.styleBias,i=n.at(n.position),o=sv(n,i,r),s=sv(n,i.rightSibling,r);return e(t,n.position,{before:o,after:s})}function sv(t,e,n){var r;return!e||e.type==="first"&&n!=="right"?-1:e.type!=="group"?t.offsetOf(e):!e.body||e.body.length<2?-1:((r=e.body)==null?void 0:r.length)===1||n!=="right"?t.offsetOf(e.body[0]):t.offsetOf(e.body[e.body.length-1])}function nh(t){let e=wl(t.model).filter(n=>n.isSuggestion);if(e.length!==0){t.model.position=t.model.offsetOf(e[0].leftSibling);for(let n of e)n.parent.removeChild(n)}}function Ol(t,e){var n;let{model:r}=t;nh(t);for(let c of wl(r))c.isError=!1;if(!r.selectionIsCollapsed||t.options.popoverPolicy==="off"){Qs(t);return}let i=[],o=r.at(r.position);for(;o&&o instanceof qt&&/^[a-zA-Z\*]$/.test(o.value);)o=o.leftSibling;if(o&&o instanceof qt&&o.value==="\\")for(i.push(o),o=o.rightSibling;o&&o instanceof qt&&/^[a-zA-Z\*]$/.test(o.value);)i.push(o),o=o.rightSibling;let s=i.map(c=>c.value).join(""),a=rC(t,s);if(a.length===0){if(/^\\[a-zA-Z\*]+$/.test(s))for(let c of i)c.isError=!0;Qs(t);return}let l=(n=e?.atIndex)!=null?n:0;t.suggestionIndex=l<0?a.length-1:l%a.length;let u=a[t.suggestionIndex];if(u!==s){let c=i[i.length-1];c.parent.addChildrenAfter([...u.slice(s.length-u.length)].map(d=>new qt(d,{isSuggestion:!0})),c),Fo(t,{interactive:!0})}UE(t,a)}function _p(t){let[e,n]=f5(t,{before:t.position});if(e===void 0||n===void 0)return!1;let r=!1;return t.getAtoms([e,n]).forEach(i=>{i.isSuggestion&&(i.isSuggestion=!1,r=!0)}),r}function Yi(t,e="accept",n){var r,i;Qs(t);let o=a0(t.model);if(!o)return!1;if(e==="accept-suggestion"||e==="accept-all"){let u=wl(t.model).filter(c=>c.isSuggestion);if(u.length!==0){for(let c of u)c.isSuggestion=!1;t.model.position=t.model.offsetOf(u[u.length-1])}if(e==="accept-suggestion")return u.length!==0}let s=wl(t.model).filter(u=>!u.isSuggestion).map(u=>u.value).join(""),a=o.leftSibling;if(o.parent.removeChild(o),t.model.position=t.model.offsetOf(a),t.switchMode((r=n?.mode)!=null?r:"math"),e==="reject")return!0;let l=O({},zo(t));return!/^[a-zA-Z0-9]$/.test(s)&&t.styleBias!=="none"&&(l.variant="normal",l.variantStyle=void 0),lt.insert(t.model,s,{selectionMode:(i=n?.selectItem)!=null&&i?"item":"placeholder",format:"latex",mode:"math",style:l}),t.snapshot(),t.model.announce("replacement"),t.switchMode("math"),!0}function rh(t){var e;let n=document.getElementById(t);return n?n.dataset.refcount=Number(Number.parseInt((e=n.dataset.refcount)!=null?e:"0")+1).toString():(n=document.createElement("div"),n.setAttribute("aria-hidden","true"),n.dataset.refcount="1",n.id=t,document.body.append(n)),n}function Nl(t){var e;let n=document.getElementById(t);if(!n)return;let r=Number.parseInt((e=n.getAttribute("data-refcount"))!=null?e:"0");r<=1?n.remove():n.dataset.refcount=Number(r-1).toString()}function WE(t,e){let n=new Ye({from:t.context}),r=new G({mode:"math",type:"root",body:wn(e,{context:n})}),i=Jd(Bl(new oe(r.render(n),{classes:"ML__base"}),n));return Gd(i,{classes:"ML__latex"}).toMarkup()}function UE(t,e){var n;if(e.length===0){Qs(t);return}let r="";for(let[o,s]of e.entries()){let a=s,l=WE(t,s),u=KE(t.keybindings,a).join("<br>");r+=`<li role="button" data-command="${a}" ${o===t.suggestionIndex?"class=ML__popover__current":""}><span class="ML__popover__latex">${a}</span><span class="ML__popover__command">${l}</span>`,u&&(r+=`<span class="ML__popover__keybinding">${u}</span>`),r+="</li>"}let i=JE(t,`<ul>${r}</ul>`);$f()&&((n=i.querySelector(".ML__popover__current"))==null||n.scrollIntoView({block:"nearest",inline:"nearest"})),setTimeout(()=>{var o;i&&!$f()&&(i.classList.add("is-visible"),ih(t),(o=i.querySelector(".ML__popover__current"))==null||o.scrollIntoView({block:"nearest",inline:"nearest"}))},32)}function $f(){let t=document.getElementById("mathlive-suggestion-popover");return t?t.classList.contains("is-visible"):!1}function ih(t,e){var n,r,i;if(!t.element||t.element.mathfield!==t||!$f())return;if(((n=t.model.at(t.model.position))==null?void 0:n.type)!=="latex"){Qs(t);return}if(e!=null&&e.deferred){setTimeout(()=>ih(t),32);return}let o=dc(t.field);if(!o)return;let s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerWidth-document.documentElement.clientWidth,u=window.innerHeight-document.documentElement.clientHeight,c=(i=(r=window.mathVirtualKeyboard)==null?void 0:r.boundingRect.height)!=null?i:0,d=document.getElementById("mathlive-suggestion-popover");o.x+d.offsetWidth/2>a-l?d.style.left=`${a-d.offsetWidth-l}px`:o.x-d.offsetWidth/2<0?d.style.left="0":d.style.left=`${o.x-d.offsetWidth/2}px`;let p=o.y-o.height;s-u-c-o.y<p?(d.classList.add("ML__popover--reverse-direction"),d.classList.remove("top-tip"),d.classList.add("bottom-tip"),d.style.top=`${o.y-o.height-d.offsetHeight-15}px`):(d.classList.remove("ML__popover--reverse-direction"),d.classList.add("top-tip"),d.classList.remove("bottom-tip"),d.style.top=`${o.y+15}px`)}function Qs(t){t.suggestionIndex=0,document.getElementById("mathlive-suggestion-popover")&&Nl("mathlive-suggestion-popover")}function JE(t,e){let n=document.getElementById("mathlive-suggestion-popover");return n?Nl("mathlive-suggestion-popover"):(Ji("suggestion-popover"),Ji("core")),n=rh("mathlive-suggestion-popover"),n.addEventListener("pointerdown",r=>r.preventDefault()),n.addEventListener("click",r=>{let i=r.target;for(;i&&!i.dataset.command;)i=i.parentElement;i&&(Yi(t,"reject"),lt.insert(t.model,i.dataset.command,{selectionMode:"placeholder",format:"latex",mode:"math"}),t.dirty=!0,t.focus())}),n.innerHTML=globalThis.MathfieldElement.createHTML(e),n}function GE(){document.getElementById("mathlive-suggestion-popover")&&(Nl("mathlive-suggestion-popover"),Gi("suggestion-popover"),Gi("core"))}function XE(){let t=String(new Error().stack).replace(/^Error.*\n/,"").split(`
`);if(t.length===0)return console.error(`Can't use relative paths to specify assets location because the sourcefile location could not be determined (unexpected stack trace format "${new Error().stack}").`),"";let e=t[1],n=e.match(/http.*\.ts[\?:]/);return n&&(e=t[2]),n=e.match(/(https?:.*):[0-9]+:[0-9]+/),n||(n=e.match(/at (.*(\.ts))[\?:]/),n||(n=e.match(/at (.*(\.mjs|\.js))[\?:]/))),n?n[1]:(console.error(t),console.error(`Can't use relative paths to specify assets location because the source file location could not be determined (unexpected location "${e}").`),"")}var bi=null,av,lv,Mp=((lv=(av=globalThis?.document)==null?void 0:av.currentScript)==null?void 0:lv.src)||XE();async function m5(t){if(/^(?:[a-z+]+:)?\/\//i.test(t)){try{return new URL(t).href}catch{}if(t.startsWith("//"))try{return new URL(`${window.location.protocol}${t}`).href}catch{}return t}if(bi===null)try{let e=await fetch(Mp,{method:"HEAD"});e.status===200&&(bi=e.url,bi=bi.replace(/\/\+esm$/,"/"),bi.includes("jsdelivr.net/")&&(bi+="/"))}catch{console.error(`Invalid URL "${t}" (relative to "${Mp}")`)}return new URL(t,bi??Mp).href}function YE(t,e,n={}){return new FontFace(t,`url(${e}.woff2) format('woff2')`,n)}var Pn="not-loaded";async function ZE(){return Pn="not-loaded",oh()}async function oh(){var t;if(Pn==="not-loaded"){if(Pn="loading",(t=getComputedStyle(document.documentElement).getPropertyValue("--ML__static-fonts"))!=null?t:!1){Pn="ready";return}if(document.body.classList.remove("ML__fonts-did-not-load"),"fonts"in document){let e=["KaTeX_Main","KaTeX_Math","KaTeX_AMS","KaTeX_Caligraphic","KaTeX_Fraktur","KaTeX_SansSerif","KaTeX_Script","KaTeX_Typewriter","KaTeX_Size1","KaTeX_Size2","KaTeX_Size3","KaTeX_Size4"],n=Array.from(document.fonts).map(o=>o.family);if(e.every(o=>n.includes(o))){Pn="ready";return}if(!globalThis.MathfieldElement.fontsDirectory){Pn="not-loaded";return}let r=await m5(globalThis.MathfieldElement.fontsDirectory);if(!r){document.body.classList.add("ML__fonts-did-not-load"),Pn="error";return}r.endsWith("/")&&(r=r.slice(0,-1));let i=[["KaTeX_Main-Regular"],["KaTeX_Main-BoldItalic",{style:"italic",weight:"bold"}],["KaTeX_Main-Bold",{weight:"bold"}],["KaTeX_Main-Italic",{style:"italic"}],["KaTeX_Math-Italic",{style:"italic"}],["KaTeX_Math-BoldItalic",{style:"italic",weight:"bold"}],["KaTeX_AMS-Regular"],["KaTeX_Caligraphic-Regular"],["KaTeX_Caligraphic-Bold",{weight:"bold"}],["KaTeX_Fraktur-Regular"],["KaTeX_Fraktur-Bold",{weight:"bold"}],["KaTeX_SansSerif-Regular"],["KaTeX_SansSerif-Bold",{weight:"bold"}],["KaTeX_SansSerif-Italic",{style:"italic"}],["KaTeX_Script-Regular"],["KaTeX_Typewriter-Regular"],["KaTeX_Size1-Regular"],["KaTeX_Size2-Regular"],["KaTeX_Size3-Regular"],["KaTeX_Size4-Regular"]].map(o=>YE(o[0].replace(/-[a-zA-Z]+$/,""),`${r}/${o[0]}`,o[1]));try{(await Promise.all(i.map(o=>{try{return o.load()}catch{}}))).forEach(o=>document.fonts.add(o)),Pn="ready";return}catch(o){console.error(`MathLive 0.108.2: The math fonts could not be loaded from "${r}"`,{cause:o}),document.body.classList.add("ML__fonts-did-not-load")}Pn="error"}}}function QE(t,e=0){let n=3735928559^e,r=1103547991^e;for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);n=Math.imul(n^o,2654435761),r=Math.imul(r^o,1597334677)}return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}function vt(t,e){!t||t.dirty||!t.field||(t.resizeObserver.unobserve(t.field),t.dirty=!0,requestAnimationFrame(()=>{jr(t)&&t.dirty&&(t.atomBoundsCache=new Map,Fo(t,e),t.resizeObserver.observe(t.field),t.resizeObserverStarted=!0)}))}function eA(t,e){var n;e=e??{};let r=new Ye({from:V(O({},t.context),{atomIdsSettings:{seed:e.forHighlighting?QE(G.serialize([t.model.root],{expandMacro:!1,defaultMode:t.options.defaultMode})):"random",groupNumbers:(n=e.forHighlighting)!=null?n:!1},letterShapeStyle:t.options.letterShapeStyle}),mathstyle:t.options.defaultMode==="inline-math"?"textstyle":"displaystyle"}),i=t.model.root.render(r);return Gd(Bl(i,r),{classes:t.hasEditablePrompts?"ML__latex ML__prompting":"ML__latex",attributes:{translate:"no","aria-hidden":"true"}})}function g5(t,e){try{let{model:n}=t;n.root.caret=void 0,n.root.isSelected=!1,n.root.containsCaret=!0;for(let r of n.atoms)r.caret=void 0,r.isSelected=!1,r.containsCaret=!1;if(n.selectionIsCollapsed){let r=n.at(n.position);r.caret=t.model.mode;let i=r.parent;for(;i;)i.containsCaret=!0,i=i.parent}else{let r=n.getAtoms(n.selection,{includeChildren:!0,includeFirstAtoms:!0});for(let i of r)i.isSelected=!0}return eA(t,e).toMarkup()}catch(n){return console.error(n),'<span class="ML__latex" translate="no" aria-hidden="true"></span>'}}function Fo(t,e){if(!jr(t))return;e!=null||(e={});let n=t.element.querySelector("[part=virtual-keyboard-toggle]");n&&(n.style.display=t.hasEditableContent?"":"none");let r=t.field;if(!r)return;let i=t.isSelectionEditable&&t.hasFocus(),o=r.classList.contains("ML__focused");o&&!i?r.classList.remove("ML__focused"):!o&&i&&r.classList.add("ML__focused");let s=g5(t,e),a=t.element.querySelector("[part=menu-toggle]");if(a){let l=!1;(t.disabled||t.readOnly&&!t.hasEditableContent||t.userSelect==="none")&&(l=!0),!l&&t.element.offsetWidth<50&&(l=!0),a.style.display=l?"none":""}if(t.model.atoms.length<=1){let l=t.options.contentPlaceholder;l&&(s+=`<span part=placeholder class="ML__content-placeholder">${Pt(l)}</span>`)}r.innerHTML=globalThis.MathfieldElement.createHTML(s),kd(t,e.interactive),t.updateToggleLayout(),t.dirty=!1}function kd(t,e){var n;let r=t.field;if(!r)return;for(let u of r.querySelectorAll(".ML__selection, .ML__contains-highlight"))u.remove();if(!(e!=null&&e)&&Pn!=="error"&&Pn!=="ready"){setTimeout(()=>{Pn==="ready"?kd(t):setTimeout(()=>kd(t),128)},32);return}let i=t.model;(n=t.atomBoundsCache)==null||n.clear();let o,s=()=>{if(o!==void 0)return o;let u=r.offsetWidth,c=r.getBoundingClientRect().width;return o=Math.floor(c)/u,isNaN(o)&&(o=1),o};if(i.selectionIsCollapsed){ih(t,{deferred:!0});let u=i.at(i.position);for(;u&&u.type!=="prompt"&&!(u.containsCaret&&u.displayContainsHighlight);)u=u.parent;if(u!=null&&u.containsCaret&&u.displayContainsHighlight){let c=s(),d=bx(t,Uo(t,u),c);if(d){d.left/=c,d.right/=c,d.top/=c,d.bottom/=c;let p=document.createElement("div");p.classList.add("ML__contains-highlight"),p.style.position="absolute",p.style.left=`${d.left+1}px`,p.style.top=`${Math.ceil(d.top)}px`,p.style.width=`${Math.ceil(d.right-d.left)}px`,p.style.height=`${Math.ceil(d.bottom-d.top)}px`,r.insertBefore(p,r.childNodes[0])}}return}let a=s(),l=tA(vx(t,{excludeAtomsWithBackground:!0}));for(let u of l){u.left/=a,u.right/=a,u.top/=a,u.bottom/=a;let c=document.createElement("div");c.classList.add("ML__selection"),c.style.position="absolute",c.style.left=`${u.left}px`,c.style.top=`${u.top}px`,c.style.width=`${Math.ceil(u.right-u.left)}px`,c.style.height=`${Math.max(1,Math.ceil(u.bottom-u.top-1))}px`,r.insertBefore(c,r.childNodes[0])}}function tA(t){let e=[];for(let n of t){let r=!1;for(let i of e)if(n.left===i.left&&n.right===i.right&&n.top===i.top&&n.bottom===i.bottom){r=!0;break}r||e.push(n)}t=e,e=[];for(let n of t){let r=0;for(let i of t)if(n.left>=i.left&&n.right<=i.right&&n.top>=i.top&&n.bottom<=i.bottom&&(r+=1,r>1))break;r===1&&e.push(n)}return e}function y5(t){if(!t)return;let e=t.model,n=e.selection,r=G.serialize([e.root],{expandMacro:!1,defaultMode:t.options.defaultMode});lt.insert(e,r,{insertionMode:"replaceAll",selectionMode:"after",format:"latex",silenceNotifications:!0,mode:"math"});let i=e.silenceNotifications;e.silenceNotifications=!0,e.selection=n,e.silenceNotifications=i,vt(t)}function uv(){for(let t of document.querySelectorAll(".ML__mathfield"))"_mathfield"in t&&y5(t._mathfield)}var b5=3,kr;function ln(t,e){e=O({target:"mathfield",canUndo:!1,audioFeedback:void 0,changeContent:!1,changeSelection:!1},e??{}),kr||(kr={});for(let n of Object.keys(t))kr[n],kr[n]=V(O({},e),{fn:t[n]})}function u0(t){let e;if(Array.isArray(t)){if(t[0]==="performWithFeedback")return u0(t[1]);e=t[0]}else e=t;return kr[e]}function $s(t){var e;return(e=u0(t))==null?void 0:e.target}function nA(t,e){var n,r;if(e=kl(e),!e)return!1;let i,o=[],s=!1,a=!1;Ht(e)?(i=e[0],o=e.slice(1)):i=e;let l=kr[i],u=l?.target;if(u==="model"){if(!t.isSelectionEditable&&l!=null&&l.changeContent)return t.model.announce("plonk"),!1;/^(delete|add)/.test(i)&&(i!=="deleteBackward"&&t.flushInlineShortcutBuffer(),t.snapshot(i)),/^complete/.test(i)||nh(t),kr[i].fn(t.model,...o),Ol(t),a=!0,s=!0}else if(u==="virtual-keyboard")a=(r=(n=window.mathVirtualKeyboard)==null?void 0:n.executeCommand(e))!=null?r:!1,s=!0;else if(kr[i]){if(!t.isSelectionEditable&&l!=null&&l.changeContent)return t.model.announce("plonk"),!1;/^(undo|redo)/.test(i)&&t.flushInlineShortcutBuffer(),a=kr[i].fn(t,...o),s=!0}else throw new Error(`Unknown command "${i}"`);return u!=="virtual-keyboard"&&(!t.model.selectionIsCollapsed||l!=null&&l.changeSelection&&i!=="deleteBackward")&&(t.flushInlineShortcutBuffer(),l!=null&&l.changeContent||t.stopCoalescingUndo(),t.defaultStyle={}),a&&(l!=null&&l.changeSelection&&s?(t.dirty=!0,t.scrollIntoView()):vt(t)),s}function rA(t,e){var n;if(!t)return!1;t.focus(),p0.keypressVibration&&G3()&&navigator.vibrate(b5);let r=u0(e);globalThis.MathfieldElement.playSound((n=r?.audioFeedback)!=null?n:"keypress");let i=t.executeCommand(e);return t.scrollIntoView(),i}ln({performWithFeedback:(t,e)=>rA(t,e)});function iA(t){return Ol(t,{atIndex:t.suggestionIndex+1}),!1}function oA(t){return Ol(t,{atIndex:t.suggestionIndex-1}),!1}ln({complete:Yi},{target:"mathfield",audioFeedback:"return",canUndo:!0,changeContent:!0,changeSelection:!0});ln({dispatchEvent:(t,e,n)=>{var r,i;return(i=(r=t.host)==null?void 0:r.dispatchEvent(new CustomEvent(e,{detail:n})))!=null?i:!1}},{target:"mathfield"});ln({nextSuggestion:iA,previousSuggestion:oA},{target:"mathfield",audioFeedback:"keypress",changeSelection:!0});function kl(t){if(!t)return;if(Ht(t)&&t.length>0){let n=t[0];return n=n.replace(/-\w/g,r=>r[1].toUpperCase()),n==="performWithFeedback"&&t.length===2?[n,kl(t[1])]:[n,...t.slice(1)]}if(typeof t!="string")return;let e=t.trim().match(/^([a-zA-Z0-9-]+)\((.*)\)$/);if(e){let n=e[1].replace(/-\w/g,i=>i[1].toUpperCase()),r=e[2].split(",").map(i=>i.trim());return[n,...r.map(i=>{if(/"[^"]*"/.test(i)||/'[^']*'/.test(i))return i.slice(1,-1);if(/^true$/.test(i))return!0;if(/^false$/.test(i))return!1;if(/^[-]?\d+$/.test(i))return parseInt(i,10);if(/^\{.*\}$/.test(i))try{return JSON.parse(i)}catch{return console.error("Invalid argument:",i),i}return kl(i)})]}return t.replace(/-\w/g,n=>n[1].toUpperCase())}var Sd="mathlive#virtual-keyboard-message";function c0(t){var e;return t.type!=="message"?!1:((e=t.data)==null?void 0:e.type)===Sd}var sA=class v5{constructor(){this.targetOrigin=window.origin,this.originValidator="none",this.targetWindow=window.top,this._boundingRect=new DOMRect(0,0,0,0),this._isShifted=!1,window.addEventListener("message",this),this.sendMessage("proxy-created"),this.listeners={}}static get singleton(){return this._singleton||(this._singleton=new v5),this._singleton}getKeycap(e){}setKeycap(e,n){this.sendMessage("update-setting",{setKeycap:{keycap:e,value:n}})}set alphabeticLayout(e){this.sendMessage("update-setting",{alphabeticLayout:e})}set layouts(e){this.sendMessage("update-setting",{layouts:e})}get normalizedLayouts(){return[]}set editToolbar(e){this.sendMessage("update-setting",{editToolbar:e})}set container(e){throw new Error("Container inside an iframe cannot be changed")}show(e){this.dispatchEvent(new CustomEvent("before-virtual-keyboard-toggle",{detail:{visible:!0},bubbles:!0,cancelable:!0,composed:!0}))&&(this.sendMessage("show",e),this.dispatchEvent(new Event("virtual-keyboard-toggle")))}hide(e){this.dispatchEvent(new CustomEvent("before-virtual-keyboard-toggle",{detail:{visible:!1},bubbles:!0,cancelable:!0,composed:!0}))&&(this.sendMessage("hide",e),this.dispatchEvent(new Event("virtual-keyboard-toggle")))}get isShifted(){return this._isShifted}get visible(){return this._boundingRect.height>0}set visible(e){e?this.show():this.hide()}get boundingRect(){return this._boundingRect}executeCommand(e){return this.sendMessage("execute-command",{command:e}),!0}updateToolbar(e){this.sendMessage("update-toolbar",e)}update(e){this.sendMessage("update-setting",e)}connect(){this.sendMessage("connect")}disconnect(){this.sendMessage("disconnect")}addEventListener(e,n,r){this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].has(n)||this.listeners[e].add(n)}dispatchEvent(e){return!this.listeners[e.type]||this.listeners[e.type].size===0?!0:(this.listeners[e.type].forEach(n=>{typeof n=="function"?n(e):n?.handleEvent(e)}),!e.defaultPrevented)}removeEventListener(e,n,r){this.listeners[e]&&this.listeners[e].delete(n)}handleEvent(e){if(c0(e)){if(!n0(e.origin,this.originValidator))throw new DOMException(`Message from unknown origin (${e.origin}) cannot be handled`,"SecurityError");this.handleMessage(e.data)}}handleMessage(e){let{action:n}=e;if(n==="execute-command"){let{command:r}=e;$s(r)==="virtual-keyboard"&&this.executeCommand(r);return}if(n==="synchronize-proxy"){this._boundingRect=e.boundingRect,this._isShifted=e.isShifted;return}if(n==="geometry-changed"){this._boundingRect=e.boundingRect,this.dispatchEvent(new Event("geometrychange"));return}}sendMessage(e,n={}){if(!this.targetWindow)throw new DOMException("A frame does not have access to the top window and can't communicate with the keyboard.","SecurityError");this.targetWindow.postMessage(O({type:Sd,action:e},n),this.targetOrigin)}},aA={numeric:{label:"123",labelClass:"MLK__tex-math",tooltip:"keyboard.tooltip.numeric",rows:[[{latex:"x",shift:"y",variants:["y","z","t","r","x^2","x^n","x^{#?}","x_n","x_i","x_{#?}",{latex:"f(#?)",class:"small"},{latex:"g(#?)",class:"small"}]},{latex:"n",shift:"a",variants:["i","j","p","k","a","u"]},"[separator-5]","[7]","[8]","[9]","[/]","[separator-5]",{latex:"\\exponentialE",shift:"\\ln",variants:["\\exp","\\times 10^{#?}","\\ln","\\log_{10}","\\log","\\lg","\\operatorname{lb}"]},{latex:"\\imaginaryI",variants:["\\Re","\\Im","\\imaginaryJ","\\Vert #0 \\Vert"]},{latex:"\\pi",shift:"\\sin",variants:["\\prod",{latex:"\\theta",aside:"theta"},{latex:"\\rho",aside:"rho"},{latex:"\\tau",aside:"tau"},"\\sin","\\cos","\\tan"]}],[{label:"<",latex:"<",class:"hide-shift",shift:{latex:"\\le",label:""}},{label:">",latex:">",class:"hide-shift",shift:{latex:"\\ge",label:""}},"[separator-5]","[4]","[5]","[6]","[*]","[separator-5]",{class:"hide-shift",latex:"#@^2}",shift:"#@^{\\prime}}"},{latex:"#@^{#0}}",class:"hide-shift",shift:"#@_{#?}"},{class:"hide-shift",latex:"\\sqrt{#0}",shift:{latex:"\\sqrt[#0]{#?}}"}}],["[(]","[)]","[separator-5]","[1]","[2]","[3]","[-]","[separator-5]",{latex:"\\int^{\\infty}_{0}\\!#?\\,\\mathrm{d}x",class:"small hide-shift",shift:"\\int",variants:[{latex:"\\int_{#?}^{#?}",class:"small"},{latex:"\\int",class:"small"},{latex:"\\iint",class:"small"},{latex:"\\iiint",class:"small"},{latex:"\\oint",class:"small"},"\\mathrm{d}x",{latex:"\\dfrac{\\mathrm{d}}{\\mathrm{d} x}",class:"small"},{latex:"\\frac{\\partial}{\\partial x}",class:"small"},"\\partial"]},{class:"hide-shift",latex:"\\forall",shift:"\\exists"},{label:"[backspace]",width:1}],[{label:"[shift]",width:2},"[separator-5]","[0]","[.]","[=]","[+]","[separator-5]","[left]","[right]",{label:"[action]",width:1}]]},greek:{label:"&alpha;&beta;&gamma;",labelClass:"MLK__tex-math",tooltip:"keyboard.tooltip.greek",rows:[[{label:"<i>&#x03c6;</i>",class:"MLK__tex hide-shift",insert:"\\varphi",aside:"phi var.",shift:"\\Phi"},{label:"<i>&#x03c2;</i>",class:"MLK__tex hide-shift",insert:"\\varsigma",aside:"sigma var.",shift:"\\Sigma"},{label:"<i>&#x03f5;</i>",class:"MLK__tex hide-shift",insert:"\\epsilon",aside:"epsilon",shift:'\\char"0190'},{label:"<i>&rho;</i>",class:"MLK__tex hide-shift",insert:"\\rho",aside:"rho",shift:'\\char"3A1'},{label:"<i>&tau;</i>",class:"MLK__tex hide-shift",insert:"\\tau",aside:"tau",shift:'\\char"3A4'},{label:"<i>&upsilon;</i>",class:"MLK__tex hide-shift",insert:"\\upsilon",aside:"upsilon",shift:"\\Upsilon"},{label:"<i>&theta;</i>",class:"MLK__tex hide-shift",insert:"\\theta",aside:"theta",shift:"\\Theta"},{label:"<i>&iota;</i>",class:"MLK__tex hide-shift",insert:"\\iota",aside:"iota",shift:'\\char"399'},{label:"<i>&omicron;</i>",class:"MLK__tex hide-shift",insert:"\\omicron",aside:"omicron",shift:'\\char"39F'},{label:"<i>&pi;</i>",class:"MLK__tex hide-shift",insert:"\\pi",aside:"pi",shift:"\\Pi"}],["[separator-5]",{label:"<i>&alpha;</i>",class:"MLK__tex hide-shift",insert:"\\alpha",aside:"alpha",shift:'\\char"391'},{label:"<i>&sigma;</i>",class:"MLK__tex hide-shift",insert:"\\sigma",aside:"sigma",shift:"\\Sigma"},{label:"<i>&delta;</i>",class:"MLK__tex hide-shift",insert:"\\delta",aside:"delta",shift:"\\Delta"},{latex:"\\phi",class:"MLK__tex hide-shift",insert:"\\phi",aside:"phi",shift:"\\Phi"},{label:"<i>&gamma;</i>",class:"MLK__tex hide-shift",insert:"\\gamma",aside:"gamma",shift:"\\Gamma"},{label:"<i>&eta;</i>",class:"MLK__tex hide-shift",insert:"\\eta",aside:"eta",shift:'\\char"397'},{label:"<i>&xi;</i>",class:"MLK__tex hide-shift",insert:"\\xi",aside:"xi",shift:"\\Xi"},{label:"<i>&kappa;</i>",class:"MLK__tex hide-shift",insert:"\\kappa",aside:"kappa",shift:"\\Kappa"},{label:"<i>&lambda;</i>",class:"MLK__tex hide-shift",insert:"\\lambda",aside:"lambda",shift:"\\Lambda"},"[separator-5]"],["[shift]",{label:"<i>&zeta;</i>",class:"MLK__tex hide-shift",insert:"\\zeta",aside:"zeta",shift:'\\char"396'},{label:"<i>&chi;</i>",class:"MLK__tex hide-shift",insert:"\\chi",aside:"chi",shift:'\\char"3A7'},{label:"<i>&psi;</i>",class:"MLK__tex hide-shift",insert:"\\psi",aside:"psi",shift:"\\Psi"},{label:"<i>&omega;</i>",class:"MLK__tex hide-shift",insert:"\\omega",aside:"omega",shift:"\\Omega"},{label:"<i>&beta;</i>",class:"MLK__tex hide-shift",insert:"\\beta",aside:"beta",shift:'\\char"392'},{label:"<i>&nu;</i>",class:"MLK__tex hide-shift",insert:"\\nu",aside:"nu",shift:'\\char"39D'},{label:"<i>&mu;</i>",class:"MLK__tex hide-shift",insert:"\\mu",aside:"mu",shift:'\\char"39C'},"[backspace]"],["[separator]",{label:"<i>&#x03b5;</i>",class:"MLK__tex",insert:"\\varepsilon",aside:"epsilon var."},{label:"<i>&#x03d1;</i>",class:"MLK__tex",insert:"\\vartheta",aside:"theta var."},{label:"<i>&#x3f0;</i>",class:"MLK__tex",insert:"\\varkappa",aside:"kappa var."},{label:"<i>&#x03d6;</i>",class:"MLK__tex",insert:"\\varpi",aside:"pi var."},{label:"<i>&#x03f1;</i>",class:"MLK__tex",insert:"\\varrho",aside:"rho var."},"[left]","[right]","[action]"]]},symbols:{label:"&infin;",labelClass:"MLK__tex",tooltip:"keyboard.tooltip.symbols",rows:[[{latex:"\\sin",shift:"\\sin^{-1}",variants:[{class:"small",latex:"\\sinh"},{class:"small",latex:"\\sin^{-1}"},{class:"small",latex:"\\operatorname{arsinh}"}]},"\\ln",{latex:"\\mathrm{abs}",insert:"\\mathrm{abs}\\left(#0\\right)"},{latex:"\\rightarrow",shift:"\\Rightarrow",variants:[{latex:"\\implies",aside:"implies"},{latex:"\\to",aside:"to"},"\\dashv",{latex:"\\roundimplies",aside:"round implies"}]},{latex:"\\exists",variants:["\\nexists"],shift:"\\nexists"},{latex:"\\in",shift:"\\notin",variants:["\\notin","\\owns"]},"\\cup",{latex:"\\overrightarrow{#@}",shift:"\\overleftarrow{#@}",variants:["\\overleftarrow{#@}","\\bar{#@}","\\vec{#@}","\\hat{#@}","\\check{#@}","\\dot{#@}","\\ddot{#@}","\\mathring{#@}","\\breve{#@}","\\acute{#@}","\\tilde{#@}","\\grave{#@}"]},{class:"small hide-shift",latex:"\\lim_{#?}",shift:"\\lim_{x\\to\\infty}",variants:[{class:"small",latex:"\\liminf_{#?}"},{class:"small",latex:"\\limsup_{#?}"}]},"\\exponentialE"],[{latex:"\\cos",shift:"\\cos^{-1}",variants:[{class:"small",latex:"\\cosh"},{class:"small",latex:"\\cos^{-1}"},{class:"small",latex:"\\operatorname{arcosh}"}]},{latex:"\\log",shift:"\\log_{10}",variants:["\\log_{#0}","\\log_{10}"]},"\\left\\vert#0\\right\\vert",{latex:"\\larr",shift:"\\lArr",variants:[{latex:"\\impliedby",aside:"implied by"},{latex:"\\gets",aside:"gets"},"\\lArr","\\vdash",{latex:"\\models",aside:"models"}]},{latex:"\\forall",shift:"\\lnot",variants:[{latex:"\\land",aside:"and"},{latex:"\\lor",aside:"or"},{latex:"\\oplus",aside:"xor"},{latex:"\\lnot",aside:"not"},{latex:"\\downarrow",aside:"nor"},{latex:"\\uparrow",aside:"nand"},{latex:"\\curlywedge",aside:"nor"},{latex:"\\bar\\curlywedge",aside:"nand"}]},{latex:"\\ni",shift:"\\not\\owns"},"\\cap",{latex:"\\overline{#@}",shift:"\\underline{#@}",variants:["\\overbrace{#@}","\\overlinesegment{#@}","\\overleftrightarrow{#@}","\\overrightarrow{#@}","\\overleftarrow{#@}","\\overgroup{#@}","\\underbrace{#@}","\\underlinesegment{#@}","\\underleftrightarrow{#@}","\\underrightarrow{#@}","\\underleftarrow{#@}","\\undergroup{#@}"]},{class:"hide-shift small",latex:"\\int",shift:"\\iint",variants:[{latex:"\\int_{#?}^{#?}",class:"small"},{latex:"\\int",class:"small"},{latex:"\\smallint",class:"small"},{latex:"\\iint",class:"small"},{latex:"\\iiint",class:"small"},{latex:"\\oint",class:"small"},"\\intop","\\iiint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\ointctrclockwise","\\intctrclockwise"]},{latex:"\\pi",shift:"\\tau",variants:["\\tau"]}],[{latex:"\\tan",shift:"\\tan^{-1}",variants:[{class:"small",latex:"\\tanh"},{class:"small",latex:"\\tan^{-1}"},{class:"small",latex:"\\operatorname{artanh}"},{class:"small",latex:"\\arctan"},{class:"small",latex:"\\operatorname{arctg}"},{class:"small",latex:"\\operatorname{tg}"}]},{latex:"\\exp",insert:"\\exp\\left(#0\\right)",variants:["\\exponentialE^{#0}"]},"\\left\\Vert#0\\right\\Vert",{latex:"\\lrArr",shift:"\\leftrightarrow",variants:[{latex:"\\iff",aside:"if and only if"},"\\leftrightarrow","\\leftrightarrows","\\Leftrightarrow",{latex:"^\\biconditional",aside:"biconditional"}]},{latex:"\\vert",shift:"!"},{latex:"#@^{\\complement}",aside:"complement",variants:[{latex:"\\setminus",aside:"set minus"},{latex:"\\smallsetminus",aside:"small set minus"}]},{latex:"\\subset",shift:"\\subseteq",variants:["\\subset","\\subseteq","\\subsetneq","\\varsubsetneq","\\subsetneqq","\\nsubset","\\nsubseteq","\\supset","\\supseteq","\\supsetneq","\\supsetneqq","\\nsupset","\\nsupseteq"]},{latex:"#@^{\\prime}",shift:"#@^{\\doubleprime}",variants:["#@^{\\doubleprime}","#@\\degree"]},{latex:"\\mathrm{d}",shift:"\\partial",variants:["\\mathrm{d}x",{latex:"\\dfrac{\\mathrm{d}}{\\mathrm{d} x}",class:"small"},{latex:"\\frac{\\partial}{\\partial x}",class:"small"},"\\partial"]},{latex:"\\infty",variants:["\\aleph_0","\\aleph_1","\\omega","\\mathfrak{m}"]}],[{label:"[shift]",width:2},{class:"box",latex:",",shift:";",variants:[";","?"]},{class:"box",latex:"\\colon",shift:"\\Colon",variants:[{latex:"\\Colon",aside:"such that",class:"box"},{latex:":",aside:"ratio",class:"box"},{latex:"\\vdots",aside:"",class:"box"},{latex:"\\ddots",aside:"",class:"box"},{latex:"\\ldotp",aside:"low dot",class:"box"},{latex:"\\cdotp",aside:"center dot",class:"box"},{latex:"\\ldots",aside:"low ellipsis",class:"box"},{latex:"\\cdots",aside:"center ellipsis",class:"box"},{latex:"\\therefore",aside:"therefore",class:"box"},{latex:"\\because",aside:"because",class:"box"}]},{class:"box",latex:"\\cdot",aside:"centered dot",shift:"\\ast",variants:["\\circ","\\bigcirc","\\bullet","\\odot","\\oslash","\\circledcirc","\\ast","\\star","\\times","\\doteq","\\doteqdot"]},"[separator]","[left]","[right]",{label:"[backspace]",width:1,class:"action hide-shift"},{label:"[action]",width:1}]]},compact:{label:"compact",rows:[["[+]","[-]","[*]","[/]","[=]","[.]","[(]","[)]","\\sqrt{#0}","#@^{#?}"],["[1]","[2]","[3]","[4]","[5]","[6]","[7]","[8]","[9]","[0]"],["[hr]"],["[undo]","[redo]","[separator]","[separator]","[separator]","[left]","[right]",{label:"[backspace]",class:"action hide-shift"},"[hide-keyboard]"]]},minimalist:{label:"minimalist",layers:[{style:`
          div.minimalist-backdrop {
            display: flex;
            justify-content: center;
          }          
          div.minimalist-container {
            --keycap-height: 40px;
            --keycap-max-width: 53px;
            --keycap-small-font-size: 12px;
            background: var(--keyboard-background);
            padding: 20px 20px 0px 20px;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            border: 1px solid var(--keyboard-border);
            box-shadow: 0 0 32px rgb(0 0 0 / 30%);
          }        
        `,backdrop:"minimalist-backdrop",container:"minimalist-container",rows:[["+","-","\\times",{latex:"\\frac{#@}{#0}",class:"small"},"=","[.]","(",")",{latex:"\\sqrt{#0}",class:"small"},{latex:"#@^{#?}",class:"small"}],["1","2","3","4","5","6","7","8","9","0"],["[hr]"],["[undo]","[redo]","[separator]","[separator]","[separator]","[left]","[right]",{label:"[backspace]",class:"action hide-shift"},"[hide-keyboard]"]]}]},"numeric-only":{label:"123",labelClass:"MLK__tex-math",tooltip:"keyboard.tooltip.numeric",id:"numeric-only",rows:[["7","8","9","[separator]",{label:"[backspace]",width:2}],["4","5","6","[separator]","[separator]","[separator]"],["1","2","3","[separator]","[separator]","[separator]"],["0",{label:"[.]",variants:[]},"-","[separator]","[left]","[right]"]]}},fc={0:["\\varnothing","\\infty"],1:["\\frac{1}{#@}","#@^{-1}","\\times 10^{#?}","\\phi","\\imaginaryI"],2:["\\frac{1}{2}","#@^2","\\sqrt2","\\exponentialE"],3:["\\frac{1}{3}","#@^3","\\sqrt3","\\pi"],4:["\\frac{1}{4}","#@^4"],5:["\\frac{1}{5}","#@^5","\\sqrt5"],6:["\\frac{1}{6}","#@^6"],7:["\\frac{1}{7}","#@^7"],8:["\\frac{1}{8}","#@^8"],9:["\\frac{1}{9}","#@^9"],".":[".",",",";","\\colon"],",":["{,}",".",";","\\colon"],a:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"},"","","","","",""],A:[{latex:"\\aleph",aside:"aleph"},{latex:"\\forall",aside:"for all"},"","","","","",""],b:[{latex:"\\beth",aside:"beth"}],c:[{latex:"\\C",aside:"set of complex numbers"},""],d:[{latex:"\\daleth",aside:"daleth"}],e:[{latex:"\\exponentialE",aside:"exponential e"},{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isnt"},"","","",""],E:[{latex:"\\exponentialE",aside:"exponential e"},{latex:"\\exists",aside:"there is"},{latex:"\\nexists",aside:"there isnt"},"","","",""],g:[{latex:"\\gimel",aside:"gimel"}],h:[{latex:"\\hbar",aside:"h bar"},{latex:"\\hslash",aside:"h slash"}],i:[{latex:"\\imaginaryI",aside:"imaginary i"},"","","",""],I:[{latex:"\\imaginaryI",aside:"imaginary i"},"","","",""],j:[{latex:"\\imaginaryJ",aside:"imaginary j"}],l:[{latex:"\\ell",aside:"ell"}],n:[{latex:"\\mathbb{N}",aside:"set of natural numbers"},""],o:["","","","","",""],O:["","","","","",""],p:[{latex:"\\mathbb{P}",aside:"set of primes"}],q:[{latex:"\\mathbb{Q}",aside:"set of rational numbers"}],r:[{latex:"\\mathbb{R}",aside:"set of real numbers"}],u:["","","",""],U:["","","",""],z:[{latex:"\\mathbb{Z}",aside:"set of integers"}],y:["",""],Y:[""],space:[{latex:'\\char"203A\\!\\char"2039',insert:"\\!",aside:"negative thin space<br> em"},{latex:'\\char"203A\\,\\char"2039',insert:"\\,",aside:"thin space<br> em"},{latex:'\\char"203A\\:\\char"2039',insert:"\\:",aside:"medium space<br> em"},{latex:'\\char"203A\\;\\char"2039',insert:"\\;",aside:"thick space<br> em"},{latex:'\\char"203A\\ \\char"2039',insert:"\\ ",aside:" em"},{latex:'\\char"203A\\enspace\\char"2039',insert:"\\enspace",aside:" em"},{latex:'\\char"203A\\quad\\char"2039',insert:"\\quad",aside:"1 em"},{latex:'\\char"203A\\qquad\\char"2039',insert:"\\qquad",aside:"2 em"}]},Qa;function x5(t,e){var n,r,i,o,s;let a=Zi.singleton;if(!a)return;let l=Os(t),u="";if(window.mathVirtualKeyboard.isShifted){let k=(n=a.getKeycap(l?.id))==null?void 0:n.shift;typeof k=="object"&&"variants"in k&&(u=(r=k.variants)!=null?r:"")}else u=(o=(i=a.getKeycap(l?.id))==null?void 0:i.variants)!=null?o:"";if(typeof u=="string"&&!Kf(u)||Array.isArray(u)&&u.length===0){e?.();return}let c={},d="";for(let k of uA(u)){let D=d0(k),N=Date.now().toString(36).slice(-2)+Math.floor(Math.random()*1e5).toString(36);c[N]=D;let[B,T]=sh(D);d+=`<div id=${N} class="item ${T}">${B}</div>`}let p=document.createElement("div");p.setAttribute("aria-hidden","true"),p.className="MLK__variant-panel",p.style.height="auto";let f=Object.keys(c).length,g=5;f===1?g=1:f===2||f===4?g=2:f===3||f===5||f===6?g=3:f>=7&&f<14&&(g=4),p.style.width=`calc(var(--variant-keycap-length) * ${g} + 12px)`,p.innerHTML=p0.createHTML(d),sr.open({root:(s=a?.container)==null?void 0:s.querySelector(".ML__keyboard"),child:p}),Qa=new AbortController;let{signal:x}=Qa,w=t?.getBoundingClientRect();if(w){w.top-p.clientHeight<0&&(p.style.width="auto",f<=6?p.style.height="56px":f<=12?p.style.height="108px":f<=18?p.style.height="205px":p.classList.add("compact"));let k=Math.max(0,Math.min(window.innerWidth-p.offsetWidth,(w.left+w.right-p.offsetWidth)/2)),D=w.top-p.clientHeight+5;p.style.left=`${k}px`,p.style.top=`${D}px`,p.classList.add("is-visible"),requestAnimationFrame(()=>{var N;p.addEventListener("pointerup",B=>{let T=Os(B.target);!(T!=null&&T.id)||!c[T.id]||(jf(c[T.id]),Bs(),e?.(),B.preventDefault())},{capture:!0,passive:!1,signal:x}),p.addEventListener("pointerenter",B=>{let T=Os(B.target);!(T!=null&&T.id)||!c[T.id]||T.classList.add("is-active")},{capture:!0,signal:x}),p.addEventListener("pointerleave",B=>{let T=Os(B.target);B.target&&"tagName"in B.target&&typeof B.target.tagName=="string"&&B.target.tagName.toUpperCase()==="ASIDE"||!(T!=null&&T.id)||!c[T.id]||T.classList.remove("is-active")},{capture:!0,signal:x}),(N=a.getKeycap(l?.id))!=null&&N.stickyVariantPanel?window.addEventListener("pointerdown",B=>{if(!(B.target instanceof Node))return;let T=p.contains(B.target);B.target===p||T||(Bs(),e?.())},{signal:x}):(window.addEventListener("pointercancel",()=>{Bs(),e?.()},{signal:x}),window.addEventListener("pointerup",()=>{Bs(),e?.()},{signal:x}))})}}function Bs(){Qa?.abort(),Qa=null,sr.state==="open"&&sr.close()}function lA(t){if(t==="foreground-color"){let e=[];for(let n of Object.keys(Ro))e.push({class:"swatch-button",label:'<span style="border: 3px solid '+Ro[n]+'"></span>',command:["applyStyle",{color:n}]});return e}if(t==="background-color"){let e=[];for(let n of Object.keys(Io))e.push({class:"swatch-button",label:'<span style="background:'+Io[n]+'"></span>',command:["applyStyle",{backgroundColor:n}]});return e}}function Kf(t){return fc[t]!==void 0}function uA(t){var e;return typeof t!="string"?t:(fc[t]||(fc[t]=(e=lA(t))!=null?e:[]),fc[t])}function cA(t){return typeof t=="string"?t:Object.entries(t).map(([e,n])=>`${e}:${n} !important`).join(";")}function dA(t){return Object.keys(t).map(e=>`${e} {${cA(t[e])}}`).join("")}function Sa(t){if(!t)return"";let e=new Ye,n=new G({mode:"math",type:"root",body:wn(t,{context:e,args:i=>i==="@"?"{\\class{ML__box-placeholder}{\\blacksquare}}":"\\placeholder{}"})}),r=Jd(Bl(new oe(n.render(e),{classes:"ML__base"}),e));return Gd(r,{classes:"ML__latex"}).toMarkup()}function Ku(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hA(t){return t.replace(/<\/?[^>]+(>|$)/g," ")}function pA(t){var e,n,r,i;let o=(i=(r=(n=(e=t.tooltip)!=null?e:typeof t.label=="string"?hA(t.label):void 0)!=null?n:t.insert)!=null?r:t.latex)!=null?i:t.key;return o&&o.replace(/\s+/g," ").trim()||null}function fA(t){if(typeof t>"u"||t===null)return null;try{return JSON.stringify(t)}catch{return null}}function mA(t){var e,n;let r=(n=(e=t.insert)!=null?e:t.latex)!=null?n:t.key;return r??null}function el(t){if(Array.isArray(t))return t.map(n=>el(n)).flat();let e=typeof t=="string"?{markup:t}:t;return"rows"in e&&Array.isArray(e.rows)&&(e.rows=e.rows.map(n=>n.map(r=>d0(r)))),e.id!=null||(e.id="ML__layer_"+Date.now().toString(36).slice(-2)+Math.floor(Math.random()*1e5).toString(36)),[e]}function gA(){var t,e;let n=window.mathVirtualKeyboard.alphabeticLayout;if(n==="auto"){let s=ml();s&&(n=s.virtualLayout),(!n||n==="auto")&&(n=(t={fr:"azerty",be:"azerty",al:"qwertz",ba:"qwertz",cz:"qwertz",de:"qwertz",hu:"qwertz",sk:"qwertz",ch:"qwertz"}[qe.locale.slice(0,2)])!=null?t:"qwerty")}let r={qwerty:["qwertyuiop"," asdfghjkl ","^zxcvbnm~"],azerty:["azertyuiop","qsdfghjklm","^ wxcvbn ~"],qwertz:["qwertzuiop"," asdfghjkl ","^yxcvbnm~"],dvorak:["^  pyfgcrl ","aoeuidhtns","qjkxbmwvz~"],colemak:[" qwfpgjluy ","arstdhneio","^zxcvbkm~"]},i=(e=r[n])!=null?e:r.qwerty,o=n==="azerty"?[[{label:"1",variants:"1"},{label:"2",shift:{latex:""},variants:"2"},{label:"3",shift:{latex:""},variants:"3"},{label:"4",variants:"4"},{label:"5",shift:{label:"(",latex:"("},variants:"5"},{label:"6",shift:{label:")",latex:")"},variants:"6"},{label:"7",shift:{latex:""},variants:"7"},{label:"8",shift:{latex:""},variants:"8"},{label:"9",shift:{latex:""},variants:"9"},{label:"0",shift:{latex:""},variants:"0"}]]:[[{label:"1",variants:"1"},{label:"2",variants:"2"},{label:"3",variants:"3"},{label:"4",variants:"4"},{label:"5",shift:{latex:"\\frac{#@}{#?}"},variants:"5"},{label:"6",shift:{latex:"#@^#?"},variants:"6"},{label:"7",variants:"7"},{label:"8",shift:{latex:"\\times"},variants:"8"},{label:"9",shift:{label:"(",latex:"("},variants:"9"},{label:"0",shift:{label:")",latex:")"},variants:"0"}]];for(let s of i){let a=[];for(let l of s)/[a-z]/.test(l)?a.push({label:l,class:"hide-shift",shift:{label:l.toUpperCase(),variants:Kf(l.toUpperCase())?l.toUpperCase():void 0},variants:Kf(l)?l:void 0}):l==="~"?n!=="dvorak"?a.push("[backspace]"):a.push({label:"[backspace]",width:1}):l==="^"?a.push("[shift]"):l===" "&&a.push("[separator-5]");o.push(a)}return o.push(["[-]","[+]","[=]",{label:" ",width:1.5},{label:",",shift:";",variants:".",class:"hide-shift"},"[.]","[left]","[right]",{label:"[action]",width:1.5}]),{label:"abc",labelClass:"MLK__tex-math",tooltip:"keyboard.tooltip.alphabetic",layers:el({rows:o})}}function w5(t){if(t==="alphabetic")return gA();if(typeof t=="string")return w5(aA[t]);let e;if("rows"in t&&Array.isArray(t.rows)){let i=t,{rows:o}=i,s=cd(i,["rows"]);e=V(O({},s),{layers:el({rows:t.rows})})}else if("markup"in t&&typeof t.markup=="string"){let i=t,{markup:o}=i,s=cd(i,["markup"]);e=V(O({},s),{layers:el(t.markup)})}else e=O({},t),"layers"in t?e.layers=el(t.layers):console.error('MathLive 0.108.2: provide either a "rows", "markup" or "layers" property');let n=!1,r=!1;for(let i of e.layers)if(i.rows)for(let o of i.rows.flat()){Ks(o)&&(n=!0);let s=o.command;typeof s=="string"&&["undo","redo","cut","copy","paste"].includes(s)&&(r=!0)}return(!("displayShiftedKeycaps"in t)||t.displayShiftedKeycaps===void 0)&&(e.displayShiftedKeycaps=n),(!("displayEditToolbar"in t)||t.displayEditToolbar===void 0)&&(e.displayEditToolbar=!r),e}function yA(t,e){var n,r;let i='<div class="left">';if(t.normalizedLayouts.length>1)for(let[o,s]of t.normalizedLayouts.entries()){let a=s,l=[o===e?"selected":"layer-switch"];a.tooltip&&l.push("MLK__tooltip"),a.labelClass&&l.push(...a.labelClass.split(" ")),i+=`<div class="${l.join(" ")}"`,a.tooltip&&(i+=" data-tooltip='"+((n=Le(a.tooltip))!=null?n:a.tooltip)+"' "),o!==e&&(i+=`data-layer="${a.layers[0].id}"`),i+=`>${(r=a.label)!=null?r:"untitled"}</div>`}return i+="</div>",i}function bA(t,e){let n="";if(t.editToolbar==="none")return"";let r=[];e.selectionIsCollapsed?r.push("undo","redo","pasteFromClipboard"):r.push("cutToClipboard","copyToClipboard","pasteFromClipboard");let i={undo:`<div class='action ${e.canUndo===!1?"disabled":""}'
          data-command='"undo"'
          data-tooltip='${Le("tooltip.undo")}'>
          <svg><use xlink:href='#svg-undo' /></svg>
      </div>`,redo:`<div class='action ${e.canRedo===!1?"disabled":""}'
          data-command='"redo"'
          data-tooltip='${Le("tooltip.redo")}'>
          <svg><use xlink:href='#svg-redo' /></svg>
      </div>`,cutToClipboard:`
        <div class='action'
            data-command='"cutToClipboard"'
            data-tooltip='${Le("tooltip.cut to clipboard")}'>
            <svg><use xlink:href='#svg-cut' /></svg>
        </div>
    `,copyToClipboard:`
        <div class='action'
            data-command='"copyToClipboard"'
            data-tooltip='${Le("tooltip.copy to clipboard")}'>
            <svg><use xlink:href='#svg-copy' /></svg>
        </div>
    `,pasteFromClipboard:`
        <div class='action'
            data-command='"pasteFromClipboard"'
            data-tooltip='${Le("tooltip.paste from clipboard")}'>
            <svg><use xlink:href='#svg-paste' /></svg>
        </div>
    `};return n+=r.map(o=>i[o]).join(""),n}function vA(t){for(let e of t)xA(e)}function xA(t){let e=Zi.singleton;if(!e)return;let n={};if(!t.id){if(t.hasAttribute("data-label")&&(n.label=t.dataset.label),t.hasAttribute("data-latex")&&(n.latex=t.dataset.latex),t.hasAttribute("data-key")&&(n.key=t.dataset.key),t.hasAttribute("data-insert")&&(n.insert=t.dataset.insert),t.hasAttribute("data-variants")&&(n.variants=t.dataset.variants),t.hasAttribute("data-aside")&&(n.aside=t.dataset.aside),t.className&&(n.class=t.className),!n.label&&!n.latex&&!n.key&&!n.insert&&(n.latex=t.innerText,n.label=t.innerHTML),t.hasAttribute("data-command"))try{n.command=JSON.parse(t.dataset.command)}catch(r){console.warn("Invalid JSON in data-command attribute",r)}t.id=e.registerKeycap(n)}if(!t.innerHTML){let[r,i]=sh(n);t.innerHTML=globalThis.MathfieldElement.createHTML(r)}}function wA(){Ji("virtual-keyboard"),Ji("core"),oh()}function kA(){Gi("core"),Gi("virtual-keyboard")}var SA=`<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">

<symbol id="svg-delete-backward" viewBox="0 0 576 512">
  <path d="M432.1 208.1L385.9 256L432.1 303C442.3 312.4 442.3 327.6 432.1 336.1C423.6 346.3 408.4 346.3 399 336.1L352 289.9L304.1 336.1C295.6 346.3 280.4 346.3 271 336.1C261.7 327.6 261.7 312.4 271 303L318.1 256L271 208.1C261.7 199.6 261.7 184.4 271 175C280.4 165.7 295.6 165.7 304.1 175L352 222.1L399 175C408.4 165.7 423.6 165.7 432.1 175C442.3 184.4 442.3 199.6 432.1 208.1V208.1zM512 64C547.3 64 576 92.65 576 128V384C576 419.3 547.3 448 512 448H205.3C188.3 448 172 441.3 160 429.3L9.372 278.6C3.371 272.6 0 264.5 0 256C0 247.5 3.372 239.4 9.372 233.4L160 82.75C172 70.74 188.3 64 205.3 64L512 64zM528 128C528 119.2 520.8 112 512 112H205.3C201 112 196.9 113.7 193.9 116.7L54.63 256L193.9 395.3C196.9 398.3 201 400 205.3 400H512C520.8 400 528 392.8 528 384V128z"/>
</symbol>

<symbol id="svg-shift" viewBox="0 0 384 512">
  <path d="M2.438 252.3C7.391 264.2 19.06 272 32 272h80v160c0 26.51 21.49 48 48 48h64C250.5 480 272 458.5 272 432v-160H352c12.94 0 24.61-7.797 29.56-19.75c4.953-11.97 2.219-25.72-6.938-34.88l-160-176C208.4 35.13 200.2 32 192 32S175.6 35.13 169.4 41.38l-160 176C.2188 226.5-2.516 240.3 2.438 252.3zM192 86.63L313.4 224H224v208H160V224H70.63L192 86.63z"/>
</symbol>

<symbol id="svg-commit" viewBox="0 0 512 512">
  <path d="M135 432.1l-128-128C2.344 300.3 0 294.2 0 288s2.344-12.28 7.031-16.97l128-128c9.375-9.375 24.56-9.375 33.94 0s9.375 24.56 0 33.94L81.94 264H464v-208C464 42.75 474.8 32 488 32S512 42.75 512 56V288c0 13.25-10.75 24-24 24H81.94l87.03 87.03c9.375 9.375 9.375 24.56 0 33.94S144.4 442.3 135 432.1z"/>
</symbol>


<symbol id="circle-plus" viewBox="0 0 512 512"><path d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344c0 13.3 10.7 24 24 24s24-10.7 24-24V280h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H280V168c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H168c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"/></symbol>

<symbol id="svg-command" viewBox="0 0 640 512">
  <path d="M34.495 36.465l211.051 211.05c4.686 4.686 4.686 12.284 0 16.971L34.495 475.535c-4.686 4.686-12.284 4.686-16.97 0l-7.071-7.07c-4.686-4.686-4.686-12.284 0-16.971L205.947 256 10.454 60.506c-4.686-4.686-4.686-12.284 0-16.971l7.071-7.07c4.686-4.687 12.284-4.687 16.97 0zM640 468v-10c0-6.627-5.373-12-12-12H300c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h328c6.627 0 12-5.373 12-12z"/>
</symbol>

<symbol id="svg-undo" viewBox="0 0 512 512">
  <path d="M20 8h10c6.627 0 12 5.373 12 12v110.625C85.196 57.047 165.239 7.715 256.793 8.001 393.18 8.428 504.213 120.009 504 256.396 503.786 393.181 392.834 504 256 504c-63.926 0-122.202-24.187-166.178-63.908-5.113-4.618-5.354-12.561-.482-17.433l7.069-7.069c4.503-4.503 11.749-4.714 16.482-.454C150.782 449.238 200.935 470 256 470c117.744 0 214-95.331 214-214 0-117.744-95.331-214-214-214-82.862 0-154.737 47.077-190.289 116H180c6.627 0 12 5.373 12 12v10c0 6.627-5.373 12-12 12H20c-6.627 0-12-5.373-12-12V20c0-6.627 5.373-12 12-12z"/>
</symbol>
<symbol id="svg-redo" viewBox="0 0 512 512">
  <path d="M492 8h-10c-6.627 0-12 5.373-12 12v110.625C426.804 57.047 346.761 7.715 255.207 8.001 118.82 8.428 7.787 120.009 8 256.396 8.214 393.181 119.166 504 256 504c63.926 0 122.202-24.187 166.178-63.908 5.113-4.618 5.354-12.561.482-17.433l-7.069-7.069c-4.503-4.503-11.749-4.714-16.482-.454C361.218 449.238 311.065 470 256 470c-117.744 0-214-95.331-214-214 0-117.744 95.331-214 214-214 82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12z"/>
</symbol>
<symbol id="svg-arrow-left" viewBox="0 0 320 512">
  <path d="M206.7 464.6l-183.1-191.1C18.22 267.1 16 261.1 16 256s2.219-11.97 6.688-16.59l183.1-191.1c9.152-9.594 24.34-9.906 33.9-.7187c9.625 9.125 9.938 24.37 .7187 33.91L73.24 256l168 175.4c9.219 9.5 8.906 24.78-.7187 33.91C231 474.5 215.8 474.2 206.7 464.6z"/>
</symbol>
<symbol id="svg-arrow-right" viewBox="0 0 320 512">
  <path d="M113.3 47.41l183.1 191.1c4.469 4.625 6.688 10.62 6.688 16.59s-2.219 11.97-6.688 16.59l-183.1 191.1c-9.152 9.594-24.34 9.906-33.9 .7187c-9.625-9.125-9.938-24.38-.7187-33.91l168-175.4L78.71 80.6c-9.219-9.5-8.906-24.78 .7187-33.91C88.99 37.5 104.2 37.82 113.3 47.41z"/>
</symbol>
<symbol id="svg-tab" viewBox="0 0 448 512">
  <path d="M32 217.1c0-8.8 7.2-16 16-16h144v-93.9c0-7.1 8.6-10.7 13.6-5.7l143.5 143.1c6.3 6.3 6.3 16.4 0 22.7L205.6 410.4c-5 5-13.6 1.5-13.6-5.7v-93.9H48c-8.8 0-16-7.2-16-16v-77.7m-32 0v77.7c0 26.5 21.5 48 48 48h112v61.9c0 35.5 43 53.5 68.2 28.3l143.6-143c18.8-18.8 18.8-49.2 0-68L228.2 78.9c-25.1-25.1-68.2-7.3-68.2 28.3v61.9H48c-26.5 0-48 21.6-48 48zM436 64h-8c-6.6 0-12 5.4-12 12v360c0 6.6 5.4 12 12 12h8c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12z"/>
</symbol>
<symbol id="svg-paste" viewBox="0 0 512 512"><path d="M160 32c11.6 0 21.3 8.2 23.5 19.2C185 58.6 191.6 64 199.2 64H208c8.8 0 16 7.2 16 16V96H96V80c0-8.8 7.2-16 16-16h8.8c7.6 0 14.2-5.4 15.7-12.8C138.7 40.2 148.4 32 160 32zM64 64h2.7C65 69 64 74.4 64 80V96c0 17.7 14.3 32 32 32H224c17.7 0 32-14.3 32-32V80c0-5.6-1-11-2.7-16H256c17.7 0 32 14.3 32 32h32c0-35.3-28.7-64-64-64H210.6c-9-18.9-28.3-32-50.6-32s-41.6 13.1-50.6 32H64C28.7 32 0 60.7 0 96V384c0 35.3 28.7 64 64 64H192V416H64c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32zM288 480c-17.7 0-32-14.3-32-32V192c0-17.7 14.3-32 32-32h96v56c0 22.1 17.9 40 40 40h56V448c0 17.7-14.3 32-32 32H288zM416 165.3L474.7 224H424c-4.4 0-8-3.6-8-8V165.3zM448 512c35.3 0 64-28.7 64-64V235.9c0-12.7-5.1-24.9-14.1-33.9l-59.9-59.9c-9-9-21.2-14.1-33.9-14.1H288c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H448z"/></symbol>
<symbol id="svg-cut" viewBox="0 0 512 512"><path d="M485.6 444.2L333.6 314.9C326.9 309.2 326.1 299.1 331.8 292.4C337.5 285.6 347.6 284.8 354.4 290.5L506.4 419.8C513.1 425.5 513.9 435.6 508.2 442.4C502.5 449.1 492.4 449.9 485.6 444.2zM485.7 67.76C492.5 62.07 502.5 62.94 508.2 69.69C513.9 76.45 513.1 86.55 506.3 92.24L208.5 343.1C218.3 359.7 224 379.2 224 400C224 461.9 173.9 512 112 512C50.14 512 0 461.9 0 400C0 338.1 50.14 288 112 288C141.5 288 168.4 299.4 188.4 318.1L262.2 256L188.4 193.9C168.4 212.6 141.5 224 112 224C50.14 224 0 173.9 0 112C0 50.14 50.14 0 112 0C173.9 0 224 50.14 224 112C224 132.8 218.3 152.3 208.5 168.9L287 235.1L485.7 67.76zM32 112C32 156.2 67.82 192 112 192C156.2 192 192 156.2 192 112C192 67.82 156.2 32 112 32C67.82 32 32 67.82 32 112zM112 480C156.2 480 192 444.2 192 400C192 355.8 156.2 320 112 320C67.82 320 32 355.8 32 400C32 444.2 67.82 480 112 480z"/></symbol>
<symbol id="svg-copy" viewBox="0 0 512 512"><path d="M272 416C263.2 416 256 423.2 256 432V448c0 17.67-14.33 32-32 32H64c-17.67 0-32-14.33-32-32V192c0-17.67 14.33-32 32-32h112C184.8 160 192 152.8 192 144C192 135.2 184.8 128 176 128H63.99c-35.35 0-64 28.65-64 64l.0098 256C0 483.3 28.65 512 64 512h160c35.35 0 64-28.65 64-64v-16C288 423.2 280.8 416 272 416zM502.6 86.63l-77.25-77.25C419.4 3.371 411.2 0 402.7 0H288C252.7 0 224 28.65 224 64v256c0 35.35 28.65 64 64 64h160c35.35 0 64-28.65 64-64V109.3C512 100.8 508.6 92.63 502.6 86.63zM416 45.25L466.7 96H416V45.25zM480 320c0 17.67-14.33 32-32 32h-160c-17.67 0-32-14.33-32-32V64c0-17.67 14.33-32 32-32h96l.0026 64c0 17.67 14.33 32 32 32H480V320z"/>
</symbol>
<symbol id="svg-angle-double-right" viewBox="0 0 512 512"><path d="M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"/>
</symbol>
<symbol id="svg-angle-double-left" viewBox="0 0 512 512"><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"/>
</symbol>
<symbol id="svg-trash" viewBox="0 0 448 512">
  <path d="M336 64l-33.6-44.8C293.3 7.1 279.1 0 264 0h-80c-15.1 0-29.3 7.1-38.4 19.2L112 64H24C10.7 64 0 74.7 0 88v2c0 3.3 2.7 6 6 6h26v368c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V96h26c3.3 0 6-2.7 6-6v-2c0-13.3-10.7-24-24-24h-88zM184 32h80c5 0 9.8 2.4 12.8 6.4L296 64H152l19.2-25.6c3-4 7.8-6.4 12.8-6.4zm200 432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V96h320v368zm-176-44V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm-80 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12zm160 0V156c0-6.6 5.4-12 12-12h8c6.6 0 12 5.4 12 12v264c0 6.6-5.4 12-12 12h-8c-6.6 0-12-5.4-12-12z"/>
</symbol>
<symbol id="svg-keyboard-down" viewBox="0 0 576 512"><path d="M64 48c-8.8 0-16 7.2-16 16V240c0 8.8 7.2 16 16 16H512c8.8 0 16-7.2 16-16V64c0-8.8-7.2-16-16-16H64zM0 64C0 28.7 28.7 0 64 0H512c35.3 0 64 28.7 64 64V240c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zM159 359c9.4-9.4 24.6-9.4 33.9 0l95 95 95-95c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9L305 505c-4.5 4.5-10.6 7-17 7s-12.5-2.5-17-7L159 393c-9.4-9.4-9.4-24.6 0-33.9zm1-167c0-8.8 7.2-16 16-16H400c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V192zM120 88h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H120c-8.8 0-16-7.2-16-16V104c0-8.8 7.2-16 16-16zm64 16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H200c-8.8 0-16-7.2-16-16V104zm96-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H280c-8.8 0-16-7.2-16-16V104c0-8.8 7.2-16 16-16zm64 16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H360c-8.8 0-16-7.2-16-16V104zm96-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16H440c-8.8 0-16-7.2-16-16V104c0-8.8 7.2-16 16-16z"/></symbol>
</svg>`;function _A(t){t.resetKeycapRegistry(),wA();let e=document.createElement("div");e.className="ML__keyboard";let n=document.createElement("div");n.className="MLK__plate",n.innerHTML=globalThis.MathfieldElement.createHTML(SA+t.normalizedLayouts.map((s,a)=>MA(t,s,a)).join(""));let r=document.createElement("div");r.className="MLK__backdrop",r.appendChild(n),e.appendChild(r),e.addEventListener("pointerdown",EA,{passive:!1});let i=e.querySelectorAll(".ML__edit-toolbar");if(i)for(let s of i)s.addEventListener("click",a=>{var l,u;let c=a.target,d="";for(;c&&!d;)d=(l=c?.getAttribute("data-command"))!=null?l:"",c=(u=c?.parentElement)!=null?u:null;d&&t.executeCommand(JSON.parse(d))});vA(e.querySelectorAll(".MLK__keycap, .action, .fnbutton, .bigfnbutton"));let o=e.querySelectorAll(".MLK__layer");o.length>0;for(let s of o)s.addEventListener("pointerdown",a=>a.preventDefault());return t.currentLayer=t.latentLayer,e}function MA(t,e,n){var r;let i=[];if(!("layers"in e))return"";for(let o of e.layers)i.push(`<div tabindex="-1" class="MLK__layer" id="${o.id}">`),(t.normalizedLayouts.length>1||e.displayEditToolbar)&&(i.push("<div class='MLK__toolbar' role='toolbar'>"),i.push(yA(t,n)),((r=e.displayEditToolbar)==null||r)&&i.push('<div class="ML__edit-toolbar right"></div>'),i.push("</div>")),i.push(CA(t,o)),i.push("</div>");return i.join("")}function CA(t,e){if(typeof e=="string")return e;let n="";if(typeof e.style=="string"?n+=`<style>${e.style}</style>`:typeof e.style=="object"&&(n+=`<style>${dA(e.style)}</style>`),e.backdrop&&(n+=`<div class='${e.backdrop}'>`),e.container&&(n+=`<div class='${e.container}'>`),e.rows){n+="<div class=MLK__rows>";for(let r of e.rows){n+='<div dir="ltr" class=MLK__row>';for(let i of r)if(i){let o=t.registerKeycap(i),[s,a]=sh(i);/(^|\s)separator/.test(a)?n+=`<div class="${a}"`:n+=`<div tabindex="-1" id="${o}" class="${a}"`,i.tooltip&&(n+=` data-tooltip="${Ku(i.tooltip)}"`);let l=pA(i);l&&(n+=` aria-label="${Ku(l)}"`);let u=fA(i.command);u&&(n+=` data-command="${Ku(u)}"`);let c=mA(i);c&&(n+=` data-keycap-value="${Ku(c)}"`),n+=`>${s}</div>`}n+="</div>"}n+="</div>"}else e.markup&&(n+=e.markup);return e.container&&(n+="</div>"),e.backdrop&&(n+="</div>"),n}function sh(t,e={shifted:!1}){var n,r,i,o,s,a,l;let u="",c=(n=t.class)!=null?n:"";if(e.shifted&&Ks(t)&&(c+=" is-active"),e.shifted&&"shift"in t)typeof t.shift=="string"?u=Sa(t.shift):typeof t.shift=="object"&&(u=t.shift.label?t.shift.label:(r=Sa(t.shift.latex||t.shift.insert||"")||t.shift.key)!=null?r:""),typeof t.shift=="object"&&(c=(o=(i=t.shift.class)!=null?i:t.class)!=null?o:"");else{if(u=t.label?t.label:(s=Sa(t.latex||t.insert||"")||t.key)!=null?s:"",t.shift){let d;typeof t.shift=="string"?d=Sa(t.shift):t.shift.label?d=t.shift.label:d=(a=Sa(t.shift.latex||t.shift.insert||"")||t.shift.key)!=null?a:"",u+=`<span class="MLK__shift">${d}</span>`}t.aside&&(u+=`<aside>${t.aside}</aside>`)}return t.layer&&!/layer-switch/.test(c)&&(c+=" layer-switch"),/(^|\s)(separator|action|shift|fnbutton|bigfnbutton)($|\s)/.test(c)||(c+=" MLK__keycap"),!/\bw[0-9]+\b/.test(c)&&t.width&&(c+=(l={0:" w0",.5:" w5",1.5:" w15",2:" w20",5:" w50"}[t.width])!=null?l:""),[u,c||"MLK__keycap"]}var $r={"[left]":{class:"action hide-shift",label:"<svg class=svg-glyph><use xlink:href=#svg-arrow-left /></svg>",command:"performWithFeedback(moveToPreviousChar)",shift:{label:"<svg class=svg-glyph><use xlink:href=#svg-angle-double-left /></svg>",command:"performWithFeedback(extendSelectionBackward)"}},"[right]":{class:"action hide-shift",label:"<svg class=svg-glyph><use xlink:href=#svg-arrow-right /></svg>",command:"performWithFeedback(moveToNextChar)",shift:{label:"<svg class=svg-glyph><use xlink:href=#svg-angle-double-right /></svg>",command:"performWithFeedback(extendSelectionForward)"}},"[up]":{class:"action hide-shift",label:"",command:"performWithFeedback(moveUp)",shift:{label:"",command:"performWithFeedback(extendSelectionUpward)"}},"[down]":{class:"action hide-shift",label:"",command:"performWithFeedback(moveDown)",shift:{label:"",command:"performWithFeedback(extendSelectionDownward)"}},"[return]":{class:"action hide-shift",command:"performWithFeedback(commit)",shift:{command:"performWithFeedback(addRowAfter)"},width:1.5,label:"<svg class=svg-glyph><use xlink:href=#svg-commit /></svg>"},"[action]":{class:"action hide-shift",command:"performWithFeedback(commit)",shift:{label:"<svg class=svg-glyph><use xlink:href=#circle-plus /></svg>",command:"performWithFeedback(addRowAfter)"},width:1.5,label:"<svg class=svg-glyph><use xlink:href=#svg-commit /></svg>"},"[hr]":{class:"separator horizontal-rule"},"[hide-keyboard]":{class:"action",command:["hideVirtualKeyboard"],width:1.5,label:"<svg class=svg-glyph-lg><use xlink:href=#svg-keyboard-down /></svg>"},"[.]":{variants:".",command:"performWithFeedback(insertDecimalSeparator)",shift:",",class:"big-op hide-shift",label:"."},"[,]":{variants:",",command:"performWithFeedback(insertDecimalSeparator)",shift:".",class:"big-op hide-shift",label:","},"[+]":{variants:[{latex:"\\sum_{#0}^{#0}",class:"small"},"\\oplus"],latex:"+",label:"+",class:"big-op hide-shift",shift:{latex:"\\sum",insert:"\\sum",class:"small"}},"[-]":{variants:["\\pm","\\ominus"],latex:"-",label:"&#x2212;",shift:"\\pm",class:"big-op hide-shift"},"[/]":{class:"big-op hide-shift",shift:{class:"",latex:"\\frac{1}{#@}"},variants:["/","\\div","\\%","\\oslash"],latex:"\\frac{#@}{#?}",label:"&divide;"},"[*]":{variants:[{latex:"\\prod_{#0}^{#0}",class:"small"},"\\otimes","\\cdot"],latex:"\\cdot",label:"&times;",shift:{latex:"\\times"},class:"big-op hide-shift"},"[=]":{variants:["\\neq","\\equiv","\\varpropto","\\thickapprox","\\lt","\\gt","\\le","\\ge"],latex:"=",label:"=",shift:{label:"",latex:"\\ne"},class:"big-op hide-shift"},"[backspace]":{class:"action bottom right hide-shift",width:1.5,command:"performWithFeedback(deleteBackward)",label:"<svg class=svg-glyph><use xlink:href=#svg-delete-backward /></svg>",shift:{class:"action warning",label:"<svg class=svg-glyph><use xlink:href=#svg-trash /></svg>",command:"deleteAll"}},"[undo]":{class:"ghost if-can-undo",command:"undo",label:"<svg class=svg-glyph><use xlink:href=#svg-undo /></svg>",tooltip:"tooltip.undo"},"[redo]":{class:"ghost  if-can-redo",command:"redo",label:"<svg class=svg-glyph><use xlink:href=#svg-redo /></svg>",tooltip:"tooltip.redo"},"[(]":{variants:[{latex:"\\lbrack",key:"["},"\\langle","\\lfloor","\\lceil",{latex:"\\lbrace",key:"{"}],key:"(",label:"(",shift:{label:"[",key:"["},class:"hide-shift"},"[)]":{variants:[{latex:"\\rbrack",key:"]"},"\\rangle","\\rfloor","\\rceil",{latex:"\\rbrace",key:"}"}],key:")",label:")",shift:{label:"]",latex:"\\rbrack"},class:"hide-shift"},"[0]":{variants:"0",latex:"0",label:"0",shift:"\\infty",class:"hide-shift"},"[1]":{variants:"1",latex:"1",label:"1",shift:"#@^{-1}",class:"hide-shift"},"[2]":{variants:"2",latex:"2",label:"2",shift:"#@^2",class:"hide-shift"},"[3]":{variants:"3",latex:"3",label:"3",shift:"#@^3",class:"hide-shift"},"[4]":{variants:"4",latex:"4",label:"4",shift:"#@^4",class:"hide-shift"},"[5]":{variants:"5",latex:"5",label:"5",shift:"#@^5",class:"hide-shift"},"[6]":{variants:"6",latex:"6",label:"6",shift:"#@^6",class:"hide-shift"},"[7]":{variants:"7",latex:"7",label:"7",shift:"#@^7",class:"hide-shift"},"[8]":{variants:"8",latex:"8",label:"8",shift:"#@^8",class:"hide-shift"},"[9]":{variants:"9",latex:"9",label:"9",shift:"#@^9",class:"hide-shift"},"[separator-5]":{class:"separator",width:.5},"[separator]":{class:"separator"},"[separator-10]":{class:"separator"},"[separator-15]":{class:"separator",width:1.5},"[separator-20]":{class:"separator",width:2},"[separator-50]":{class:"separator",width:5},"[shift]":{class:"shift bottom left",width:1.5,label:"<span class=caps-lock-indicator></span><svg class=svg-glyph><use xlink:href=#svg-shift /></svg>"},"[foreground-color]":{variants:"foreground-color",command:["applyStyle",{color:"red"}],label:"<span style='border-radius: 50%;width:22px;height:22px; border: 3px solid #cc2428; box-sizing: border-box'>"},"[background-color]":{variants:"background-color",command:["applyStyle",{backgroundColor:"yellow"}],label:"<span style='border-radius: 50%;width:22px;height:22px; background:#fff590; box-sizing: border-box'></span>"}};function d0(t){var e;if(typeof t=="string"){if(t==="[.]"&&globalThis.MathfieldElement.decimalSeparator===","&&(t="[,]"),!$r[t])return{latex:t};t={label:t}}let n;return"label"in t&&t.label&&$r[t.label]&&(n=V(O(O({},$r[t.label]),t),{label:$r[t.label].label})),"key"in t&&t.key&&$r[t.key]&&(n=V(O(O({},$r[t.key]),t),{key:$r[t.key].key})),n?(n.command==="insertDecimalSeparator"&&(n.label=(e=globalThis.MathfieldElement.decimalSeparator)!=null?e:"."),(n.tooltip===void 0||n.tooltip===null||n.tooltip===!1)&&delete n.tooltip,(n.tooltip===void 0||n.tooltip===null||n.tooltip===!1)&&delete n.tooltip,(n.aside===void 0||n.aside===null||n.aside===!1)&&delete n.aside,(n.variants===void 0||n.variants===null||n.variants===!1)&&delete n.variants,(n.shift===void 0||n.shift===null||n.shift===!1)&&delete n.shift,n):t}var tl;function EA(t){var e,n,r,i;if(t.button!==0)return;let o=Zi.singleton;if(!o)return;let s=t.target;for(;s&&!s.getAttribute("data-layer");)s=s.parentElement;if(s){o.currentLayer=(e=s.getAttribute("data-layer"))!=null?e:"",t.preventDefault();return}let a=Os(t.target);if(!(a!=null&&a.id))return;let l=o.getKeycap(a.id);if(!l)return;t.type;let u=o;if(!u.connectedMathfieldWindow){let p=(n=window.focusedMathfield)==null?void 0:n.call(window);if(p){let f=(i=(r=p.element)==null?void 0:r.ownerDocument)==null?void 0:i.defaultView;f&&f!==window&&(u.connectedMathfieldWindow=f)}}let c=new AbortController,d=c.signal;a.classList.add("is-pressed"),a.addEventListener("pointerenter",ju(c),{capture:!0,signal:d}),a.addEventListener("pointerleave",ju(c),{capture:!0,signal:d}),a.addEventListener("pointercancel",ju(c),{signal:d}),a.addEventListener("pointerup",ju(c),{signal:d}),Ks(l)&&(a.classList.add("is-active"),o.shiftPressCount++),l.variants&&(tl&&clearTimeout(tl),tl=setTimeout(()=>{a.classList.contains("is-pressed")&&(a.classList.remove("is-pressed"),a.classList.add("is-active"),t.target&&"releasePointerCapture"in t.target&&t.target.releasePointerCapture(t.pointerId),x5(a,()=>{c.abort(),a?.classList.remove("is-active")}))},l.stickyVariantPanel?0:300)),t.preventDefault()}function ju(t){return e=>{let n=Os(e.target);if(!(n!=null&&n.id))return;let r=Zi.singleton;if(!r)return;let i=r.getKeycap(n.id);if(i){if(e.type==="pointerenter"&&e.target===n&&e.isPrimary&&n.classList.add("is-pressed"),e.type==="pointercancel"){n.classList.remove("is-pressed"),Ks(i)&&(r.shiftPressCount--,n.classList.toggle("is-active",r.isShifted)),t.abort();return}if(e.type==="pointerleave"&&e.target===n){n.classList.remove("is-pressed"),Ks(i)&&(r.shiftPressCount--,n.classList.toggle("is-active",r.isShifted));return}if(e.type==="pointerup"){tl&&clearTimeout(tl),Ks(i)?n.classList.toggle("is-active",r.isShifted):n.classList.contains("is-pressed")&&(n.classList.remove("is-pressed"),r.isShifted&&i.shift?typeof i.shift=="string"?r.executeCommand(["insert",i.shift,{focus:!0,feedback:!0,scrollIntoView:!0,mode:"math",format:"latex"}]):jf(i.shift):jf(i),r.shiftPressCount===1&&!e.shiftKey&&(r.shiftPressCount=0)),t.abort(),e.preventDefault();return}}}}function jf(t){let e=t.command;!e&&t.insert&&(e=["insert",t.insert,{focus:!0,feedback:!0,scrollIntoView:!0,mode:"math",format:"latex"}]),!e&&t.key&&(e=["typedText",t.key,{focus:!0,feedback:!0,simulateKeystroke:!0}]),!e&&t.latex&&(e=["insert",t.latex,{focus:!0,feedback:!0,scrollIntoView:!0,mode:"math",format:"latex"}]),e||(e=["typedText",t.label,{focus:!0,feedback:!0,simulateKeystroke:!0}]),Zi.singleton&&Zi.singleton.executeCommand(e)}function AA(t){if(t.nodeType!==1)return!1;let e=t.classList;return e.contains("MLK__keycap")||e.contains("shift")||e.contains("action")||e.contains("fnbutton")||e.contains("bigfnbutton")}function Os(t){if(!t)return;let e=t;for(;e&&!AA(e);)e=e.parentElement;return e??void 0}function Ks(t){return!!t.class&&/(^|\s)shift($|\s)/.test(t.class)}var Zi=class k5{constructor(){this.originalContainerBottomPadding=null,this.keycapRegistry={},this._shiftPressCount=0,this.isSandbox=!1;var e;this.targetOrigin=window.origin,this.originValidator="none",this._alphabeticLayout="auto",this._layouts=Object.freeze(["default"]),this._editToolbar="default",this._container=void 0,this._visible=!1,this._rebuilding=!1,this.observer=new ResizeObserver(n=>{this.adjustBoundingRect(),this.dispatchEvent(new Event("geometrychange")),this.sendMessage("geometry-changed",{boundingRect:this.boundingRect})}),this.listeners={};try{(e=window.top)==null||e.addEventListener("message",this)}catch{window.addEventListener("message",this)}J3()&&document.addEventListener("focusin",n=>{let r=n.target;r!=null&&r.isConnected&&setTimeout(()=>{let i=cv();i&&i.mathVirtualKeyboardPolicy==="auto"&&i.hasEditableContent&&this.show({animate:!0})},300)}),document.addEventListener("focusout",n=>{n.target instanceof Go&&n.target.mathVirtualKeyboardPolicy!=="manual"&&setTimeout(()=>{cv()||this.hide()},300)})}get currentLayer(){var e,n,r;return(r=(n=(e=this._element)==null?void 0:e.querySelector(".MLK__layer.is-visible"))==null?void 0:n.id)!=null?r:""}set currentLayer(e){var n;if(!this._element){this.latentLayer=e;return}let r=e?this._element.querySelector(`#${e}.MLK__layer`):null;r||(r=this._element.querySelector(".MLK__layer")),r&&((n=this._element.querySelector(".MLK__layer.is-visible"))==null||n.classList.remove("is-visible"),r.classList.add("is-visible")),this.render()}get shiftPressCount(){return this._shiftPressCount}set shiftPressCount(e){var n;this._shiftPressCount=e>2||e<0?0:e,(n=this._element)==null||n.classList.toggle("is-caps-lock",this.shiftPressCount===2),this.render()}get isShifted(){return this._shiftPressCount>0}resetKeycapRegistry(){this.keycapRegistry={}}registerKeycap(e){let n="ML__k"+Date.now().toString(36).slice(-2)+Math.floor(Math.random()*1e5).toString(36);return this.keycapRegistry[n]=e,n}setKeycap(e,n){$r[e]=d0(n),this.rebuild()}getKeycap(e){var n;return e?(n=$r[e])!=null?n:this.keycapRegistry[e]:void 0}getLayer(e){let n=this.normalizedLayouts;for(let r of n)for(let i of r.layers)if(i.id===e)return i}get alphabeticLayout(){return this._alphabeticLayout}set alphabeticLayout(e){this._alphabeticLayout=e,this._normalizedLayouts=void 0,this.rebuild()}get layouts(){return this._layouts}set layouts(e){this.updateNormalizedLayouts(e),this.rebuild()}updateNormalizedLayouts(e){let n=Array.isArray(e)?[...e]:[e],r=n.findIndex(i=>i==="default");r>=0&&n.splice(r,1,"numeric","symbols","alphabetic","greek"),this._layouts=Object.freeze(n),this._normalizedLayouts=n.map(i=>w5(i))}get normalizedLayouts(){return this._normalizedLayouts||this.updateNormalizedLayouts(this._layouts),this._normalizedLayouts}get editToolbar(){return this._editToolbar}set editToolbar(e){this._editToolbar=e,this.rebuild()}get container(){return this._container===void 0?window.document.body:this._container}set container(e){this._container=e,this.rebuild()}static get singleton(){if(this._singleton===void 0)try{this._singleton=new k5}catch{this._singleton=null}return this._singleton}get style(){return this._style}addEventListener(e,n,r){this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].has(n)||this.listeners[e].add(n)}dispatchEvent(e){return!this.listeners[e.type]||this.listeners[e.type].size===0?!0:(this.listeners[e.type].forEach(n=>{typeof n=="function"?n(e):n?.handleEvent(e)}),!e.defaultPrevented)}removeEventListener(e,n,r){this.listeners[e]&&this.listeners[e].delete(n)}get element(){return this._element}set element(e){var n;this._element!==e&&((n=this._element)==null||n.remove(),this._element=e)}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get boundingRect(){var e;if(!this._visible)return new DOMRect;let n=(e=this._element)==null?void 0:e.getElementsByClassName("MLK__plate")[0];return n?n.getBoundingClientRect():new DOMRect}adjustBoundingRect(){if(!this._element)return;let e=this.boundingRect.height;if(this.container===document.body){this._element.style.setProperty("--_keyboard-height",`calc(${e}px + var(--_padding-top) + var(--_padding-bottom) + env(safe-area-inset-bottom, 0))`);let n=e-1;this.container.style.paddingBottom=this.originalContainerBottomPadding?`calc(${this.originalContainerBottomPadding} + ${n}px)`:`${n}px`}else this._element.style.setProperty("--_keyboard-height",`${e}px`)}rebuild(){if(this._rebuilding||!this._element)return;this._rebuilding=!0;let e=this.currentLayer;requestAnimationFrame(()=>{this._rebuilding=!1,this._element&&(this._element.remove(),this._element=void 0),this.visible&&(this.buildAndAttachElement(),this.currentLayer=e,this.render(),this.adjustBoundingRect(),this._element.classList.add("is-visible"))})}render(){var e;if(!this._element)return;let n=this.getLayer(this.currentLayer);this._element.classList.toggle("backdrop-is-transparent",!!(n&&(n.backdrop||n.container)));let r=this._element.querySelectorAll(".MLK__layer.is-visible .MLK__keycap, .MLK__layer.is-visible .action, .fnbutton, .MLK__layer.is-visible .bigfnbutton, .MLK__layer.is-visible .shift");if(!r)return;let i=this.isShifted;for(let o of r){let s=this.getKeycap(o.id);if(s){let[a,l]=sh(s,{shifted:i});o.innerHTML=globalThis.MathfieldElement.createHTML(a),o.className=l,i&&typeof s.shift=="object"&&(e=s.shift)!=null&&e.tooltip?o.dataset.tooltip=s.shift.tooltip:!i&&s.tooltip&&(o.dataset.tooltip=s.tooltip)}}}show(e){var n;if(this._visible)return;let r=this.container;if(r&&window.mathVirtualKeyboard&&this.stateWillChange(!0)){if(this._element||(this.buildAndAttachElement(),this.adjustBoundingRect()),!this._visible){let i=this._element.getElementsByClassName("MLK__plate")[0];if(i&&this.observer.observe(i),r===window.document.body){let o=r.style.paddingBottom;this.originalContainerBottomPadding=o;let s=i.offsetHeight-1;r.style.paddingBottom=o?`calc(${o} + ${s}px)`:`${s}px`}window.addEventListener("mouseup",this),window.addEventListener("blur",this),window.addEventListener("keydown",this,{capture:!0}),window.addEventListener("keyup",this,{capture:!0}),(n=this._element)==null||n.classList.toggle("is-caps-lock",this.shiftPressCount===2),this.currentLayer=this.latentLayer}this._visible=!0,e!=null&&e.animate?requestAnimationFrame(()=>{this._element&&(this._element.classList.add("animate"),this._element.addEventListener("transitionend",()=>{var i;return(i=this._element)==null?void 0:i.classList.remove("animate")},{once:!0}),this._element.classList.add("is-visible"),this.stateChanged())}):(this._element.classList.add("is-visible"),this.stateChanged())}}hide(e){var n;let r=this.container;if(r&&this._visible&&this.stateWillChange(!1)){if(this._visible=!1,this._element){this.latentLayer=this.currentLayer;let i=this._element.getElementsByClassName("MLK__plate")[0];i&&this.observer.unobserve(i),window.removeEventListener("mouseup",this),window.removeEventListener("blur",this),window.removeEventListener("keydown",this,{capture:!0}),window.removeEventListener("keyup",this,{capture:!0}),window.removeEventListener("contextmenu",this,{capture:!0}),Bs(),kA(),(n=this._element)==null||n.remove(),this._element=void 0,this.originalContainerBottomPadding!==null&&(r.style.paddingBottom=this.originalContainerBottomPadding)}this.stateChanged()}}get height(){var e,n;return(n=(e=this.element)==null?void 0:e.offsetHeight)!=null?n:0}buildAndAttachElement(){var e;this.element,this.element=_A(this),window.addEventListener("contextmenu",this,{capture:!0}),this.element.addEventListener("contextmenu",n=>{n.shiftKey||((n.ctrlKey||n.button===2)&&x5(n.target),n.preventDefault(),n.stopPropagation())},{capture:!0}),(e=this.container)==null||e.appendChild(this.element)}handleEvent(e){if(c0(e)){if(!n0(e.origin,this.originValidator))throw new DOMException(`Message from unknown origin (${e.origin}) cannot be handled`,"SecurityError");if(e.data.action==="disconnect"){if(this._visible)return;this.connectedMathfieldWindow=void 0}else e.data.action!=="update-setting"&&e.data.action!=="proxy-created"&&e.data.action!=="execute-command"&&(e.source,this.connectedMathfieldWindow=e.source);this.handleMessage(e.data,e.source)}if(this._element)switch(e.type){case"mouseup":case"blur":document.body.style.userSelect="",this.shiftPressCount=0;break;case"contextmenu":e.button!==2&&e.preventDefault();break;case"keydown":{e.key==="Shift"&&!e.repeat&&(this.shiftPressCount=1);break}case"keyup":{(e.key==="Shift"||!e.getModifierState("Shift")&&this.shiftPressCount!==2)&&(this.shiftPressCount=0);break}}}handleMessage(e,n){let{action:r}=e;if(r==="execute-command"){let{command:i}=e,o=$s(i);if(window===window.top&&n!==window||window===window.top&&o!=="virtual-keyboard")return;this.executeCommand(i);return}if((r==="connect"||r==="show")&&this.sendMessage("synchronize-proxy",{boundingRect:this.boundingRect,alphabeticLayout:this._alphabeticLayout,layouts:this._layouts,editToolbar:this._editToolbar},n),r!=="disconnect"&&!this.isSandbox){if(r==="show"){typeof e.animate<"u"?this.show({animate:e.animate}):this.show();return}if(r==="hide"){typeof e.animate<"u"?this.hide({animate:e.animate}):this.hide();return}if(r==="update-setting"){if(e.alphabeticLayout&&(this.alphabeticLayout=e.alphabeticLayout),e.layouts&&(this.layouts=e.layouts),e.editToolbar&&(this.editToolbar=e.editToolbar),e.setKeycap){let{keycap:i,value:o}=e.setKeycap;this.setKeycap(i,o),this.render()}return}if(r==="proxy-created"){this.sendMessage("synchronize-proxy",{boundingRect:this.boundingRect,alphabeticLayout:this._alphabeticLayout,layouts:this._layouts,editToolbar:this._editToolbar},n);return}}}sendMessage(e,n,r){if(n.command&&this.dispatchEvent(new CustomEvent("math-virtual-keyboard-command",{detail:n.command})),r||(r=this.connectedMathfieldWindow),this.targetOrigin===null||this.targetOrigin==="null"||r===window){window.dispatchEvent(new MessageEvent("message",{source:window,origin:window.origin,data:O({type:Sd,action:e},n)}));return}if(r)r.postMessage(O({type:Sd,action:e},n),{targetOrigin:this.targetOrigin});else if(e==="execute-command"&&Array.isArray(n.command)&&n.command[0]==="insert"){let i=n.command[1].split("");for(let o of i)this.dispatchEvent(new KeyboardEvent("keydown",{key:o,bubbles:!0})),this.dispatchEvent(new KeyboardEvent("keyup",{key:o,bubbles:!0}))}}stateWillChange(e){return this.dispatchEvent(new CustomEvent("before-virtual-keyboard-toggle",{detail:{visible:e},bubbles:!0,cancelable:!0,composed:!0}))}stateChanged(){this.dispatchEvent(new Event("virtual-keyboard-toggle")),this._visible||(this.dispatchEvent(new Event("geometrychange")),this.sendMessage("geometry-changed",{boundingRect:this.boundingRect}))}focus(){this.sendMessage("focus",{})}blur(){this.sendMessage("blur",{})}updateToolbar(e){let n=this._element;if(!n)return;n.classList.toggle("is-math-mode",e.mode==="math"),n.classList.toggle("is-text-mode",e.mode==="text"),n.classList.toggle("can-undo",e.canUndo),n.classList.toggle("can-redo",e.canRedo),n.classList.toggle("can-copy",!e.selectionIsCollapsed),n.classList.toggle("can-cut",!e.selectionIsCollapsed),n.classList.toggle("can-paste",!0);let r=n.querySelectorAll(".ML__edit-toolbar");if(r)for(let i of r)i.innerHTML=bA(this,e)}update(e){this._style=e.style,this.updateToolbar(e)}connect(){this.connectedMathfieldWindow=window}disconnect(){this._visible||(this.connectedMathfieldWindow=void 0)}executeCommand(e){if(e=kl(e),!e)return!1;let n,r=[],i=$s(e);return Ht(e)?(n=e[0],n==="performWithFeedback"&&(i=$s(e.slice(1))),r=e.slice(1)):n=e,i==="virtual-keyboard"?kr[n].fn(void 0,...r):(this.sendMessage("execute-command",{command:e}),!1)}dispose(){window.removeEventListener("mouseup",this),window.removeEventListener("blur",this),window.removeEventListener("message",this)}};function cv(){let t=wd(),e=null;for(;t;){if("host"in t&&t.host instanceof Go){e=t.host;break}t=t.parentNode}return e}Xn()&&!("mathVirtualKeyboard"in window)&&(window===window.top?S5():Object.defineProperty(window,"mathVirtualKeyboard",{get:()=>sA.singleton,configurable:!0}));function S5(){let t=Zi.singleton;return window.mathVirtualKeyboard!==t&&Object.defineProperty(window,"mathVirtualKeyboard",{get:()=>t}),t}function _d(t){let e={};for(let n of Object.keys(t))switch(n){case"scriptDepth":let r=t.scriptDepth;if(Ht(r))e.scriptDepth=[r[0],r[1]];else if(typeof r=="number")e.scriptDepth=[r,r];else if(typeof r=="string"){let[o,s]=r.split(",").map(a=>parseInt(a.trim()));e.scriptDepth=[o,s]}else throw new TypeError("Unexpected value for scriptDepth");break;case"mathVirtualKeyboardPolicy":let i=t.mathVirtualKeyboardPolicy.toLowerCase();if(i==="sandboxed"){let o=S5();o&&(o.isSandbox=!0),i="manual"}e.mathVirtualKeyboardPolicy=i;break;case"letterShapeStyle":t.letterShapeStyle==="auto"?qe.locale.startsWith("fr")?e.letterShapeStyle="french":e.letterShapeStyle="tex":e.letterShapeStyle=t.letterShapeStyle;break;case"defaultMode":["text","math","inline-math"].includes(t.defaultMode)?e.defaultMode=t.defaultMode:(console.error('MathLive 0.108.2:  valid values for defaultMode are "text", "math" or "inline-math"'),e.defaultMode="math");break;case"macros":e.macros=fd(t.macros);break;default:Ht(t[n])?e[n]=[...t[n]]:typeof t[n]=="object"&&!(t[n]instanceof Element)&&n!=="computeEngine"?e[n]=O({},t[n]):e[n]=t[n]}return e}function _o(t,e){let n;typeof e=="string"?n=[e]:e===void 0?n=Object.keys(t):n=e;let r={};for(let i of n)t[i]===null?r[i]=null:Ht(t[i])?r[i]=[...t[i]]:typeof t[i]=="object"&&!(t[i]instanceof Element)&&i!=="computeEngine"?r[i]=O({},t[i]):r[i]=t[i];return typeof e=="string"?r[e]:r}function mc(){return{readOnly:!1,defaultMode:"math",macros:{},registers:{},colorMap:Ud,backgroundColorMap:Um,letterShapeStyle:qe.locale.startsWith("fr")?"french":"tex",minFontScale:0,maxMatrixCols:10,smartMode:!1,smartFence:!0,smartSuperscript:!0,scriptDepth:[1/0,1/0],removeExtraneousParentheses:!0,isImplicitFunction:t=>["\\sin","\\cos","\\tan","\\arcsin","\\arccos","\\arctan","\\arcsec","\\arccsc","\\arsinh","\\arcosh","\\artanh","\\arcsech","\\arccsch","\\arg","\\ch","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\sec","\\sinh","\\sh","\\tanh","\\tg","\\th","\\lg","\\lb","\\log","\\ln"].includes(t),mathModeSpace:"",placeholderSymbol:"",contentPlaceholder:"",popoverPolicy:"auto",environmentPopoverPolicy:"off",keybindings:OC,inlineShortcuts:mx,inlineShortcutTimeout:0,mathVirtualKeyboardPolicy:"auto",originValidator:"none",onInsertStyle:l0,onInlineShortcut:()=>"",onScrollIntoView:null,onExport:BC,value:""}}function dv(t){return t.defaultMode==="inline-math"?"math":t.defaultMode}function DA(t,e){let n=t.at(t.position);if(n.type==="composition")n.value=e;else{let{caret:r}=n;n.caret=void 0;let i=new Ox(e,{mode:n.mode});i.caret=r,n.parent.addChildAfter(i,n),t.position+=1}}function LA(t){let e=t.at(t.position);e.type==="composition"&&(e.parent.removeChild(e),t.position-=1)}function TA(t){let e=t.at(t.position);for(;e&&!Yr(e.parentBranch);)e=e.parent;return[e.firstSibling,e.lastSibling]}function BA(t,e){let n=t.at(t.position);for(;n&&!(n.parent instanceof He);)n=n.parent;if(n?.type==="array"&&n.environmentName,!n||!(n.parent instanceof He)){let r=t.at(t.position);if(n=r,!n.parent.parent){let i=t.extractAtoms([t.position,t.lastOffset]),o=t.extractAtoms([0,t.position]),s;return e.endsWith("column")?(o.length===0&&(o=Vu()),i.length===0&&(i=Vu()),s=Dn("split",[[o,i]]),t.root=s,_a(s,0,0)?vs(t,s,0,0):_a(s,0,1)?vs(t,s,0,1):t.position=t.offsetOf(r)):(s=Dn("lines",[[o],[i]]),t.root=s,vs(t,s,1,0)),[void 0,[0,0]]}if(n.parent instanceof kt){let i=n.parent,o=t.extractAtoms([t.position,t.offsetOf(i.lastChild)]),s=t.extractAtoms([t.offsetOf(i.firstChild),t.position]);s.length===0&&(s=Vu()),o.length===0&&(o=Vu());let a="pmatrix",l=i.leftDelim,u=i.rightDelim;l==="("&&(u===")"||u==="?")?a="pmatrix":(l==="["||l==="\\lbrack")&&(u==="]"||u==="\\rbrack"||u==="?")?a="bmatrix":l==="\\vert"&&u==="\\vert"?a="vmatrix":l==="\\Vert"&&u==="\\Vert"?a="Vmatrix":(l==="{"||l==="\\lbrace")&&(u==="."||u==="?")&&(a="cases");let c=Dn(a,e.endsWith("column")?[[s,o]]:[[s],[o]]);return i.parent.addChildBefore(c,i),i.parent.removeChild(i),_a(c,0,0)?vs(t,c,0,0):e.endsWith("column")?_a(c,0,1)?vs(t,c,0,1):t.position=t.offsetOf(n):_a(c,1,0)?vs(t,c,1,0):t.position=t.offsetOf(n),[void 0,[0,0]]}}return n&&n.parent instanceof He?[n.parent,n.parentBranch]:[void 0,[0,0]]}function _a(t,e,n){let r=t.getCell(e,n);return r?.length!==2?!1:r[1].type==="placeholder"}function OA(t,e,n,r){let i=e.getCell(n,r);return i?[t.offsetOf(i[0]),t.offsetOf(i[i.length-1])]:-1}function vs(t,e,n,r){let i=OA(t,e,n,r);typeof i!="number"&&t.setSelection(i)}function qu(t,e,n,r,i){let o=e.getCell(n,r);o&&t.setPositionHandlingPlaceholder(t.offsetOf(o[i==="start"?0:o.length-1]))}function Sl(t,e){let[n,[r,i]]=BA(t,e);if(n)switch(e){case"after row":n.addRowAfter(r),qu(t,n,r+1,0,"end");break;case"after column":if(n.maxColumns<=n.colCount){t.announce("plonk");return}n.addColumnAfter(i),qu(t,n,r,i+1,"end");break;case"before row":n.addRowBefore(r),qu(t,n,r,0,"start");break;case"before column":if(n.maxColumns<=n.colCount){t.announce("plonk");return}n.addColumnBefore(i),qu(t,n,r,i,"start");break}}function _5(t){var e;let n=t.at(t.position);if(!Yr(n.parentBranch)&&n.parent!==t.root&&t.root.type!=="root")return t.announce("plonk"),!1;if(!t.contentWillChange({inputType:"insertText"}))return!1;if((e=t.parentEnvironment)!=null&&e.isMultiline){t.selectionIsCollapsed||t.deleteAtoms(en(t.selection));let[r,i]=TA(t),o=t.extractAtoms([t.position,t.offsetOf(i)]),s=t.extractAtoms([t.offsetOf(r),t.position]),a=r.parent,[l,u]=r.parentBranch;return a.setCell(l,u,s),Sl(t,"after row"),a.setCell(l+1,u,o),t.position=t.offsetOf(a.getCell(l+1,u)[0]),t.contentDidChange({inputType:"insertText"}),!0}return Sl(t,"after row"),t.contentDidChange({inputType:"insertText"}),!0}function NA(t){return t.contentWillChange({inputType:"insertText"})?(Sl(t,"before row"),t.contentDidChange({inputType:"insertText"}),!0):!1}function M5(t){return t.contentWillChange({inputType:"insertText"})?(Sl(t,"after column"),t.contentDidChange({inputType:"insertText"}),!0):!1}function PA(t){return t.contentWillChange({inputType:"insertText"})?(Sl(t,"before column"),t.contentDidChange({inputType:"insertText"}),!0):!1}function C5(t,e){if(!t.contentWillChange({}))return!1;t.mathfield.snapshot();let n=".",r=".";switch(e){case"pmatrix":case"pmatrix*":n="(",r=")";break;case"bmatrix":case"bmatrix*":n="[",r="]";break;case"Bmatrix":case"Bmatrix*":n="\\lbrace",r="\\rbrace";break;case"vmatrix":case"vmatrix*":n="\\vert",r="\\vert";break;case"Vmatrix":case"Vmatrix*":n="\\Vert",r="\\Vert";break;case"matrix":case"matrix*":n=".",r=".";break;case"cases":case"dcases":n="\\lbrace";break;case"rcases":r="\\rbrace";break}let i=t.at(t.position),o=i.type==="array"?i:t.parentEnvironment;return o.environmentName=e,o.leftDelim=n,o.rightDelim=r,t.contentDidChange({}),!0}function E5(t,e){let n=t.at(t.position);for(;n&&!(Array.isArray(n.parentBranch)&&n.parent instanceof He);)n=n.parent;if(Array.isArray(n?.parentBranch)&&n?.parent instanceof He){let r=n.parent,i=n.parentBranch,o;switch(e){case"row":if(r.rowCount>1){r.removeRow(i[0]);let s=r.getCell(Math.max(0,i[0]-1),i[1]);o=t.offsetOf(s[s.length-1])}break;case"column":if(r.colCount>r.minColumns){r.removeColumn(i[1]);let s=r.getCell(i[0],Math.max(0,i[1]-1));o=t.offsetOf(s[s.length-1])}break}o!==void 0&&t.setPositionHandlingPlaceholder(o)}}function IA(t){return t.contentWillChange({inputType:"deleteContent"})?(E5(t,"row"),t.contentDidChange({inputType:"deleteContent"}),!0):!1}function RA(t){return t.contentWillChange({inputType:"deleteContent"})?(E5(t,"column"),t.contentDidChange({inputType:"deleteContent"}),!0):!1}ln({addRowAfter:_5,addColumnAfter:M5,addRowBefore:NA,addColumnBefore:PA,removeRow:IA,removeColumn:RA,setEnvironment:C5},{target:"model",canUndo:!0,changeContent:!0,changeSelection:!0});function Vu(){return[new ur]}var A5=class D5{constructor(e){this.recording=!1,this.model=e,this.reset()}reset(){this.stack=[],this.index=-1,this.lastOp=""}startRecording(){this.recording=!0}stopRecording(){this.recording=!1}canUndo(){return this.index-1>=0}canRedo(){return this.stack.length-1>this.index}stopCoalescing(e){e&&this.index>=0&&(this.stack[this.index].selection=e),this.lastOp=""}undo(){if(!this.canUndo())return!1;let e=this.stack[this.index-1];return this.index-=1,this.lastOp="",this.model.setState(e,{silenceNotifications:!1,type:"undo"}),!0}redo(){if(!this.canRedo())return!1;let e=this.stack[this.index+1];return this.index+=1,this.lastOp="",this.model.setState(e,{silenceNotifications:!1,type:"redo"}),!0}pop(){this.canUndo()&&(this.stack.splice(this.index,this.stack.length-this.index),this.index-=1)}snapshot(e){return this.recording?(e&&e===this.lastOp&&this.pop(),this.stack.splice(this.index+1,this.stack.length-this.index-1),this.stack.push(this.model.getState()),this.index+=1,this.stack.length>D5.maximumDepth&&(this.stack.shift(),this.index-=1),this.lastOp=e??"",!0):!1}};A5.maximumDepth=1e3;var zA=A5;function nl(t,e,n,r){var i,o,s,a,l,u;let c=n.parent;if(Yr(r)&&n instanceof He&&n.isMultiline&&KA(t,n,r[0],e))return!0;if(c&&n instanceof kt){let d=!r&&e==="forward"||r==="body"&&e==="backward",p=d?t.offsetOf(n.firstChild):t.offsetOf(n.lastChild);return d?n.rightDelim!=="?"&&n.rightDelim!=="."?(n.leftDelim=".",n.isDirty=!0):(c.addChildrenAfter(n.removeBranch("body"),n),c.removeChild(n),p--):n.leftDelim!=="?"&&n.leftDelim!=="."?(n.rightDelim=".",n.isDirty=!0):(c.addChildrenAfter(n.removeBranch("body"),n),c.removeChild(n),p--),t.position=p,!0}if(c&&n.type==="surd"){if(e==="forward"&&!r||e==="backward"&&r==="body"){let d=n.leftSibling;n.hasChildren&&c.addChildrenAfter(n.removeBranch("body"),n),c.removeChild(n),t.position=t.offsetOf(d)}else e==="forward"&&r==="body"?t.position=t.offsetOf(n):!r&&e==="backward"?n.hasChildren?t.position=t.offsetOf(n.lastChild):(t.position=Math.max(0,t.offsetOf(n)-1),c.removeChild(n)):r==="above"&&(n.hasEmptyBranch("above")&&n.removeBranch("above"),e==="backward"?t.position=t.offsetOf(n.leftSibling):t.position=t.offsetOf(n.body[0]));return!0}if(c&&(n.type==="box"||n.type==="enclose")){let d=r&&e==="backward"||!r&&e==="forward"?n.leftSibling:n.lastChild;return c.addChildrenAfter(n.removeBranch("body"),n),c.removeChild(n),t.position=t.offsetOf(d),!0}if(n.type==="genfrac"||n.type==="overunder"){if(!r)return n.type==="overunder"&&n.hasEmptyBranch("body")||n.type==="genfrac"&&n.hasEmptyBranch("below")&&n.hasEmptyBranch("above")?!1:(t.position=t.offsetOf(e==="forward"?n.firstChild:n.lastChild),!0);let d=Go.fractionNavigationOrder==="numerator-denominator"?"above":"below",p=d==="above"?"below":"above";if(c&&(e==="forward"&&r===d||e==="backward"&&r===p)){let f=n.removeBranch(d),g=n.removeBranch(p);return c.addChildrenAfter([...f,...g],n),c.removeChild(n),t.position=t.offsetOf(f.length>0?f[f.length-1]:g[0]),!0}return e==="backward"?t.position=t.offsetOf(n.leftSibling):t.position=t.offsetOf(n),!0}if(n.type==="extensible-symbol"||n.type==="subsup"||n.type==="operator"){if(!r&&e==="forward")return!1;if(!r){if(n.subscript||n.superscript){let d=e==="forward"?(s=(i=n.superscript)==null?void 0:i[0])!=null?s:(o=n.subscript)==null?void 0:o[0]:(u=(a=n.subscript)==null?void 0:a[0].lastSibling)!=null?u:(l=n.superscript)==null?void 0:l[0].lastSibling;return d&&(t.position=t.offsetOf(d)),!0}return!1}if(!n.hasChildren&&n.type==="subsup"){let d=e==="forward"?t.offsetOf(n):Math.max(0,t.offsetOf(n)-1);return n.parent.removeChild(n),t.position=d,!0}if(r&&n.hasEmptyBranch(r)){if(n.removeBranch(r),n.type==="subsup"&&!n.subscript&&!n.superscript){let d=e==="forward"?t.offsetOf(n):Math.max(0,t.offsetOf(n)-1);return n.parent.removeChild(n),t.position=d,!0}return r==="superscript"&&e==="backward"?t.position=t.offsetOf(n.firstChild)-1:r==="subscript"&&e==="backward"?n.superscript?t.position=t.offsetOf(n.superscript[0].lastSibling):t.position=t.offsetOf(n.firstChild)-1:t.position=t.offsetOf(n),!0}if(r==="superscript")if(e==="backward"){let d=t.offsetOf(n.firstChild)-1;t.position=d}else n.subscript?t.position=t.offsetOf(n.subscript[0]):t.position=t.offsetOf(n);else r==="subscript"&&(e==="backward"&&n.superscript?t.position=t.offsetOf(n.superscript[0].lastSibling):e==="backward"?t.position=t.offsetOf(n.firstChild)-1:t.position=t.offsetOf(n));return!0}if(c?.type==="genfrac"&&!r&&n.type!=="first"){let d=t.offsetOf(n.leftSibling);return c.removeChild(n),c.hasEmptyBranch("above")&&c.hasEmptyBranch("below")?(d=t.offsetOf(c.leftSibling),c.parent.removeChild(c),t.announce("delete",void 0,[c]),t.position=d,!0):(t.announce("delete",void 0,[n]),t.position=d,!0)}if(e==="backward"&&(c?.command==="\\ln"||c?.command==="\\log")&&n.parentBranch!=="body"){let d=t.offsetOf(c.leftSibling);return c.parent.removeChild(c),t.announce("delete",void 0,[c]),t.position=d,!0}return!1}function FA(t){return!t.mathfield.isSelectionEditable||!t.contentWillChange({inputType:"deleteContentBackward"})?!1:t.selectionIsCollapsed?t.deferNotifications({content:!0,selection:!0,type:"deleteContentBackward"},()=>{let e=t.at(t.position);if(!(e&&nl(t,"backward",e))){if(e!=null&&e.isFirstSibling){if(nl(t,"backward",e.parent,e.parentBranch))return;e=null}if(!e){t.announce("plonk");return}t.position=t.offsetOf(e.leftSibling),e.parent.removeChild(e),t.announce("delete",void 0,[e]),t.root.hasEmptyBranch("body")&&t.mathfield.flushInlineShortcutBuffer()}}):Gr(t,en(t.selection),"deleteContentBackward")}function $A(t){return!t.mathfield.isSelectionEditable||!t.contentWillChange({inputType:"deleteContentForward"})?!1:t.selectionIsCollapsed?t.deferNotifications({content:!0,selection:!0,type:"deleteContentForward"},()=>{var e,n;let r=t.at(t.position).rightSibling;if(r&&nl(t,"forward",r))return;if(r){if(t.at(t.position).isLastSibling&&nl(t,"forward",r.parent,r.parentBranch))return}else{if(r=t.at(t.position),r.isLastSibling&&nl(t,"forward",r.parent,r.parentBranch))return;r=void 0}if(t.position===t.lastOffset||!r){t.announce("plonk");return}r.parent.removeChild(r);let i=(e=t.at(t.position))==null?void 0:e.rightSibling;for(;i?.type==="subsup";)i.parent.removeChild(i),i=(n=t.at(t.position))==null?void 0:n.rightSibling;t.announce("delete",void 0,[r]),t.root.hasEmptyBranch("body")&&t.mathfield.flushInlineShortcutBuffer()}):Gr(t,en(t.selection),"deleteContentForward")}function Gr(t,e,n){let r=t.getAtoms(e);if(r.length>0&&r[0].parent){let i=r[0];for(;i&&!(i instanceof He);)i=i.parent;let o=r[r.length-1];for(;o&&!(o instanceof He);)o=o.parent;if(i&&i instanceof He){let c=i;if(c&&o===c&&c.isMultiline){let[d,p]=[Math.min(t.position,t.anchor),Math.max(t.position,t.anchor)],[f,g]=t.at(d).parentBranch,[x,w]=t.at(p).parentBranch;if(x-f+1>=2)return t.deferNotifications({content:!0,selection:!0,type:n},()=>{var k;let D=c.getCell(f,g),N=c.getCell(x,w);if(!D||!N)return;t.extractAtoms([d,p]);let B=c.getCell(f,g);c.getCell(x,w);for(let R=x-1;R>f;R--)c.removeRow(R);if(f!==x){let R=c.getCell(f+1,g);if(B&&R){let L=[...B.filter(P=>P.type!=="first"),...R.filter(P=>P.type!=="first")];c.setCell(f,g,L),c.removeRow(f+1)}}let T=c.getCell(f,g);if(T){let R=B?B.filter(L=>L.type!=="first").length:0;t.position=t.offsetOf((k=T[R])!=null?k:T[0])}else t.position=d;c.isDirty=!0})}}let s=r[0].parent.firstChild;s.type==="first"&&(s=s.rightSibling);let a=r[r.length-1].parent.lastChild,l=r[0];l.type==="first"&&(l=l.rightSibling);let u=r[r.length-1];if(l===s&&u===a){let c=r[0].parent;c.parent&&c.type!=="prompt"&&(e=[t.offsetOf(c.leftSibling),t.offsetOf(c)])}if(r.length===1&&r[0].type==="placeholder"&&r[0].parent.type==="genfrac"){let c=r[0].parent,d=r[0].parentBranch==="below"?"above":"below",p=t.offsetOf(c.leftSibling);return t.deferNotifications({content:!0,selection:!0,type:n},()=>{var f,g;let x=c.removeBranch(d);if(x.length===1&&x[0].type==="placeholder")(g=c.parent)==null||g.removeChild(c),t.position=Math.max(0,p);else{let w=c.parent.addChildrenAfter(x,c);(f=c.parent)==null||f.removeChild(c),t.position=t.offsetOf(w)}})}}return t.deferNotifications({content:!0,selection:!0,type:n},()=>{let i=new Map;if(r.length>0){let s=r[0],a=r[r.length-1],l=new Set,u=s.parent;for(;u;)(u.type==="surd"||u.type==="box"||u.type==="enclose"||u.type==="leftright"||u.type==="genfrac"||u.type==="overunder")&&u.parent&&l.add(u),u=u.parent;let c=new Set;for(u=a.parent;u;)(u.type==="surd"||u.type==="box"||u.type==="enclose"||u.type==="leftright"||u.type==="genfrac"||u.type==="overunder")&&u.parent&&c.add(u),u=u.parent;for(let d of r)for(u=d.parent;u;){if((u.type==="surd"||u.type==="box"||u.type==="enclose"||u.type==="leftright"||u.type==="genfrac"||u.type==="overunder")&&u.parent){i.has(u)||i.set(u,{containsStart:l.has(u),containsEnd:c.has(u)});break}u=u.parent}}let o=Math.min(...e);t.deleteAtoms(e);for(let[s,a]of i){if(!s.parent)continue;let l=a.containsStart!==a.containsEnd;if(s.type==="surd"||s.type==="box"||s.type==="enclose"||s.type==="leftright"){let u=s.branch("body");if(!u||u.length===0||u.length===1&&u[0].type==="placeholder"){let c=t.offsetOf(s.leftSibling);s.parent.removeChild(s),t.position=Math.max(0,c)}else if(l&&!a.containsStart&&a.containsEnd){let c=t.offsetOf(s.leftSibling),d=s.removeBranch("body");d&&d.length>0&&s.parent.addChildrenAfter(d,s),s.parent.removeChild(s),t.position=Math.max(0,c)}}if(s.type==="genfrac"){let u=s.branch("above"),c=s.branch("below"),d=!u||u.length===0||u.length===1&&u[0].type==="placeholder",p=!c||c.length===0||c.length===1&&c[0].type==="placeholder";if(d&&p){let f=t.offsetOf(s.leftSibling);s.parent.removeChild(s),t.position=Math.max(0,f)}else if(d&&!p){let f=t.offsetOf(s.leftSibling),g=s.removeBranch("below");g&&g.length>0&&s.parent.addChildrenAfter(g,s),s.parent.removeChild(s),t.position=Math.max(0,f)}else if(!d&&p){let f=t.offsetOf(s.leftSibling),g=s.removeBranch("above");g&&g.length>0&&s.parent.addChildrenAfter(g,s),s.parent.removeChild(s),t.position=Math.max(0,f)}else if(l&&!a.containsStart&&a.containsEnd&&!d&&!p){let f=t.offsetOf(s.leftSibling),g=s.removeBranch("above");g&&g.length>0&&s.parent.addChildrenAfter(g,s),s.parent.removeChild(s),t.position=Math.max(0,f)}}}i.size===0&&(t.position=o),t.root.hasEmptyBranch("body")&&t.mathfield.flushInlineShortcutBuffer()})}function KA(t,e,n,r){if(!(e instanceof He)||!e.isMultiline||e.rows.length===1||e.rows[n].length>1)return!1;let i=e.getCell(n,0);if(!i)return!1;if(e.removeRow(n),r==="backward"){let o=e.getCell(n-1,0);if(!o)return t.position=t.offsetOf(e),!0;o.length>0?t.position=t.offsetOf(o[o.length-1]):t.position=t.offsetOf(e),e.setCell(n-1,0,[...o,...i])}else{let o=e.getCell(n,0);if(!o)return t.position=t.offsetOf(e),!0;o.length>0?t.position=t.offsetOf(o[0]):t.position=t.offsetOf(e),e.setCell(n,0,[...i,...o])}return!0}function jA(t,e,n){var r,i;if(t.at(e).mode!=="text")return e;let o=n==="backward"?-1:1,s;if(yl.test(t.at(e).value)){let a=e,l;do l=t.at(a).mode==="text"&&yl.test(t.at(a).value),a+=o;while(t.at(a)&&l);s=t.at(a)?a-2*o:a-o}else if(/\s/.test(t.at(e).value)){let a=e;for(;((r=t.at(a))==null?void 0:r.mode)==="text"&&/\s/.test(t.at(a).value);)a+=o;if(!t.at(a))s=a-o;else{let l=!0;do l=t.at(a).mode==="text"&&!/\s/.test(t.at(a).value),a+=o;while(t.at(a)&&l);s=t.at(a)?a-2*o:a-o}}else{let a=e;for(;((i=t.at(a))==null?void 0:i.mode)==="text"&&!/\s/.test(t.at(a).value);)a+=o;s=t.at(a)?a:a-o;let l=!0;for(;t.at(a)&&l;)l=t.at(a).mode==="text"&&/\s/.test(t.at(a).value),l&&(s=a),a+=o;s=t.at(a)?a-2*o:a-o}return s-(o>0?0:1)}function Ri(t,e,n){var r,i,o,s,a,l,u,c;let d=t.position;(r=n?.extend)!=null&&r||t.collapseSelection(e);let p=t.at(t.position);if(e==="forward"&&(p.type==="subsup"?(p=p.rightSibling,p||(p=t.at(t.position+1))):p=t.at(t.position+1)),!p)return t.announce("plonk"),!1;let f=t.offsetOf(p);if(p instanceof na)f=jA(t,f,e);else if(p instanceof qt)if(p.isSuggestion)for(;p&&p instanceof qt;)p.isSuggestion=!1,f=t.offsetOf(p),p=p.rightSibling;else if(e==="forward"){if(p=p.rightSibling,!p||!(p instanceof qt))return t.announce("plonk"),!1;for(;p&&p instanceof qt&&/[a-zA-Z\*]/.test(p.value);)f=t.offsetOf(p),p=p.rightSibling}else{if(p=p.leftSibling,!p||!(p instanceof qt))return t.announce("plonk"),!1;for(;p&&p instanceof qt&&/[a-zA-Z\*]/.test(p.value);)f=t.offsetOf(p),p=p.leftSibling}else if(e==="forward"&&p.type==="mopen"){let g=0;do p.type==="mopen"?g+=1:p.type==="mclose"&&(g-=1),p=p.rightSibling;while(!p.isLastSibling&&g!==0);f=t.offsetOf(p.leftSibling)}else if(e==="backward"&&p.type==="mclose"){let g=0;do p.type==="mopen"?g+=1:p.type==="mclose"&&(g-=1),p=p.leftSibling;while(!p.isFirstSibling&&g!==0);f=t.offsetOf(p)}else if(e==="backward")if(p.type==="first")for(;f>0&&p.type==="first";)f-=1,p=t.at(f);else{let g=p.type;p.type==="subsup"&&(f=t.offsetOf(t.at(f).leftSibling)),f-=1;let x=(i=t.at(f))==null?void 0:i.type;for(;f>=0&&x===g;)((o=t.at(f))==null?void 0:o.type)==="subsup"?f=t.offsetOf(t.at(f).leftSibling):f-=1,x=t.at(f).type}else{let{type:g}=p,x=(s=t.at(f))==null?void 0:s.type,{lastOffset:w}=t;for(;f<=w&&(x===g||x==="subsup");){for(;((a=t.at(f).rightSibling)==null?void 0:a.type)==="subsup";)f=t.offsetOf(t.at(f).rightSibling);f+=1,x=(l=t.at(f))==null?void 0:l.type}f-=1}if((u=n?.extend)!=null&&u){if(!t.setSelection(t.anchor,f))return t.announce("plonk"),!1;t.announce("move",d)}else{if(f===t.position)return t.announce("plonk"),!1;(c=n?.delete)!=null&&c?e==="forward"?Gr(t,[d,f],"deleteWordForward"):(Gr(t,[d,f],"deleteWordBackward"),t.position=f):(t.position=f,t.announce("move",d))}return t.mathfield.stopCoalescingUndo(),!0}function Sr(t,e,n){var r,i;if(n=n??{extend:!1},t.mathfield.styleBias=e==="backward"?"right":"left",e!=="forward"){let[a,l]=f5(t);a!==void 0&&l!==void 0&&t.deleteAtoms([a,l])}if(e==="upward")return VA(t,n);if(e==="downward")return HA(t,n);if(n.extend){let a=gc(t,t.position,e);a<0&&(a=0),a>t.lastOffset&&(a=t.lastOffset);let l=t.setSelection(t.anchor,a);return t.mathfield.stopCoalescingUndo(),l}if(t.selectionIsPlaceholder){t.collapseSelection(e);let a=Sr(t,e);return t.mathfield.stopCoalescingUndo(),a}let o=t.position,s=o;if(t.collapseSelection(e)?(o=t.position,L5(t,o)||(o=gc(t,o,e))):o=gc(t,o,e),o<0||o>t.lastOffset){let a=!0;return t.silenceNotifications||(a=(i=(r=t.mathfield.host)==null?void 0:r.dispatchEvent(new CustomEvent("move-out",{detail:{direction:e},cancelable:!0,bubbles:!0,composed:!0})))!=null?i:!0),a&&t.announce("plonk"),a}return t.setPositionHandlingPlaceholder(o),t.mathfield.stopCoalescingUndo(),t.announce("move",s),!0}function gc(t,e,n){return e=e+(n==="forward"?1:-1),e<0||e>t.lastOffset||L5(t,e)?e:gc(t,e,n)}function L5(t,e){var n;let r=t.at(e),i=r.parent;for(;i&&!i.inCaptureSelection;)i=i.parent;return!(i!=null&&i.inCaptureSelection||(n=r.parent)!=null&&n.skipBoundary&&(!r.isFirstSibling&&r.isLastSibling||r.type==="first")||t.mathfield.hasEditablePrompts&&!r.parentPrompt)}function qA(t,e,n){let r=1/0,i=0;for(;i<e.length;i++){let o=e[i],s=t.getHTMLElement(o);if(!s)continue;let a=xx(s).right,l=Math.abs(n-a);if(l<=r)r=l;else break}return e[i-1]}function Md(t,e,n,r,i){let o=t.mathfield.hasEditablePrompts,s=o?n.filter(u=>u.type==="prompt"&&!u.captureSelection):n,a=xx(t.mathfield.getHTMLElement(e)).right,l=t.offsetOf(qA(t.mathfield,s,a))-(o?1:0);if(r){let[u,c]=t.selection.ranges[0],d;l<(i==="up"?u:c)?d={ranges:[[l,c]],direction:"backward"}:d={ranges:[[u,l]],direction:"forward"},t.setSelection(d)}else t.setPositionHandlingPlaceholder(l);t.announce(`move ${i}`)}function VA(t,e){var n,r;let i=(n=e?.extend)!=null?n:!1;i||t.collapseSelection("backward");let o=()=>{var l,u;let c=!0;return t.silenceNotifications||(c=(u=(l=t.mathfield.host)==null?void 0:l.dispatchEvent(new CustomEvent("move-out",{detail:{direction:"upward"},cancelable:!0,bubbles:!0,composed:!0})))!=null?u:!0),t.announce(c?"line":"plonk"),c},s=t.at(t.position),a=s;for(;a&&a.parentBranch!=="below"&&!(Array.isArray(a.parentBranch)&&a.parent instanceof He);)a=a.parent;if(Array.isArray(a?.parentBranch)&&a.parent instanceof He){let l=a.parent;if(a.parentBranch[0]<1)return o();let u=a.parentBranch[0]-1,c=l.getCell(u,a.parentBranch[1]);if(!c.some(d=>d.type==="prompt"&&!d.captureSelection)&&t.mathfield.hasEditablePrompts)return o();Md(t,s,c,i,"up")}else if(a){let l=(r=a.parent.branch("above"))!=null?r:a.parent.createBranch("above");if(!l.some(u=>u.type==="prompt"&&u.placeholderId)&&t.mathfield.hasEditablePrompts)return o();Md(t,s,l,i,"up")}else return o();return t.mathfield.stopCoalescingUndo(),!0}function HA(t,e){var n,r;let i=(n=e?.extend)!=null?n:!1;i||t.collapseSelection("forward");let o=()=>{var l,u;let c=!0;return t.silenceNotifications||(c=(u=(l=t.mathfield.host)==null?void 0:l.dispatchEvent(new CustomEvent("move-out",{detail:{direction:"downward"},cancelable:!0,bubbles:!0,composed:!0})))!=null?u:!0),t.announce(c?"line":"plonk"),c},s=t.at(t.position),a=s;for(;a&&a.parentBranch!=="above"&&!(Yr(a.parentBranch)&&a.parent instanceof He);)a=a.parent;if(Yr(a?.parentBranch)&&a.parent instanceof He){let l=a.parent;if(a.parentBranch[0]+1>l.rows.length-1)return o();let u=a.parentBranch[0]+1,c=l.getCell(u,a.parentBranch[1]);if(!c.some(d=>d.type==="prompt"&&!d.captureSelection)&&t.mathfield.hasEditablePrompts)return o();Md(t,s,c,i,"down")}else if(a){let l=(r=a.parent.branch("below"))!=null?r:a.parent.createBranch("below");if(!l.some(u=>u.type==="prompt")&&t.mathfield.hasEditablePrompts)return o();Md(t,s,l,i,"down")}else return o();return!0}function T5(t){let e=t.position,n=t.at(e).parent;return n!=null&&n.parent?(t.position=t.offsetOf(n),t.mathfield.stopCoalescingUndo(),t.announce("move",e),!0):(t.announce("plonk"),!1)}function WA(t){let e=0,n=t.at(t.position),r=!1;for(;n;)n.hasEmptyBranch("superscript")?n.hasEmptyBranch("subscript")||(r=!1):(e+=1,r=!0),n=n.parent;return r?e:0}function UA(t){let e=0,n=t.at(t.position),r=!1;for(;n;)n.hasEmptyBranch("subscript")?n.hasEmptyBranch("superscript")||(r=!1):(e+=1,r=!0),n=n.parent;return r?e:0}function hv(t){if(t.collapseSelection(),WA(t)>=t.mathfield.options.scriptDepth[1])return t.announce("plonk"),!1;let e=t.at(t.position);if(e.subsupPlacement===void 0){let n=e.rightSibling;n?.type!=="subsup"&&(n=new eh({style:e.style}),e.parent.addChildAfter(n,e)),e=n}return e.createBranch("superscript"),t.setSelection(t.getSiblingsRange(t.offsetOf(e.superscript[0]))),!0}function pv(t){if(t.collapseSelection(),UA(t)>=t.mathfield.options.scriptDepth[0])return t.announce("plonk"),!1;let e=t.at(t.position);if(e.subsupPlacement===void 0){let n=e.rightSibling;n?.type!=="subsup"&&(n=new eh({style:e.style}),e.parent.addChildAfter(n,e)),e=n}return e.createBranch("subscript"),t.setSelection(t.getSiblingsRange(t.offsetOf(e.subscript[0]))),!0}function JA(){function t(l){let u=[],c=[];return[...l.querySelectorAll(`input, select, textarea, a[href], button,
        [tabindex], audio[controls], video[controls],
        [contenteditable]:not([contenteditable="false"]), details>summary`)].filter(e).forEach((d,p)=>{let f=r(d);f===0?u.push(d):c.push({documentOrder:p,tabIndex:f,node:d})}),c.sort((d,p)=>d.tabIndex===p.tabIndex?d.documentOrder-p.documentOrder:d.tabIndex-p.tabIndex).map(d=>d.node).concat(u)}function e(l){return!(!n(l)||i(l)||r(l)<0)}function n(l){return!(l.disabled||l.type==="hidden"&&l.tagName.toUpperCase()==="INPUT"||a(l))}function r(l){var u;let c=Number.parseInt((u=l.getAttribute("tabindex"))!=null?u:"NaN",10);return Number.isNaN(c)?l.contentEditable==="true"||(l.nodeName==="AUDIO"||l.nodeName==="VIDEO")&&l.getAttribute("tabindex")===null?0:l.tabIndex:c}function i(l){return l.tagName.toUpperCase()==="INPUT"&&l.type==="radio"&&!s(l)}function o(l,u){for(let c of l)if(c.checked&&c.form===u)return c;return null}function s(l){var u;if(!l.name)return!0;let c=((u=l.form)!=null?u:l.ownerDocument).querySelectorAll('input[type="radio"][name="'+l.name+'"]'),d=o(c,l.form);return!d||d===l}function a(l){if(!Xn()||l===document.activeElement||l.contains(document.activeElement))return!1;if(getComputedStyle(l).visibility==="hidden")return!0;let u=l.getBoundingClientRect();if(u.width===0||u.height===0)return!0;for(;l;){if(getComputedStyle(l).display==="none")return!0;l=l.parentElement}return!1}return Xn()?t(document.body):[]}function hn(t,e,n="forward"){let r=t.position;if(Ht(e)){let i=t.offsetOf(e[0]),o=t.offsetOf(e[e.length-1]);return n==="forward"?t.setSelection(i,o):t.setSelection(o,i),t.announce("move",r),t.mathfield.stopCoalescingUndo(),!0}return n==="forward"?hn(t,[e.leftSibling,e]):hn(t,[e,e.leftSibling])}function ir(t,e){let n=t.position;if(typeof e=="number"&&(e=t.at(e)),e.type==="prompt")t.setSelection(t.offsetOf(e.firstChild),t.offsetOf(e.lastChild));else{let r=t.offsetOf(e);e.type==="placeholder"?t.setSelection(r-1,r):t.position=r}return t.announce("move",n),t.mathfield.stopCoalescingUndo(),!0}function Ns(t,e){var n,r;let i=e==="forward"?1:-1;t.at(t.anchor).type==="placeholder"&&Sr(t,e);let o,s=t.at(t.anchor).parentPrompt;s?e==="forward"?o=t.offsetOf(s)+1:o=t.offsetOf(s.leftSibling):o=Math.max(t.position+i,0);let a=qf(t,o,e);if(!a||e==="forward"&&t.offsetOf(a)<o||e==="backward"&&t.offsetOf(a)>o){if(!((r=(n=t.mathfield.host)==null?void 0:n.dispatchEvent(new CustomEvent("move-out",{detail:{direction:e},cancelable:!0,bubbles:!0,composed:!0})))==null||r))return t.announce("plonk"),!1;let l=JA();if(!document.activeElement||l.length<=1)return t.announce("plonk"),!1;let u=l.indexOf(document.activeElement)+i;return u<0&&(u=l.length-1),u>=l.length&&(u=0),l[u].focus(),t.mathfield.stopCoalescingUndo(),!0}return ir(t,a),!0}function qf(t,e=0,n="forward"){return t.findAtom(r=>r.type==="placeholder"||r.type==="prompt"||!t.mathfield.readOnly&&r.treeDepth>2&&r.isFirstSibling&&r.isLastSibling,e,n)}ln({moveToOpposite:t=>{let e={superscript:"subscript",subscript:"superscript",above:"below",below:"above"},n=t.at(t.position),{parent:r}=n;if(!r)return t.announce("plonk"),!1;let i=n.parentBranch,o;if(typeof i=="string"&&(o=e[i]),!o){let a=n.subsupPlacement?pv(t):hv(t);return t.mathfield.stopCoalescingUndo(),a}r.branch(o)||r.createBranch(o);let s=t.setSelection(t.getBranchRange(t.offsetOf(r),o));return t.mathfield.stopCoalescingUndo(),s},moveBeforeParent:t=>{let{parent:e}=t.at(t.position);return e?(t.position=t.offsetOf(e),t.mathfield.stopCoalescingUndo(),!0):(t.announce("plonk"),!1)},moveAfterParent:t=>T5(t),moveToNextChar:t=>Sr(t,"forward"),moveToPreviousChar:t=>Sr(t,"backward"),moveUp:t=>Sr(t,"upward"),moveDown:t=>Sr(t,"downward"),moveToNextWord:t=>Ri(t,"forward"),moveToPreviousWord:t=>Ri(t,"backward"),moveToGroupStart:t=>{let e=t.offsetOf(t.at(t.position).firstSibling);return e===t.position?(t.announce("plonk"),!1):(t.position=e,t.mathfield.stopCoalescingUndo(),!0)},moveToGroupEnd:t=>{let e=t.offsetOf(t.at(t.position).lastSibling);return e===t.position?(t.announce("plonk"),!1):(t.position=e,t.mathfield.stopCoalescingUndo(),!0)},moveToNextGroup:t=>{var e,n,r,i;if(t.position===t.lastOffset&&t.anchor===t.lastOffset)return Ns(t,"forward");let o=t.at(t.position);if(o.mode==="text"){if(t.selectionIsCollapsed){let d=o;for(;d?.mode==="text";)d=d.leftSibling;let p=o;for(;((e=p.rightSibling)==null?void 0:e.mode)==="text";)p=p.rightSibling;if(d&&p)return hn(t,[d,p])}if(o.rightSibling.mode==="text"){let d=o;for(;d?.mode==="text";)d=d.rightSibling;return d?(ir(t,(n=d.leftSibling)!=null?n:d),t.mathfield.switchMode("math"),!0):ir(t,t.lastOffset)}}let s=t.at(t.anchor).parentPrompt,a=s?t.offsetOf(s)+1:Math.max(t.position+1,0),l=qf(t,a,"forward");if(l&&t.offsetOf(l)<a)return Ns(t,"forward");if(l)return ir(t,l);let u=fv(t,o,d=>d.type==="leftright"||d.type==="text","forward");if(u){if(u.mode==="text"){let d=u;for(;d?.mode==="text";)d=d.rightSibling;return hn(t,[(r=u.leftSibling)!=null?r:u,(i=d.leftSibling)!=null?i:d])}return hn(t,u)}let c=o.parent;if(c){if(c.type==="leftright"||c.type==="surd")return hn(t,c);if(o.parentBranch==="superscript"&&c.subscript)return hn(t,c.subscript);if(o.parentBranch==="above"&&c.below)return hn(t,c.below);if(o.parentBranch==="superscript"||o.parentBranch==="subscript")return ir(t,c);if(o.parentBranch==="above"||o.parentBranch==="below")return hn(t,c)}return ir(t,t.lastOffset)},moveToPreviousGroup:t=>{var e;if(t.position===0&&t.anchor===0)return Ns(t,"backward");let n=t.at(t.position),r=n.mode;if(r==="text"){if(t.selectionIsCollapsed){let a=n;for(;a?.mode==="text";)a=a.leftSibling;let l=n;for(;((e=l.rightSibling)==null?void 0:e.mode)==="text";)l=l.rightSibling;if(a&&l)return hn(t,[a,l])}for(;n?.mode==="text";)n=n.leftSibling;return n?ir(t,n):ir(t,0)}let i=t.at(t.anchor).parentPrompt,o=i?t.offsetOf(i.leftSibling):Math.max(t.position-1,0),s=qf(t,o,"backward");if(s&&t.offsetOf(s)>o)return Ns(t,"backward");if(s)return ir(t,s);if(r==="math"){let a=fv(t,n,u=>u.type==="leftright"||u.type==="text","backward");if(a){if(a.mode==="text"){let u=a;for(;u?.mode==="text";)u=u.leftSibling;return hn(t,[a,u])}return hn(t,a)}let l=n.parent;if(l){if(l.type==="leftright"||l.type==="surd")return hn(t,l);if(n.parentBranch==="subscript"&&l.superscript)return hn(t,l.superscript);if(n.parentBranch==="below"&&l.above)return hn(t,l.above);if(n.parentBranch==="superscript"||n.parentBranch==="subscript")return ir(t,l);if(n.parentBranch==="above"||n.parentBranch==="below")return hn(t,l)}return ir(t,0)}return!1},moveToMathfieldStart:t=>t.selectionIsCollapsed&&t.position===0?(t.announce("plonk"),!1):(t.position=0,t.mathfield.stopCoalescingUndo(),!0),moveToMathfieldEnd:t=>t.selectionIsCollapsed&&t.position===t.lastOffset?(t.announce("plonk"),!1):(t.position=t.lastOffset,t.mathfield.stopCoalescingUndo(),!0),moveToSuperscript:hv,moveToSubscript:pv},{target:"model",changeSelection:!0});ln({moveToNextPlaceholder:t=>Ns(t,"forward"),moveToPreviousPlaceholder:t=>Ns(t,"backward")},{target:"model",changeSelection:!0,audioFeedback:"return"});function fv(t,e,n,r){if(r==="forward"){let o=e.rightSibling;for(;o&&!n(o);)o=o.rightSibling;return o}let i=e.leftSibling;for(;i&&!n(i);)i=i.leftSibling;return i}function Hu(t,e,n){typeof e=="function"&&(n=e,e=1/0),e===void 0&&(e=1/0);let r=t.position,i=!1,o="";for(;!i;){let s=t.at(r);i=e===0||s===void 0||s.type==="first"||s.mode!=="math"||!(s.type&&/mord|mpunct|operator/.test(s.type)||s.type==="mop"&&/[a-zA-Z ]+/.test(s.value))||!s.hasEmptyBranch("superscript")||!s.hasEmptyBranch("subscript")||typeof n=="function"&&!n(s),i||(s.mode="text",s.command=s.value,s.verbatimLatex=void 0,o+=s.value),r-=1,e-=1}t.contentDidChange({data:o,inputType:"insertText"})}function Ma(t,e,n){typeof e=="function"&&(n=e,e=1/0),e===void 0&&(e=1/0);let r=t.position,i=!1,o=[];for(;!i;){let s=t.at(r);i=e===0||!s||s.type==="first"||s.isFirstSibling||s.mode!=="text"||s.value===" "||typeof n=="function"&&!n(s),i||(o.push(G.serialize([s],{defaultMode:"math"})),s.mode="math"),r-=1,e-=1}h0(t),t.contentDidChange({data:Fe(o),inputType:"insertText"})}function h0(t){var e;let n=t.position-1;for(;n>=0&&((e=t.at(n))==null?void 0:e.mode)==="math";)n-=1;if(!(n<0)&&t.at(n).mode==="text"&&t.at(n).value===" "&&t.at(n-1).mode==="math"){t.at(n-1).parent.removeChild(t.at(n-1));let r=t.silenceNotifications;t.silenceNotifications=!0,t.position-=1,t.silenceNotifications=r,t.contentDidChange({inputType:"deleteContent"})}}function GA(t){let e="",n=t.position,r=!1;for(;!r;){let i=t.at(n);r=!(i&&(i.mode==="text"||i.mode==="math"&&i.type&&/mord|mpunct/.test(i.type))),r||(e=i.value+e),n-=1}return e}function XA(t,e,n){let{model:r}=t;if(r.mode==="latex"||!r.at(r.position).isLastSibling||!n||!xl(n))return!1;let i=Es(n);if(!r.selectionIsCollapsed)return!!(t.model.mode==="text"&&/[/_^]/.test(i));let o=GA(r)+i;if(t.model.mode==="text"){if(e==="Esc"||/[/\\]/.test(i))return!0;if(/[\^_]/.test(i))return/(^|\s)[a-zA-Z][^_]$/.test(o)&&Ma(r,1),!0;let s={")":"(","}":"{","]":"["}[i],{parent:a}=r.at(r.position);if(s&&a instanceof kt&&a.leftDelim===s)return!0;if(/(^|[^a-zA-Z])(a|I) $/.test(o))return!1;if(/[$]/u.test(i))return!0;if(/(^|[^a-zA-Z'])[a-zA-Z] $/.test(o))return Ma(r,1),!1;if(/\D\.[^\d\s]$/.test(o)){Ma(r,1);let l=r.at(r.position);return l.value="",l.style.variant="normal",l.command="\\cdot",l.verbatimLatex=void 0,r.contentDidChange({data:"\\cdot",inputType:"insertText"}),!0}if(/(^|\s)[a-zA-Z][^a-zA-Z]$/.test(o)||/\.\d$/.test(o)||/\([\d+\-.]$/.test(o))return Ma(r,1),!0;if(/\([a-z][,;]$/.test(o))return Ma(r,2),!0;if(/[\d+\-=><*|]$/.test(i))return h0(r),!0}else{if(e==="[Space]")return Hu(r,void 0,s=>/[a-z][:,;.]$/.test(s.value)),!0;if(/[a-zA-Z]{3,}$/.test(o)&&!/(dxd|abc|xyz|uvw)$/.test(o))return Hu(r,void 0,s=>/[a-zA-Z]/.test(s.value)),!0;if(/(^|\W)(if)$/i.test(o))return Hu(r,1),!0;if(/(\u0393|\u0394|\u0398|\u039B|\u039E|\u03A0|\u03A3|\u03A5|\u03A6|\u03A8|\u03A9|[\u03B1-\u03C9]|\u03D1|\u03D5|\u03D6|\u03F1|\u03F5){3,}$/u.test(o)&&!/()$/.test(o))return Hu(r,void 0,s=>/(:|,|;|.|\u0393|\u0394|\u0398|\u039B|\u039E|\u03A0|\u03A3|\u03A5|\u03A6|\u03A8|\u03A9|[\u03B1-\u03C9]|\u03D1|\u03D5|\u03D6|\u03F1|\u03F5)/u.test(s.value)),!0;if(i==="?"||i==="."&&!/[\d-+]\.$/.test(o))return!0}return!1}function YA(t,e){if(!t.isSelectionEditable||!t.keystrokeCaptionVisible)return;let n=B5(),r=t.element.getBoundingClientRect();n.style.left=`${r.left}px`,n.style.top=`${r.top-64}px`,n.innerHTML=globalThis.MathfieldElement.createHTML("<span>"+(s0(e)||e)+"</span>"+n.innerHTML),n.style.visibility="visible",setTimeout(()=>{n.childNodes.length>0&&n.childNodes[n.childNodes.length-1].remove(),n.childNodes.length===0&&(n.style.visibility="hidden")},3e3)}function ZA(t){if(t.keystrokeCaptionVisible=!t.keystrokeCaptionVisible,t.keystrokeCaptionVisible){let e=B5();e.innerHTML=""}else{let e=rh("mathlive-keystroke-caption-panel");e.style.visibility="hidden"}return!1}function B5(){return document.getElementById("mathlive-keystroke-caption-panel")||(Ji("keystroke-caption"),Ji("core"),rh("mathlive-keystroke-caption-panel"))}function QA(){document.getElementById("mathlive-keystroke-caption-panel")&&(Nl("mathlive-keystroke-caption-panel"),Gi("core"),Gi("keystroke-caption"))}function O5(t,e){var n,r,i,o;let{model:s}=t,a=p5(e);if(e.isTrusted){zM(e);let w=ml();t.keyboardLayout!==w.id&&(t.keyboardLayout=w.id,t._keybindings=void 0)}if(clearTimeout(t.inlineShortcutBufferFlushTimer),t.inlineShortcutBufferFlushTimer=0,YA(t,a),e.isTrusted&&e.defaultPrevented)return t.flushInlineShortcutBuffer(),!1;let l,u=0,c="",d=0,p=t.inlineShortcutBuffer,f=!1;if(t.isSelectionEditable&&s.selectionIsPlaceholder&&xl(e)&&(t.flushInlineShortcutBuffer(),s.deleteAtoms(en(s.selection)),t.snapshot("delete"),f=!0),t.isSelectionEditable){if(s.mode==="math"&&(!s.selectionIsPlaceholder||f))if(a==="[Backspace]")t.undoManager.lastOp==="insert-shortcut"?c="undo":p.pop();else if(!xl(e))t.flushInlineShortcutBuffer();else{let w=Es(e),k=[...(r=(n=p[p.length-1])==null?void 0:n.keystrokes)!=null?r:[],w];p.push({state:s.getState(),keystrokes:k,leftSiblings:nD(t)}),u=0;let D="";for(;!l&&u<k.length;)d=p.length-(k.length-u),D=k.slice(u).join(""),l=e0(p[d].leftSiblings,D,t.options.inlineShortcuts),!l&&/^[a-zA-Z][a-zA-Z0-9]+?([_\^][a-zA-Z0-9\*\+\-]+?)?$/.test(D)&&(l=t.options.onInlineShortcut(t,D)),u+=1;t.flushInlineShortcutBuffer({defer:!0})}t.options.smartMode&&(l?t.switchMode("math"):XA(t,a,e)&&(t.switchMode({math:"text",text:"math"}[s.mode]),c=""))}if(!l){if(c||(c=$E(t.keybindings,s.mode,e)),!c&&(a==="[Enter]"||a==="[Return]")){let w=!0;return s.contentWillChange({inputType:"insertLineBreak"})&&(t.host&&(w=t.host.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))),!w&&e.preventDefault?(e.preventDefault(),e.stopPropagation()):((i=s.parentEnvironment)!=null&&i.isMultiline&&t.executeCommand("addRowAfter"),s.contentDidChange({inputType:"insertLineBreak"}))),w}if(a==="[Space]"&&s.mode==="latex"&&Yi(t,"accept-all"))return t.dirty=!0,t.scrollIntoView(),e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1;if((!c||a==="[Space]")&&s.mode==="math"){if(a==="[Space]"){if(t.styleBias="none",t.flushInlineShortcutBuffer(),t.options.mathModeSpace)return lt.insert(s,t.options.mathModeSpace,{format:"latex",mode:"math"}),t.snapshot("insert-space"),c="",t.dirty=!0,t.scrollIntoView(),e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!1;let w=s.at(s.position+1),k=s.at(s.position-1);if(w?.mode==="text"||k?.mode==="text")return lt.insert(s," ",{mode:"text"}),t.snapshot("insert-space"),t.dirty=!0,t.scrollIntoView(),!1}(o=s.at(s.position))!=null&&o.isDigit()&&globalThis.MathfieldElement.decimalSeparator===","&&Es(e)===","&&(c="insertDecimalSeparator")}}if(!l&&!c){if(s.mathfield.smartFence){if(Hf(s,Es(e),zo(t)))return t.dirty=!0,t.scrollIntoView(),e.preventDefault&&e.preventDefault(),!1}else{let{parent:w}=s.at(s.position);if(w instanceof kt&&w.rightDelim==="?"&&s.at(s.position).isLastSibling&&/^[)}\]|]$/.test(a))return t.snapshot(),w.isDirty=!0,w.rightDelim=a,s.position+=1,s.selectionDidChange(),s.contentDidChange({data:Es(e),inputType:"insertText"}),t.snapshot("insert-fence"),t.dirty=!0,t.scrollIntoView(),e.preventDefault&&e.preventDefault(),!1;if(!s.selectionIsCollapsed){let k=Es(e);if(k==="("||k==="{"||k==="["){let D={"(":"(","{":"\\lbrace","[":"\\lbrack"}[k],N={"(":")","{":"\\rbrace","[":"\\rbrack"}[k],[B,T]=en(s.selection);return t.snapshot(),s.position=T,lt.insert(s,N,{format:"latex"}),s.position=B,lt.insert(s,D,{format:"latex"}),s.setSelection(B+1,T+1),s.contentDidChange({data:k,inputType:"insertText"}),t.snapshot("insert-fence"),t.dirty=!0,t.scrollIntoView(),e.preventDefault&&e.preventDefault(),!1}}}return!0}let g=s.at(Math.max(s.position,s.anchor)),{parent:x}=g;if(c==="moveAfterParent"&&x?.type==="leftright"&&g.isLastSibling&&t.options.smartFence&&Hf(s,".",t.defaultStyle)&&(c="",vt(t)),t.keyboardDelegate.cancelComposition(),c)t.executeCommand(c);else if(l){let w=zo(t);s.setState(p[d].state);let k=p[p.length-1].keystrokes;k=k.slice(u-1);for(let D of k)lt.insert(s,D,{silenceNotifications:!0,style:w});t.snapshot("insert-shortcut"),s.setState(p[d].state),s.deferNotifications({content:!0,selection:!0,data:l,type:"insertText"},()=>(lt.insert(s,l,{format:"latex",style:w}),h0(t.model),l.endsWith(" ")&&(t.switchMode("text"),lt.insert(s," ",{style:w,mode:"text"})),t.snapshot(),s.selectionIsCollapsed||t.flushInlineShortcutBuffer(),!0)),t.dirty=!0,s.announce("replacement")}return t.scrollIntoView(),e.preventDefault&&e.preventDefault(),!1}function eD(t){var e,n;let{position:r}=t,i=r,o=[];for(;i>0;){let g=t.at(i),x=g.value;if(g.type==="mord"||g.type==="mbin"&&(x==="+"||x==="-"||x===""))o.unshift(g),i--;else break}if(o.length===0)return null;let s=o.map(g=>g.value).join(""),a=((n=(e=globalThis.MathfieldElement)==null?void 0:e.decimalSeparator)!=null?n:".")==="."?"\\.":",",l=new RegExp(`^(\\d+(?:${a}\\d*)?)[eE]([+\\-]?)(\\d+)$`),u=s.match(l);if(!u)return null;let c=u[1],d=u[2],p=u[3],f=d+p;return{startOffset:i,endOffset:r,significand:c,exponent:f}}function tD(t,e){var n;let r=(n=globalThis.MathfieldElement)==null?void 0:n.scientificNotationTemplate;if(!r||r===""||!r.includes("#1")||!r.includes("#2"))return null;let i=r.replace("#1",t);return i=i.replace("#2",e),i}function mv(t){let{model:e}=t;if(e.mode!=="math")return!1;let n=eD(e);if(!n)return!1;let r=tD(n.significand,n.exponent);return r?(e.deferNotifications({content:!0,selection:!0,type:"insertText"},()=>{e.selection={ranges:[[n.startOffset,n.endOffset]],direction:"forward"},lt.insert(e,r,{insertionMode:"replaceSelection",selectionMode:"after"})}),t.snapshot("format-scientific-notation"),t.dirty=!0,t.scrollIntoView(),!0):!1}function Vf(t,e,n){let{model:r}=t;if(!t.isSelectionEditable){r.announce("plonk");return}n!=null||(n={}),n.focus&&t.focus(),n.feedback&&globalThis.MathfieldElement.playSound("keypress"),typeof n.mode=="string"&&(t.switchMode(n.mode),t.snapshot());let i=ox(e),o=window.mathVirtualKeyboard;if(o!=null&&o.isShifted&&(i=typeof i=="string"?i.toUpperCase():i.map(s=>s.toUpperCase())),n.simulateKeystroke){let s=!0;for(let a of i)O5(t,new KeyboardEvent("keypress",{key:a}))&&(s=!1);if(s)return}if(r.mode==="latex"){if(r.deferNotifications({content:!0,selection:!0,data:e,type:"insertText"},()=>{nh(t);for(let s of i)lt.insert(r,s,{insertionMode:"replaceSelection"});t.snapshot("insert-latex"),Ol(t)}),e==="}"){let s=wl(r).map(l=>l.value).join(""),a=s.match(/^\\([a-zA-Z]+)/);if(a){let l="\\"+a[1],u=Vt(l,"math");if(u?.definitionType==="function"){let c=u.params.filter(d=>!d.isOptional).length;if(c>0){let d=0,p=0,f=!0;for(let g=0;g<s.length;g++){let x=s[g];if(f){if(x==="\\"||/[a-zA-Z]/.test(x))continue;f=!1}x==="{"?d++:x==="}"&&(d--,d===0&&p++)}if(d===0&&p===c&&Yi(t,"accept-all")){t.dirty=!0,t.scrollIntoView();return}}}}}}else if(r.mode==="text"){let s=O(O({},iD(r)),t.defaultStyle);for(let a of i)lt.insert(r,a,{style:s,insertionMode:"replaceSelection"});t.snapshot("insert-text")}else if(r.mode==="math")for(let s of i)rD(t,s);t.dirty=!0,t.scrollIntoView()}function nD(t){let e=t.model,n=[],r=e.at(Math.min(e.position,e.anchor));for(;r.type!=="first";)n.push(r),r=r.leftSibling;return n}function rD(t,e){let n=t.model;/\d/.test(e)||mv(t);let r={"^":"moveToSuperscript",_:"moveToSubscript"," ":t.options.mathModeSpace?["insert",t.options.mathModeSpace]:"moveAfterParent"}[e];if(r){t.executeCommand(r);return}let i=O({},zo(t));!/[a-zA-Z0-9]/.test(e)&&t.styleBias!=="none"&&(i.variant="normal",i.variantStyle=void 0);let o=n.at(n.position),s=n.selectionIsPlaceholder;if(/\d/.test(e)&&t.options.smartSuperscript&&o.parentBranch==="superscript"&&o.parent.type!=="mop"&&o.parent.type!=="operator"&&o.parent.type!=="extensible-symbol"&&o.hasNoSiblings){if(!lt.insert(n,e,{style:i,insertionMode:"replaceSelection",selectionMode:s?"after":"placeholder"})){t.undoManager.pop();return}t.snapshot("insert-mord"),T5(n);return}let a=e;if(a==="{"?a="\\lbrace":a==="}"?a="\\rbrace":a==="&"?a="\\&":a==="#"?a="\\#":a==="$"?a="\\$":a==="%"?a="\\%":a==="~"?a="\\~":a==="\\"&&(a="\\backslash"),!!lt.insert(n,a,{style:i,insertionMode:"replaceSelection",selectionMode:s?"after":"placeholder"})&&(t.snapshot(`insert-${n.at(n.position).type}`),/\d/.test(e))){let l=t.options.inlineShortcutTimeout>0?t.options.inlineShortcutTimeout:1e3;clearTimeout(t.scientificNotationTimer),t.scientificNotationTimer=setTimeout(()=>{mv(t)},l)}}function iD(t){var e,n,r,i;if(t.selectionIsCollapsed)return(n=(e=t.at(t.position))==null?void 0:e.style)!=null?n:{};let o=en(t.selection)[0];return(i=(r=t.at(o+1))==null?void 0:r.style)!=null?i:{}}function Hf(t,e,n){var r;if(!e||t.mode!=="math")return!1;let i=t.at(t.position),{parent:o}=i,s={"(":"(",")":")","{":"\\lbrace","}":"\\rbrace","[":"\\lbrack","]":"\\rbrack","|":"|"}[e];if(!s)return!1;let a=bd[s],l=Zd[s];if(!t.selectionIsCollapsed){t.mathfield.snapshot();let[u,c]=en(t.selection),d=t.extractAtoms([u,c]),p=o.addChildrenAfter([new kt("left...right",d,{leftDelim:s,rightDelim:l})],t.at(u));return t.setSelection(t.offsetOf(p.firstChild),t.offsetOf(p.lastChild)),t.mathfield.snapshot("insert-fence"),t.contentDidChange({data:s,inputType:"insertText"}),!0}if(s==="|"){let u=o instanceof kt?o.leftDelim+o.rightDelim:"";if(u==="\\lbrace\\rbrace"||u==="\\{\\}"||u==="\\lbrace?")return t.mathfield.snapshot(),lt.insert(t,"\\,\\middle\\vert\\,",{format:"latex",style:n}),t.mathfield.snapshot("insert-fence"),t.contentDidChange({data:s,inputType:"insertText"}),!0}if(l){if(o instanceof kt&&o.firstChild===i&&(o.leftDelim==="?"||o.leftDelim==="."))return o.leftDelim=s,o.isDirty=!0,t.mathfield.snapshot(),t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0;if(!(o instanceof kt)){let p=i;for(;p&&!(p.type==="mclose"&&p.value===l);)p=p.rightSibling;if(p){t.mathfield.snapshot();let f=t.extractAtoms([t.offsetOf(i),t.offsetOf(p)]);f.pop();let g=new kt("left...right",f,{leftDelim:s,rightDelim:l});return o.addChildrenAfter([g],i),t.position=t.offsetOf(g.firstChild),t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0}}let u=t.offsetOf(i.lastSibling),c;for(c=t.position;c<=u;c++){let p=t.at(c);if(p instanceof kt&&(p.leftDelim==="?"||p.leftDelim===".")&&gv(s,p.rightDelim))break}let d=t.at(c);if(c<=u&&d instanceof kt){d.leftDelim=s,t.mathfield.snapshot();let p=t.extractAtoms([t.position,c-1]);return p=p.filter(f=>f.type!=="first"),d.addChildren(p,d.parentBranch),t.position+=1,t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0}if(o instanceof kt&&(o.leftDelim==="?"||o.leftDelim===".")&&gv(s,o.rightDelim)){o.isDirty=!0,o.leftDelim=s,t.mathfield.snapshot();let p=t.extractAtoms([t.offsetOf(i.firstSibling),t.position]);for(let f of p)o.parent.addChildBefore(f,o);return t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0}if(!(o instanceof kt&&o.leftDelim==="|")){if(s==="("){let p=t.position-1,f=!1;for(;p>=0;){let g=t.at(p);if(g.type==="first")break;if(g.type==="mord"&&g.value&&/^[\d]$/.test(g.value)){p-=1;continue}if(g.type==="group"&&((r=g.body)==null?void 0:r.length)===2&&g.body[0].type==="first"&&g.body[1].value===","){f=!0;break}if(g.type==="mord"&&(g.value===","||g.value===".")){f=!0;break}break}if(f)return!1}if(t.mathfield.snapshot(),lt.insert(t,`\\left${s}\\right?`,{format:"latex",style:n}),i.lastSibling.type!=="first"){let p=t.offsetOf(i.lastSibling),f=t.extractAtoms([t.position,p]);t.at(t.position).body=f,t.position-=1}return t.mathfield.snapshot("insert-fence"),!0}}if(a){if(s===")"){let g=t.position-1,x=!1;for(;g>=0;){let w=t.at(g);if(w.type==="first")break;if(w.type==="mord"&&w.value&&/^[\d]$/.test(w.value)){x=!0,g-=1;continue}break}if(x&&t.at(g).type==="mopen"&&t.at(g).value==="(")return!1}let u=i;for(;u;){if(u.type==="mopen"&&u.value===a){t.mathfield.snapshot();let g=u.leftSibling,x=t.extractAtoms([t.offsetOf(u.leftSibling),t.offsetOf(i)]);[,...x]=x;let w=new kt("left...right",x,{leftDelim:a,rightDelim:s});return o.addChildrenAfter([w],g),t.position=t.offsetOf(w),t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0}u=u.leftSibling}if(o instanceof kt&&i.isLastSibling&&Cp(o.leftDelim,s))return t.mathfield.snapshot(),o.isDirty=!0,o.rightDelim=s,t.position+=1,t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0;let c=t.offsetOf(i.firstSibling),d;for(d=t.position;d>=c;d--){let g=t.at(d);if(g instanceof kt&&(g.rightDelim==="?"||g.rightDelim===".")&&Cp(g.leftDelim,s))break}let p=t.at(d);if(d>=c&&p instanceof kt)return t.mathfield.snapshot(),p.rightDelim=s,p.addChildren(t.extractAtoms([d,t.position]),p.parentBranch),t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0;if(o instanceof kt&&(o.rightDelim==="?"||o.rightDelim===".")&&Cp(o.leftDelim,s))return t.mathfield.snapshot(),o.isDirty=!0,o.rightDelim=s,o.parent.addChildren(t.extractAtoms([t.position,t.offsetOf(i.lastSibling)]),o.parentBranch),t.position=t.offsetOf(o),t.contentDidChange({data:s,inputType:"insertText"}),t.mathfield.snapshot("insert-fence"),!0;let f=o.parent;return f instanceof kt&&(f.rightDelim==="?"||f.rightDelim===".")&&t.at(t.position).isLastSibling?(t.position=t.offsetOf(f),Hf(t,s,n)):!1}return!1}function Cp(t,e){return t?["(","\\lparen","{","\\{","\\lbrace","[","\\lbrack"].includes(t)?[")","\\rparen","}","\\}","\\rbrace","]","\\rbrack"].includes(e):Zd[t]===e:!0}function gv(t,e){return e?[")","\\rparen","}","\\}","\\rbrace","]","\\rbrack"].includes(e)?["(","\\lparen","{","\\{","\\lbrace","[","\\lbrack"].includes(t):bd[e]===t:!0}ln({scrollIntoView:t=>(t.scrollIntoView(),!0),scrollToStart:t=>(t.field.scroll(0,0),!0),scrollToEnd:t=>{let e=t.field.getBoundingClientRect();return t.field.scroll(e.left-window.scrollX,0),!0},toggleKeystrokeCaption:ZA,toggleContextMenu:t=>{let e=t.toggleContextMenu();return e||t.model.announce("plonk"),e},plonk:t=>(t.model.announce("plonk"),!0),switchMode:(t,e,n,r)=>(t.switchMode(e,n,r),!0)});ln({undo:t=>(t.undo(),!0),redo:t=>(t.redo(),!0)},{target:"mathfield",changeContent:!0});ln({insert:(t,e,n)=>t.insert(e,n),typedText:(t,e,n)=>(Vf(t,e,n),!0),insertDecimalSeparator:t=>{let e=t.model;return e.mode==="math"&&globalThis.MathfieldElement.decimalSeparator===","&&e.at(Math.max(e.position,e.anchor)).isDigit()?(t.insert("{,}",{format:"latex"}),t.snapshot("insert-mord"),!0):(t.insert("."),!0)},commit:t=>{var e,n;let r=t.model;return r.contentWillChange({inputType:"insertLineBreak"})&&((e=t.host)==null||e.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})),(n=r.parentEnvironment)!=null&&n.isMultiline&&t.executeCommand("addRowAfter"),r.contentDidChange({inputType:"insertLineBreak"})),!0},insertPrompt:(t,e,n)=>{let r=t.getPrompts(),i="prompt-"+Date.now().toString(36).slice(-2)+Math.floor(Math.random()*1e5).toString(36),o=0;for(;r.includes(i)&&o<100;){if(o===99)return console.error("could not find a unique ID after 100 tries"),!1;i="prompt-"+Date.now().toString(36).slice(-2)+Math.floor(Math.random()*1e5).toString(36),o++}return t.insert(`\\placeholder[${e??i}]{}`,n),!0}},{target:"mathfield",canUndo:!0,changeContent:!0,changeSelection:!0});ln({copyToClipboard:t=>(t.focus(),t.model.selectionIsCollapsed&&t.select(),"queryCommandSupported"in document&&document.queryCommandSupported("copy")&&document.execCommand("copy")||t.element.querySelector(".ML__keyboard-sink").dispatchEvent(new ClipboardEvent("copy",{bubbles:!0,composed:!0})),!1)},{target:"mathfield"});ln({cutToClipboard:t=>(t.focus(),"queryCommandSupported"in document&&document.queryCommandSupported("cut")&&document.execCommand("cut")||t.element.querySelector(".ML__keyboard-sink").dispatchEvent(new ClipboardEvent("cut",{bubbles:!0,composed:!0})),!0),pasteFromClipboard:t=>(t.focus(),"queryCommandSupported"in document&&document.queryCommandSupported("paste")?(document.execCommand("paste"),!0):(navigator.clipboard.readText().then(e=>{e&&t.model.contentWillChange({inputType:"insertFromPaste",data:e})?(t.stopCoalescingUndo(),t.stopRecording(),t.insert(e,{mode:t.model.mode})&&(Ol(t),t.startRecording(),t.snapshot("paste"),t.model.contentDidChange({inputType:"insertFromPaste"}),vt(t))):t.model.announce("plonk"),t.startRecording()}).catch(()=>{t.model.announce("plonk"),t.startRecording()}),!0))},{target:"mathfield",canUndo:!0,changeContent:!0,changeSelection:!0});function Wf(t){let[e,n]=en(t.selection);if(e=yv(t,e,"backward"),n=yv(t,n,"forward"),e===n){let r=t.at(e);if(r.type==="leftright")return t.setSelection(t.offsetOf(r.firstChild)-1,n);if(r.type==="first"&&(r.parent.type==="leftright"||r.parent.type==="surd"))return t.setSelection(e-1,t.offsetOf(r.parent.lastChild)+1);t.setSelection(e-1,n)}else t.setSelection(e,n);return!0}function yv(t,e,n){var r;let i=t.at(e);if(!i)return e;let o=n==="forward"?1:-1;if(i.mode==="text"){for(;i&&!(i.mode!=="text"||!yl.test(i.value));)e+=o,i=t.at(e);return n==="backward"?e-1:e}if(i.mode==="latex"){if(/[a-zA-Z\\*]/.test(i.value))if(n==="backward")for(;i?.mode==="latex"&&i.value!=="\\"&&/[a-zA-Z]/.test(i.value);)e+=o,i=t.at(e);else for(;i?.mode==="latex"&&/[a-zA-Z\\*]/.test(i.value);)e+=o,i=t.at(e);else if(i.value==="{"){if(n==="forward"){for(;i?.mode==="latex"&&i.value!=="}";)e+=o,i=t.at(e);return e}return e-1}else if(i.value==="}"){if(n==="backward"){for(;i?.mode==="latex"&&i.value!=="{";)e+=o,i=t.at(e);return e-1}return e}return e-1}if(i.mode==="math"){if(i.isDigit()){for(;(r=t.at(e+o))!=null&&r.isDigit();)e+=o;return n==="backward"?e-1:e}if(i.style.variant||i.style.variantStyle){let s=i.style.variant,a=i.style.variantStyle;for(;;){let l=t.at(e+o);if(!l||l.style.variant!==s||l.style.variantStyle!==a)break;e+=o}return n==="backward"?e-1:e}return e}return e}ln({selectGroup:t=>{let e=Wf(t);return e||t.announce("plonk"),e},selectAll:t=>t.setSelection(0,t.lastOffset),extendSelectionForward:t=>Sr(t,"forward",{extend:!0}),extendSelectionBackward:t=>Sr(t,"backward",{extend:!0}),extendToNextWord:t=>Ri(t,"forward",{extend:!0}),extendToPreviousWord:t=>Ri(t,"backward",{extend:!0}),extendSelectionUpward:t=>Sr(t,"upward",{extend:!0}),extendSelectionDownward:t=>Sr(t,"downward",{extend:!0}),extendToNextBoundary:t=>Ri(t,"forward",{extend:!0}),extendToPreviousBoundary:t=>Ri(t,"backward",{extend:!0}),extendToGroupStart:t=>{let e=t.setSelection(t.anchor,t.offsetOf(t.at(t.position).firstSibling));return e||t.announce("plonk"),e},extendToGroupEnd:t=>{let e=t.setSelection(t.anchor,t.offsetOf(t.at(t.position).lastSibling));return e||t.announce("plonk"),e},extendToMathFieldStart:t=>{let e=t.setSelection(t.anchor,0);return e||t.announce("plonk"),e},extendToMathFieldEnd:t=>{let e=t.setSelection(t.anchor,t.lastOffset);return e||t.announce("plonk"),e}},{target:"model",changeSelection:!0});var mo=null,Ca=0,Cd=class Vn{static start(e,n,r,i){var o;Vn.element=e,(o=Vn.controller)==null||o.abort(),Vn.controller=new AbortController;let s={signal:Vn.controller.signal};"PointerEvent"in window?(e.addEventListener("pointermove",r,s),e.addEventListener("pointerup",i,s),e.addEventListener("pointercancel",i,s),Uf(n)&&(Vn.pointerId=n.pointerId,e.setPointerCapture(n.pointerId))):(window.addEventListener("mousemove",r,s),window.addEventListener("blur",i,s),window.addEventListener("mouseup",i,s))}static stop(){var e;(e=Vn.controller)==null||e.abort(),Vn.controller=void 0,typeof Vn.pointerId=="number"&&(Vn.element.releasePointerCapture(Vn.pointerId),Vn.pointerId=void 0)}};function Uf(t){return t!==null&&globalThis.PointerEvent!==void 0&&t instanceof PointerEvent}function Ep(t,e,n){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}function bv(t,e,n){return t<e?e:t>n?n:t}function vv(t,e){var n,r,i,o,s,a;if(e.buttons>1)return;t.atomBoundsCache?t.atomBoundsCache.clear():t.atomBoundsCache=new Map;let l=t,u,c=!1,d=!1,p="none",f=!1,g=!1,x=e.clientX,w=e.clientY,k=Date.now(),D=l.field,N=setInterval(()=>{f?D.scroll({top:0,left:D.scrollLeft-16}):g&&D.scroll({top:0,left:D.scrollLeft+16})},32);function B(){Cd.stop(),c=!1,clearInterval(N),t.element.classList.remove("tracking"),e&&e.preventDefault()}function T(re){if(!l.hasFocus()){B();return}let ce=re.clientX,ge=re.clientY,xe=Uf(re)&&re.pointerType==="touch"?20:5;if(Date.now()<k+500&&Math.abs(x-ce)<xe&&Math.abs(w-ge)<xe){re.preventDefault(),re.stopPropagation();return}let De=D.getBoundingClientRect();g=ce>De.right,f=ce<De.left;let We=u;Uf(re)&&(re.isPrimary||(We=yc(l,re.clientX,re.clientY,{bias:0})));let et=yc(l,ce,ge,{bias:ce<=x?ce===x?0:-1:1});We>=0&&et>=0&&(l.model.extendSelectionTo(We,et),vt(t)),d&&Wf(l.model)}mo&&Math.abs(mo.x-x)<5&&Math.abs(mo.y-w)<5&&Date.now()<mo.time+500?(Ca+=1,mo.time=k):(mo={x,y:w,time:k},Ca=1);let R=D.getBoundingClientRect(),L=(r=(n=t.container)==null?void 0:n.getBoundingClientRect())!=null?r:t.element.getBoundingClientRect(),P=(o=(i=t.element)==null?void 0:i.getBoundingClientRect())!=null?o:L,W=Ep(x,w,R),de=!W&&L?Ep(x,w,L):!1,q=!W&&!de&&P?Ep(x,w,P):!1,ae=W?x:de||q?bv(x,R.left,R.right):x,be=W?w:de||q?bv(w,R.top,R.bottom):w;if(W||de||q){if(t.flushInlineShortcutBuffer(),u=yc(t,ae,be,{bias:0}),u!==t.model.anchor){let re=t.defaultStyle.variantStyle;t.defaultStyle=re!==void 0?{variantStyle:re}:{},t.styleBias="left"}if(u>=0){if(t.element.classList.add("tracking"),e.shiftKey){let re=t.model.selectionIsCollapsed;t.model.extendSelectionTo(t.model.anchor,u),_p(t.model)||re?p="all":p="selection"}else if(t.model.at(u).type==="placeholder"||t.model.at(u).type==="prompt"){let re=t.model.at(u);re.hasChildren&&re.firstChild?t.model.position=t.model.offsetOf(re.firstChild):t.model.setSelection(u-1,u),p="selection"}else if(((s=t.model.at(u).rightSibling)==null?void 0:s.type)==="placeholder"||((a=t.model.at(u).rightSibling)==null?void 0:a.type)==="prompt"){let re=t.model.at(u).rightSibling;re.hasChildren&&re.firstChild?t.model.position=t.model.offsetOf(re.firstChild):t.model.setSelection(u,u+1),p="selection"}else{let re=t.model.at(u);if(re.captureSelection&&re.hasChildren&&re.body&&re.body.length>0){let ce=re.body.find(ge=>ge.type!=="first");ce&&(ce.type==="placeholder"||ce.type==="prompt")&&ce.hasChildren&&ce.firstChild?(t.model.position=t.model.offsetOf(ce.firstChild),p="selection"):(t.model.position=u,_p(t.model)?p="all":p="selection")}else t.model.position=u,_p(t.model)?p="all":p="selection"}e.detail===3||Ca>2?(B(),(e.detail===3||Ca===3)&&(t.model.selection={ranges:[[0,t.model.lastOffset]]},p="all")):c||(c=!0,Cd.start(D,e,T,B),(e.detail===2||Ca===2)&&(d=!0,Wf(t.model),p="all"))}t.hasFocus()||(p="none",t.onFocus(),t.model.announce("line"))}else mo=null;t.stopCoalescingUndo(),p!=="none"&&(t.model.selectionIsCollapsed&&(p="all"),vt(t)),e.preventDefault()}function oD(t,e,n){if(t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom)return 0;let r=t-(n.left+n.right)/2,i=e-(n.top+n.bottom)/2;return r*r+i*i}function za(t,e,n,r,i){if(!n.id)return[1/0,null];if(e.has(n.id))return e.get(n.id);let o=Uo(t,n);if(!o)return[1/0,null];let s=[1/0,null],a=t.model;if(n instanceof He){let l=-1,u=1/0;for(let d=0;d<n.rows.length;d++){let p=n.rows[d];if(!p||p.length===0)continue;let f=1/0,g=-1/0;for(let x of p)if(x)for(let w of x){let k=Uo(t,w);k&&(f=Math.min(f,k.top),g=Math.max(g,k.bottom))}if(f!==1/0&&g!==-1/0){let x;i<f?x=f-i:i>g?x=i-g:x=0,x<u&&(u=x,l=d)}}let c=l>=0?[n.rows[l]]:n.rows;for(let d of c)for(let p of d)if(p)for(let f of p){let g=za(t,e,f,r,i);g[0]<=s[0]&&(s=g)}if(!n.isMultiline)for(let d of n.children){let p=za(t,e,d,r,i);p[0]<=s[0]&&(s=p)}}else if(n.hasChildren&&!n.captureSelection&&r>=o.left&&r<=o.right){let l=n.children;for(let u of l){let c=za(t,e,u,r,i);c[0]<=s[0]&&(s=c)}for(let u of n.branches){let c=n.branch(u);if(!c||c.length===0)continue;let d=[a.offsetOf(c[0]),a.offsetOf(c[c.length-1])],p=RC(t,d);if(i>=p.top&&i<=p.bottom)for(let f of c){let g=za(t,e,f,r,i);g[0]<=s[0]&&(s=g)}}}return s[1]||(s=[oD(r,i,o),n]),e.set(n.id,s),s}function sD(t,e,n){let[,r]=za(t,new Map,t.model.root,e,n);return r}function yc(t,e,n,r){var i;let o=t.field.querySelector(".ML__latex").getBoundingClientRect();if(!o)return 0;if(e>o.right||n>o.bottom+8)return t.model.lastOffset;if(e<o.left||n<o.top-8)return 0;r=r??{},r.bias=(i=r.bias)!=null?i:0;let s=sD(t,e,n),a=[],l=s;for(;l;)a.unshift(l),l=l.parent;for(let c of a)if(c.captureSelection){s=c;break}let u=t.model.offsetOf(s);if(u<0)return-1;if(s.leftSibling){let c=s.type==="placeholder"||s.type==="prompt";if(r.bias===0&&!c){let d=Uo(t,s);d&&e<(d.left+d.right)/2&&(u=t.model.offsetOf(s.leftSibling))}else r.bias<0&&(u=t.model.offsetOf(s.leftSibling))}return u}var aD=class extends lt{constructor(){super("math")}onPaste(t,e){if(!e||!t.model.contentWillChange({data:typeof e=="string"?e:null,dataTransfer:typeof e=="string"?null:e,inputType:"insertFromPaste"}))return!1;let n="",r="auto",i=typeof e!="string"?e.getData("application/json+mathlive"):"";if(i)try{let o=JSON.parse(i);if(o&&Array.isArray(o)){t.snapshot();let s=Hi(o),{model:a}=t;a.selectionIsCollapsed||a.deleteAtoms(en(a.selection));let l=a.at(a.position);if(l.parent instanceof He){l.parentBranch;let u=[],c=[];s[0].type==="first"&&s.shift(),s[s.length-1].type==="first"&&s.pop();for(let g of s)g.type==="first"&&c.length>0?(u.push(c),c=[g]):c.push(g);c.length>0&&u.push(c);let d=Number(l.parentBranch[0]),p=Number(l.parentBranch[1]),f=l.parent.maxColumns;for(;l.parent.colCount-p<u.length&&l.parent.colCount<f;)l.parent.addColumn();l.parent.addChildrenAfter(u[0],l);for(let g=1;g<u.length;g++)p++,p>=f&&(p=0,l.parent.addRowAfter(d),d++),l.parent.setCell(d,p,u[g])}else l.parent.addChildrenAfter(s.filter(u=>u.type!=="first"),l);return a.position=a.offsetOf(s[s.length-1]),a.contentDidChange({inputType:"insertFromPaste"}),vt(t),!0}}catch{}if(i=typeof e!="string"?e.getData("application/json"):"",i&&globalThis.MathfieldElement.computeEngine)try{let o=JSON.parse(i);if(typeof o=="object"&&"latex"in o&&o.latex&&(n=o.latex),!n){let s=globalThis.MathfieldElement.computeEngine.box(o);s&&!s.has("Error")&&(n=s.latex)}n||(r="latex")}catch{}if(!n&&typeof e!="string"&&(n=e.getData("application/x-latex"),n&&(r="latex")),n||(n=typeof e=="string"?e:e.getData("text/plain")),n){let o;return[o,n]=t0(n),r==="auto"&&o&&(r="latex"),t.stopCoalescingUndo(),t.stopRecording(),this.insert(t.model,n,{format:r})&&(t.startRecording(),t.snapshot("paste"),vt(t)),t.startRecording(),!0}return!1}insert(t,e,n){var r,i;let o=typeof e=="string"?e:(i=(r=globalThis.MathfieldElement.computeEngine)==null?void 0:r.box(e).latex)!=null?i:"";if(!n.silenceNotifications&&!t.contentWillChange({data:o,inputType:"insertText"}))return!1;n.insertionMode||(n.insertionMode="replaceSelection"),n.selectionMode||(n.selectionMode="placeholder"),n.format||(n.format="auto");let{silenceNotifications:s}=t;n.silenceNotifications&&(t.silenceNotifications=!0);let a=t.silenceNotifications;t.silenceNotifications=!0;let l={"?":"\\placeholder{}","@":"\\placeholder{}"};l[0]=n.insertionMode==="replaceAll"?"":t.getValue(t.selection,"latex-unstyled"),n.insertionMode==="replaceSelection"?t.deleteAtoms(en(t.selection)):n.insertionMode==="replaceAll"?t.deleteAtoms():n.insertionMode==="insertBefore"?t.collapseSelection("backward"):n.insertionMode==="insertAfter"&&t.collapseSelection("forward"),!t.at(t.position).isLastSibling&&t.at(t.position+1).type==="placeholder"?t.deleteAtoms([t.position,t.position+1]):t.at(t.position).type==="placeholder"&&t.deleteAtoms([t.position-1,t.position]);let u=-1;l[0]?l["@"]=l[0]:typeof e=="string"&&/(^|[^\\])#@/.test(e)&&(u=lD(t),u>=0&&(l["@"]=t.getValue(u,t.position,"latex"))),l[0]||(l[0]=l["?"]);let c=!1,d=w=>(c=!0,l[w]),[p,f]=xv(t,e,d,n);if(!f)return!1;let g=f.length===1&&f[0].type==="genfrac";if(g&&u>=0&&typeof t.mathfield.options.isImplicitFunction=="function"&&t.mathfield.options.isImplicitFunction(t.at(t.position).command)?(l["@"]=l["?"],c=!1,[p,f]=xv(t,e,d,n)):u>=0&&t.deleteAtoms([u,t.position]),f.length===1&&f[0].isRoot)t.root=f[0];else{let{parent:w}=t.at(t.position),k=w.hasEmptyBranch("body");if(g&&p!=="latex"&&t.mathfield.options.removeExtraneousParentheses&&w instanceof kt&&w.leftDelim==="("&&k){let N=w.parent,B=w.parentBranch;N.removeChild(w),N.setChildren(f,B)}let D=t.at(t.position);D.parent.addChildrenAfter(f,D),p==="latex"&&typeof e=="string"&&w?.type==="root"&&k&&!c&&(w.verbatimLatex=e)}t.silenceNotifications=a;let x=f[f.length-1];if(n.selectionMode==="placeholder"){let w;if(f.length===1&&f[0].type==="genfrac"){let k=f[0].branch("above");if(w=k?.find(D=>D.type==="placeholder"),!w){let D=f[0].branch("below");w=D?.find(N=>N.type==="placeholder")}}if(w||(w=f.flatMap(k=>[k,...k.children]).find(k=>k.type==="placeholder")),w){let k=t.offsetOf(w);t.setSelection(k-1,k),t.announce("move")}else if(x){let k=x.body,D=x.hasEmptyBranch("body");k&&D?t.setSelection(t.offsetOf(k[0]),t.offsetOf(k[k.length-1])+1):t.position=t.offsetOf(x)}}else n.selectionMode==="before"||(n.selectionMode==="after"?x&&(t.position=t.offsetOf(x)):n.selectionMode==="item"&&t.setSelection(t.anchor,t.offsetOf(x)));return t.contentDidChange({data:o,inputType:"insertText"}),t.silenceNotifications=s,!0}};function xv(t,e,n,r){var i;let o,s=[];if(typeof e!="string"||r.format==="math-json"){let a=globalThis.MathfieldElement.computeEngine;if(!a)return["math-json",[]];[o,e]=["latex",a.box(e).latex],s=wn(e,{context:t.mathfield.context})}else typeof e=="string"&&r.format==="ascii-math"?([o,e]=yd(e,{format:"ascii-math",inlineShortcuts:t.mathfield.options.inlineShortcuts}),s=wn(e,{context:t.mathfield.context}),o!=="latex"&&t.mathfield.options.removeExtraneousParentheses&&(s=s.map(a=>Ed(a)))):(r.format==="auto"||(i=r.format)!=null&&i.startsWith("latex"))&&(r.format==="auto"&&([o,e]=yd(e,{format:"auto",inlineShortcuts:t.mathfield.options.inlineShortcuts})),r.format==="latex"&&([,e]=t0(e)),s=wn(e,{context:t.mathfield.context,args:n}),r.format!=="latex"&&t.mathfield.options.removeExtraneousParentheses&&(s=s.map(a=>Ed(a))));return o0(s,r.style),[o??"latex",s]}function Ed(t){var e;if(t instanceof kt&&t.leftDelim!=="("&&t.rightDelim===")"){let n=(e=t.body)==null?void 0:e.filter(r=>r.type!=="first");if(n?.length===1&&n[0].type==="genfrac")return n[0]}for(let n of t.branches)t.hasEmptyBranch(n)||t.setChildren(t.branch(n).map(r=>Ed(r)),n);return t instanceof He&&t.forEachCell((n,r,i)=>{t.setCell(r,i,n.map(o=>Ed(o)))}),t}function lD(t){let e=t.at(t.position);if(e.mode==="text"){for(;!e.isFirstSibling&&e.mode==="text";)e=e.leftSibling;return t.offsetOf(e)}let n=e,r=!1;if(e.type==="mclose"){let i=bd[e.value];for(;!e.isFirstSibling&&!(e.type==="mopen"&&e.value===i);)e=e.leftSibling;e.isFirstSibling||(e=e.leftSibling),r=!0}else e.type==="leftright"&&(e=e.leftSibling,r=!0);if(r)for(;!e.isFirstSibling&&(e.isFunction||wv(e));)e=e.leftSibling;else{let i=[];for(;!e.isFirstSibling&&(wv(e)||i.length>0);)e.type==="mclose"&&i.unshift(e.value),e.type==="mopen"&&i.length>0&&e.value===bd[i[0]]&&i.shift(),e=e.leftSibling}return n===e?-1:t.offsetOf(e)}function uD(t){if(t.type==="mord"&&t.value==="e"){let e=t.leftSibling;if(e&&e.isDigit())return!0}if(t.type==="mbin"&&(t.value==="+"||t.value==="-"||t.value==="")){let e=t.leftSibling,n=t.rightSibling;if(e?.type==="mord"&&e.value==="e"&&n&&n.isDigit()){let r=e.leftSibling;if(r&&r.isDigit())return!0}}if(t.type==="subsup"){let e=t.leftSibling;if(e&&e.isDigit()&&e.value==="0"){let n=e.leftSibling;if(n&&n.isDigit()&&n.value==="1"){let r=n.leftSibling;if(r?.type==="mbin"&&(r.value===""||r.value==="\\times")){let i=r.leftSibling;if(i&&i.isDigit())return!0}}}}if(t.isDigit()&&t.value==="0"){let e=t.leftSibling,n=t.rightSibling;if(e&&e.isDigit()&&e.value==="1"&&n?.type==="subsup"){let r=e.leftSibling;if(r?.type==="mbin"&&(r.value===""||r.value==="\\times")){let i=r.leftSibling;if(i&&i.isDigit())return!0}}}if(t.isDigit()&&t.value==="1"){let e=t.rightSibling;if(e&&e.isDigit()&&e.value==="0"){let n=e.rightSibling;if(n?.type==="subsup"){let r=t.leftSibling;if(r?.type==="mbin"&&(r.value===""||r.value==="\\times")){let i=r.leftSibling;if(i&&i.isDigit())return!0}}}}if(t.type==="mbin"&&(t.value===""||t.value==="\\times")){let e=t.leftSibling,n=t.rightSibling;if(e&&e.isDigit()&&n&&n.isDigit()&&n.value==="1"){let r=n.rightSibling;if(r&&r.isDigit()&&r.value==="0"){let i=r.rightSibling;if(i?.type==="subsup")return!0}}}return!1}function wv(t){return t.isDigit()||uD(t)?!0:t.type&&/^(mord|surd|subsup|leftright|mop|mclose)$/.test(t.type)?t.type!=="extensible-symbol":!1}new aD;var cD=class extends lt{constructor(){super("text")}onPaste(t,e){if(!e)return!1;let n=typeof e=="string"?e:e.getData("text/plain");return n&&t.model.contentWillChange({inputType:"insertFromPaste",data:n})?(t.stopCoalescingUndo(),t.stopRecording(),this.insert(t.model,n)&&(t.model.contentDidChange({inputType:"insertFromPaste"}),t.startRecording(),t.snapshot("paste"),vt(t)),t.startRecording(),!0):!1}insert(t,e,n={}){if(!t.contentWillChange({data:e,inputType:"insertText"}))return!1;n.insertionMode||(n.insertionMode="replaceSelection"),n.selectionMode||(n.selectionMode="placeholder"),n.format||(n.format="auto");let{silenceNotifications:r}=t;n.silenceNotifications&&(t.silenceNotifications=!0);let i=t.silenceNotifications;t.silenceNotifications=!0,n.insertionMode==="replaceSelection"&&!t.selectionIsCollapsed?t.deleteAtoms(en(t.selection)):n.insertionMode==="replaceAll"?(t.root.setChildren([],"body"),t.position=0):n.insertionMode==="insertBefore"?t.collapseSelection("backward"):n.insertionMode==="insertAfter"&&t.collapseSelection("forward");let o=dD(e,t.mathfield.context);if(o0(o,n.style),!o)return!1;let s=t.at(t.position),a=s.parent.addChildrenAfter(o,s);return t.silenceNotifications=i,n.selectionMode==="before"||(n.selectionMode==="item"?t.setSelection(t.anchor,t.offsetOf(a)):a&&(t.position=t.offsetOf(a))),t.contentDidChange({data:e,inputType:"insertText"}),t.silenceNotifications=r,!0}};function dD(t,e){if(t.includes("$")){let n=[],r=0,i=!1,o="";for(;r<t.length;)t[r]==="$"?r+1<t.length&&t[r+1]==="$"?(!i&&o?(n.push(Wu(o)),o=""):i&&o&&(n.push(o),o=""),n.push("$$"),i=!i,r+=2):(!i&&o?(n.push(Wu(o)),o=""):i&&o&&(n.push(o),o=""),n.push("$"),i=!i,r+=1):(o+=t[r],r+=1);return o&&(i?n.push(o):n.push(Wu(o))),wn(n.join(""),{context:e,parseMode:"text"})}return wn(Wu(t),{context:e,parseMode:"text"})}function Wu(t){return t=t.replace(/\\/g,"\\textbackslash "),t=t.replace(/#/g,"\\#"),t=t.replace(/%/g,"\\%"),t=t.replace(/&/g,"\\&"),t=t.replace(/_/g,"\\_"),t=t.replace(/{/g,"\\textbraceleft "),t=t.replace(/}/g,"\\textbraceright "),t=t.replace(/lbrace/g,"\\textbraceleft "),t=t.replace(/rbrace/g,"\\textbraceright "),t=t.replace(/\^/g,"\\textasciicircum "),t=t.replace(/~/g,"\\textasciitilde "),t=t.replace(//g,"\\textsterling "),t}new cD;function _i(t){return{value:t.model.getValue(),selectionIsCollapsed:t.model.selectionIsCollapsed,canUndo:t.canUndo(),canRedo:t.canRedo(),style:hD(t.model),mode:t.model.mode}}function hD(t){var e;if(t.selectionIsCollapsed)return(e=t.at(t.position))==null?void 0:e.style;let n=t.getAtoms(t.selection);if(n.length===0)return{};let r=O({},n[0].style);for(let i of n)for(let[o,s]of Object.entries(i.style))r[o]!==s&&delete r[o];return r}var ht=4,vn=20,Dt=2*(vn+ht),Uu=(t,e)=>`
  <line x1="${t+vn}" y1="${e+vn}" 
    x2="${t>e?t+vn:7*vn+10*ht}" 
    y2="${t<e?e+vn:7*vn+10*ht}"/>
  <svg id="plus" viewBox="0 0 40 40" x="${t}" y="${e}" width="40" height="40">
    <circle class="cls-2" cx="20" cy="20" r="20"/>
    <path class="font" d="m33.33,20c0,1.84-1.49,3.34-3.33,3.34h-6.67v6.66c0,1.84-1.49,3.34-3.33,3.34s-3.34-1.5-3.34-3.34v-6.66h-6.66c-1.84,0-3.34-1.5-3.34-3.34s1.5-3.33,3.34-3.33h6.66v-6.67c0-1.84,1.5-3.33,3.34-3.33s3.33,1.49,3.33,3.33v6.67h6.67c1.84,0,3.33,1.49,3.33,3.33Z"/>
  </svg>`,kv=(t,e)=>`
  <line x1="${t+vn}" y1="${e+vn}" 
    x2="${t>e?t+vn:7*vn+10*ht}" 
    y2="${t<e?e+vn:7*vn+10*ht}"/>
  <svg id="minus" viewBox="0 0 40 40" x="${t}" y="${e}" width="40" height="40">
    <circle class="cls-2" cx="20" cy="20" r="20"/>
    <path class="font" d="m33.33,20c0,1.84-1.49,3.33-3.33,3.33H10c-1.84,0-3.34-1.49-3.34-3.33s1.5-3.34,3.34-3.34h20c1.84,0,3.33,1.5,3.33,3.34Z"/>
  </svg>`,Ju=(t,e,n)=>`
  <svg id="arrow" viewBox="0 0 40 40" x="${t}" y="${e}" width="40" height="40">
    <circle class="cls-2" cx="20" cy="20" r="20"/>
    <g transform="rotate(${n})" transform-origin="20 20">
      <path class="font" d="m17.7,7.23h4.6c.52,0,.94.42.94.94v13.82c0,.52.42.94.94.94h3.39c.83,0,1.25,1.01.66,1.6l-7.56,7.56c-.37.37-.96.37-1.32,0l-7.56-7.56c-.59-.59-.17-1.6.66-1.6h3.39c.52,0,.94-.42.94-.94v-13.82c0-.52.42-.94.94-.94Z"/>
    </g>  
  </svg>`,pD=`
<svg class="MLEP__array-buttons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
viewBox=
"-2 -2 ${8*vn+10*ht+5} ${8*vn+10*ht+5}">
  <rect 
      class="MLEP__array-insert-background rows"
      x="0" 
      y="${Dt+ht}" 
      height="${3*Dt}" 
      width="${Dt}" 
      rx="${Dt/2}"/>
      <rect 
      class="MLEP__array-insert-background columns"
      x="${Dt+ht}" 
      y="0" 
      height="${Dt}" 
      width="${3*Dt}" 
      rx="${Dt/2}"/>
  <g data-command='"moveDown"'>
  ${Ju(2*(ht+Dt),2*ht+3*Dt,0)}
  </g>
  <g data-command='"moveUp"'>
  ${Ju(2*(ht+Dt),2*ht+Dt,180)}
  </g>
  <g data-command='"moveToNextWord"'>
  ${Ju(2*ht+3*Dt,2*(ht+Dt),-90)}
  </g>
  <g data-command='"moveToPreviousWord"'>
  ${Ju(2*ht+Dt,2*(ht+Dt),90)}
  </g>
  <g>

  <g data-command='"addColumnBefore"'>
  ${Uu(2*ht+Dt,ht)}
  </g>
  <g data-command='"removeColumn"'>
  ${kv(2*ht+2*Dt,ht)}
  </g>
  <g data-command='"addColumnAfter"'>
  ${Uu(2*ht+3*Dt,ht)}
  </g>
  <g data-command='"addRowBefore"'>
  ${Uu(ht,2*ht+Dt)}
  </g>
  <g data-command='"removeRow"'>
  ${kv(ht,2*ht+2*Dt)}
  </g>
  <g data-command='"addRowAfter"'>
    ${Uu(ht,2*ht+3*Dt)}
  </g>
</svg>`,fD=t=>`
<svg id="matrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","matrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/></svg>`,mD=t=>`
<svg id="pmatrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
data-command='["setEnvironment","pmatrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <path class="cls-2" d="m6,4c-3.96,4.6-3.96,11.4,0,16"/>
  <path class="cls-2" d="m22,4c3.96,4.6,3.96,11.4,0,16"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/></svg>`,N5=t=>`
<svg id="Bmatrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","Bmatrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <path class="cls-2" d="m6,4c-1.1,0-2,.9-2,2v3c0,1.66-.9,3-2,3,1.1,0,2,1.34,2,3v3c0,1.1.9,2,2,2"/>
  <path class="cls-2" d="m22,4c1.1,0,2,.9,2,2v3c0,1.66.9,3,2,3-1.1,0-2,1.34-2,3v3c0,1.1-.9,2-2,2"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/>
</svg>`,gD=t=>`
<svg id="bmatrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","bmatrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <path class="cls-2" d="m6,4h-3v16h3"/>
  <path class="cls-2" d="m22,4h3v16h-3"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/>
</svg>`,yD=t=>`
<svg id="vmatrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","vmatrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/>
  <line class="cls-2" x1="4" y1="4" x2="4" y2="20"/>
  <line class="cls-2" x1="24" y1="4" x2="24" y2="20"/>
</svg>`,bD=t=>`
<svg id="Vmatrix" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="-3.5 -3 35 30" 
  data-command='["setEnvironment","Vmatrix"]'>
  <rect class="cls-1" width="28" height="24"/>
  <circle cx="10" cy="8" r="1"/>
  <circle cx="14" cy="12" r="1"/>
  <circle cx="18" cy="16" r="1"/>
  <line class="cls-2" x1="6" y1="4" x2="6" y2="20"/>
  <line class="cls-2" x1="22" y1="4" x2="22" y2="20"/>
  <line class="cls-2" x1="2" y1="4" x2="2" y2="20"/>
  <line class="cls-2" x1="26" y1="4" x2="26" y2="20"/>
</svg>`,vD=t=>`
<svg id="cases" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","cases"]'>
  <rect class="cls-1" width="28" height="24"/>
  <path class="cls-2" d="m10,4c-1.1,0-2,.9-2,2v3c0,1.66-.9,3-2,3,1.1,0,2,1.34,2,3v3c0,1.1.9,2,2,2"/>
  <circle cx="13" cy="8" r="1"/>
  <circle cx="13" cy="16" r="1"/>
  <circle cx="21" cy="8" r="1"/>
  <circle cx="21" cy="16" r="1"/>
</svg>`,xD=t=>`
<svg id="rcases" class="${t}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" 
  data-command='["setEnvironment","rcases"]'>
  <rect class="cls-1" width="28" height="24"/>
  <path class="cls-2" d="m18,20c1.1,0,2-.9,2-2v-3c0-1.66.9-3,2-3-1.1,0-2-1.34-2-3v-3c0-1.1-.9-2-2-2"/>
  <circle cx="15" cy="8" r="1"/>
  <circle cx="15" cy="16" r="1"/>
  <circle cx="7" cy="8" r="1"/>
  <circle cx="7" cy="16" r="1"/>
</svg>`,Ap={matrix:fD,pmatrix:mD,bmatrix:gD,Bmatrix:N5,vmatrix:yD,Vmatrix:bD},Dp={cases:vD,rcases:xD,Bmatrix:N5};function wD(t){var e,n;let r=(e=t.model.parentEnvironment)==null?void 0:e.rows;if(!r)return;let i=0;r.forEach(f=>{(!i||f.length>i)&&(i=f.length)});let o=document.getElementById("mathlive-environment-popover");o||(o=rh("mathlive-environment-popover"),Ji("environment-popover"),Ji("core"),o.setAttribute("aria-hidden","true"));let s,a=o.querySelector(".MLEP__environment-controls");a?s=a:(s=document.createElement("div"),o.innerHTML="",o.appendChild(s)),s.className="MLEP__environment-controls",s.style.display="flex",s.style.width="100%",s.style.height="100%",s.style.boxSizing="border-box",s.innerHTML=pD;let l=[],u="",c=t.model.parentEnvironment.environmentName;if(Lx(c)){let f=SD(c);u=Ap[f]("active");let g=Ap,{[f]:x}=g,w=cd(g,[Zg(f)]);l=Object.values(w).map(k=>k("inactive"))}else if(oE(c)){let f=_D(c);u=Dp[f]("active");let g=Dp,{[f]:x}=g,w=cd(g,[Zg(f)]);l=Object.values(w).map(k=>k("inactive"))}else sE(c)&&(u=Ap.matrix("active"),l=Object.values(Dp).map(f=>f("inactive")));let d=document.createElement("div");d.className="MLEP__environment-delimiter-controls",d.style.display="flex",d.style.flexDirection="column",d.innerHTML=`
  <div class='MLEP__array-delimiter-options'>
  ${u}
  ${l.join("")}
  </div>`,u&&s.appendChild(d),s.querySelectorAll("[data-command]").forEach(f=>{let g=f.dataset.command,x=g;try{x=JSON.parse(g)}catch{}f.addEventListener("mousedown",w=>w.preventDefault()),x&&f.addEventListener("click",()=>t.executeCommand(x))});let p=(n=t.field)==null?void 0:n.getBoundingClientRect();p&&(o.style.top=`${window.scrollY+(p.top-o.clientHeight-15)}px`,o.style.left=`${p.left+20}px`,o.classList.add("is-visible"))}function Jf(){let t=document.getElementById("mathlive-environment-popover");t?.classList.remove("is-visible")}function kD(){document.getElementById("mathlive-environment-popover")&&(Nl("mathlive-environment-popover"),Gi("environment-popover"),Gi("core"))}function Gu(t){if(!t.hasFocus())return;let e=!1;if(t.model.mode==="math"){let n=t.model.parentEnvironment;if(n!=null&&n.rows&&iE(n.environmentName)){let r=t.options.environmentPopoverPolicy;e=r==="auto"||r==="on"}}e?wD(t):Jf()}function SD(t){return t.replace("*","")}function _D(t){return t==="dcases"?"cases":t}function P5(t){let e=getComputedStyle(t).direction;return e==="ltr"||e==="rtl"?e:"ltr"}function Sv(t,e,n){return e==="left"||e==="leading"&&n==="ltr"||e==="trailing"&&n==="rtl"?t.left:t.right}function Lp(t,e,n,r){return n==="middle"?t-e/2:n==="start"&&r==="rtl"||n==="end"&&r==="ltr"||n==="top"||n==="right"?Math.max(0,t-e):t}function MD(t,e,n,r){return n==="middle"?t-e/2:n==="start"&&r==="ltr"||n==="end"&&r==="rtl"||n==="top"||n==="right"?t:t-e}function CD(t,e){var n,r,i;let o=(n=P5(t))!=null?n:"ltr";t.style.position="fixed",t.style.left="",t.style.top="",t.style.right="",t.style.bottom="",t.style.height="",t.style.width="";let s=t.getBoundingClientRect(),a=Number.isFinite(e.maxHeight)?Math.min(e.maxHeight,window.innerHeight):window.innerHeight,l=Math.min(a,(r=e.height)!=null?r:s.height),u=Lp(e.location.y,l,e.verticalPos,o);u+l>window.innerHeight-8&&(e.alternateLocation?(u=Lp(e.alternateLocation.y,l,e.verticalPos,o),u+l>window.innerHeight-8&&(u=void 0)):u=void 0),Number.isFinite(u)||(u=Math.max(8,window.innerHeight-8-l),8+l>window.innerHeight-8&&(t.style.bottom="8px")),l=Math.min(u+l,window.innerHeight-8)-u;let c=Number.isFinite(e.maxWidth)?Math.min(e.maxWidth,window.innerWidth):window.innerWidth,d=Math.min(c,(i=e.width)!=null?i:s.width),p=Lp(e.location.x,d,e.horizontalPos,o);p+d>window.innerWidth-8&&(e.alternateLocation?(p=MD(e.alternateLocation.x,d,e.verticalPos,o),p+d>window.innerWidth-8&&(p=void 0)):p=void 0),Number.isFinite(p)||(p=Math.max(8,window.innerWidth-8-d),8+d>window.innerWidth-8&&(t.style.right="8px")),d=Math.min(p+d,window.innerWidth-8)-p,o==="rtl"?t.style.right=`${Math.ceil(window.innerWidth-p-d).toString()}px`:t.style.left=`${Math.ceil(p).toString()}px`,t.style.top=`${Math.ceil(u).toString()}px`,l!==s.height&&(t.style.height=`${Math.ceil(l).toString()}px`),d!==s.width&&(t.style.width=`${Math.ceil(d).toString()}px`)}function ED(t,e){return Math.hypot(e.x-t.x,e.y-t.y)}function Ps(t){return"submenu"in t}function Kr(t){return"type"in t&&t.type==="command"||"onMenuSelect"in t||"id"in t}function Gf(t){return"type"in t&&t.type==="divider"}function Tp(t){return"type"in t&&t.type==="heading"}var _v={};function Bp(t){let e=_v[t];if(!e){let n;switch(t){case"checkmark":n=`<span aria-hidden="true" class="ui-checkmark"><svg  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"></path></svg>
      </span>`;break;case"trailing-chevron":n='<span aria-hidden="true" class="ui-trailing-chevron"><svg focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"></path></svg></span>';break;case"mixedmark":n='<span aria-hidden="true" class="ui-mixedmark"><svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 512 512"><path fill="currentColor" d="M0 256c0-13.3 10.7-24 24-24H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H24c-13.3 0-24-10.7-24-24z"/></svg></span>'}if(n){let r=document.createElement("template");r.innerHTML=n,_v[t]=r,e=r}}if(e){if("content"in e)return e.content.cloneNode(!0);let n=document.createElement("svg");return n.innerHTML=e.innerHTML,n}}var Mv=80,I5=class{constructor(t,e){this._className="",this._element=null;var n;this.parentMenu=e,this._declaration=t,Object.freeze(this._declaration),Ps(t)?(this.type="submenu",this.submenu=new R5(t.submenu,{parentMenu:e,submenuClass:t.submenuClass,columnCount:t.columnCount})):this.type=(n=t.type)!=null?n:"command",this.hasCheck=Kr(t)&&t.checked!==void 0}get rootMenu(){return this.parentMenu.rootMenu}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}dispose(){var t,e;(t=this._abortController)==null||t.abort(),this._abortController=void 0,(e=this._element)==null||e.remove(),this._element=null,this.submenu&&this.submenu.dispose(),this.submenu=void 0}get menuItem(){return this._declaration}get label(){var t;return(t=this._label)!=null?t:""}set label(t){t===void 0&&(t=""),t!==this._label&&(this._label=t,this.dirty=!0)}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.dirty=!0)}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.element&&(t?this.element.removeAttribute("aria-disabled"):this.element.setAttribute("aria-disabled","true")),this.dirty=!0}get checked(){return this._checked}set checked(t){this._checked=t,this.dirty=!0}get tooltip(){return this._tooltip}set tooltip(t){t!==this._tooltip&&(this._tooltip=t,this.dirty=!0)}get ariaLabel(){return this._ariaLabel}set ariaLabel(t){t!==this._ariaLabel&&(this._ariaLabel=t,this.dirty=!0)}get active(){var t,e;return(e=(t=this.element)==null?void 0:t.classList.contains("active"))!=null?e:!1}set active(t){this.element&&this.element.classList.toggle("active",t)}updateState(t){var e,n,r;let i=this._declaration;if(Gf(i)){this.enabled=!1,this.checked=!1;return}Tp(i)&&(this.enabled=!1,this.checked=!1,this.visible=!0),Kr(i)&&(this.checked=(e=go(i.checked,t))!=null?e:!1),(Kr(i)||Ps(i))&&(this.enabled=(n=go(i.enabled,t))!=null?n:!0,this.visible=(r=go(i.visible,t))!=null?r:!0,this.visible&&this.enabled&&this.submenu&&(this.submenu.updateState(t),this.submenu.visible||(this.visible=!1))),(Kr(i)||Tp(i)||Ps(i))&&(this.label=go(i.label,t),this._className=go(i.class,t),this.tooltip=go(i.tooltip,t),this.ariaLabel=go(i.ariaLabel,t)),this._element&&this.updateElement()}set dirty(t){t&&this.parentMenu&&(this.parentMenu.dirty=!0)}updateElement(){var t;if(!this.visible||!this.element)return;let e=this.element;e.textContent="",e.className="",e.className=(t=this._className)!=null?t:"",this.enabled?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true"),this.checked===!0?(e.setAttribute("aria-checked","true"),e.append(Bp("checkmark"))):this.checked==="mixed"?(e.setAttribute("aria-checked","mixed"),e.append(Bp("mixedmark"))):e.removeAttribute("aria-checked"),this.ariaLabel&&e.setAttribute("aria-label",this.ariaLabel);let n=document.createElement("span");if(n.className=this.parentMenu.hasCheck?"label indent":"label",this.type==="heading"&&n.classList.add("heading"),n.innerHTML=this.label,e.append(n),this._tooltip&&e.setAttribute("data-tooltip",this._tooltip),Kr(this._declaration)&&this._declaration.keyboardShortcut){let r=document.createElement("kbd");r.innerHTML=s0(this._declaration.keyboardShortcut),e.append(r)}this.type==="submenu"&&e.append(Bp("trailing-chevron"))}get element(){if(this._element)return this._element;if(Gf(this._declaration)){let n=document.createElement("li");return n.setAttribute("part","menu-divider"),n.setAttribute("role","divider"),this._element=n,n}let t=document.createElement("li");this._element=t,(Kr(this._declaration)||Tp(this._declaration)||Ps(this._declaration))&&t.setAttribute("part","menu-item"),t.setAttribute("tabindex","-1"),this.hasCheck?t.setAttribute("role","menuitemcheckbox"):t.setAttribute("role","menuitem"),this.type==="submenu"&&(t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded","false"));let e=this.abortController.signal;return t.addEventListener("pointerenter",this,{signal:e}),t.addEventListener("pointerleave",this,{signal:e}),t.addEventListener("pointerup",this,{signal:e}),t.addEventListener("click",this,{signal:e}),this._element}dispatchSelect(){var t;if(!Kr(this._declaration))return;let e=new CustomEvent("menu-select",{cancelable:!0,bubbles:!0,detail:{modifiers:this.rootMenu.modifiers,id:this._declaration.id,data:this._declaration.data}});this.parentMenu.dispatchEvent(e)&&typeof this._declaration.onMenuSelect=="function"&&this._declaration.onMenuSelect({target:(t=this.parentMenu.host)!=null?t:void 0,modifiers:this.rootMenu.modifiers,id:this._declaration.id,data:this._declaration.data})}handleEvent(t){var e;if(!(!this.visible||!this.enabled)){if(t.type==="click"){this.rootMenu.state==="modal"&&this.select(),t.stopPropagation(),t.preventDefault();return}if(t.type==="pointerenter"){let n=t;this.rootMenu.cancelDelayedOperation(),this.parentMenu.isSubmenuOpen&&(e=this.parentMenu.activeMenuItem)!=null&&e.movingTowardSubmenu(n)?this.rootMenu.scheduleOperation(()=>{this.parentMenu.activeMenuItem=this,this.openSubmenu()}):(this.parentMenu.activeMenuItem=this,this.openSubmenu({withDelay:!0}));return}if(t.type==="pointerleave"){this.rootMenu.activeSubmenu===this.parentMenu&&(this.parentMenu.activeMenuItem=null);return}if(t.type==="pointerup"){this.rootMenu.state!=="modal"&&this.select(),t.stopPropagation(),t.preventDefault();return}}}select(){if(this.rootMenu.cancelDelayedOperation(),this.type==="submenu"){this.openSubmenu();return}this.active=!1,setTimeout(()=>{this.active=!0,setTimeout(()=>{this.active=!1,this.rootMenu.hide(),this.dispatchSelect()},Mv)},Mv)}openSubmenu(t){var e;if(this.type!=="submenu"||!this.element)return;if((e=t?.withDelay)!=null&&e){this.rootMenu.scheduleOperation(()=>this.openSubmenu());return}let n=this.element.getBoundingClientRect(),r=P5(this.element);this.submenu.show({container:this.rootMenu.element.parentNode,location:{x:Sv(n,"trailing",r),y:n.top-4},alternateLocation:{x:Sv(n,"leading",r),y:n.top-4}})}movingTowardSubmenu(t){if(!this.element||this.type!=="submenu")return!1;let e=this.rootMenu.lastMoveEvent;if(!e)return!1;let n=t.timeStamp-e.timeStamp;if(n>500)return!1;let r=t.clientX-e.clientX;if(AD(r,e.clientY-t.clientY,n)<=.2)return!1;let i="right";if(this.submenu.element){let o=this.submenu.element.getBoundingClientRect(),s=this.element.getBoundingClientRect();o.left<s.left+s.width/2&&(i="left")}return i==="right"?r>0:r<0}};function AD(t,e,n){return Math.hypot(t,e)/n}function go(t,e){return t===void 0||typeof t!="function"?t:(e!=null||(e={alt:!1,control:!1,shift:!1,meta:!1}),t(e))}var R5=class Fa{constructor(e,n){this._element=null,this._activeMenuItem=null,this._dirty=!0;var r,i;this.parentMenu=(r=n?.parentMenu)!=null?r:null,this._submenuClass=n?.submenuClass,this.columnCount=(i=n?.columnCount)!=null?i:1,this.isSubmenuOpen=!1,this.menuItems=e}get children(){return Object.freeze([...this._menuItems])}set menuItems(e){let n=this.parentMenu;this.dispose(),this.parentMenu=n,e=[...e],this._menuItems=e.map(r=>r.onCreate?r.onCreate(r,this):new I5(r,this)),this.hasCheck=void 0,this.dirty=!0}dispose(){var e;this.hide(),this._element&&this._element.remove(),this._abortController&&this._abortController.abort(),(e=this._menuItems)==null||e.forEach(n=>n.dispose()),this._menuItems=[],this._activeMenuItem=null,this.parentMenu=null}handleEvent(e){if(e.type==="wheel"&&this._element){let n=e;this._element.scrollBy(0,n.deltaY),e.stopPropagation()}}dispatchEvent(e){return this.rootMenu.dispatchEvent(e)}get host(){return this.rootMenu.host}get rootMenu(){return this.parentMenu.rootMenu}updateState(e){var n,r,i;this._menuItems.forEach(u=>u.updateState(e));let o=this.hasCheck;this.hasCheck=this._menuItems.some(u=>u.visible&&u.hasCheck),this.hasCheck!==o&&this._menuItems.forEach(u=>u.updateState(e));let s,a=0;for(let u of this._menuItems)u.type==="heading"?(s&&a===0&&(s.visible=!1),s=u,a=0):u.type==="divider"&&s?(s.visible=a>0,s=void 0,a=0):s&&u.visible&&(a+=1);s&&(s.visible=a>0);let l=!0;for(let u of this._menuItems)u.type==="divider"?(u.visible=!l,l=!0):u.visible&&(l=!1);(n=this.activeMenuItem)!=null&&n.visible||(this.activeMenuItem=null),!((r=this.activeMenuItem)!=null&&r.enabled)&&((i=this.activeMenuItem)==null?void 0:i.type)==="submenu"&&this._activeMenuItem.submenu.hide(),this._dirty=!1}get enabled(){return this.updateIfDirty(),this._menuItems.some(e=>e.type!=="divider"&&e.visible&&e.enabled)}get visible(){return this.updateIfDirty(),this._menuItems.some(e=>e.type!=="divider"&&e.visible)}set dirty(e){this._dirty!==e&&e&&this.parentMenu&&(this._dirty=!0,this.parentMenu.dirty=!0)}updateIfDirty(){this._dirty&&this.updateState(this.rootMenu.modifiers)}updateElement(){var e;if(this._element){this._element.textContent="";for(let{element:n,visible:r}of this._menuItems)n&&r&&this._element.append(n);(e=this._element.querySelector("li:first-of-type"))==null||e.setAttribute("tabindex","0")}}get element(){if(this._element)return this._element;let e=document.createElement("menu");e.setAttribute("role","menu"),e.setAttribute("tabindex","-1"),e.setAttribute("aria-orientation","vertical"),e.setAttribute("part","ui-menu-container"),this._submenuClass&&e.classList.add(this._submenuClass),e.classList.add("ui-menu-container"),this._abortController||(this._abortController=new AbortController);let n=this._abortController.signal;return e.addEventListener("focus",this,{signal:n}),e.addEventListener("wheel",this,{passive:!0,signal:n}),this._element=e,this.updateElement(),e}get activeMenuItem(){return this._activeMenuItem}set activeMenuItem(e){var n,r,i,o;if(this.rootMenu.cancelDelayedOperation(),e!==this._activeMenuItem){if(this.activeMenuItem){let s=this.activeMenuItem;s.active=!1,(n=s.submenu)==null||n.hide()}if(!((r=e?.visible)==null||r)){this._activeMenuItem=null;return}this._activeMenuItem=e,e&&(e.active=!0)}e?(i=e.element)==null||i.focus({preventScroll:!0}):(o=this._element)==null||o.focus({preventScroll:!0})}get firstMenuItem(){this.updateIfDirty();let e=0,n=!1,r=this._menuItems;for(;!n&&e<=r.length-1;){let i=r[e];n=i.type!=="divider"&&i.visible&&i.enabled,e+=1}return n?r[e-1]:null}get lastMenuItem(){this.updateIfDirty();let e=this._menuItems,n=e.length-1,r=!1;for(;!r&&n>=0;){let i=e[n];r=i.type!=="divider"&&i.visible&&i.enabled,n-=1}return r?e[n+1]:null}nextMenuItem(e){if(e===0)return this._activeMenuItem;if(!this._activeMenuItem)return e>0?this.firstMenuItem:this.lastMenuItem;if(!this.firstMenuItem||!this.lastMenuItem||!this._activeMenuItem)return null;this.updateIfDirty();let n=this._menuItems.indexOf(this.firstMenuItem),r=this._menuItems.indexOf(this.lastMenuItem),i=this._menuItems.indexOf(this._activeMenuItem),o=1;for(;i>=n&&i<=r;){i+=e>0?1:-1;let s=this._menuItems[i];if(!s)break;if(s.visible&&s.enabled){if(o===Math.abs(e))return this._menuItems[i];o+=1}}return e>0?this.lastMenuItem:this.firstMenuItem}getMenuItemColumn(e){this.updateIfDirty();let n=this._menuItems.filter(r=>r.visible&&r.enabled).indexOf(e);return n<0?-1:n%this.columnCount}static get collator(){return Fa._collator||(Fa._collator=new Intl.Collator(void 0,{usage:"search",sensitivity:"base"})),Fa._collator}findMenuItem(e){var n;this.updateIfDirty();let r=this._menuItems.filter(a=>a.type!=="divider"&&a.visible&&a.enabled);if(r.length===0)return null;let i=Math.max(...r.map(a=>a.label.length))-e.length;if(i<0)return null;let o=null,s=0;for(;s<i&&!o;)o=(n=r.find(a=>Fa.collator.compare(e,a.label.substring(s,e.length))===0))!=null?n:null,s++;return o}show(e){return!this.visible||!e.container?!1:(this.updateElement(),e.container.appendChild(this.element),Qg()&&(this.element.popover="manual",this.element.showPopover()),e.location&&CD(this.element,{location:e.location,alternateLocation:e.alternateLocation,verticalPos:"bottom",horizontalPos:"start"}),Cv(),this.element.focus({preventScroll:!0}),Ev(),this.parentMenu&&(this.parentMenu.openSubmenu=this),!0)}hide(){var e,n,r,i,o,s;this.openSubmenu=null,this.activeMenuItem=null,this.parentMenu&&(this.parentMenu.openSubmenu=null),!(!((e=this._element)!=null&&e.isConnected)||!this._element.parentElement)&&(Qg()&&(n=this._element)!=null&&n.popover&&this._element.hidePopover(),Cv(),(i=(r=this.parentMenu)==null?void 0:r.element)==null||i.focus(),(s=(o=this._element)==null?void 0:o.parentNode)==null||s.removeChild(this._element),Ev())}set openSubmenu(e){var n,r,i,o;let s=e!==null;((n=this.activeMenuItem)==null?void 0:n.type)==="submenu"&&((r=this.activeMenuItem.element)==null||r.setAttribute("aria-expanded",s.toString())),(o=(i=this.activeMenuItem)==null?void 0:i.element)==null||o.classList.toggle("is-submenu-open",s),this.isSubmenuOpen=s}};function Cv(){document.addEventListener("focusin",zi,!0),document.addEventListener("focusout",zi,!0),document.addEventListener("focus",zi,!0),document.addEventListener("blur",zi,!0)}function zi(t){t.stopImmediatePropagation(),t.preventDefault()}function Ev(){document.removeEventListener("focusin",zi,!0),document.removeEventListener("focusout",zi,!0),document.removeEventListener("focus",zi,!0),document.removeEventListener("blur",zi,!0)}var z5=class F5 extends R5{constructor(e,n){var r;super(e),this.state="closed",this.typingBufferResetTimer=0,this.hysteresisTimer=0,this._updating=!1,this._host=(r=n?.host)!=null?r:null,this.isDynamic=e.some($5),this._modifiers={shift:!1,control:!1,alt:!1,meta:!1},this.typingBuffer="",this.state="closed"}get modifiers(){return this._modifiers}set modifiers(e){IE(this._modifiers,e)||(this._modifiers=e,this.dirty=!0)}get activeSubmenu(){let e=this;for(;e.isSubmenuOpen;)e=e.activeMenuItem.submenu;return e}set dirty(e){this._updating||this._dirty!==e&&(this._dirty=!0,e&&setTimeout(()=>{this.updateState(this.modifiers),this.updateElement()}))}updateState(e){this._updating=!0,this.modifiers=e??this.modifiers,super.updateState(this.modifiers),this._updating=!1}handleKeyupEvent(e){this.isDynamic&&(this.modifiers=Lo(e)),e.stopImmediatePropagation()}handleKeydownEvent(e){var n,r,i;if(e.key==="Tab"||e.key==="Escape"){this.hide();return}this.isDynamic&&(this.modifiers=Lo(e));let o=!0,s=this.activeSubmenu,a=s.activeMenuItem;switch(e.key){case" ":case"Space":case"Return":case"Enter":a?.select(Lo(e));break;case"ArrowRight":if(a?.type==="submenu")a.select(Lo(e)),this.activeSubmenu.activeMenuItem=this.activeSubmenu.firstMenuItem;else if(!a)s.activeMenuItem=s.firstMenuItem;else{let l=(n=s.getMenuItemColumn(a))!=null?n:-1;if(l>=0&&l<((r=s.columnCount)!=null?r:1)-1){let u=s.nextMenuItem(1);u&&(s.activeMenuItem=u)}}break;case"ArrowLeft":if(s===this.rootMenu)a||(s.activeMenuItem=s.firstMenuItem);else if((a&&(i=s.getMenuItemColumn(a))!=null?i:-1)<=0||!a){s.hide();let l=s.parentMenu.activeMenuItem;if(l){let{element:u}=l;u?.focus(),u?.classList.remove("is-submenu-open")}}else{let l=s.nextMenuItem(-1);l&&(s.activeMenuItem=l)}break;case"ArrowDown":s.activeMenuItem=s.nextMenuItem(s.columnCount);break;case"ArrowUp":s.activeMenuItem=s.nextMenuItem(-s.columnCount);break;case"Home":case"PageUp":s.activeMenuItem=s.firstMenuItem;break;case"End":case"PageDown":s.activeMenuItem=s.lastMenuItem;break;case"Backspace":if(this.typingBuffer&&(this.typingBuffer=this.typingBuffer.slice(0,-1),this.typingBuffer)){clearTimeout(this.typingBufferResetTimer);let l=s.findMenuItem(this.typingBuffer);l&&(s.activeMenuItem=l),this.typingBufferResetTimer=setTimeout(()=>{this.typingBuffer=""},500)}break;default:if(xl(e)){isFinite(this.typingBufferResetTimer)&&clearTimeout(this.typingBufferResetTimer),this.typingBuffer+=e.key;let l=s.findMenuItem(this.typingBuffer);l&&(s.activeMenuItem=l),this.typingBufferResetTimer=setTimeout(()=>{this.typingBuffer=""},500)}else o=!1}o&&(e.preventDefault(),e.stopPropagation())}handleEvent(e){if(e.type==="keydown")this.handleKeydownEvent(e);else if(e.type==="keyup")this.handleKeyupEvent(e);else if(e.type==="pointermove")this.lastMoveEvent=e;else if(e.type==="pointerup")Number.isFinite(this.rootMenu._openTimestamp)&&Date.now()-this.rootMenu._openTimestamp<120?this.state="modal":this.state==="modal"&&e.target===this.scrim&&this.hide();else if(e.type==="contextmenu"){e.preventDefault(),e.stopPropagation();return}super.handleEvent(e)}dispatchEvent(e){return this._host?this._host.dispatchEvent(e):!0}get host(){return this._host}get scrim(){return sr.element}connectScrim(e){let n=this.scrim;n.addEventListener("pointerup",this,!0),n.addEventListener("contextmenu",this),n.addEventListener("keydown",this),n.addEventListener("keyup",this),n.addEventListener("pointermove",this),sr.open({root:e,onDismiss:()=>this.hide()})}disconnectScrim(){let e=this.scrim;e.removeEventListener("pointerup",this,!0),e.removeEventListener("contextmenu",this),e.removeEventListener("keydown",this),e.removeEventListener("keyup",this),e.removeEventListener("pointermove",this),sr.state==="open"&&sr.scrim.close()}get rootMenu(){return this}show(e){return this._onDismiss=e?.onDismiss,e!=null&&e.modifiers&&(this.modifiers=e.modifiers),this.updateState(),this.connectScrim(e?.target),super.show(V(O({},e),{container:this.scrim}))?(this._openTimestamp=Date.now(),this.state="open",!0):(this.disconnectScrim(),!1)}hide(){this.cancelDelayedOperation(),this.state!==void 0&&(this.state!=="closed"&&(this.activeMenuItem=null,sr.element.parentElement.focus(),super.hide(),this.state="closed",this.disconnectScrim()),this._onDismiss&&(this._onDismiss(),this._onDismiss=void 0))}scheduleOperation(e){this.cancelDelayedOperation();let n=F5.SUBMENU_DELAY;if(n<=0){e();return}this.hysteresisTimer=setTimeout(()=>{this.hysteresisTimer=0,e()},n)}cancelDelayedOperation(){this.hysteresisTimer&&(clearTimeout(this.hysteresisTimer),this.hysteresisTimer=0)}};z5.SUBMENU_DELAY=120;var Av=z5;function $5(t){return Gf(t)?!1:typeof t.label=="function"||typeof t.ariaLabel=="function"||typeof t.tooltip=="function"||(Kr(t)||Ps(t))&&(typeof t.enabled=="function"||typeof t.visible=="function")||Kr(t)&&typeof t.checked=="function"?!0:Ps(t)?t.submenu.some($5):!1}var Ad=class{};Ad.DELAY=300,Ad.MAX_DISTANCE=10;function DD(t){return new Promise((e,n)=>{let r=xd(t);r||e(!1);let i=r,o=setTimeout(()=>{s.abort(),e(ED(i,r)<Ad.MAX_DISTANCE)},Ad.DELAY),s=new AbortController,a=s.signal;for(let l of["pointermove","pointerup","pointercancel"])window.addEventListener(l,u=>{if(u.type==="pointerup"||u.type==="pointercancel")clearTimeout(o),s.abort(),e(!1);else if(u.type==="pointermove"){let c=xd(u);c&&(i=c)}},{passive:!0,signal:a})})}async function Dv(t,e,n){if(t.defaultPrevented)return!1;if(t.type==="contextmenu"){let r=t;if(t.preventDefault(),t.stopPropagation(),n.show({target:e,location:xd(r),modifiers:Lo(r)}))return!0}if(t.type==="keydown"){let r=t;if(r.code==="ContextMenu"||r.code==="F10"&&r.shiftKey){let i=e?.getBoundingClientRect();if(Lv(e)&&i&&n.show({target:e,location:{x:Math.ceil(i.left+i.width/2),y:Math.ceil(i.top+i.height/2)},modifiers:Lo(r)}))return t.preventDefault(),t.stopPropagation(),!0}}if(t.type==="pointerdown"&&t.pointerType!=="mouse"&&t.button===0){let r=t.target;for(;r&&e!==r;)r=r.parentNode;if(!r||!n.visible)return!1;let i=xd(t);if(await DD(t))return n.state!=="closed"||!Lv(e)?!1:(n.show({target:e,location:i}),!0)}return!1}function Lv(t){return t.dispatchEvent(new Event("contextmenu",{cancelable:!0}))}var K5="<mo>&#x2061;</mo>",Dd="<mo>&#8290;</mo>";function bc(t){return t.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function at(t,e){return!t||!e.generateID?"":` extid="${t}"`}function LD(t,e,n){var r,i,o,s,a,l,u,c;let d=!1;e=e??t.atoms.length;let p="",f="",g=t.atoms[t.index],x=(r=g.style)==null?void 0:r.variant,w=(i=g.style)==null?void 0:i.variantStyle,k="";if(g.value&&(x||w)){let N=(o=_f(g.value,x,w))!=null?o:g.value;if(N!==g.value)return t.index+=1,p=`<mi${at(g.id,n)}>${N}</mi>`,_r(p,t,n)||(t.mathML+=p,t.lastType="mi"),!0;k=(s={upnormal:"normal",boldnormal:"bold",italicmain:"italic",bolditalicmain:"bold-italic","updouble-struck":"double-struck","double-struck":"double-struck",boldfraktur:"bold-fraktur",calligraphic:"script",upcalligraphic:"script",script:"script",boldscript:"bold-script",boldcalligraphic:"bold-script",fraktur:"fraktur","upsans-serif":"sans-serif","boldsans-serif":"bold-sans-serif","italicsans-serif":"sans-serif-italic","bolditalicsans-serif":"sans-serif-bold-italic",monospace:"monospace"}[(w??"")+(x??"")])!=null?s:"",k&&(k=` mathvariant="${k}"`)}let D={"\\exponentialE":"&#x02147;","\\imaginaryI":"&#x2148;","\\differentialD":"&#x2146;","\\capitalDifferentialD":"&#x2145;","\\alpha":"&#x03b1;","\\pi":"&#x03c0;","\\infty":"&#x221e;","\\forall":"&#x2200;","\\nexists":"&#x2204;","\\exists":"&#x2203;","\\hbar":"","\\cdotp":"","\\ldots":"","\\cdots":"","\\ddots":"","\\vdots":"","\\ldotp":"."};if(g.command==="!")return t.index+=1,p="<mo>!</mo>",_r(p,t,n)||(t.mathML+=p,t.lastType="mo"),!0;if(D[g.command]){t.index+=1;let N=`<mi${at(g.id,n)}${k}>${D[g.command]}</mi>`;return(t.lastType==="mi"||t.lastType==="mn"||t.lastType==="mtext"||t.lastType==="fence")&&(N=Dd+N),_r(N,t,n)||(t.mathML+=N,t.lastType="mi"),!0}if(g.command==="\\operatorname")f=js(g.body),t.index+=1;else if(x||w)for(;t.index<e&&(g.type==="mord"||g.type==="macro")&&!g.isDigit()&&x===((l=(a=g.style)==null?void 0:a.variant)!=null?l:"")&&w===((c=(u=g.style)==null?void 0:u.variantStyle)!=null?c:"");)f+=js([g]),t.index+=1,g=t.atoms[t.index];else(g.type==="mord"||g.type==="macro")&&!g.isDigit()&&(f+=js([g]),t.index+=1);if(f.length>0){d=!0,p=`<mi${k}>${f}</mi>`;let N=t.lastType;p.endsWith(">f</mi>")||p.endsWith(">g</mi>")?(p+=K5,t.lastType="applyfunction"):t.lastType=/^<mo>(.*)<\/mo>$/.test(p)?"mo":"mi",_r(p,t,n)||((N==="mi"||N==="mn"||N==="mtext"||N==="fence")&&(p=Dd+p),t.mathML+=p)}return d}function j5(t){return t.index<t.atoms.length&&t.atoms[t.index].superscript&&t.atoms[t.index].type==="subsup"}function q5(t){let e=-1,n=t.index,r=!1,i=!1;for(;n<t.atoms.length&&!r&&!i;){let o=t.atoms[n];r=!o.isDigit(),i=!r&&o.superscript!==void 0,n++}return i&&(e=n-1),e}function _r(t,e,n){var r;let i=e.atoms[e.index-1];if(!i)return!1;if(!i.superscript&&!i.subscript)if(((r=e.atoms[e.index])==null?void 0:r.type)==="subsup")i=e.atoms[e.index],e.index+=1;else return!1;let o=e.lastType;e.lastType="";let s=Ze(i.superscript,n);e.lastType="";let a=Ze(i.subscript,n);if(e.lastType=o,!s&&!a)return!1;let l="";return s&&a?l=`<msubsup>${t}${a}${s}</msubsup>`:s?l=`<msup>${t}${s}</msup>`:a&&(l=`<msub>${t}${a}</msub>`),e.mathML+=l,e.lastType="",!0}function TD(t,e,n){e=e??t.atoms.length;let r=t.index,i="",o=q5(t);for(o>=0&&o<e&&(e=o);t.index<e&&t.atoms[t.index].mode==="text";)i+=t.atoms[t.index].value?t.atoms[t.index].value:" ",t.index+=1;return i.length>0?(i=`<mtext ${at(t.atoms[r].id,n)}>${i}</mtext>`,o<0&&j5(t)&&(o=t.index,t.index+=1),_r(i,t,n)||(t.mathML+=i,t.lastType="mtext"),!0):!1}function BD(t,e,n){e=e??t.atoms.length;let r=t.index,i="",o=q5(t);for(o>=0&&o<e&&(e=o);t.index<e&&t.atoms[t.index].isDigit();)i+=t.atoms[t.index].asDigit(),t.index+=1;return i.length<=0?!1:(i="<mn"+at(t.atoms[r].id,n)+">"+i+"</mn>",o<0&&j5(t)&&(o=t.index,t.index+=1),_r(i,t,n)||(t.mathML+=i,t.lastType="mn"),!0)}function OD(t,e,n){let r=!1;e=e??t.atoms.length;let i="",o="";if(t.index<e&&t.atoms[t.index].type==="mopen"){let s=!1,a=0,l=t.index,u=-1,c=l+1;for(;c<e&&!s;)t.atoms[c].type==="mopen"?a+=1:t.atoms[c].type==="mclose"&&(a-=1),a===-1&&(s=!0,u=c),c+=1;s&&(i="<mrow>",i+=$o(t.atoms[l],n),i+=Ze(t.atoms,n,l+1,u),i+=$o(t.atoms[u],n),i+="</mrow>",t.index=u+1,(t.lastType==="mi"||t.lastType==="mn"||t.lastType==="mfrac"||t.lastType==="fence")&&(t.mathML+=Dd),_r(i,t,n)&&(r=!0,t.lastType="",i=""),o="fence")}return i.length>0&&(r=!0,t.mathML+=i,t.lastType=o),r}function ND(t,e,n){let r=!1;e=e??t.atoms.length;let i="",o="",s=t.atoms[t.index];if(!s)return!1;let a={"\\ne":"&ne;","\\neq":"&ne;","\\pm":"&#177;","\\times":"&#215;","\\colon":":","\\vert":"|","\\Vert":"","\\mid":"","\\{":"{","\\}":"}","\\lbrace":"{","\\rbrace":"}","\\lbrack":"[","\\rbrack":"]","\\lparen":"(","\\rparen":")","\\langle":"","\\rangle":"","\\lfloor":"","\\rfloor":"","\\lceil":"","\\rceil":""};if(a[s.command]){t.index+=1;let l=`<mo${at(s.id,n)}>${a[s.command]}</mo>`;return _r(l,t,n)||(t.mathML+=l,t.lastType="mo"),!0}if(t.index<e&&(s.type==="mbin"||s.type==="mrel"))i+=Xf(t.atoms[t.index],n),t.index+=1,o="mo";else if(t.index<e&&(s.type==="mop"||s.type==="operator"||s.type==="extensible-symbol")){if(s.subsupPlacement==="over-under"&&(s.superscript||s.subscript)){let l=$o(s,n);return s.superscript&&s.subscript?(i+="<munderover>"+l,i+=Ze(s.subscript,n),i+=Ze(s.superscript,n),i+="</munderover>"):s.superscript?(i+="<mover>"+l,i+=Ze(s.superscript,n),i+="</mover>"):s.subscript&&(i+="<munder>"+l,i+=Ze(s.subscript,n),i+="</munder>"),t.mathML+=i,t.lastType="mo",t.index+=1,!0}{let l=t.atoms[t.index],u=l.value==="\\operatorname",c=u?'<mi class="MathML-Unit"'+at(l.id,n)+">"+js(l.value)+"</mi>":$o(l,n);i+=c,!u&&!/^<mo>(.*)<\/mo>$/.test(c)?(i+=K5,o="applyfunction"):o=u?"mi":"mo"}(t.lastType==="mi"||t.lastType==="mn")&&!/^<mo>(.*)<\/mo>$/.test(i)&&(i=Dd+i),t.index+=1}return i.length>0&&(r=!0,_r(i,t,n)||(t.mathML+=i,t.lastType=o)),r}function Ze(t,e,n,r){e!=null||(e={});let i={atoms:[],index:n??0,mathML:"",lastType:""};if(typeof t=="number"||typeof t=="boolean")i.mathML=t.toString();else if(typeof t=="string")i.mathML=t;else if(t instanceof G)i.mathML=Xf(t,e);else if(Array.isArray(t)){i.atoms=t;let o=0;for(r=r||(t?t.length:0);i.index<r;)if(TD(i,r,e)||BD(i,r,e)||LD(i,r,e)||ND(i,r,e)||OD(i,r,e))o+=1;else if(i.index<r){let s=Xf(i.atoms[i.index],e);i.lastType==="mn"&&s.length>0&&i.atoms[i.index].type==="genfrac"&&(s="<mo>&#x2064;</mo>"+s),i.atoms[i.index].type==="genfrac"?i.lastType="mfrac":i.lastType="",i.index+=1,_r(s,i,e)?o+=1:s.length>0&&(i.mathML+=s,o+=1)}o>1&&(i.mathML="<mrow>"+i.mathML+"</mrow>")}return i.mathML}function $o(t,e){let n="",r=js(t.value);return r&&(n="<mo"+at(t.id,e)+">"+r+"</mo>"),n}function js(t){if(!t)return"";if(typeof t=="string")return bc(t);if(!Array.isArray(t)&&typeof t.body=="string")return bc(t.body);let e="";for(let n of t)typeof n.value=="string"&&(e+=n.value);return bc(e)}function Xf(t,e){var n,r,i,o,s,a,l,u,c,d,p,f,g,x,w,k,D,N,B,T,R,L,P;if(t.mode==="text")return`<mi${at(t.id,e)}>${t.value}</mi>`;let W={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",longleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",longrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",longrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xleftrightarrows:"",xRightleftharpoons:"",longRightleftharpoons:"",xLeftrightharpoons:"",longLeftrightharpoons:""},de={"\\!":-3/18,"\\ ":6/18,"\\,":3/18,"\\:":4/18,"\\>":4/18,"\\;":5/18,"\\enspace":.5,"\\quad":1,"\\qquad":2,"\\enskip":.5},q="",ae="",be,re,ce,ge,xe,De,{command:We}=t;if(t.command==="\\error")return`<merror${at(t.id,e)}>${Ze(t.body,e)}</merror>`;let et={"\\vert":"|","\\Vert":"","\\mid":"","\\lbrack":"[","\\rbrack":"]","\\{":"{","\\}":"}","\\lbrace":"{","\\rbrace":"}","\\lparen":"(","\\rparen":")","\\langle":"","\\rangle":"","\\lfloor":"","\\rfloor":"","\\lceil":"","\\rceil":""},Ae={"\\vec":"&#x20d7;","\\acute":"&#x00b4;","\\grave":"&#x0060;","\\dot":"&#x02d9;","\\ddot":"&#x00a8;","\\tilde":"&#x007e;","\\bar":"&#x00af;","\\breve":"&#x02d8;","\\check":"&#x02c7;","\\hat":"&#x005e;"};switch(t.type){case"first":break;case"error":if(t.command==="\\\\")break;q=`<merror${at(t.id,e)}>${Ze(t.body,e)}</merror>`;break;case"group":case"root":q=Ze(t.body,e);break;case"array":let Ke=t;if((Ke.leftDelim&&Ke.leftDelim!=="."||Ke.rightDelim&&Ke.rightDelim!==".")&&(q+="<mrow>",Ke.leftDelim&&Ke.leftDelim!=="."&&(q+=`<mo>${et[Ke.leftDelim]||Ke.leftDelim}</mo>`)),q+="<mtable",Ke.colFormat){for(q+=' columnalign="',ce=0;ce<Ke.colFormat.length;ce++){let b=Ke.colFormat[ce];"align"in b&&(q+={l:"left",c:"center",r:"right"}[b.align]+" ")}q+='"'}for(q+=">",re=0;re<Ke.rows.length;re++){for(q+="<mtr>",be=0;be<Ke.rows[re].length;be++)q+="<mtd>"+Ze(Ke.rows[re][be],e)+"</mtd>";q+="</mtr>"}q+="</mtable>",(Ke.leftDelim&&Ke.leftDelim!=="."||Ke.rightDelim&&Ke.rightDelim!==".")&&(Ke.rightDelim&&Ke.rightDelim!=="."&&(q+=`<mo>${et[Ke.rightDelim]||Ke.rightDelim}</mo>`),q+="</mrow>");break;case"genfrac":let ot=t;(ot.leftDelim||ot.rightDelim)&&(q+="<mrow>"),ot.leftDelim&&ot.leftDelim!=="."&&(q+="<mo"+at(t.id,e)+">"+(et[ot.leftDelim]||ot.leftDelim)+"</mo>"),ot.hasBarLine?(q+="<mfrac>",q+=Ze(t.above,e)||"<mi>&nbsp;</mi>",q+=Ze(t.below,e)||"<mi>&nbsp;</mi>",q+="</mfrac>"):(q+="<mtable"+at(t.id,e)+">",q+="<mtr>"+Ze(t.above,e)+"</mtr>",q+="<mtr>"+Ze(t.below,e)+"</mtr>",q+="</mtable>"),ot.rightDelim&&ot.rightDelim!=="."&&(q+="<mo"+at(t.id,e)+">"+(et[ot.rightDelim]||ot.rightDelim)+"</mo>"),(ot.leftDelim||ot.rightDelim)&&(q+="</mrow>");break;case"surd":t.hasEmptyBranch("above")?(q+="<msqrt"+at(t.id,e)+">",q+=Ze(t.body,e),q+="</msqrt>"):(q+="<mroot"+at(t.id,e)+">",q+=Ze(t.body,e),q+=Ze(t.above,e),q+="</mroot>");break;case"leftright":let Bt=t,Ot=Bt.leftDelim;q="<mrow>",Ot&&Ot!=="."&&(q+=`<mo${at(t.id,e)}>${(n=et[Ot])!=null?n:Ot}</mo>`),t.body&&(q+=Ze(t.body,e));let S=Bt.matchingRightDelim();S&&S!=="."&&(q+=`<mo${at(t.id,e)}>${(r=et[S])!=null?r:S}</mo>`),q+="</mrow>";break;case"sizeddelim":case"delim":q+=`<mo${at(t.id,e)}>${et[t.value]||t.value}</mo>`;break;case"accent":let M=t;q+='<mover accent="true"'+at(t.id,e)+">",q+=Ze(t.body,e),q+="<mo>"+(Ae[We]||M.accent)+"</mo>",q+="</mover>";break;case"line":case"overlap":break;case"overunder":let h=t;xe=t.above,ge=t.below,(h.svgAbove||xe)&&(h.svgBelow||ge)?De=t.body:xe&&xe.length>0?(De=t.body,(o=(i=t.body)==null?void 0:i[0])!=null&&o.below?(ge=t.body[0].below,De=t.body[0].body):((a=(s=t.body)==null?void 0:s[0])==null?void 0:a.type)==="first"&&(u=(l=t.body)==null?void 0:l[1])!=null&&u.below&&(ge=t.body[1].below,De=t.body[1].body)):ge&&ge.length>0&&(De=t.body,(d=(c=t.body)==null?void 0:c[0])!=null&&d.above?(xe=t.body[0].above,De=t.body[0].body):((f=(p=t.body)==null?void 0:p[0])==null?void 0:f.type)==="first"&&(x=(g=t.body)==null?void 0:g[1])!=null&&x.above&&(xe=t.body[1].above,De=t.body[1].body)),(h.svgAbove||xe)&&(h.svgBelow||ge)?(q+=`<munderover ${at(t.id,e)}>`,q+=(w=W[h.svgBody])!=null?w:Ze(De,e),q+=(k=W[h.svgBelow])!=null?k:Ze(ge,e),q+=(D=W[h.svgAbove])!=null?D:Ze(xe,e),q+="</munderover>"):h.svgAbove||xe?(q+=`<mover ${at(t.id,e)}>`+((N=W[h.svgBody])!=null?N:Ze(De,e)),q+=(B=W[h.svgAbove])!=null?B:Ze(xe,e),q+="</mover>"):(h.svgBelow||ge)&&(q+=`<munder ${at(t.id,e)}>`+((T=W[h.svgBody])!=null?T:Ze(De,e)),q+=(R=W[h.svgBelow])!=null?R:Ze(ge,e),q+="</munder>");break;case"placeholder":q+="?";break;case"mord":{if(q=typeof t.value=="string"?t.value:We,q.length>0&&q.startsWith("\\"))typeof t.value=="string"&&t.value.charCodeAt(0)>255?q="&#x"+("000000"+t.value.charCodeAt(0).toString(16)).slice(-4)+";":typeof t.value=="string"&&(q=t.value.charAt(0));else if(t.command==="\\char"){let v=(L=t.args)==null?void 0:L[0];if(v!==void 0&&"number"in v){let _=v.number;typeof _=="number"&&(q="&#x"+("000000"+_.toString(16)).slice(-4)+";")}}else typeof t.value=="string"?q=t.value:(console.error("Did not expect this"),q="");let b=/\d/.test(q)?"mn":"mi";q=`<${b}${at(t.id,e)}>${bc(q)}</${b}>`;break}case"mbin":case"mrel":case"minner":q=$o(t,e);break;case"mpunct":q='<mo separator="true"'+at(t.id,e)+">"+We+"</mo>";break;case"mop":case"operator":case"extensible-symbol":t.value!==""&&(q="<mo"+at(t.id,e)+">",q+=We==="\\operatorname"?t.body:We||t.body,q+="</mo>");break;case"box":let m=t;q='<menclose notation="box"',m.backgroundcolor&&(q+=' mathbackground="'+m.backgroundcolor+'"'),q+=at(t.id,e)+">"+Ze(t.body,e)+"</menclose>";break;case"spacing":q+='<mspace width="'+((P=de[We])!=null?P:0)+'em"/>';break;case"enclose":let y=t;q='<menclose notation="';for(let b in y.notation)Object.prototype.hasOwnProperty.call(y.notation,b)&&y.notation[b]&&(q+=ae+b,ae=" ");q+=at(t.id,e)+'">'+Ze(t.body,e)+"</menclose>";break;case"prompt":q='<menclose notation="roundexbox""">'+Ze(t.body,e)+"</menclose>";break;case"space":q+="&nbsp;";break;case"subsup":break;case"phantom":break;case"composition":break;case"rule":break;case"chem":break;case"mopen":q+=$o(t,e);break;case"mclose":q+=$o(t,e);break;case"macro":{let b=t.command+js(t.macroArgs);b&&(q+=`<mo ${at(t.id,e)}>${b}</mo>`)}break;case"latexgroup":q+=Ze(t.body,e);break;case"latex":q+="<mtext"+at(t.id,e)+">"+t.value+"</mtext>";break;case"tooltip":q+=Ze(t.body,e);break;case"text":q+=`<mtext ${at(t.id,e)}x>${t.value}</mtext>`;break;default:if(t.command==="\\displaystyle")return`<mrow ${at(t.id,e)} displaystyle="true">${Ze(t.body,e)}</mrow>`;if(t.command==="\\textstyle")return`<mrow ${at(t.id,e)} displaystyle="false">${Ze(t.body,e)}</mrow>`;console.info("Unexpected element in conversion to MathML:",t)}return q}var xs={"\\alpha":"alpha ","\\mu":"mew ","\\sigma":"sigma ","\\pi":"pie ","\\imaginaryI":"imaginary eye ","\\imaginaryJ":"imaginary jay ","\\sum":"Summation ","\\prod":"Product ","+":"plus ","-":"minus ",";":'<break time="150ms"/> semi-colon <break time="150ms"/>',",":'<break time="150ms"/> comma  <break time="150ms"/>',"|":'<break time="150ms"/>Vertical bar<break time="150ms"/>',"(":'<break time="150ms"/>Open paren. <break time="150ms"/>',")":'<break time="150ms"/> Close paren. <break time="150ms"/>',"=":"equals ","<":"is less than ","\\lt":"is less than ","<=":"is less than or equal to ","\\le":"is less than or equal to ","\\gt":"is greater than ",">":"is greater than ","\\pm":"plus or minus","\\mp":"minus or plus","\\ge":"is greater than or equal to ","\\geq":"is greater than or equal to ","\\leq":"is less than or equal to ","\\ne":"is not equal to ","\\neq":"is not equal to ","!":"factorial ","\\sin":"sine ","\\cos":"cosine ","":"","":"minus ",":":'<break time="150ms"/> such that <break time="200ms"/> ',"\\colon":'<break time="150ms"/> such that <break time="200ms"/> ',"\\hbar":"etch bar ","\\iff":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\Longleftrightarrow":'<break time="200ms"/>if, and only if, <break time="200ms"/>',"\\land":"and ","\\lor":"or ","\\neg":"not ","\\div":"divided by ","\\forall":"for all ","\\exists":"there exists ","\\nexists":"there does not exists ","\\in":"element of ","\\N":'the set <break time="150ms"/><say-as interpret-as="character">n</say-as>',"\\C":'the set <break time="150ms"/><say-as interpret-as="character">c</say-as>',"\\Z":'the set <break time="150ms"/><say-as interpret-as="character">z</say-as>',"\\Q":'the set <break time="150ms"/><say-as interpret-as="character">q</say-as>',"\\infty":"infinity ","\\nabla":"nabla ","\\partial":"partial derivative of ","\\cdot":"times ","\\cdots":"dot dot dot ","\\Rightarrow":"implies ","\\lparen":'<break time="150ms"/>open paren<break time="150ms"/>',"\\rparen":'<break time="150ms"/>close paren<break time="150ms"/>',"\\lbrace":'<break time="150ms"/>open brace<break time="150ms"/>',"\\{":'<break time="150ms"/>open brace<break time="150ms"/>',"\\rbrace":'<break time="150ms"/>close brace<break time="150ms"/>',"\\}":'<break time="150ms"/>close brace<break time="150ms"/>',"\\langle":'<break time="150ms"/>left angle bracket<break time="150ms"/>',"\\rangle":'<break time="150ms"/>right angle bracket<break time="150ms"/>',"\\lfloor":'<break time="150ms"/>open floor<break time="150ms"/>',"\\rfloor":'<break time="150ms"/>close floor<break time="150ms"/>',"\\lceil":'<break time="150ms"/>open ceiling<break time="150ms"/>',"\\rceil":'<break time="150ms"/>close ceiling<break time="150ms"/>',"\\vert":'<break time="150ms"/>vertical bar<break time="150ms"/>',"\\mvert":'<break time="150ms"/>divides<break time="150ms"/>',"\\lvert":'<break time="150ms"/>left vertical bar<break time="150ms"/>',"\\rvert":'<break time="150ms"/>right vertical bar<break time="150ms"/>',"\\lbrack":'<break time="150ms"/> open square bracket <break time="150ms"/>',"\\rbrack":'<break time="150ms"/> close square bracket <break time="150ms"/>',mm:"millimeters",cm:"centimeters",km:"kilometers",kg:"kilograms"},Op={array:"array",matrix:"matrix",pmatrix:"parenthesis matrix",bmatrix:"square brackets matrix",Bmatrix:"braces matrix",vmatrix:"bars matrix",Vmatrix:"double bars matrix","matrix*":"matrix",smallmatrix:"small matrix"};function PD(t){let e="";return t.startsWith("\\")&&(e=" "+t.replace("\\","")+" "),e}function Ea(t){let e=0;if(Ht(t))for(let n of t)n.type!=="first"&&(e+=1);return e===1}function ID(t){if(Ht(t)){for(let e of t)if(e.type!=="first"&&e.id)return e.id.toString()}return""}function Tv(t){let e="";if(Ht(t))for(let n of t)n.type!=="first"&&typeof n.value=="string"&&(e+=n.value);return e}function RD(t){return t?t.map(e=>e.value).join(""):""}function Xu(t){if(t&&!t.some(e=>e.type!=="first"&&e.value===void 0))return t.map(e=>e.value).join("")}function Yf(t){return`<emphasis>${t}</emphasis>`}function zD(t,e){var n;let r="",i=!1,o=!1;for(let s=0;s<e.length;s++)e[s].type!=="first"&&(e[s].mode!=="text"&&(o=!1),s<e.length-2&&e[s].type==="mopen"&&e[s+2].type==="mclose"&&e[s+1].type==="mord"?(r+=" of ",r+=Yf(ze(t,e[s+1])),s+=2):e[s].mode==="text"?o?r+=(n=e[s].value)!=null?n:" ":(o=!0,r+=ze("text",e[s])):e[s].isDigit()?i?r+=e[s].asDigit():(i=!0,r+=ze(t,e[s])):(i=!1,r+=ze(t,e[s])));return r}function ze(t,e){var n,r,i,o,s,a,l,u;function c(k){return globalThis.MathfieldElement.textToSpeechMarkup?/[a-z]/.test(k)?` <say-as interpret-as="character">${k}</say-as>`:/[A-Z]/.test(k)?`capital <say-as interpret-as="character">${k.toLowerCase()}</say-as>`:k:/[a-z]/.test(k)?" '"+k.toUpperCase()+"'":/[A-Z]/.test(k)?" 'capital "+k.toUpperCase()+"'":k}if(!e)return"";if(Ht(e))return zD(t,e);let d="";if(e.id&&t==="math"&&(d+='<mark name="'+e.id.toString()+'"/>'),e.mode==="text")return d+e.value;let p="",f="",g="",x=!1,{command:w}=e;switch(w){case"\\vec":return"vector "+ze(t,e.body);case"\\acute":return ze(t,e.body)+" acute";case"\\grave":return ze(t,e.body)+" grave";case"\\dot":return"dot over"+ze(t,e.body);case"\\ddot":return"double dot over"+ze(t,e.body);case"\\mathring":return"ring over"+ze(t,e.body);case"\\tilde":case"\\widetilde":return"tilde over"+ze(t,e.body);case"\\bar":return ze(t,e.body)+" bar";case"\\breve":return ze(t,e.body)+" breve";case"\\check":case"\\widecheck":return"check over "+ze(t,e.body);case"\\hat":case"\\widehat":return"hat over"+ze(t,e.body);case"\\overarc":case"\\overparen":case"\\wideparen":return"arc over "+ze(t,e.body);case"\\underarc":case"\\underparen":return"arc under "+ze(t,e.body);case"\\mathop":return(n=Xu(e.body))!=null?n:ze(t,e.body);case"\\mathit":return(r=Xu(e.body))!=null?r:ze(t,e.body);case"\\mathrm":return(i=Xu(e.body))!=null?i:ze(t,e.body);case"\\mathbb":return"blackboard"+((o=Xu(e.body))!=null?o:ze(t,e.body))}switch(e.type){case"prompt":let k=e.body.length>1?'start input . <break time="500ms"/> '+ze(t,e.body)+'. <break time="500ms"/> end input':"blank";d+=' <break time="300ms"/> '+k+'. <break time="700ms"/>'+((s=e.correctness)!=null?s:"")+' . <break time="700ms"/> ';break;case"array":let D=e.rows,N=e.environmentName;if(Object.keys(Op).includes(N)){d+=` begin ${Op[N]} `;for(let R=0;R<D.length;R++){R>0&&(d+=","),d+=` row ${R+1} `;for(let L=0;L<D[R].length;L++)L>0&&(d+=","),d+=` column ${L+1}: `,d+=ze("math",D[R][L])}d+=` end ${Op[N]} `}break;case"group":w==="\\ne"?d+=" not equal ":(w==="\\not"&&(d+=" not "),d+=ze("math",e.body));break;case"root":d+=ze("math",e.body);break;case"genfrac":if(p=ze("math",e.above),f=ze("math",e.below),Ea(e.above)&&Ea(e.below)){let R={"1/2":" half ","1/3":" one third ","2/3":" two third","1/4":" one quarter ","3/4":" three quarter ","1/5":" one fifth ","2/5":" two fifths ","3/5":" three fifths ","4/5":" four fifths ","1/6":" one sixth ","5/6":" five sixths ","1/8":" one eight ","3/8":" three eights ","5/8":" five eights ","7/8":" seven eights ","1/9":" one ninth ","2/9":" two ninths ","4/9":" four ninths ","5/9":" five ninths ","7/9":" seven ninths ","8/9":" eight ninths "}[Tv(e.above)+"/"+Tv(e.below)];R?d=R:d+=p+" over "+f}else d+=' the fraction <break time="150ms"/>'+p+' over <break time="150ms"/>'+f+'.<break time="150ms"/> End fraction.<break time="150ms"/>';break;case"surd":if(g=ze("math",e.body),e.hasEmptyBranch("above"))d+=Ea(e.body)?" the square root of "+g+" , ":' the square root of <break time="200ms"/>'+g+'. <break time="200ms"/> End square root';else{let R=ze("math",e.above);R=R.trim();let L=R.replace(/<mark([^/]*)\/>/g,"");L==="3"?d+=' the cube root of <break time="200ms"/>'+g+'. <break time="200ms"/> End cube root':L==="n"?d+=' the nth root of <break time="200ms"/>'+g+'. <break time="200ms"/> End root':d+=' the root with index: <break time="200ms"/>'+R+', of <break time="200ms"/>'+g+'. <break time="200ms"/> End root'}break;case"leftright":{let R=e;d+=(a=R.leftDelim?xs[R.leftDelim]:void 0)!=null?a:R.leftDelim,d+=ze("math",e.body),d+=(l=R.rightDelim?xs[R.rightDelim]:void 0)!=null?l:R.rightDelim}break;case"rule":break;case"overunder":break;case"overlap":break;case"macro":let B=w.replace(/^\\/g,""),T=Xm()[B];T!=null&&T.expand?d+=ze("math",e.body):d+=`${B} `;break;case"placeholder":d+="placeholder ";break;case"delim":case"sizeddelim":case"mord":case"minner":case"mbin":case"mrel":case"mpunct":case"mopen":case"mclose":{if(w==="\\mathbin"||w==="\\mathrel"||w==="\\mathopen"||w==="\\mathclose"||w==="\\mathpunct"||w==="\\mathord"||w==="\\mathinner"){d=ze(t,e.body);break}let R=e.isDigit()?e.asDigit():e.value,L=e.command;if((e.type==="delim"||e.type==="sizeddelim")&&(L=e.value,R=L),t==="text")d+=R;else{if(e.type==="mbin"&&(d+='<break time="150ms"/>'),R){let P=xs[R]||(L?xs[L.trim()]:"");if(P)d+=" "+P;else{let W=L?PD(L.trim()):"";d+=W||c(R)}}else d+=ze("math",e.body);e.type==="mbin"&&(d+='<break time="150ms"/>')}break}case"mop":case"operator":case"extensible-symbol":if(e.value!==""){let R=e.command;if(R==="\\sum")if(!e.hasEmptyBranch("superscript")&&!e.hasEmptyBranch("subscript")){let L=ze("math",e.superscript);L=L.trim();let P=ze("math",e.subscript);P=P.trim(),d+=' the summation from <break time="200ms"/>'+P+'<break time="200ms"/> to  <break time="200ms"/>'+L+'<break time="200ms"/> of <break time="150ms"/>',x=!0}else if(e.hasEmptyBranch("subscript"))d+=" the summation of";else{let L=ze("math",e.subscript);L=L.trim(),d+=' the summation from <break time="200ms"/>'+L+'<break time="200ms"/> of <break time="150ms"/>',x=!0}else if(R==="\\prod")if(!e.hasEmptyBranch("superscript")&&!e.hasEmptyBranch("subscript")){let L=ze("math",e.superscript);L=L.trim();let P=ze("math",e.subscript);P=P.trim(),d+=' the product from <break time="200ms"/>'+P+'<break time="200ms"/> to <break time="200ms"/>'+L+'<break time="200ms"/> of <break time="150ms"/>',x=!0}else if(e.hasEmptyBranch("subscript"))d+=" the product  of ";else{let L=ze("math",e.subscript);L=L.trim(),d+=' the product from <break time="200ms"/>'+L+'<break time="200ms"/> of <break time="150ms"/>',x=!0}else if(R==="\\int")if(!e.hasEmptyBranch("superscript")&&!e.hasEmptyBranch("subscript")){let L=ze("math",e.superscript);L=L.trim();let P=ze("math",e.subscript);P=P.trim(),d+=' the integral from <break time="200ms"/>'+Yf(P)+'<break time="200ms"/> to <break time="200ms"/>'+Yf(L)+' <break time="200ms"/> of ',x=!0}else d+=' the integral of <break time="200ms"/> ';else if(R==="\\operatorname"||R==="\\operatorname*")d+=RD(e.body)+" ";else if(typeof e.value=="string"){let L=(u=xs[e.value])!=null?u:e.command?xs[e.command]:void 0;d+=L||" "+e.value}else e.command&&(e.command==="\\mathop"?d+=ze("math",e.body):d+=e.command.startsWith("\\")?" "+e.command.slice(1):" "+e.command)}break;case"enclose":g=ze("math",e.body),d+=" crossed out "+g+". End crossed out.";break}if(!x&&!e.hasEmptyBranch("superscript")){let k=ze(t,e.superscript);k=k.trim();let D=k.replace(/<[^>]*>/g,"");if(Ea(e.superscript)){if(t==="math"){let N=ID(e.superscript);N&&(d+='<mark name="'+N+'"/>')}D===""?d+=" prime ":D==="2"?d+=" squared ":D==="3"?d+=" cubed ":Number.isNaN(Number.parseInt(D))?d+=" to the "+k+"; ":d+=' to the <say-as interpret-as="ordinal">'+D+"</say-as> power; "}else Number.isNaN(Number.parseInt(D))?d+=" raised to the "+k+"; ":d+=' raised to the <say-as interpret-as="ordinal">'+D+"</say-as> power; "}if(!x&&!e.hasEmptyBranch("subscript")){let k=ze("math",e.subscript);k=k.trim(),d+=Ea(e.subscript)?" sub "+k:" subscript "+k+". End subscript. "}return d}function Ko(t){var e,n;let r=globalThis.MathfieldElement;if(r.textToSpeechRules==="sre"&&("sre"in window||"SRE"in window)){let o=Ze(t);if(o){r.textToSpeechMarkup&&(r.textToSpeechRulesOptions=(e=r.textToSpeechRulesOptions)!=null?e:{},r.textToSpeechRulesOptions=V(O({},r.textToSpeechRulesOptions),{markup:r.textToSpeechMarkup}),r.textToSpeechRulesOptions.markup==="ssml"&&(r.textToSpeechRulesOptions=V(O({},r.textToSpeechRulesOptions),{markup:"ssml_step"})),r.textToSpeechRulesOptions=V(O({},r.textToSpeechRulesOptions),{rate:r.speechEngineRate}));let s=(n=window.SRE)!=null?n:globalThis.sre.System.getInstance();r.textToSpeechRulesOptions&&s.setupEngine(r.textToSpeechRulesOptions);let a="";try{a=s.toSpeech(o)}catch(l){console.error("MathLive 0.108.2: `SRE.toSpeech()` runtime error",l)}return a}return""}let i=ze("math",t);if(r.textToSpeechMarkup==="ssml"){let o="";r.speechEngineRate&&(o='<prosody rate="'+r.speechEngineRate+'">'),i='<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US"><amazon:auto-breaths>'+o+"<p><s>"+i+"</s></p>"+(o?"</prosody>":"")+"</amazon:auto-breaths></speak>"}else r.textToSpeechMarkup==="mac"&&ta()==="macos"?i=i.replace(/<mark([^/]*)\/>/g,"").replace(/<emphasis>/g,"[[emph+]]").replace(/<\/emphasis>/g,"").replace(/<break time="(\d*)ms"\/>/g,"[[slc $1]]").replace(/<say-as[^>]*>/g,"").replace(/<\/say-as>/g,""):i=i.replace(/<[^>]*>/g,"").replace(/\s{2,}/g," ");return i}var mr={"\\ne":"","\\neq":"","":"-","-":"-","\\alpha":"alpha","\\beta":"beta","\\gamma":"gamma","\\delta":"delta","\\epsilon":"epsilon","\\varepsilon":"varepsilon","\\zeta":"zeta","\\eta":"eta","\\theta":"theta","\\vartheta":"vartheta","\\iota":"iota","\\kappa":"kappa","\\lambda":"lambda","\\mu":"mu","\\nu":"nu","\\xi":"xi","\\pi":"pi","\\rho":"rho","\\sigma":"sigma","\\tau":"tau","\\upsilon":"upsilon","\\phi":"phi","\\varphi":"varphi","\\chi":"chi","\\psi":"psi","\\omega":"omega","\\Gamma":"Gamma","\\Delta":"Delta","\\Theta":"Theta","\\Lambda":"Lambda","\\Xi":"Xi","\\Pi":"Pi","\\Sigma":"Sigma","\\Phi":"Phi","\\Psi":"Psi","\\Omega":"Omega","\\exponentialE":"e","\\imaginaryI":"i","\\imaginaryJ":"j","\\!":" ","\\,":" ","\\:":" ","\\>":" ","\\;":" ","\\enskip":" ","\\enspace":" ","\\qquad":" ","\\quad":" ","\\infty":"oo","\\R":"RR","\\mathbb{R}":"RR","\\N":"NN","\\mathbb{N}":"NN","\\Z":"ZZ","\\mathbb{Z}":"ZZ","\\Q":"QQ","\\mathbb{Q}":"QQ","\\C":"CC","\\mathbb{C}":"CC","\\emptyset":"O/","\\varnothing":"O/","\\varDelta":"Delta","\\varTheta":"Theta","\\varLambda":"Lambda","\\varXi":"Xi","\\varPi":"Pi","\\varSigma":"Sigma","\\varUpsilon":"Upsilon","\\varPhi":"Phi","\\varPsi":"Psi","\\varOmega":"Omega"},Aa={"\\pm":"+-","\\colon":" : ","\\sum":" sum ","\\prod":" prod ","\\bigcap":" nnn ","\\bigcup":" uuu ","\\int":" int ","\\oint":" oint ","\\ge":">=","\\le":"<=","\\ne":"!=","\\neq":"!=","\\lt":"<","\\gt":">","\\gets":"<-","\\to":"->","\\land":" and ","\\lor":" or ","\\lnot":" not ","\\forall":" AA ","\\exists":" EE ","\\in":" in ","\\notin":" !in ","\\mapsto":"|->","\\implies":"=>","\\iff":"<=>","\\cdot":" * ","\\ast":" ** ","\\star":" *** ","\\times":" * ","\\div":" -: ","\\ltimes":" |>< ","\\rtimes":" ><| ","\\bowtie":" |><| ","\\circ":"@"},Yu={"\\vert":"|","\\Vert":"||","\\mid":"|","\\lbrack":"[","\\rbrack":"]","\\lbrace":"{","\\rbrace":"}","\\lparen":"(","\\rparen":")","\\langle":"(:","\\rangle":":)"};function FD(t){let e="";for(let n of t){let r=e[e.length-1];r!==void 0&&(/\d$/.test(r)&&/^\d/.test(n)||/[a-zA-Z]$/.test(r)&&/^[a-zA-Z]/.test(n))&&(e+=" "),e+=n}return e}function bt(t,e){var n,r,i,o,s,a,l,u,c,d,p,f,g,x,w,k,D,N,B;if(!t)return"";if(Ht(t)){if(t.length===0)return"";if(t[0].mode==="latex")return t.map(q=>bt(q)).join("");if(t[0].mode==="text"){let q=0,ae="";for(;((n=t[q])==null?void 0:n.mode)==="text";)ae+=t[q].body?bt(t[q].body,e):t[q].value,q++;return e!=null&&e.plain?ae+bt(t.slice(q),e):`"${ae}" ${bt(t.slice(q))}`}let W=0,de=[];for(;((r=t[W])==null?void 0:r.mode)==="math";){let q="";for(;((i=t[W])==null?void 0:i.type)==="mord"&&/\d/.test(t[W].value);)q+=t[W++].value;q?de.push(q):de.push(bt(t[W++],e))}return de.push(bt(t.slice(W),e)),FD(de)}if(t.mode==="text")return e!=null&&e.plain?t.value:`"${t.value}"`;let T="",{command:R}=t,L;if(R==="\\placeholder")return`(${bt(t.body,e)})`;let P=G.serialize([t],{expandMacro:!1,defaultMode:"math"});switch(t.type){case"accent":let W={"\\vec":"vec","\\dot":"dot","\\ddot":"ddot","\\bar":"bar","\\hat":"hat","\\acute":"acute;","\\grave":"grave","\\tilde":"tilde","\\breve":"breave","\\check":"check"}[R];T=`${W??""} ${bt(t.body,e)} `;break;case"first":return"";case"latexgroup":return t.body.map(q=>q.value).join("");case"group":case"root":T=(o=mr[R])!=null?o:bt(t.body,e);break;case"genfrac":{let q=t;(q.leftDelim||q.rightDelim)&&(T=q.leftDelim==="."||!q.leftDelim?"{:":q.leftDelim),q.hasBarLine?(T+="(",T+=bt(q.above,e),T+=")/(",T+=bt(q.below,e),T+=")"):(T+="((",T+=bt(q.above,e),T+=") choose (",T+=bt(q.below,e),T+="))"),(q.leftDelim||q.rightDelim)&&(T+=q.rightDelim==="."||!q.rightDelim?"{:":q.rightDelim)}break;case"surd":t.hasEmptyBranch("above")?T+=`sqrt(${bt(t.body,e)})`:T+=`root(${bt(t.above,e)})(${bt(t.body,e)})`;break;case"latex":T=t.value;break;case"leftright":{let q=t,ae=q.leftDelim;ae&&Yu[ae]&&(ae=Yu[ae]),T+=ae==="."||!ae?"{:":ae,T+=bt(q.body,e);let be=q.matchingRightDelim();be&&Yu[be]&&(be=Yu[be]),T+=be==="."||!be?":}":be}break;case"sizeddelim":case"delim":T=t.value;break;case"overlap":break;case"overunder":break;case"mord":if(mr[P])return mr[P];T=(l=(a=(s=mr[R])!=null?s:R)!=null?a:R)!=null?l:typeof t.value=="string"?t.value:"",T.startsWith("\\")&&(T+=" "),L=R?R.match(/{?\\char"([\dabcdefABCDEF]+)}?/):null,L?T=String.fromCodePoint(Number.parseInt("0x"+L[1])):T.length>0&&T.startsWith("\\")&&(T=typeof t.value=="string"?t.value.charAt(0):t.command),T=$D(T,t.style);break;case"mbin":case"mrel":case"minner":T=(d=(c=(u=mr[P])!=null?u:mr[R])!=null?c:Aa[R])!=null?d:t.value;break;case"mopen":case"mclose":T=t.value;break;case"mpunct":T=(p=Aa[R])!=null?p:R;break;case"mop":case"operator":case"extensible-symbol":t.value!==""&&(Aa[R]?T=Aa[R]:T=R==="\\operatorname"?bt(t.body,e):(f=t.value)!=null?f:R,T+=" ");break;case"array":let de=t.environmentName;if(t.isMultiline)T=t.rows.map(q=>q.map(ae=>bt(ae,e)).join("")).join(`
`);else{let q=(g={bmatrix:["[","]"],"bmatrix*":["[","]"]}[de])!=null?g:["(",")"],ae=[],be=t.rows;for(let ce of be){let ge=[];for(let xe of ce)ge.push(bt(xe,e));ae.push(q[0]+ge.join(",")+q[1])}let re=(x={bmatrix:["[","]"],"bmatrix*":["[","]"],cases:["{",":}"]}[de])!=null?x:["(",")"];T=re[0]+ae.join(",")+re[1]}break;case"box":break;case"spacing":T=(k=(w=mr[P])!=null?w:mr[R])!=null?k:" ";break;case"enclose":T="("+bt(t.body,e)+")";break;case"space":T=" ";break;case"subsup":T="";break;case"macro":T=(B=(N=(D=mr[P])!=null?D:mr[R])!=null?N:Aa[R])!=null?B:bt(t.body,e);break}if(!t.hasEmptyBranch("subscript")){T+="_";let W=bt(t.subscript,e);T+=W.length!==1?`(${W})`:W}if(!t.hasEmptyBranch("superscript")){T+="^";let W=bt(t.superscript,e);T+=W.length!==1?`(${W})`:W}return T}function $D(t,e){if(!e)return t;let n=t;return e.variant==="double-struck"&&(n=`bbb "${n}"`),e.variant==="script"&&(n=`cc "${n}"`),e.variant==="fraktur"&&(n=`fr "${n}"`),e.variant==="sans-serif"&&(n=`sf "${n}"`),e.variant==="monospace"&&(n=`tt "${n}"`),e.variantStyle==="bold"&&(n=`bb "${n}"`),e.color?`color({${e.color}})(${n})`:n}function Pt(t,e){var n;let r=V(O({},hx()),{renderPlaceholder:()=>new oe(160,{maxFontSize:1})});if(e!=null&&e.letterShapeStyle&&e?.letterShapeStyle!=="auto"&&(r.letterShapeStyle=e.letterShapeStyle),e!=null&&e.macros){let u=fd(e?.macros);r.getMacro=c=>Ym(c,u)}e!=null&&e.registers&&(r.registers=O(O({},r.registers),e.registers));let i=(n=e?.defaultMode)!=null?n:"math",o="math",s="displaystyle";i==="inline-math"?s="textstyle":i==="math"?s="displaystyle":i==="text"&&(s="textstyle",o="text");let a=new Ye({from:r}),l=new G({type:"root",mode:o,body:wn(t,{context:a,parseMode:o,mathstyle:s})}).render(a);return l?(Jd(Bl(l,a)),Gd(l,{classes:"ML__latex"}).toMarkup()):""}function KD(t,e={}){return Ze(wn(t,{parseMode:"math",args:()=>"",mathstyle:"displaystyle"}),e)}function jD(t){let e=wn(t,{parseMode:"math",mathstyle:"displaystyle"});return Ko(e)}var Zu;function qD(t){var e,n;if(!Zu){let r=(e=globalThis[Symbol.for("io.cortexjs.compute-engine")])==null?void 0:e.ComputeEngine;r?Zu=new r:console.error(`MathLive 0.108.2: The CortexJS Compute Engine library is not available.
        
        Load the library, for example with:
        
        import "https://esm.run/@cortex-js/compute-engine"`)}return(n=Zu?.box(t).latex)!=null?n:""}function VD(t){return yd(t,{format:"ascii-math"})[1]}function Zf(t){if(typeof t=="string"){let e=HD(t);if(!e)throw new Error(`Invalid color: ${t}`);return e}return"C"in t?UD(t):"a"in t?V5(t):t}function qs(t){return t<0?0:t>255?255:Math.round(t)}function HD(t){if(!t||t[0]!=="#")return;t=t.slice(1);let e;return t.length<=4?(e={r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)},t.length===4&&(e.a=parseInt(t[3]+t[3],16)/255)):(e={r:parseInt(t[0]+t[1],16),g:parseInt(t[2]+t[3],16),b:parseInt(t[4]+t[5],16)},t.length===8&&(e.a=parseInt(t[6]+t[7],16)/255)),typeof e?.a>"u"&&(e.a=1),e}function Qf(t){let[e,n,r]=[t.L,t.C,t.H],i=r*Math.PI/180,o={L:e,a:n*Math.cos(i),b:n*Math.sin(i)};return t.alpha!==void 0&&(o.alpha=t.alpha),o}function WD(t){let[e,n,r]=[t.L,t.a,t.b],i=Math.sqrt(n*n+r*r),o=Math.atan2(r,n)*180/Math.PI,s={L:e,C:i,H:o};return t.alpha!==void 0&&(s.alpha=t.alpha),s}function Np(t){let[e,n,r]=[t.L,t.a,t.b],i=Math.pow(.9999999984505198*e+.39633779217376786*n+.2158037580607588*r,3),o=Math.pow(1.00000000888176*e-.10556134232365635*n-.0638541747717059*r,3),s=Math.pow(e*1.000000054672411-.0894841820949657*n-1.2914855378640917*r,3),a=4.076741661347994*i-3.307711590408193*o+.230969928729428*s,l=-1.2684380040921763*i+2.6097574006633715*o-.3413193963102197*s,u=-.004196086541837188*i-.7034186144594493*o+1.7076147009309444*s,c=d=>{let p=Math.abs(d);return p<=.0031308?d*12.92:(Math.sign(d)||1)*(1.055*Math.pow(p,1/2.4)-.055)};return[c(a),c(l),c(u)]}function Pp(t){let[e,n,r]=t;return e>=0&&e<=1&&n>=0&&n<=1&&r>=0&&r<=1}function Ip(t,e){let[n,r,i]=t;return n=qs(n*255),r=qs(r*255),i=qs(i*255),e!==void 0?{r:n,g:r,b:i,alpha:e}:{r:n,g:r,b:i}}function V5(t){let[e,n,r]=Np(t);if(Pp([e,n,r]))return Ip([e,n,r],t.alpha);let i=WD(t);if(i.C=0,[e,n,r]=Np(Qf(i)),!Pp([e,n,r]))return Ip([e,n,r],t.alpha);let o=0,s=t.L,a=(o+s)/2;i.C=a;let l=.36/Math.pow(2,12);for(;s-o>l;)a=(o+s)/2,i.C=a,[e,n,r]=Np(Qf(i)),Pp([e,n,r])?o=a:s=a;return Ip([e,n,r],t.alpha)}function UD(t){return V5(Qf(t))}function Bv(t,e){let n=Zf(t),r=Zf(e),i=.56,o=.57,s=.62,a=.65,l=.022,u=1.414,c=.1,d=5e-4,p=1.14,f=.027,g=1.14,x=.027;function w(L){return L>=l?L:L+(l-L)**u}function k(L){return(L<0?-1:1)*Math.pow(Math.abs(L),2.4)}let D=w(k(r.r/255)*.2126729+k(r.g/255)*.7151522+k(r.b/255)*.072175),N=w(k(n.r/255)*.2126729+k(n.g/255)*.7151522+k(n.b/255)*.072175),B,T,R;return Math.abs(N-D)<d?T=0:N>D?(B=N**i-D**o,T=B*p):(B=N**a-D**s,T=B*g),Math.abs(T)<c?R=0:T>0?R=T-x:R=T+f,R*100}function H5(t,e,n){n!=null||(n="#fff"),e!=null||(e="#000");let r=Bv(t,n),i=Bv(t,e);return Math.abs(r)>Math.abs(i)?n:e}function JD(t){let e=Zf(t),n=((1<<24)+(qs(e.r)<<16)+(qs(e.g)<<8)+qs(e.b)).toString(16).slice(1);return e.alpha!==void 0&&e.alpha<1&&(n+=("00"+Math.round(e.alpha*255).toString(16)).slice(-2)),n[0]===n[1]&&n[2]===n[3]&&n[4]===n[5]&&n[6]===n[7]&&(n=n[0]+n[2]+n[4]+(e.alpha!==void 0&&e.alpha<1?n[6]:"")),"#"+n}function ct(t){let e=W5(t),n="";for(let r of e){if(typeof r.value!="string")return"";n+=r.value}return n}function W5(t){let e=t.model.selection.ranges;if(e.length!==1)return[];let n=t.model.getAtoms(e[0]);return n.length===1&&n[0].isRoot&&(n=n[0].children),n.filter(r=>r.type!=="first")}function GD(t,e){let n=W5(t);if(n.length!==1)return!1;let r=Rf[e];return r?!!r.test(n[0].value):!1}function XD(t){return[zp(t,"double-struck","mathbb","tooltip.blackboard"),zp(t,"fraktur","mathfrak","tooltip.fraktur"),zp(t,"calligraphic","mathcal","tooltip.caligraphic"),Fp(t,"up","mathrm","tooltip.roman-upright"),Fp(t,"bold","bm","tooltip.bold"),Fp(t,"italic","mathit","tooltip.italic")]}function YD(t){return[{id:"accent-vec",class:"ML__center-menu",label:()=>Pt(`\\vec{${ct(t)}}`),visible:()=>ct(t).length===1,onMenuSelect:()=>t.insert("\\vec{#@}",{selectionMode:"item"})},{id:"accent-overrightarrow",class:"ML__center-menu",label:()=>Pt(`\\overrightarrow{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\overrightarrow{#@}",{selectionMode:"item"})},{id:"accent-overleftarrow",class:"ML__center-menu",label:()=>Pt(`\\overleftarrow{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\overleftarrow{#@}",{selectionMode:"item"})},{id:"accent-dot",class:"ML__center-menu",label:()=>Pt(`\\dot{${ct(t)}}`),visible:()=>ct(t).length===1,onMenuSelect:()=>t.insert("\\dot{#@}",{selectionMode:"item"})},{id:"accent-ddot",class:"ML__center-menu",label:()=>Pt(`\\ddot{${ct(t)}}`),visible:()=>ct(t).length===1,onMenuSelect:()=>t.insert("\\ddot{#@}",{selectionMode:"item"})},{id:"accent-bar",class:"ML__center-menu",label:()=>Pt(`\\bar{${ct(t)}}`),visible:()=>ct(t).length===1,onMenuSelect:()=>t.insert("\\bar{#@}",{selectionMode:"item"})},{id:"accent-overline",class:"ML__center-menu",label:()=>Pt(`\\overline{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\overline{#@}",{selectionMode:"item"})},{id:"accent-overgroup",class:"ML__center-menu",label:()=>Pt(`\\overgroup{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\overgroup{#@}",{selectionMode:"item"})},{id:"accent-overbrace",class:"ML__center-menu",label:()=>Pt(`\\overbrace{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\overbrace{#@}",{selectionMode:"item"})},{id:"accent-underline",class:"ML__center-menu",label:()=>Pt(`\\underline{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\underline{#@}",{selectionMode:"item"})},{id:"accent-undergroup",class:"ML__center-menu",label:()=>Pt(`\\undergroup{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\undergroup{#@}",{selectionMode:"item"})},{id:"accent-underbrace",class:"ML__center-menu",label:()=>Pt(`\\underbrace{${ct(t)}}`),visible:()=>ct(t).length>0,onMenuSelect:()=>t.insert("\\underbrace{#@}",{selectionMode:"item"})}]}function ZD(t){return[{id:"decoration-boxed",label:()=>Pt(`\\boxed{${t.getValue(t.model.selection)}}}`),onMenuSelect:()=>t.insert("\\boxed{#@}",{selectionMode:"item"})},{id:"decoration-red-box",label:()=>Pt(`\\bbox[5px, border: 2px solid red]{${t.getValue(t.model.selection)}}`),onMenuSelect:()=>t.insert("\\bbox[5px, border: 2px solid red]{#@}",{selectionMode:"item"})},{id:"decoration-dashed-black-box",label:()=>Pt(`\\bbox[5px, border: 2px dashed black]{${t.getValue(t.model.selection)}}`),onMenuSelect:()=>t.insert("\\bbox[5px, border: 2px dashed black]{#@}",{selectionMode:"item"})}]}function QD(t){let e=[];for(let n of Object.keys(Io))e.push({id:`background-color-${n}`,class:(JD(H5(Io[n]))==="#000"?"dark-contrast":"light-contrast")+" menu-swatch",label:`<span style="background:${Io[n]} "></span>`,ariaLabel:()=>{var r;return(r=Le(n))!=null?r:n},checked:()=>{var r;return(r={some:"mixed",all:!0}[t.queryStyle({backgroundColor:n})])!=null?r:!1},onMenuSelect:()=>t.applyStyle({backgroundColor:n},{operation:"toggle"})});return e}function eL(t){let e=[];for(let n of Object.keys(Ro))e.push({id:`color-${n}`,class:(H5(Ro[n])==="#000"?"dark-contrast":"light-contrast")+" menu-swatch",label:`<span style="background:${Ro[n]} "></span>`,ariaLabel:()=>{var r;return(r=Le(n))!=null?r:n},checked:()=>{var r;return(r={some:"mixed",all:!0}[t.queryStyle({color:n})])!=null?r:!1},onMenuSelect:()=>t.applyStyle({color:n},{operation:"toggle"})});return e}var tL=class extends I5{constructor(t,e,n,r){super(t,e),this.row=n,this.col=r}set active(t){let e=this.parentMenu.children;if(t)for(let n of e)n.element.classList.toggle("active",n.row<=this.row&&n.col<=this.col);else for(let n of e)n.element.classList.remove("active")}};function nL(t){let e=[];for(let n=1;n<=5;n++)for(let r=1;r<=5;r++)e.push({id:`insert-matrix-${n}x${r}`,onCreate:(i,o)=>new tL(i,o,n,r),label:"",tooltip:()=>Le("tooltip.row-by-col",n,r),data:{row:n,col:r},onMenuSelect:()=>{t.insert(`\\begin{pmatrix}${Array(n).fill(Array(r).fill("#?").join(" & ")).join("\\\\")}\\end{pmatrix}`,{selectionMode:"item"})}});return e}function rL(t){return[{label:()=>Le("menu.array.add row above"),id:"add-row-above",onMenuSelect:()=>t.executeCommand("addRowBefore"),keyboardShortcut:"shift+alt+[Return]",visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return e!==r}},{label:()=>Le("menu.array.add row below"),id:"add-row-below",onMenuSelect:()=>t.executeCommand("addRowAfter"),keyboardShortcut:"alt+[Return]",visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return e!==r}},{label:()=>Le("menu.array.add column before"),id:"add-column-before",onMenuSelect:()=>t.executeCommand("addColumnBefore"),visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return n!==i},keyboardShortcut:"shift+alt+[Tab]",enabled:()=>{let e=t.model.parentEnvironment;if(!e)return!1;let[n,r]=Rp(t);return n<e.maxColumns}},{label:()=>Le("menu.array.add column after"),id:"add-column-after",onMenuSelect:()=>t.executeCommand("addColumnAfter"),keyboardShortcut:"alt+[Tab]",visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return n!==i}},{type:"divider"},{label:()=>Le("menu.array.delete row"),id:"delete-row",onMenuSelect:()=>t.executeCommand("removeRow"),enabled:()=>{let[e,n]=vi(t),[r,i]=Rp(t);return r>e},visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return e!==r}},{label:()=>Le("menu.array.delete column"),id:"delete-column",onMenuSelect:()=>t.executeCommand("removeColumn"),enabled:()=>{let[e,n]=vi(t),[r,i]=Rp(t);return i>n},visible:()=>{if(!t.isSelectionEditable||!yo(t))return!1;let[e,n]=vi(t),[r,i]=ws(t);return n!==i}},{type:"divider"},{label:()=>Le("menu.borders"),visible:()=>(iL(t)||yo(t))&&t.isSelectionEditable,submenu:[{label:"  ",id:"environment-no-border",onMenuSelect:()=>Da(t,"matrix")},{label:"()",id:"environment-parentheses",onMenuSelect:()=>Da(t,"pmatrix")},{label:"[]",id:"environment-brackets",onMenuSelect:()=>Da(t,"bmatrix")},{label:"||",id:"environment-bar",onMenuSelect:()=>Da(t,"vmatrix")},{label:"{}",id:"environment-braces",onMenuSelect:()=>Da(t,"Bmatrix")}],submenuClass:"border-submenu"},{type:"divider"},{label:()=>Le("menu.insert matrix"),id:"insert-matrix",visible:()=>t.isSelectionEditable,submenu:nL(t),submenuClass:"insert-matrix-submenu",columnCount:5},{type:"divider"},{label:()=>Le("menu.insert"),id:"insert",submenu:sL(t)},{type:"divider"},{label:()=>Le("menu.mode"),id:"mode",visible:()=>t.isSelectionEditable&&t.model.selectionIsCollapsed,submenu:[{label:()=>Le("menu.mode-math"),id:"mode-math",onMenuSelect:()=>{Yi(t,"accept-all"),t.executeCommand(["switchMode","math"])},checked:()=>t.model.mode==="math"},{label:()=>Le("menu.mode-text"),id:"mode-text",onMenuSelect:()=>{Yi(t,"accept-all"),t.executeCommand(["switchMode","text"])},checked:()=>t.model.mode==="text"},{label:()=>Le("menu.mode-latex"),id:"mode-latex",onMenuSelect:()=>t.executeCommand(["switchMode","latex"]),checked:()=>t.model.mode==="latex"}]},{type:"divider"},{label:()=>Le("menu.font-style"),id:"variant",visible:()=>t.isSelectionEditable,submenu:XD(t),submenuClass:"variant-submenu"},{label:()=>Le("menu.color"),id:"color",visible:()=>t.isSelectionEditable,submenu:eL(t),columnCount:4,submenuClass:"swatches-submenu"},{label:()=>Le("menu.background-color"),id:"background-color",visible:()=>t.isSelectionEditable,submenu:QD(t),columnCount:4,submenuClass:"swatches-submenu"},{label:()=>Le("menu.accent"),id:"accent",visible:()=>t.isSelectionEditable,submenu:YD(t),submenuClass:"variant-submenu"},{label:()=>Le("menu.decoration"),id:"decoration",visible:()=>t.isSelectionEditable&&ct(t).length>0,submenu:ZD(t),submenuClass:"variant-submenu"},{type:"divider"},{label:()=>Le("menu.evaluate"),id:"ce-evaluate",visible:()=>t.isSelectionEditable&&globalThis.MathfieldElement.computeEngine!==null,onMenuSelect:()=>{let e=oL(t);if(!e){t.model.announce("plonk");return}t.model.selectionIsCollapsed?(t.model.position=t.model.lastOffset,t.insert(`=${e}`,{insertionMode:"insertAfter",selectionMode:"item"})):t.insert(e,{insertionMode:"replaceSelection",selectionMode:"item"})}},{label:()=>Le("menu.simplify"),id:"ce-simplify",visible:()=>t.isSelectionEditable&&globalThis.MathfieldElement.computeEngine!==null,onMenuSelect:()=>{var e,n;if(t.model.selectionIsCollapsed){let r=(e=t.expression)==null?void 0:e.simplify();if(t.model.position=t.model.lastOffset,!r){t.model.announce("plonk");return}t.insert(`=${r.latex}`,{insertionMode:"insertAfter",selectionMode:"item"})}else{let r=(n=globalThis.MathfieldElement.computeEngine)==null?void 0:n.parse(t.getValue(t.model.selection)).simplify();if(!r){t.model.announce("plonk");return}t.insert(r.latex,{insertionMode:"replaceSelection",selectionMode:"item"})}}},{label:()=>{var e;let n=globalThis.MathfieldElement.computeEngine;if(n===null)return"";let r=(e=t.expression)==null?void 0:e.unknowns[0];if(r){let i=n.box(r).latex;return Le("menu.solve-for",Pt(i))}return Le("menu.solve")},id:"ce-solve",visible:()=>{var e;return t.isSelectionEditable&&globalThis.MathfieldElement.computeEngine!==null&&((e=t.expression)==null?void 0:e.unknowns.length)===1&&t.expression.unknowns[0]!=="Nothing"},onMenuSelect:()=>{var e;let n=t.expression,r=n?.unknowns[0],i=(e=n.solve(r))==null?void 0:e.map(o=>{var s;return(s=o.simplify().latex)!=null?s:""});if(!i){t.model.announce("plonk");return}t.insert(`${r}=${i.length===1?i[0]:"\\left\\lbrace"+i?.join(", ")+"\\right\\rbrace"}`,{insertionMode:"replaceAll",selectionMode:"item"})}},{type:"divider"},{label:()=>Le("menu.cut"),id:"cut",onMenuSelect:()=>t.executeCommand("cutToClipboard"),visible:()=>!t.options.readOnly&&t.isSelectionEditable,keyboardShortcut:"meta+X"},{label:()=>Le("menu.copy"),id:"copy",submenu:[{label:()=>Le("menu.copy-as-latex"),id:"copy-latex",onMenuSelect:()=>lt.copyToClipboard(t,"latex"),keyboardShortcut:"meta+C"},{label:()=>Le("menu.copy-as-typst"),id:"copy-latex",onMenuSelect:()=>lt.copyToClipboard(t,"typst")},{label:()=>Le("menu.copy-as-ascii-math"),id:"copy-ascii-math",onMenuSelect:()=>lt.copyToClipboard(t,"ascii-math")},{label:()=>Le("menu.copy-as-mathml"),id:"copy-math-ml",onMenuSelect:()=>lt.copyToClipboard(t,"math-ml")}]},{label:()=>Le("menu.paste"),id:"paste",onMenuSelect:()=>t.executeCommand("pasteFromClipboard"),visible:()=>t.hasEditableContent,keyboardShortcut:"meta+V"},{label:()=>Le("menu.select-all"),id:"select-all",keyboardShortcut:"meta+A",onMenuSelect:()=>t.executeCommand("selectAll")}]}function yo(t){var e,n;let r=(n=(e=t.model.parentEnvironment)==null?void 0:e.environmentName)!=null?n:"";return["array","matrix","pmatrix","bmatrix","vmatrix","Bmatrix","cases","dcases","rcases"].includes(r)}function iL(t){let e=t.model.at(t.model.position);if(e.type!=="array")return!1;let n=e.environmentName;return["matrix","pmatrix","bmatrix","vmatrix","Bmatrix"].includes(n)}function Rp(t){var e;let n=(e=t.model.parentEnvironment)==null?void 0:e.rows;return n?[n.length,n.reduce((r,i)=>Math.max(r,i.length),0)]:[0,0]}function vi(t){let e=t.model.parentEnvironment;return e?[e.minRows,e.minColumns]:[0,0]}function ws(t){let e=t.model.parentEnvironment;return e?[e.maxRows,e.maxColumns]:[0,0]}function Da(t,e){nh(t),t.flushInlineShortcutBuffer(),C5(t.model,e),vt(t)}function oL(t){var e,n;let r;if(t.model.selectionIsCollapsed?r=(e=globalThis.MathfieldElement.computeEngine)==null?void 0:e.parse(t.getValue(),{canonical:!1}):r=(n=globalThis.MathfieldElement.computeEngine)==null?void 0:n.parse(t.getValue(t.model.selection),{canonical:!1}),!r)return"";let i=r.evaluate();return i.isSame(r)&&(i=r.N()),i.latex}function zp(t,e,n,r){return{id:`variant-${e}`,label:()=>{var i;return ct(t).length<12?Pt(`\\${n}{${ct(t)}}`):(i=Le(r))!=null?i:r},class:"ML__xl",tooltip:()=>{var i;return(i=Le(r))!=null?i:r},visible:()=>GD(t,e),checked:()=>{var i;return(i={some:"mixed",all:!0}[t.queryStyle({variant:e})])!=null?i:!1},onMenuSelect:()=>t.applyStyle({variant:e},{operation:"toggle"})}}function Fp(t,e,n,r){return{id:`variant-style-${e}`,label:()=>{var i;let o=ct(t);return o.length>0&&o.length<12?Pt(`\\${n}{${ct(t)}}`):(i=Le(r))!=null?i:r},class:()=>{let i=ct(t);return i.length>0&&i.length<12?"ML__xl":""},tooltip:()=>{var i;return(i=Le(r))!=null?i:r},visible:!0,checked:()=>{var i;return(i={some:"mixed",all:!0}[t.queryStyle({variantStyle:e})])!=null?i:!1},onMenuSelect:()=>t.applyStyle({variantStyle:e},{operation:"toggle"})}}function sL(t){return[{label:()=>Bn("abs"),id:"insert-abs",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("|#?|")},{label:()=>Bn("nth-root"),id:"insert-nth-root",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\sqrt[#?]{#?}")},{label:()=>Bn("log-base"),id:"insert-log-base",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\log_{#?}{#?}")},{type:"heading",label:()=>Le("menu.insert.heading-calculus")},{label:()=>Bn("derivative"),id:"insert-derivative",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\dfrac{\\mathrm{d}}{\\mathrm{d}x}#?\\bigm|_{x=#?}")},{label:()=>Bn("nth-derivative"),id:"insert-nth-derivative",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\dfrac{\\mathrm{d}^#?}{\\mathrm{d}x^#?}#?\\bigm|_{x=#?}")},{label:()=>Bn("integral"),id:"insert-integral",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\int_#?^#?#?\\,\\mathrm{d}#?")},{label:()=>Bn("sum"),id:"insert-sum",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\sum_#?^#?#?")},{label:()=>Bn("product"),id:"insert-product",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\prod_#?^#?#?")},{type:"heading",label:()=>Le("menu.insert.heading-complex-numbers")},{label:()=>Bn("modulus"),id:"insert-modulus",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\lvert#?\\rvert")},{label:()=>Bn("argument"),id:"insert-argument",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\arg(#?)")},{label:()=>Bn("real-part"),id:"insert-real-part",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\Re(#?)")},{label:()=>Bn("imaginary-part"),id:"insert-imaginary-part",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\Im(#?)")},{label:()=>Bn("conjugate"),id:"insert-conjugate",visible:()=>t.isSelectionEditable,onMenuSelect:()=>t.insert("\\overline{#?}")}]}function Bn(t){return`<span class='ML__insert-template'> ${Pt(Le(`menu.insert.${t}-template`))}</span><span class="ML__insert-label">${Le(`menu.insert.${t}`)}</span>`}var bn={"\\ne":"!=","\\neq":"!=","":"-","-":"-","\\alpha":"alpha","\\beta":"beta","\\gamma":"gamma","\\delta":"delta","\\epsilon":"epsilon.alt","\\varepsilon":"epsilon","\\zeta":"zeta","\\eta":"eta","\\theta":"theta.alt","\\vartheta":"theta","\\iota":"iota","\\kappa":"kappa","\\lambda":"lambda","\\mu":"mu","\\nu":"nu","\\xi":"xi","\\pi":"pi","\\rho":"rho","\\sigma":"sigma","\\tau":"tau","\\upsilon":"upsilon","\\phi":"phi.alt","\\varphi":"phi","\\chi":"chi","\\psi":"psi","\\omega":"omega","\\Gamma":"Gamma","\\Delta":"Delta","\\Theta":"Theta","\\Lambda":"Lambda","\\Xi":"Xi","\\Pi":"Pi","\\Sigma":"Sigma","\\Phi":"Phi","\\Psi":"Psi","\\Omega":"Omega","\\exponentialE":"e","\\imaginaryI":"i","\\imaginaryJ":"j","\\!":" #h(-1em/6) ","\\,":" thin ","\\:":" med ","\\>":" med ","\\;":" thick ","\\enskip":"space.en","\\enspace":"space.en","\\qquad":"space.quad space.quad","\\quad":"space.quad","\\infty":"infinity","\\R":"RR","\\mathbb{R}":"RR","\\N":"NN","\\mathbb{N}":"NN","\\Z":"ZZ","\\mathbb{Z}":"ZZ","\\Q":"QQ","\\mathbb{Q}":"QQ","\\C":"CC","\\mathbb{C}":"CC","\\emptyset":"emptyset","\\varnothing":"nothing","\\varDelta":"Delta","\\varTheta":"Theta","\\varLambda":"Lambda","\\varXi":"Xi","\\varPi":"Pi","\\varSigma":"Sigma","\\varUpsilon":"Upsilon","\\varPhi":"Phi","\\varPsi":"Psi","\\varOmega":"Omega","\\vert":" | ","\\Vert":" || ","\\mid":" divides ","\\lbrack":" bracket.l ","\\rbrack":" bracket.r ","\\lbrace":" brace.l ","\\rbrace":" brace.r ","\\lparen":" paren.l ","\\rparen":" paren.r ","\\langle":" angle.l ","\\rangle":" angle.r ","\\differentialD":" dif ","\\diamond":" diamond.stroked.small ","\\square":" square.stroked.small ","\\lceil":" ceil.l ","\\rceil":" ceil.r ","\\lfloor":" floor.l ","\\rfloor":" floor.r ","\\aleph":" aleph ","\\bet":" bet ","\\gimel":" gimel ","\\dalet":" dalet ","\\mod":" mod ","\\equiv":" equiv ","\\subset":" subset ","\\supset":" supset ","\\subseteq":" subset.eq ","\\supseteq":" supset.eq ","\\subsetneq":" subset.neq ","\\supsetneq":" supset.neq ","\\supsetneqq":" supset.neq ","\\nsubset":" subset.not ","\\nsupset":" supset.not ","\\nsubseteq":" subset.eq.not ","\\nsupseteq":" supset.eq.not ","\\approx":" approx ","\\uparrow":" arrow.t ","\\downarrow":" arrow.b ","\\rightarrow":" arrow.r ","\\leftarrow":" arrow.l ","\\longmapsto":" mapsto.long ","\\longmapsfrom":" arrow.l.bar.long ","/":"\\/","&":"&"},Ov={"[":" bracket.l ","]":" bracket.r ","{":" brace.l ","}":" brace.r ","(":" paren.l ",")":" paren.r ","<":" angle.l ",">":" angle.r ",".":""},Nv={" bracket.l ":"["," bracket.r ":"]"," brace.l ":"{"," brace.r ":"}"," paren.l ":"("," paren.r ":")"," angle.l ":" angle.l "," angle.r ":" angle.r "},La={"\\pm":"plus.minus","\\colon":" : ","\\sum":" sum ","\\prod":" product ","\\bigcap":" inter.big ","\\bigcup":" union.big ","\\int":" integral ","\\iint":" integral.double ","\\iiint":" integral.triple ","\\intop":" integral ","\\oint":" integral.cont ","\\oiint":" integral.surf ","\\oiiint":" integral.vol ","\\setminus":" without ","\\vdots":" without ","\\ddots":" dots.down ","\\ge":">=","\\le":"<=","\\ne":"!=","\\neq":"!=","\\lt":"<","\\gt":">","\\gets":"<-","\\to":"->","\\land":" and ","\\lor":" or ","\\lnot":" not ","\\forall":" forall ","\\exists":" exists ","\\in":" in ","\\notin":" in.not ","\\mapsto":"|->","\\implies":"==>","\\iff":"<==>","\\cdot":" dot.op ","\\ast":" * ","\\star":" star.op ","\\times":" times ","\\div":" div ","\\ltimes":" times.l ","\\rtimes":" times.r ","\\bowtie":"  ","\\circ":" circle.stroked.small "},aL={underarc:"underparen",underparen:"underparen",underbrace:"underbrace",underline:"underline",overarc:"overparen",overparen:"overparen",overbrace:"overbrace",overline:"overline",cancel:"cancel",displaystyle:"display",textstyle:"inline"},lL={longrightarrow:t=>`arrow.r.long^(${dt(t.above)})`,longleftarrow:t=>`arrow.l.long^(${dt(t.above)})`};function uL(t){let e="";for(let n of t){let r=e[e.length-1];r!==void 0&&(/\d$/.test(r)&&/^\d/.test(n)||/[a-zA-Z]$/.test(r)&&/^[a-zA-Z]/.test(n))&&(e+=" "),e+=n}return e}function dt(t){var e,n,r,i,o,s,a,l,u,c,d,p,f,g,x,w,k,D,N,B,T,R,L;if(!t)return"";if(Ht(t)){if(t.length===0)return"";if(t[0].mode==="latex")return t.map(re=>dt(re)).join("");if(t[0].mode==="text"){let re=0,ce="";for(;((e=t[re])==null?void 0:e.mode)==="text";)ce+=t[re].body?dt(t[re].body):t[re].value,re++;return` "${ce}" ${dt(t.slice(re))}`}let ae=0,be=[];for(;((n=t[ae])==null?void 0:n.mode)==="math";){let re="";for(;((r=t[ae])==null?void 0:r.type)==="mord"&&/\d/.test(t[ae].value);)re+=t[ae++].value;re?be.push(re):be.push(dt(t[ae++]))}return be.push(dt(t.slice(ae))),uL(be)}if(t.mode==="text")return`"${t.value}"`;let P="",{command:W}=t,de;if(W==="\\placeholder")return`"${dt(t.body)}"`;let q=G.serialize([t],{expandMacro:!0,defaultMode:"math"});switch(t.type){case"accent":let ae={"\\vec":"arrow","\\dot":"dot","\\ddot":"dot.double","\\bar":"overline","\\hat":"hat","\\acute":"acute","\\grave":"grave","\\tilde":"tilde","\\breve":"breve","\\check":"caron"}[W];P=`${ae??""}(${dt(t.body)}) `;break;case"first":return"";case"latexgroup":return t.body.map(re=>re.value).join("");case"group":case"root":P=(i=bn[W])!=null?i:dt(t.body);break;case"genfrac":{let re=t;re.hasBarLine?(P+="(",P+=dt(re.above),P+=")/(",P+=dt(re.below),P+=")"):P+=`binom(${dt(re.above)}, ${dt(re.below)})`}break;case"surd":t.hasEmptyBranch("above")?P+=`sqrt(${dt(t.body)})`:P+=`root(${dt(t.above)}, ${dt(t.body)})`;break;case"latex":P=t.value;break;case"leftright":{let re=t,ce=re.leftDelim;ce&&bn[ce]&&(ce=bn[ce]);let ge=re.matchingRightDelim();ge&&bn[ge]&&(ge=bn[ge]),ce&&(ce=(o=Ov[ce])!=null?o:ce),ge&&(ge=(s=Ov[ge])!=null?s:ge),ce&&ge?P=`lr(${(a=Nv[ce])!=null?a:ce}${dt(re.body)}${(l=Nv[ge])!=null?l:ge})`:P=`lr(${ce}${dt(re.body)}${ge})`}break;case"sizeddelim":case"delim":P=t.value;break;case"overlap":break;case"mord":if(bn[q])return bn[q];P=(d=(c=(u=bn[W])!=null?u:W)!=null?c:W)!=null?d:typeof t.value=="string"?t.value:"",P.startsWith("\\")&&(P+=" "),de=W?W.match(/{?\\char"([\dabcdefABCDEF]+)}?/):null,de?P=String.fromCodePoint(Number.parseInt("0x"+de[1])):P.length>0&&P.startsWith("\\")&&(P=typeof t.value=="string"?t.value.charAt(0):t.command),P=cL(P,t.style),P=` ${P} `;break;case"mbin":case"mrel":case"minner":P=(g=(f=(p=bn[q])!=null?p:bn[W])!=null?f:La[W])!=null?g:t.value;break;case"mopen":case"mclose":P=(x=bn[q])!=null?x:t.value;break;case"mpunct":P=(w=La[W])!=null?w:W;break;case"mop":case"operator":case"extensible-symbol":t.value!==""&&(La[W]?P=La[W]:P=W==="\\operatorname"?dt(t.body):(k=t.value)!=null?k:W,P+=" ");break;case"array":let be=t.environmentName;if(t.isMultiline)P=t.rows.map(re=>re.map(ce=>dt(ce)).join("")).join(`
`);else{let re=t.rows,ce=re.map(xe=>xe.map(dt).join(", ")),ge={pmatrix:'"("',bmatrix:'"["',"bmatrix*":'"["',Bmatrix:'"{"',vmatrix:'"|"',matrix:"#none"}[be];ge?P=`mat(delim: ${ge}, ${ce.join(" ; ")})`:be==="cases"||be==="rcases"?P=`cases(reverse: #${be==="rcases"}, ${ce.join(", ")})`:be==="aligned"?P=re.map(xe=>xe.map(dt).join(" & ")).join(" \\ "):P=re.map(xe=>xe.map(dt).join("")).join("")}break;case"box":break;case"spacing":P=(N=(D=bn[q])!=null?D:bn[W])!=null?N:" ";break;case"space":P=" ";break;case"subsup":P=(B=t.leftSibling)!=null&&B.value?"":'""';break;case"macro":P=(L=(R=(T=bn[q])!=null?T:bn[W])!=null?R:La[W])!=null?L:dt(t.body);break}if(!P){let ae=aL[t.command.slice(1)];ae&&(P=`${ae}(${dt(t.body)})`)}if(!P){let ae=lL[t.command.slice(1)];ae&&(P=ae(t))}if(!t.hasEmptyBranch("subscript")){P+="_";let ae=dt(t.subscript);P+=ae.length!==1?`(${ae})`:ae}if(!t.hasEmptyBranch("superscript")){P+="^";let ae=dt(t.superscript);P+=ae.length!==1?`(${ae})`:ae}return P}function cL(t,e){if(!e)return t;let n=t;return e.variant==="double-struck"&&(n=`bb(${n})`),e.variant==="script"&&(n=`cal(${n})`),e.variant==="fraktur"&&(n=`frak(${n})`),e.variant==="sans-serif"&&(n=`sans(${n})`),e.variant==="monospace"&&(n=`mono(${n})`),e.variantStyle==="bold"&&(n=`bold(${n})`),n}function Fi(t,e){return typeof t=="string"?t+Ko(e):Ko(t)}function em(t){var e;let n;if(t.parent.type==="prompt")t.parentBranch==="body"&&(n="prompt");else if(t.parentBranch==="body"){if(t.type==="first"&&(t.parent.type==="root"?n="mathfield":t.parent.type==="surd"?n="radicand":t.parent.type==="genfrac"?n="fraction":t.parent.type==="sizeddelim"&&(n="delimiter"),n))return n;t.type==="subsup"?t.superscript&&t.subscript?n="superscript and subscript":t.superscript?n="superscript":t.subscript&&(n="subscript"):t.type&&(n=(e={accent:"accented",array:"array",box:"box",chem:"chemical formula",delim:"delimiter",enclose:"cross out","extensible-symbol":"extensible symbol",error:"error",first:"first",genfrac:"fraction",group:"group",latex:"LaTeX",leftright:"delimiter",line:"line",subsup:"subscript-superscript",operator:"operator",overunder:"over-under",placeholder:"placeholder",rule:"rule",sizeddelim:"delimiter",space:"space",spacing:"spacing",surd:"square root",text:"text",prompt:"prompt",root:"math field",mop:"operator"}[t.type])!=null?e:"parent")}else if(t.parent.type==="genfrac"){if(t.parentBranch==="above")return"numerator";if(t.parentBranch==="below")return"denominator"}else t.parent.type==="surd"?t.parentBranch==="above"&&(n="index"):t.parentBranch==="superscript"?n="superscript":t.parentBranch==="subscript"&&(n="subscript");return n??"parent"}function dL(t,e,n,r){let i="";if(e==="plonk"){globalThis.MathfieldElement.playSound("plonk"),t.flushInlineShortcutBuffer();return}if(e==="delete")i=Fi("deleted: ",r);else if(e==="focus"||e.includes("move"))i=hL(t.model,n),i+=pL(t.model);else if(e==="replacement")i=Fi(t.model.at(t.model.position));else if(e==="line"){let o=Fi(t.model.root);t.keyboardDelegate.setAriaLabel(o)}else i=r?Fi(e+" ",r):e;if(i){let o=t.ariaLiveText.textContent.includes("")?"  ":"  ";t.ariaLiveText.textContent=i+o}}function hL(t,e){if(Number.isNaN(e))return"";let n=t.at(e);if(!n||n.treeDepth<=t.at(t.position).treeDepth)return"";let r="",i=n.parent,o=t.at(t.position).parent;for(;i!==t.root&&i!==o;)r+=`out of ${em(i)};`,i=i.parent;return r}function pL(t){if(!t.selectionIsCollapsed)return`selected: ${Fi(t.getAtoms(t.selection))}`;let e="",n=t.at(t.position);if(n.isFirstSibling&&(e=`start of ${em(n)}: `),n.isLastSibling){if(!n.isFirstSibling){if(!n.parent.parent)return`${Fi(n)}; end of mathfield`;e=`${Fi(n)}; end of ${em(n)}`}}else e+=Fi(n);return e}var fL=class{constructor(t,e,n){this.mathfield=t,this.mode=e,this.silenceNotifications=!1,this._selection={ranges:[[0,0]],direction:"none"},this._anchor=0,this._position=0,this.root=n}dispose(){this.mathfield=void 0}getState(){let t={ranges:[...this._selection.ranges]};return this.selection.direction&&this.selection.direction!=="none"&&(t.direction=this.selection.direction),{content:this.root.toJson(),selection:t,mode:this.mode}}setState(t,e){var n;let r=this.silenceNotifications;this.silenceNotifications=(n=e?.silenceNotifications)!=null?n:!0;let i={};if(e?.type==="undo"&&(i={inputType:"historyUndo"}),e?.type==="redo"&&(i={inputType:"historyRedo"}),this.contentWillChange(i)){let o=this.silenceNotifications;this.silenceNotifications=!0,this.mode=t.mode,this.root=Hi(t.content),this.selection=t.selection,this.silenceNotifications=o,this.contentDidChange(i),this.selectionDidChange()}this.silenceNotifications=r}get atoms(){return this.root.children}get selection(){return this._selection}set selection(t){this.setSelection(t)}setSelection(t,e){return!this.mathfield.contentEditable&&this.mathfield.userSelect==="none"?!1:this.deferNotifications({selection:!0,content:!0},()=>{var n,r,i,o;let s=this.normalizeSelection(t,e);if(s===void 0)throw new TypeError("Invalid selection");if(s.ranges.length===1&&s.ranges[0][0]===s.ranges[0][1]){let p=s.ranges[0][0];if(!this.mathfield.dirty&&!((n=this.at(p))!=null&&n.parentPrompt)&&this.mathfield.hasEditablePrompts){if((r=this.at(p-1))!=null&&r.parentPrompt){this._anchor=this.normalizeOffset(p-1),this._position=this._anchor,this._selection=this.normalizeSelection(this._anchor);return}if((i=this.at(p+1))!=null&&i.parentPrompt){this._anchor=this.normalizeOffset(p+1),this._position=this._anchor,this._selection=this.normalizeSelection(this._anchor);return}this._anchor=0,this._position=0,this._selection={ranges:[[0,0]]};return}this._anchor=p,this._position=p,this._selection=s;return}let a=en(s);a=mL(this,a),s.direction==="backward"?[this._position,this._anchor]=a:[this._anchor,this._position]=a;let l=a[0]+1;for(;l<=this.lastOffset&&((o=this.at(l))==null?void 0:o.type)==="first"&&l<a[1];)l+=1;let u=l<=this.lastOffset?this.at(l):this.at(a[1]),c=this.at(a[1]),d=G.commonAncestor(u,c);d?.type==="array"&&u.parent===d&&c.parent===d?this._selection={ranges:[a],direction:s.direction}:this._selection={ranges:[a],direction:s.direction},this._position>=0&&this._position<=this.lastOffset})}setPositionHandlingPlaceholder(t){var e;let n=this.at(t);n?.type==="placeholder"?this.setSelection(t-1,t):((e=n?.rightSibling)==null?void 0:e.type)==="placeholder"?this.setSelection(t,t+1):this.position=t,n instanceof qt&&n.isSuggestion&&(n.isSuggestion=!1),this.mathfield.stopCoalescingUndo()}get position(){return this._position}set position(t){this.setSelection(t,t)}get anchor(){return this._anchor}get selectionIsCollapsed(){return this._anchor===this._position}get selectionIsPlaceholder(){return Math.abs(this._anchor-this._position)===1?this.at(Math.max(this._anchor,this._position)).type==="placeholder":!1}collapseSelection(t="forward"){return this._anchor===this._position?!1:(t==="backward"?this.position=Math.min(this._anchor,this._position):this.position=Math.max(this._anchor,this._position),!0)}get lastOffset(){return this.atoms.length-1}at(t){return this.atoms[t]}offsetOf(t){return this.atoms.indexOf(t)}getSiblingsRange(t){let e=this.at(t),{parent:n}=e;if(!n)return[0,this.lastOffset];let r=e.parent.branch(e.parentBranch);return[this.offsetOf(r[0]),this.offsetOf(r[r.length-1])]}getBranchRange(t,e){let n=this.at(t).branch(e);return[this.offsetOf(n[0]),this.offsetOf(n[n.length-1])]}getCellRange(t){var e,n;this.getParentCell(t);let r=this.at(t);if(r){for(;r&&((e=r.parent)==null?void 0:e.type)!=="array";)r=r.parent;if(((n=r?.parent)==null?void 0:n.type)==="array")return[this.offsetOf(r.firstSibling),this.offsetOf(r.lastSibling)]}}getAtoms(t,e,n){let r=n??{};if(uc(t)){if(r=e??{},t.ranges.length>1)return t.ranges.reduce((d,p)=>[...d,...this.getAtoms(p,r)],[]);t=t.ranges[0]}let i,o;if(Li(t)){if(i=t,!Li(e))return[];o=e}else[i,o]=t,Object.keys(r).length===0&&(r=e??{});if(!Number.isFinite(i))return[];r.includeChildren===void 0&&(r.includeChildren=!1),i<0&&(i=this.lastOffset-i+1),o<0&&(o=this.lastOffset+o+1);let s=Math.min(i,o),a=Math.max(i,o),l=s===0?0:s+1,u=a;if(!r.includeChildren&&l===1&&u===this.lastOffset)return[this.root];let c=[];for(let d=l;d<=u;d++){let p=this.atoms[d];Pv(this,p,l,u,r.includeFirstAtoms)&&c.push(p)}return r.includeChildren||(c=c.filter(d=>{let p=!1,{parent:f}=d;for(;f&&!p;)p=Pv(this,f,l,u,r.includeFirstAtoms),f=f.parent;return!p})),c}findAtom(t,e=0,n="forward"){let r,i=this.lastOffset;if(n==="forward"){for(let o=e;o<=i;o++)if(r=this.atoms[o],t(r))return r;for(let o=0;o<e;o++)if(r=this.atoms[o],t(r))return r;return}for(let o=e;o>=0;o--)if(r=this.atoms[o],t(r))return r;for(let o=i;o>e;o--)if(r=this.atoms[o],t(r))return r}extractAtoms(t){var e;let n=this.getAtoms(t);n.length===1&&!n[0].parent&&n[0].isRoot&&(n[0]instanceof He?n=n[0].rows.flatMap(r=>r.flatMap(i=>i)):n=[...(e=n[0].body)!=null?e:n[0].children],n=n.filter(r=>r.type!=="first"));for(let r of n)r.parent.removeChild(r);return n}deleteAtoms(t){if(t!=null||(t=[0,-1]),this.extractAtoms(t),t[0]===0&&t[1]===-1&&this.root instanceof He)for(;this.root.rowCount>1;)this.root.removeRow(1);this.position=t[0]}atomToString(t,e){let n=e??"latex";if(n.startsWith("latex"))return G.serialize([t],{expandMacro:n==="latex-expanded",skipStyles:n==="latex-unstyled",skipPlaceholders:n==="latex-without-placeholders",defaultMode:this.mathfield.options.defaultMode});if(n==="math-ml")return Ze(t);if(n==="spoken")return Ko(t);if(n==="spoken-text"){let r=globalThis.MathfieldElement.textToSpeechMarkup;globalThis.MathfieldElement.textToSpeechMarkup="";let i=Ko(t);return globalThis.MathfieldElement.textToSpeechMarkup=r,i}if(n==="spoken-ssml"||n==="spoken-ssml-with-highlighting"){let r=globalThis.MathfieldElement.textToSpeechMarkup;globalThis.MathfieldElement.textToSpeechMarkup="ssml";let i=Ko(t);return globalThis.MathfieldElement.textToSpeechMarkup=r,i}return n==="typst"?dt(t):n==="plain-text"?bt(t,{plain:!0}):n==="ascii-math"?bt(t):(console.error(`MathLive 0.108.2: Unexpected format "${n}`),"")}getValue(t,e,n){if(t===void 0)return this.atomToString(this.root,"latex");if(typeof t=="string"&&t!=="math-json")return this.atomToString(this.root,t);let r,i;if(Li(t)&&Li(e)?(r=[this.normalizeRange([t,e])],i=n):gd(t)?(r=[this.normalizeRange(t)],i=e):uc(t)?(r=t.ranges,i=e):(r=[this.normalizeRange([0,-1])],i=t),i!=null||(i="latex"),i==="math-json"){if(!globalThis.MathfieldElement.computeEngine)return window[Symbol.for("io.cortexjs.compute-engine")]||console.error(`The CortexJS Compute Engine library is not available.
Load the library, for example with:
import "https://esm.run/@cortex-js/compute-engine"`),'["Error", "compute-engine-not-available"]';let o=this.getValue({ranges:r},"latex-unstyled");try{let s=globalThis.MathfieldElement.computeEngine.parse(o);return JSON.stringify(s.json)}catch(s){return JSON.stringify(["Error",`'${s.toString()}'`])}}if(i.startsWith("latex")){let o={expandMacro:i==="latex-expanded",skipStyles:i==="latex-unstyled",skipPlaceholders:i==="latex-without-placeholders",defaultMode:this.mathfield.options.defaultMode};return Fe(r.map(s=>G.serialize(this.getAtoms(s),o)))}return r.map(o=>this.getAtoms(o).map(s=>this.atomToString(s,i)).join("")).join("")}extendSelectionTo(t,e){return!this.mathfield.contentEditable&&this.mathfield.userSelect==="none"?!1:this.deferNotifications({selection:!0},()=>{let n=this.normalizeRange([t,e]),[r,i]=n,o=new Set(["genfrac","subsup","accent","box","overlap","overunder"]),{parent:s}=this.at(i);if(s!=null&&s.type&&o.has(s.type))for(;s!=null&&s.type&&o.has(s.type)&&vc(this,s,[r,i]);)i=this.offsetOf(s),s=s.parent;for(s=this.at(r).parent;s!=null&&s.type&&o.has(s.type)&&vc(this,s,[r,i]);)r=this.offsetOf(s.leftSibling),s=s.parent;if(s=this.at(i).parent,s!=null&&s.type&&o.has(s.type))for(;s!=null&&s.type&&o.has(s.type)&&vc(this,s,[r,i]);)i=this.offsetOf(s),s=s.parent;this._position=this.normalizeOffset(e),this._selection={ranges:[[r,i]],direction:"none"}})}announce(t,e,n=[]){var r,i;((i=(r=this.mathfield.host)==null?void 0:r.dispatchEvent(new CustomEvent("announce",{detail:{command:t,previousPosition:e,atoms:n},cancelable:!0,bubbles:!0,composed:!0})))==null||i)&&dL(this.mathfield,t,e,n)}deferNotifications(t,e){let n=this._selection,r=this._anchor,i=this._position,o=this.silenceNotifications;this.silenceNotifications=!0;let s=this.root.changeCounter;e(),this.silenceNotifications=o;let a=r!==this._anchor||i!==this._position||MC(this._selection,n)==="different";t.selection&&a&&this.selectionDidChange();let l=this.root.changeCounter!==s;return t.content&&l&&this.contentDidChange({inputType:t.type}),l||a}normalizeOffset(t){return t>0?t=Math.min(t,this.lastOffset):t<0&&(t=this.lastOffset+t+1),t}normalizeRange(t){let[e,n]=t;return e=this.normalizeOffset(e),n=this.normalizeOffset(n),e<n?[e,n]:[n,e]}normalizeSelection(t,e){var n;let r;if(Li(t)){let i=this.normalizeOffset(t);if(Li(e)){let o=this.normalizeOffset(e);r=i<=o?{ranges:[[i,o]],direction:"none"}:{ranges:[[o,i]],direction:"backward"}}else r={ranges:[[i,i]],direction:"none"}}else if(gd(t)){let i=this.normalizeOffset(t[0]),o=this.normalizeOffset(t[1]);r=i<=o?{ranges:[[i,o]],direction:"none"}:{ranges:[[o,i]],direction:"backward"}}else uc(t)&&(r={ranges:t.ranges.map(i=>this.normalizeRange(i)),direction:(n=t.direction)!=null?n:"none"});return r}get parentEnvironment(){let t=this.at(this.position).parent;if(t){for(;t.parent&&t.type!=="array";)t=t.parent;if(t.type==="array")return t}}get parentCell(){return this.getParentCell(this.position)}getParentCell(t){var e,n;let r=this.at(t);if(r){for(;r&&((e=r.parent)==null?void 0:e.type)!=="array";)r=r.parent;if(((n=r?.parent)==null?void 0:n.type)==="array")return r.parentBranch}}contentWillChange(t={}){if(this.silenceNotifications||!this.mathfield)return!0;let e=this.silenceNotifications;this.silenceNotifications=!0;let n=this.mathfield.onContentWillChange(t);return this.silenceNotifications=e,n}contentDidChange(t){var e;if(window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.update(_i(this.mathfield)),this.silenceNotifications||!((e=this.mathfield)!=null&&e.host))return;let n=this.silenceNotifications;this.silenceNotifications=!0,setTimeout(()=>{var r;!this.mathfield||!jr(this.mathfield)||!this.mathfield.host||this.mathfield.host.dispatchEvent(new InputEvent("input",V(O({},t),{data:t.data?t.data:(r=t.inputType)!=null?r:"",bubbles:!0,composed:!0})))},0),this.silenceNotifications=n}selectionDidChange(){if(!this.mathfield)return;let t=this.silenceNotifications;t||(this.silenceNotifications=!0,this.mathfield.onSelectionDidChange()),this.silenceNotifications=t}};function Pv(t,e,n,r,i){let o=t.offsetOf(e);if(o<n||o>r)return!1;if(!e.hasChildren)return!0;let s=i?e.firstChild:U5(e);if(!s)return!1;let a=i?e.lastChild:J5(e);if(!a)return!1;let l=t.offsetOf(s);if(l>=n&&l<=r){let u=t.offsetOf(a);if(u>=n&&u<=r)return!0}return!1}function vc(t,e,n){if(!(e!=null&&e.hasChildren))return!1;let[r,i]=n,o=U5(e);if(!o)return!1;let s=J5(e);if(!s)return!1;let a=t.offsetOf(o),l=t.offsetOf(s);return a>=r&&a<=i&&l>=a&&l<=i}function mL(t,e){let[n,r]=e,i=r+1;if(i>t.lastOffset)return e;let o=t.at(i);return gL(t,o,n,r)&&(r=t.offsetOf(o)),[n,r]}function gL(t,e,n,r){if(e?.type!=="subsup"||!vc(t,e,[n,r]))return!1;let i=e.leftSibling;if(!i)return!1;let o=t.offsetOf(i);return o>n&&o<=r}function U5(t){for(let e of t.children)if(e.type!=="first")return e}function J5(t){let{children:e}=t;for(let n=e.length-1;n>=0;n--)if(e[n].type!=="first")return e[n]}ln({deleteAll:t=>t.contentWillChange({inputType:"deleteContent"})&&Gr(t,[0,-1],"deleteContent"),deleteForward:t=>$A(t),deleteBackward:t=>FA(t),deleteNextWord:t=>t.contentWillChange({inputType:"deleteWordForward"})&&Ri(t,"forward",{delete:!0}),deletePreviousWord:t=>t.contentWillChange({inputType:"deleteWordBackward"})&&Ri(t,"backward",{delete:!0}),deleteToGroupStart:t=>{if(!t.contentWillChange({inputType:"deleteSoftLineBackward"}))return!1;let e=t.offsetOf(t.at(t.position).firstSibling);return e===t.position?(t.announce("plonk"),!1):(t.deferNotifications({content:!0,selection:!0,type:"deleteSoftLineBackward"},()=>t.deleteAtoms([t.anchor,e])),t.position=e,!0)},deleteToGroupEnd:t=>{if(!t.contentWillChange({inputType:"deleteSoftLineForward"}))return!1;let e=t.offsetOf(t.at(t.position).lastSibling);return e===t.position?(t.announce("plonk"),!1):(t.deferNotifications({content:!0,selection:!0,type:"deleteSoftLineForward"},()=>t.deleteAtoms([t.anchor,e])),!0)},deleteToMathFieldStart:t=>t.contentWillChange({inputType:"deleteHardLineBackward"})&&Gr(t,[t.anchor,0],"deleteHardLineBackward"),deleteToMathFieldEnd:t=>t.contentWillChange({inputType:"deleteHardLineForward"})&&Gr(t,[t.anchor,-1],"deleteHardLineForward")},{target:"model",audioFeedback:"delete",canUndo:!0,changeContent:!0,changeSelection:!0});var yL=`<svg xmlns="http://www.w3.org/2000/svg" style="width: 21px;"  viewBox="0 0 576 512" role="img" aria-label="${Le("tooltip.toggle virtual keyboard")}"><path d="M528 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm16 336c0 8.823-7.177 16-16 16H48c-8.823 0-16-7.177-16-16V112c0-8.823 7.177-16 16-16h480c8.823 0 16 7.177 16 16v288zM168 268v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-336 80v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm384 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zM120 188v-24c0-6.627-5.373-12-12-12H84c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm96 0v-24c0-6.627-5.373-12-12-12h-24c-6.627 0-12 5.373-12 12v24c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12zm-96 152v-8c0-6.627-5.373-12-12-12H180c-6.627 0-12 5.373-12 12v8c0 6.627 5.373 12 12 12h216c6.627 0 12-5.373 12-12z"/></svg>`,bL=`<svg xmlns="http://www.w3.org/2000/svg" style="height: 18px;" viewBox="0 0 448 512" role="img" aria-label="${Le("tooltip.menu")}"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg>`,vL=class $a{constructor(e,n){this.focusBlurInProgress=!1,this.programmaticFocusInProgress=!1,this.connectedToVirtualKeyboard=!1;var r,i;this.options=O(V(O({},mc()),{macros:Xm(),registers:dx()}),_d(n)),this.eventController=new AbortController;let o=this.eventController.signal;n.eventSink&&(this.host=n.eventSink),this.element=e,e.mathfield=this,this.blurred=!0,this.keystrokeCaptionVisible=!1,this.suggestionIndex=0,this.inlineShortcutBuffer=[],this.inlineShortcutBufferFlushTimer=0,this.scientificNotationTimer=0,this.defaultStyle={},this.styleBias="left",this.options.defaultMode==="inline-math"?this.element.classList.add("ML__is-inline"):this.element.classList.remove("ML__is-inline"),this.dirty=!1;let s=(i=(r=n.value)!=null?r:this.element.textContent)!=null?i:"";s=s.trim();let a=dv(this.options),l=wn(s,{context:this.context}),u;l.length===1&&l[0].isRoot?u=l[0]:u=new G({type:"root",mode:a,body:l}),this.model=new fL(this,a,u),this.undoManager=new zA(this.model);let c=[];if(c.push("<span contenteditable=true role=textbox aria-autocomplete=none aria-multiline=false part=keyboard-sink class=ML__keyboard-sink autocapitalize=off autocomplete=off autocorrect=off spellcheck=false inputmode=none tabindex=0></span>"),c.push('<span part=container class=ML__container  style="visibility:hidden">'),c.push("<span part=content class=ML__content>"),c.push(g5(this)),c.push("</span>"),c.push("<div class=ML__toggles>"),window.mathVirtualKeyboard&&(c.push(`<div part=virtual-keyboard-toggle class=ML__virtual-keyboard-toggle role=button ${this.hasEditableContent?"":'style="display:none;"'} data-l10n-tooltip="tooltip.toggle virtual keyboard">`),c.push(yL),c.push("</div>")),c.push('<div part=menu-toggle class=ML__menu-toggle role=button data-l10n-tooltip="tooltip.menu">'),c.push(bL),c.push("</div>"),c.push("</div>"),c.push("</span>"),c.push("<span class=ML__sr-only>"),c.push("<span role=status aria-live=assertive aria-atomic=true></span>"),c.push("</span>"),this.element.innerHTML=globalThis.MathfieldElement.createHTML(c.join("")),!this.element.children){console.error("%cMathLive 0.108.2: Something went wrong and the mathfield could not be created.%c\nIf you are using Vue, this may be because you are using the runtime-only build of Vue. Make sure to include `runtimeCompiler: true` in your Vue configuration. There may a warning from Vue in the log above.","color:red;font-family:system-ui;font-size:1.2rem;font-weight:bold","color:inherit;font-family:system-ui;font-size:inherit;font-weight:inherit");return}this._l10Subscription=qe.subscribe(()=>qe.update(this.element)),qe.update(this.element),this.container=this.element.querySelector("[part=container]"),this.field=this.container.querySelector("[part=content]"),this.field.addEventListener("click",g=>g.stopImmediatePropagation(),{capture:!1,signal:o}),this.field.addEventListener("wheel",this,{passive:!1,signal:o});let d=this.element;if("PointerEvent"in window?d.addEventListener("pointerdown",this,{signal:o}):d.addEventListener("mousedown",this,{signal:o}),this.host){let g=x=>{x.target===this.host&&this.handleEvent(x)};"PointerEvent"in window?this.host.addEventListener("pointerdown",g,{signal:o}):this.host.addEventListener("mousedown",g,{signal:o})}let p=this.element.querySelector("[part=virtual-keyboard-toggle]");p?.addEventListener("pointerdown",g=>{g.currentTarget===p&&(window.mathVirtualKeyboard.visible?window.mathVirtualKeyboard.hide():(window.mathVirtualKeyboard.show({animate:!0}),window.mathVirtualKeyboard.update(_i(this))),g.preventDefault(),g.stopPropagation())},{signal:o}),this.field.addEventListener("contextmenu",this,{signal:o});let f=this.element.querySelector("[part=menu-toggle]");f?.addEventListener("pointerdown",g=>{if(g.currentTarget!==f)return;let x=this.menu;if(x.state!=="closed")return;this.element.classList.add("tracking");let w=f.getBoundingClientRect();x.modifiers=Lo(g),x.show({target:f,location:{x:w.left,y:w.bottom},onDismiss:()=>this.element.classList.remove("tracking")}),g.preventDefault(),g.stopPropagation()},{signal:o}),(this.disabled||this.readOnly&&!this.hasEditableContent||this.userSelect==="none")&&(f.style.display="none"),this.ariaLiveText=this.element.querySelector("[role=status]"),this.keyboardDelegate=zE(this.element.querySelector(".ML__keyboard-sink"),this.element,this),window.addEventListener("resize",this,{signal:o}),document.addEventListener("scroll",this,{signal:o}),this.resizeObserver=new ResizeObserver(g=>{if(this.resizeObserverStarted){this.resizeObserverStarted=!1;return}this.updateToggleLayout(),vt(this)}),this.resizeObserverStarted=!0,this.resizeObserver.observe(this.field),this.resizeObserver.observe(this.container),setTimeout(()=>this.updateToggleLayout(),100),window.mathVirtualKeyboard.addEventListener("virtual-keyboard-toggle",this,{signal:o}),Pn!=="ready"&&document.fonts.ready.then(()=>kd(this)),e.querySelector("[part=container]").style.removeProperty("visibility"),this.undoManager.startRecording(),this.undoManager.snapshot("set-value"),vt(this)}connectToVirtualKeyboard(){this.connectedToVirtualKeyboard||(this.connectedToVirtualKeyboard=!0,window.addEventListener("message",this,{signal:this.eventController.signal}),window.mathVirtualKeyboard.connect(),window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.update(_i(this)),Gu(this))}disconnectFromVirtualKeyboard(){this.connectedToVirtualKeyboard&&(window.removeEventListener("message",this),window.mathVirtualKeyboard.disconnect(),this.connectedToVirtualKeyboard=!1,Jf())}showMenu(e){var n,r;let i=(r=(n=e?.location)!=null?n:dc(this.field))!=null?r:void 0,o=e?.modifiers,s=this.element.querySelector("[part=container]");return this._menu.show({target:s,location:i,modifiers:o})}get colorMap(){return e=>{var n,r,i;return(i=(r=(n=this.options).colorMap)==null?void 0:r.call(n,e))!=null?i:Ud(e)}}get backgroundColorMap(){return e=>{var n,r,i,o,s,a;return(a=(s=(r=(n=this.options).backgroundColorMap)==null?void 0:r.call(n,e))!=null?s:(o=(i=this.options).colorMap)==null?void 0:o.call(i,e))!=null?a:Um(e)}}get smartFence(){var e;return(e=this.options.smartFence)!=null?e:!1}get readOnly(){var e;return(e=this.options.readOnly)!=null?e:!1}get disabled(){var e,n;return(n=(e=this.host)==null?void 0:e.disabled)!=null?n:!1}get contentEditable(){return this.host?this.host.getAttribute("contenteditable")!=="false":!1}get userSelect(){if(!this.host)return"";let e=getComputedStyle(this.host);return e.getPropertyValue("user-select")||e.getPropertyValue("-webkit-user-select")}get hasEditableContent(){return this.disabled||!this.contentEditable?!1:!this.readOnly||this.hasEditablePrompts}get hasEditablePrompts(){return this.readOnly&&!this.disabled&&this.contentEditable&&this.model.findAtom(e=>e.type==="prompt"&&!e.locked)!==void 0}get isSelectionEditable(){if(this.disabled||!this.contentEditable)return!1;if(!this.readOnly)return!0;let e=this.model.at(this.model.anchor),n=this.model.at(this.model.position),r=G.commonAncestor(e,n);return!!(r?.type==="prompt"||r!=null&&r.parentPrompt)}get letterShapeStyle(){var e;return(e=this.options.letterShapeStyle)!=null?e:"tex"}get minFontScale(){return this.options.minFontScale}get maxMatrixCols(){return this.options.maxMatrixCols}queryStyle(e){let n=Ff(this,e);"verbatimColor"in n&&delete n.verbatimColor,"verbatimBackgroundColor"in n&&delete n.verbatimBackgroundColor;let r=Object.keys(n).length;if(r===0)return"all";if(r>1){for(let u of Object.keys(n)){let c=this.queryStyle({[u]:n[u]});if(c==="none")return"none";if(c==="some")return"some"}return"all"}let i=Object.keys(n)[0],o=n[i];if(this.model.selectionIsCollapsed)return zo(this)[i]===o?"all":"none";let s=this.model.getAtoms(this.model.selection,{includeChildren:!0}),a=s.length;if(a===0)return"none";let l=0;for(let u of s){if(u.type==="first"){a-=1;continue}u.style[i]===o&&(l+=1)}return l===0?"none":l===a?"all":"some"}get keybindings(){var e,n;if(this._keybindings)return this._keybindings;let[r,i]=qE(this.options.keybindings,(e=ml())!=null?e:FM());return((n=ml())==null?void 0:n.score)>0&&(this._keybindings=r,i.length>0&&console.error("MathLive 0.108.2: Invalid keybindings for current keyboard layout",i)),r}get menu(){return this._menu!=null||(this._menu=new Av(rL(this),{host:this.host})),this._menu}set menuItems(e){this._menu?this._menu.menuItems=e:this._menu=new Av(e,{host:this.host})}setOptions(e){var n;this.options=O(O({},this.options),_d(e)),this._keybindings=void 0,this.options.defaultMode==="inline-math"?this.element.classList.add("ML__is-inline"):this.element.classList.remove("ML__is-inline");let r=this.options.defaultMode;r==="inline-math"&&(r="math"),((n=this.model.root.firstChild)==null?void 0:n.mode)!==r&&(this.model.root.firstChild.mode=r),this.options.readOnly&&this.hasFocus()&&window.mathVirtualKeyboard.visible&&this.executeCommand("hideVirtualKeyboard");let i=G.serialize([this.model.root],{expandMacro:!1,defaultMode:this.options.defaultMode});("macros"in e||this.model.getValue()!==i)&&y5(this),("value"in e||"registers"in e||"colorMap"in e||"backgroundColorMap"in e||"letterShapeStyle"in e||"minFontScale"in e||"maxMatrixCols"in e||"readOnly"in e||"contentPlaceholder"in e||"placeholderSymbol"in e)&&vt(this)}getOptions(e){return _o(this.options,e)}getOption(e){return _o(this.options,e)}async handleEvent(e){var n,r,i;if(jr(this)){if(c0(e)){if(!n0(e.origin,(n=this.options.originValidator)!=null?n:"none"))throw new DOMException(`Message from unknown origin (${e.origin}) cannot be handled`,"SecurityError");let{action:o}=e.data;if(o==="execute-command"){let s=kl(e.data.command);if(!s||$s(s)==="virtual-keyboard")return;this.executeCommand(s)}else o==="update-state"||(o==="focus"?this.focus({preventScroll:!0}):o==="blur"&&this.blur());return}switch(e.type){case"focus":this.programmaticFocusInProgress||this.onFocus({suppressEvents:!0});break;case"blur":this.onBlur({dispatchEvents:!1});break;case"mousedown":this.userSelect!=="none"&&!((r=e.target)!=null&&r.closest("[part=virtual-keyboard-toggle],[part=menu-toggle]"))&&vv(this,e);break;case"pointerdown":!e.defaultPrevented&&this.userSelect!=="none"&&!((i=e.target)!=null&&i.closest("[part=virtual-keyboard-toggle],[part=menu-toggle]"))&&(vv(this,e),e.shiftKey===!1&&await Dv(e,this.container,this.menu)&&Cd.stop());break;case"contextmenu":this.userSelect!=="none"&&e.shiftKey===!1&&await Dv(e,this.container,this.menu)&&Cd.stop();break;case"virtual-keyboard-toggle":this.hasFocus()&&Gu(this),this.hasFocus()&&this.options.mathVirtualKeyboardPolicy!=="manual"&&(this.keyboardDelegate.blur(),this.keyboardDelegate.focus());break;case"resize":this.geometryChangeTimer&&cancelAnimationFrame(this.geometryChangeTimer),this.geometryChangeTimer=requestAnimationFrame(()=>jr(this)&&this.onGeometryChange());break;case"scroll":this.geometryChangeTimer&&cancelAnimationFrame(this.geometryChangeTimer),this.geometryChangeTimer=requestAnimationFrame(()=>jr(this)&&this.onGeometryChange());break;case"wheel":this.onWheel(e);break;case"message":break;default:console.warn("Unexpected event type",e.type)}}}updateToggleLayout(){if(!this.element||!this.host)return;let e=this.element.querySelector(".ML__toggles");if(!e)return;let n=this.host.offsetHeight,r=e.classList.contains("ML__toggles--vertical");n>=100&&!r?e.classList.add("ML__toggles--vertical"):n<100&&r&&e.classList.remove("ML__toggles--vertical")}dispose(){if(!jr(this))return;qe.unsubscribe(this._l10Subscription),this.keyboardDelegate.dispose(),this.keyboardDelegate=void 0,this.eventController.abort(),this.eventController=void 0,this.resizeObserver.disconnect(),window.mathVirtualKeyboard.removeEventListener("virtual-keyboard-toggle",this),this.disconnectFromVirtualKeyboard(),this.model.dispose();let e=this.element;delete e.mathfield,this.element=void 0,this.host=void 0,this.field=void 0,this.ariaLiveText=void 0,QA(),GE(),kD()}flushInlineShortcutBuffer(e){if(e!=null||(e={defer:!1}),!e.defer){this.inlineShortcutBuffer.length=0,clearTimeout(this.inlineShortcutBufferFlushTimer),this.inlineShortcutBufferFlushTimer=0;return}this.options.inlineShortcutTimeout>0&&(clearTimeout(this.inlineShortcutBufferFlushTimer),this.inlineShortcutBufferFlushTimer=setTimeout(()=>this.flushInlineShortcutBuffer(),this.options.inlineShortcutTimeout))}executeCommand(e){return $s(e)==="virtual-keyboard"?(this.focus({preventScroll:!0}),window.mathVirtualKeyboard.executeCommand(e),requestAnimationFrame(()=>window.mathVirtualKeyboard.update(_i(this))),!1):nA(this,e)}get errors(){return fE(this.model.getValue(),{context:this.context})}getValue(e,n,r){return this.model.getValue(e,n,r)}setValue(e,n){var r;n=n??{mode:"math"},n.insertionMode===void 0&&(n.insertionMode="replaceAll"),(n.format===void 0||n.format==="auto")&&(n.format="latex"),(n.mode===void 0||n.mode==="auto")&&(n.mode=(r=EC(this.model,this.model.position))!=null?r:"math");let i=this.undoManager.canUndo();lt.insert(this.model,e,n)&&(vt(this),i||this.undoManager.reset(),this.undoManager.snapshot("set-value"))}get expression(){let e=globalThis.MathfieldElement.computeEngine;return e?e.box(e.parse(this.model.getValue("latex-unstyled"))):(console.error("MathLive 0.108.2:  no compute engine available. Make sure the Compute Engine library is loaded."),null)}scrollIntoView(){var e;if(!this.element)return;if(this.host){if(this.options.onScrollIntoView)this.options.onScrollIntoView(this);else if(this.host.scrollIntoView({block:"nearest",inline:"nearest"}),window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.container===window.document.body){let i=window.mathVirtualKeyboard.boundingRect,o=this.host.getBoundingClientRect();o.bottom>i.top&&((e=window.document.scrollingElement)==null||e.scrollBy(0,o.bottom-i.top+8))}}this.dirty&&Fo(this,{interactive:!0});let n=this.field.getBoundingClientRect(),r=null;if(this.model.selectionIsCollapsed)r=dc(this.field);else{let i=vx(this);if(i.length>0){let o=-1/0,s=1/0,a=-1/0;for(let u of i)u.right>o&&(o=u.right),u.top<s&&(s=u.top),u.bottom>a&&(a=u.bottom);let l=a-s;r={x:o+n.left-this.field.scrollLeft,y:s+n.top-this.field.scrollTop,height:l}}}if(this.host&&r){let i=this.host.getBoundingClientRect(),o=20,s=r.y,a=r.y+r.height,l=this.host.scrollTop;s<i.top+o?l=s-i.top+this.host.scrollTop-o:a>i.bottom-o&&(l=a-i.bottom+this.host.scrollTop+o),l!==this.host.scrollTop&&this.host.scroll({top:l,behavior:"auto"})}if(r){let i=r.x-window.scrollX,o=this.field.scrollLeft;i<n.left?o=i-n.left+this.field.scrollLeft-20:i>n.right&&(o=i-n.right+this.field.scrollLeft+20),this.field.scroll({top:this.field.scrollTop,left:o})}}insert(e,n){if(typeof e!="string"||e.length===0&&(n?.insertionMode==="insertBefore"||n?.insertionMode==="insertAfter")||e.length===0&&this.model.selectionIsCollapsed)return!1;if(this.flushInlineShortcutBuffer(),n=n??{mode:"math"},n.focus&&this.focus(),n.feedback&&(globalThis.MathfieldElement.keypressVibration&&G3()&&navigator.vibrate(b5),globalThis.MathfieldElement.playSound("keypress")),e==="\\\\")_5(this.model);else if(e==="&")M5(this.model);else if(this.model.selectionIsCollapsed){let r=O({},zo(this));!/^[a-zA-Z0-9]$/.test(e)&&this.styleBias!=="none"&&(r.variant="normal",r.variantStyle=void 0),lt.insert(this.model,e,O({style:r},n))}else lt.insert(this.model,e,n);return this.snapshot(`insert-${this.model.at(this.model.position).type}`),vt(this),n.scrollIntoView&&this.scrollIntoView(),!0}switchMode(e,n="",r=""){if(this.model.mode===e||!this.hasEditableContent||!this.contentEditable||this.disabled)return;let{model:i}=this,o=i.mode;if(i.mode=e,this.host&&!this.host.dispatchEvent(new Event("mode-change",{bubbles:!0,composed:!0,cancelable:!0}))){i.mode=o;return}i.mode=o,i.deferNotifications({content:!!r||!!n,selection:!0,type:"insertText"},()=>{let s=i.at(i.position),a=(d,p)=>{if(!d)return;let f=i.mode==="math"?wn(yd(d,{format:"ascii-math"})[1],{context:this.context}):[...d].map(g=>new na(g,g,{}));if(p.select){let g=s.parent.addChildrenAfter(f,s);i.setSelection(i.offsetOf(f[0].leftSibling),i.offsetOf(g))}else i.position=i.offsetOf(s.parent.addChildrenAfter(f,s));c=!0},l=(d,p)=>{let f=new Ya(d);s.parent.addChildAfter(f,s),p.select?i.setSelection(i.offsetOf(f.firstChild),i.offsetOf(f.lastChild)):i.position=i.offsetOf(f.lastChild),c=!0},u=()=>{let d=e==="latex"?"latex":e==="math"?"plain-text":"ascii-math",p=en(i.selection),f=this.model.getValue(p,d),g=this.model.extractAtoms(p);return g.length===1&&g[0].type==="placeholder"&&(f=r),s=i.at(p[0]),f},c=!1;if(this.flushInlineShortcutBuffer(),this.stopCoalescingUndo(),Yi(this,"accept"),i.selectionIsCollapsed)a(n,{select:!1}),i.mode=e,e==="latex"?l(r,{select:!1}):a(r,{select:!1});else{let d=u();i.mode=e,e==="latex"?l(d,{select:!0}):a(d,{select:!0})}return vt(this),this.undoManager.snapshot(e==="latex"?"insert-latex":"insert"),c}),i.mode=e,window.mathVirtualKeyboard.update(_i(this))}hasFocus(){return!this.blurred}focus(e){var n;this.disabled||this.focusBlurInProgress||(this.hasFocus()||(this.programmaticFocusInProgress=!0,this.onFocus(),this.model.announce("line")),(n=e?.preventScroll)!=null&&n||this.scrollIntoView())}blur(){this.disconnectFromVirtualKeyboard(),this.hasFocus()&&this.keyboardDelegate.blur()}select(){this.model.selection={ranges:[[0,this.model.lastOffset]]},this.focus()}applyStyle(e,n={}){var r;let i,o="set",s=!1;gd(n)?i=n:(n.operation==="toggle"&&(o="toggle"),i=n.range,s=(r=n.silenceNotifications)!=null?r:!1),i&&(i=this.model.normalizeRange(i)),i&&i[0]===i[1]&&(i=void 0);let a=Ff(this,e);if(i===void 0&&this.model.selectionIsCollapsed){if(o==="set"){let c=O({},this.defaultStyle);"color"in a&&delete c.verbatimColor,"backgroundColor"in a&&delete c.verbatimBackgroundColor,this.defaultStyle=O(O({},c),a),this.styleBias="none";return}let l=zo(this),u=O({},this.defaultStyle);for(let c of Object.keys(a))l[c]===a[c]?(c==="color"&&delete u.verbatimColor,c==="backgroundColor"&&delete u.verbatimBackgroundColor,delete u[c]):u[c]=a[c];this.defaultStyle=u,this.styleBias="none";return}this.model.deferNotifications({content:!s,type:"insertText"},()=>{if(i===void 0)for(let l of this.model.selection.ranges)If(this.model,l,a,{operation:o});else If(this.model,i,a,{operation:o})}),vt(this)}toggleContextMenu(){var e;let n=this.menu;if(!n.visible)return!1;if(n.state==="open")return n.hide(),!0;let r=(e=wx(this,this.model.position))==null?void 0:e.bounds;if(!r)return!1;let i={x:r.right,y:r.bottom};return n.show({target:this.element.querySelector("[part=container]"),location:i,onDismiss:()=>{var o;return(o=this.element)==null?void 0:o.focus()}}),!0}getPrompt(e){return this.model.findAtom(r=>r.type==="prompt"&&r.placeholderId===e)}getPromptValue(e,n){let r=this.getPrompt(e);if(!r)return"";let i=this.model.offsetOf(r.firstChild),o=this.model.offsetOf(r.lastChild);return this.model.getValue(i,o,n)}getPrompts(e){return this.model.atoms.filter(n=>n.type!=="prompt"?!1:e?!(e.id&&n.placeholderId!==e.id||e.locked&&n.locked!==e.locked||e.correctness==="undefined"&&n.correctness||e.correctness&&n.correctness!==e.correctness):!0).map(n=>n.placeholderId)}setPromptValue(e,n,r){if(n!==void 0){let i=this.getPrompt(e);if(!i){console.error(`MathLive 0.108.2: unknown prompt ${e}`);return}let o=this.model.getBranchRange(this.model.offsetOf(i),"body");this.model.setSelection(o),this.insert(n,V(O({},r),{insertionMode:"replaceSelection"}))}r!=null&&r.silenceNotifications&&(this.valueOnFocus=this.getValue()),vt(this)}setPromptState(e,n,r){let i=this.getPrompt(e);if(!i){console.error(`MathLive 0.108.2: unknown prompt ${e}`);return}n==="undefined"?i.correctness=void 0:typeof n=="string"&&(i.correctness=n),typeof r=="boolean"&&(i.locked=r,i.captureSelection=r),vt(this)}getPromptState(e){let n=this.getPrompt(e);return n?[n.correctness,n.locked]:(console.error(`MathLive 0.108.2: unknown prompt ${e}`),[void 0,!0])}getPromptRange(e){let n=this.getPrompt(e);return n?this.model.getBranchRange(this.model.offsetOf(n),"body"):(console.error(`MathLive 0.108.2: unknown prompt ${e}`),[0,0])}canUndo(){return this.undoManager.canUndo()}canRedo(){return this.undoManager.canRedo()}popUndoStack(){this.undoManager.pop(),window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.update(_i(this))}snapshot(e){var n;this.undoManager.snapshot(e)&&(window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.update(_i(this)),(n=this.host)==null||n.dispatchEvent(new CustomEvent("undo-state-change",{bubbles:!0,composed:!0,detail:{type:"snapshot"}})))}stopCoalescingUndo(){this.undoManager.stopCoalescing(this.model.selection)}stopRecording(){this.undoManager.stopRecording()}startRecording(){this.undoManager.startRecording()}undo(){var e;this.undoManager.undo()&&((e=this.host)==null||e.dispatchEvent(new CustomEvent("undo-state-change",{bubbles:!0,composed:!0,detail:{type:"undo"}})))}redo(){var e;this.undoManager.redo()&&((e=this.host)==null||e.dispatchEvent(new CustomEvent("undo-state-change",{bubbles:!0,composed:!0,detail:{type:"redo"}})))}resetUndo(){var e;(e=this.undoManager)==null||e.reset()}onSelectionDidChange(){var e,n;let r=this.model;if(r.mathfield.hasFocus()&&this.keyboardDelegate.setValue(r.getValue(r.selection,"latex-expanded")),r.selectionIsCollapsed){let i=a0(r),o=r.position,s=r.at(o),a=(e=s.mode)!=null?e:dv(this.options);if(i&&(o<r.offsetOf(i.firstChild)-1||o>r.offsetOf(i.lastChild)+1))Yi(this,"accept",{mode:a}),r.position=r.offsetOf(s);else{let l=r.at(o+1);l?.type==="first"&&l.mode==="latex"?r.position=o+1:i&&l?.mode!=="latex"?r.position=o-1:this.switchMode(a)}}(n=this.host)==null||n.dispatchEvent(new Event("selection-change",{bubbles:!0,composed:!0})),window.mathVirtualKeyboard.visible&&window.mathVirtualKeyboard.update(_i(this)),Gu(this)}onContentWillChange(e){var n,r,i;return(i=(r=this.host)==null?void 0:r.dispatchEvent(new InputEvent("beforeinput",V(O({},e),{data:e.data?e.data:(n=e.inputType)!=null?n:"",cancelable:!0,bubbles:!0,composed:!0}))))!=null?i:!0}onFocus(e){if(this.disabled||this.focusBlurInProgress||!this.blurred)return;let n=$a._globallyFocusedMathfield;n&&n!==this&&!n.disabled&&n.hasFocus()&&n.onBlur({dispatchEvents:!0}),this.focusBlurInProgress=!0,this.blurred=!1,$a._globallyFocusedMathfield=this,this.stopCoalescingUndo(),this.valueOnFocus=this.model.getValue(),this.hasEditablePrompts&&!this.model.at(this.model.anchor).parentPrompt&&this.executeCommand("moveToNextPlaceholder"),Fo(this,{interactive:!0}),setTimeout(()=>{var r,i;if(jr(this))if((r=e?.suppressEvents)!=null&&r){let o=new AbortController,s=o.signal,a=l=>{l.preventDefault(),l.stopPropagation()};for(let l of["focus","focusin"])(i=this.host)==null||i.addEventListener(l,a,{capture:!0,signal:s});this.focusBlurInProgress=!1,this.keyboardDelegate.focus(),this.connectToVirtualKeyboard(),setTimeout(()=>o.abort(),0)}else this.focusBlurInProgress=!1,this.keyboardDelegate.focus(),this.connectToVirtualKeyboard(),setTimeout(()=>{this.programmaticFocusInProgress=!1},0)},60)}onBlur(e){var n,r,i,o;if(!(this.focusBlurInProgress||this.blurred)&&(this.focusBlurInProgress=!0,this.stopCoalescingUndo(),this.blurred=!0,$a._globallyFocusedMathfield===this&&($a._globallyFocusedMathfield=void 0),this.ariaLiveText.textContent="",Qs(this),this.model.getValue()!==this.valueOnFocus&&((n=this.host)==null||n.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))),this.disconnectFromVirtualKeyboard(),((r=e?.dispatchEvents)==null||r)&&((i=this.host)==null||i.dispatchEvent(new Event("blur",{bubbles:!1,composed:!0})),(o=this.host)==null||o.dispatchEvent(new UIEvent("focusout",{bubbles:!0,composed:!0}))),vt(this),this.focusBlurInProgress=!1,Jf(),p0.restoreFocusWhenDocumentFocused)){let s=new AbortController,a=s.signal;window.addEventListener("blur",()=>{window.addEventListener("focus",()=>{jr(this)&&this.focus({preventScroll:!0})},{once:!0,signal:a})},{once:!0,signal:a}),document.addEventListener("focusin",()=>s.abort(),{once:!0}),document.addEventListener("click",()=>s.abort(),{once:!0})}}onInput(e){Vf(this,e)}onKeystroke(e){return O5(this,e)}onCompositionStart(e){Gr(this.model,en(this.model.selection),"insertText");let n=dc(this.field);n&&requestAnimationFrame(()=>{Fo(this),this.keyboardDelegate.moveTo(n.x,n.y-n.height)})}onCompositionUpdate(e){DA(this.model,e),vt(this)}onCompositionEnd(e){LA(this.model),Vf(this,e,{simulateKeystroke:!0})}onCut(e){if(!this.isSelectionEditable){this.model.announce("plonk");return}this.model.contentWillChange({inputType:"deleteByCut"})&&(this.stopCoalescingUndo(),e.clipboardData?lt.onCopy(this,e):lt.copyToClipboard(this,"latex"),Gr(this.model,en(this.model.selection),"deleteByCut"),this.snapshot("cut"),vt(this))}onCopy(e){e.clipboardData?lt.onCopy(this,e):lt.copyToClipboard(this,"latex")}onPaste(e){let n=this.isSelectionEditable;return n&&(n=lt.onPaste(this.model.at(this.model.position).mode,this,e.clipboardData)),n||this.model.announce("plonk"),e.preventDefault(),e.stopPropagation(),n}onGeometryChange(){var e;(e=this._menu)==null||e.hide(),ih(this),Gu(this)}onWheel(e){let n=5*e.deltaX;if(!Number.isFinite(n)||n===0)return;let r=this.field;n<0&&r.scrollLeft===0||n>0&&r.offsetWidth+r.scrollLeft>=r.scrollWidth||(r.scrollBy({top:0,left:n}),e.preventDefault(),e.stopPropagation())}getHTMLElement(e){let n=e;for(;!n.id&&n.hasChildren;)n=e.children[0];return this.field.querySelector(`[data-atom-id="${n.id}"]`)}get context(){var e,n;return{registers:(e=this.options.registers)!=null?e:{},smartFence:this.smartFence,letterShapeStyle:this.letterShapeStyle,minFontScale:this.minFontScale,maxMatrixCols:this.maxMatrixCols,placeholderSymbol:(n=this.options.placeholderSymbol)!=null?n:"",colorMap:r=>this.colorMap(r),backgroundColorMap:r=>this.backgroundColorMap(r),getMacro:r=>Ym(r,this.options.macros),atomIdsSettings:{seed:"random",groupNumbers:!1}}}};ln({speak:(t,e,n)=>xL(t,e,n)},{target:"mathfield"});function xL(t,e,n){var r;n=n??{withHighlighting:!1};let{model:i}=t;function o(c){let d=null;switch(c){case"all":d=i.root;break;case"selection":d=i.getAtoms(i.selection);break;case"left":{d=i.getAtoms(i.offsetOf(i.at(i.position).leftSibling),i.position);break}case"right":{d=i.getAtoms(i.position,i.offsetOf(i.at(i.position).rightSibling));break}case"group":d=i.getAtoms(i.getSiblingsRange(i.position));break;case"parent":{let{parent:p}=i.at(i.position);p!=null&&p.parent?d=p:d=i.root;break}default:d=i.root}return d}function s(c){let d="";switch(c){case"all":console.error("Internal failure: speak all failed");break;case"selection":d="no selection";break;case"left":d="at start";break;case"right":d="at end";break;case"group":console.error("Internal failure: speak group failed");break;case"parent":d="no parent";break;default:console.error('unknown speak_ param value: "'+c+'"');break}return d}let a=globalThis.MathfieldElement,l=o(e);if(l===null)return(r=a.speakHook)==null||r.call(a,s(e)),!1;(n.withHighlighting||a.speechEngine==="amazon")&&(a.textToSpeechMarkup=globalThis.sre&&a.textToSpeechRules==="sre"?"ssml_step":"ssml");let u=Ko(l);return Xn()&&n.withHighlighting?(Ci().readAloudMathfield=t,Fo(t,{forHighlighting:!0}),a.readAloudHook&&a.readAloudHook(t.field,u)):a.speakHook&&a.speakHook(u),!1}function wL(t){var e,n;if(!Xn())return;let r=globalThis.MathfieldElement;if(!r.speechEngine||r.speechEngine==="local"){let i=new SpeechSynthesisUtterance(t);globalThis.speechSynthesis.speak(i)}else if(r.speechEngine==="amazon")if(!("AWS"in window))console.error("MathLive 0.108.2: AWS SDK not loaded. See https://www.npmjs.com/package/aws-sdk");else{let i=new globalThis.AWS.Polly({apiVersion:"2016-06-10"}),o={OutputFormat:"mp3",VoiceId:(e=r.speechEngineVoice)!=null?e:"Joanna",Engine:["Amy","Emma","Brian","Ivy","Joanna","Kendra","Kimberly","Salli","Joey","Justin","Matthew"].includes((n=r.speechEngineVoice)!=null?n:"Joanna")?"neural":"standard",Text:t,TextType:"ssml"};i.synthesizeSpeech(o,(s,a)=>{if(s)console.trace(`MathLive 0.108.2: \`polly.synthesizeSpeech()\` error: ${s}`);else if(a!=null&&a.AudioStream){let l=new Uint8Array(a.AudioStream),u=new Blob([l.buffer],{type:"audio/mpeg"}),c=URL.createObjectURL(u);new Audio(c).play().catch(d=>console.error(d))}})}else r.speechEngine==="google"&&console.error("MathLive 0.108.2: The Google speech engine is not supported yet. Please come again.")}function G5(t){if(t&&(t.classList.remove("ML__highlight"),t.children))for(let e of t.children)G5(e)}function tm(t,e){var n;t&&(!e||((n=t.dataset)==null?void 0:n.atomId)===e?(t.classList.add("ML__highlight"),t.children&&t.children.length>0&&[...t.children].forEach(r=>{r instanceof HTMLElement&&tm(r)})):(t.classList.remove("ML__highlight"),t.children&&t.children.length>0&&[...t.children].forEach(r=>{r instanceof HTMLElement&&tm(r,e)})))}function kL(t,e){var n;if(!Xn())return;if(globalThis.MathfieldElement.speechEngine!=="amazon"){console.error("MathLive 0.108.2: Use Amazon TTS Engine for synchronized highlighting"),typeof globalThis.MathfieldElement.speakHook=="function"&&globalThis.MathfieldElement.speakHook(e);return}if(!globalThis.AWS){console.error("MathLive 0.108.2: AWS SDK not loaded. See https://www.npmjs.com/package/aws-sdk");return}let r=new globalThis.AWS.Polly({apiVersion:"2016-06-10"}),i={OutputFormat:"json",VoiceId:(n=globalThis.MathfieldElement.speechEngineVoice)!=null?n:"Joanna",Engine:"standard",Text:e,TextType:"ssml",SpeechMarkTypes:["ssml"]};Ci().readAloudElement=t,r.synthesizeSpeech(i,(o,s)=>{if(o){console.trace(`MathLive 0.108.2: \`polly.synthesizeSpeech()\` error: ${o}`);return}if(!(s!=null&&s.AudioStream))return;let a=new TextDecoder("utf-8").decode(new Uint8Array(s.AudioStream));Ci().readAloudMarks=a.split(`
`).map(l=>l?JSON.parse(l):{}),Ci().readAloudTokens=[];for(let l of Ci().readAloudMarks)l.value&&Ci().readAloudTokens.push(l.value);Ci().readAloudCurrentMark="",i.OutputFormat="mp3",i.SpeechMarkTypes=[],r.synthesizeSpeech(i,(l,u)=>{if(l){console.trace(`MathLive 0.108.2: \`polly.synthesizeSpeech("${e}") error:${l}`);return}if(!(u!=null&&u.AudioStream))return;let c=new Uint8Array(u.AudioStream),d=new Blob([c.buffer],{type:"audio/mpeg"}),p=URL.createObjectURL(d),f=Ci();f.readAloudAudio?f.readAloudAudio.pause():(f.readAloudAudio=new Audio,f.readAloudAudio.addEventListener("ended",()=>{let g=f.readAloudMathfield;f.readAloudStatus="ended",document.body.dispatchEvent(new Event("read-aloud-status-change",{bubbles:!0,composed:!0})),g?(Fo(g),f.readAloudElement=null,f.readAloudMathfield=null,f.readAloudTokens=[],f.readAloudMarks=[],f.readAloudCurrentMark=""):G5(f.readAloudElement)}),f.readAloudAudio.addEventListener("timeupdate",()=>{let g="",x=f.readAloudAudio.currentTime*1e3+100;for(let w of f.readAloudMarks)w.time<x&&(g=w.value);f.readAloudCurrentMark!==g&&(f.readAloudCurrentToken=g,g&&g===f.readAloudFinalToken?f.readAloudAudio.pause():(f.readAloudCurrentMark=g,tm(f.readAloudElement,f.readAloudCurrentMark)))})),f.readAloudAudio.src=p,f.readAloudStatus="playing",document.body.dispatchEvent(new Event("read-aloud-status-change",{bubbles:!0,composed:!0})),f.readAloudAudio.play()})})}Xn()||console.error('MathLive 0.108.2: this version of the MathLive library is for use in the browser. A subset of the API is available on the server side in the "mathlive-ssr" library. If using server side rendering (with React for example) you may want to do a dynamic import of the MathLive library inside a `useEffect()` call.');var it=new WeakMap,SL=.5,xi={letterShapeStyle:"mf.letterShapeStyle = ...",horizontalSpacingScale:'Removed. Use `"thinmuskip"`, `"medmuskip"`, and `"thickmuskip"` registers ',macros:"mf.macros = ...",registers:"mf.registers = ...",backgroundColorMap:"mf.backgroundColorMap = ...",colorMap:"mf.colorMap = ...",enablePopover:"mf.popoverPolicy = ...",mathModeSpace:"mf.mathModeSpace = ...",placeholderSymbol:"mf.placeholderSymbol = ...",readOnly:"mf.readOnly = ...",removeExtraneousParentheses:"mf.removeExtraneousParentheses = ...",scriptDepth:"mf.scriptDepth = ...",smartFence:"mf.smartFence = ...",smartMode:"mf.smartMode = ...",smartSuperscript:"mf.smartSuperscript = ...",inlineShortcutTimeout:"mf.inlineShortcutTimeout = ...",inlineShortcuts:"mf.inlineShortcuts = ...",keybindings:"mf.keybindings = ...",virtualKeyboardMode:"mf.mathVirtualKeyboardPolicy = ...",customVirtualKeyboardLayers:"mathVirtualKeyboard.layers = ...",customVirtualKeyboards:"mathVirtualKeyboard.layouts = ...",keypressSound:"mathVirtualKeyboard.keypressSound = ...",keypressVibration:"mathVirtualKeyboard.keypressVibration = ...",plonkSound:"mathVirtualKeyboard.plonkSound = ...",virtualKeyboardContainer:"mathVirtualKeyboard.container = ...",virtualKeyboardLayout:"mathVirtualKeyboard.alphabeticLayout = ...",virtualKeyboardTheme:"No longer supported",virtualKeyboardToggleGlyph:"No longer supported",virtualKeyboardToolbar:"mathVirtualKeyboard.editToolbar = ...",virtualKeyboards:"Use `mathVirtualKeyboard.layouts`",speechEngine:"`MathfieldElement.speechEngine`",speechEngineRate:"`MathfieldElement.speechEngineRate`",speechEngineVoice:"`MathfieldElement.speechEngineVoice`",textToSpeechMarkup:"`MathfieldElement.textToSpeechMarkup`",textToSpeechRules:"`MathfieldElement.textToSpeechRules`",textToSpeechRulesOptions:"`MathfieldElement.textToSpeechRulesOptions`",readAloudHook:"`MathfieldElement.readAloudHook`",speakHook:"`MathfieldElement.speakHook`",computeEngine:"`MathfieldElement.computeEngine`",fontsDirectory:"`MathfieldElement.fontsDirectory`",soundsDirectory:"`MathfieldElement.soundsDirectory`",createHTML:"`MathfieldElement.createHTML`",onExport:"`mf.onExport`",onInlineShortcut:"`mf.onInlineShortcut`",onScrollIntoView:"`mf.onScrollIntoView`",locale:"MathfieldElement.locale = ...",strings:"MathfieldElement.strings = ...",decimalSeparator:"MathfieldElement.decimalSeparator = ...",fractionNavigationOrder:"MathfieldElement.fractionNavigationOrder = ..."},Lt=class Mi extends HTMLElement{constructor(e){if(super(),this._observer=null,e){let n=[];for(let r of Object.keys(e))if(xi[r])if(xi[r].startsWith("mf."))if(xi[r].startsWith(`mf.${r}`))n.push(`Option \`${r}\` cannot be used as a constructor option. Use ${xi[r]}`);else{let i=xi[r].match(/([a-zA-Z]+) =/);n.push(`Option \`${r}\` has been renamed \`${i[1]}\``)}else n.push(`Option \`${r}\` cannot be used as a constructor option. Use ${xi[r]}`);if(n.length>0){console.group("%cMathLive 0.108.2: %cInvalid Options","color:#12b; font-size: 1.1rem","color:#db1111; font-size: 1.1rem"),console.warn("Some of the options passed to `new MathfieldElement(...)` are invalid. \n          See mathfield/changelog/ for details.");for(let r of n)console.warn(r);console.groupEnd()}}if(ks()&&(this._internals=this.attachInternals(),this._internals.role="math",this._internals.ariaLabel="math input field",this._internals.ariaMultiLine="false"),this.attachShadow({mode:"open",delegatesFocus:!0}),this.shadowRoot&&"adoptedStyleSheets"in this.shadowRoot){this.shadowRoot.adoptedStyleSheets=[So("core"),So("mathfield"),So("mathfield-element"),So("ui"),So("menu")],this.shadowRoot.appendChild(document.createElement("span"));let n=document.createElement("slot");n.style.display="none",this.shadowRoot.appendChild(n)}else this.shadowRoot.innerHTML="<style>"+Oi("core")+Oi("mathfield")+Oi("mathfield-element")+Oi("ui")+Oi("menu")+'</style><span></span><slot style="display:none"></slot>';e&&this._setOptions(e)}static get formAssociated(){return ks()}static get optionsAttributes(){return{"default-mode":"string","letter-shape-style":"string","min-font-scale":"number","max-matrix-cols":"number","popover-policy":"string","math-mode-space":"string","read-only":"boolean","remove-extraneous-parentheses":"on/off","smart-fence":"on/off","smart-mode":"on/off","smart-superscript":"on/off","inline-shortcut-timeout":"string","script-depth":"string",placeholder:"string","virtual-keyboard-target-origin":"string","math-virtual-keyboard-policy":"string"}}static get observedAttributes(){return[...Object.keys(this.optionsAttributes),"contenteditable","disabled","readonly","read-only"]}static get fontsDirectory(){return this._fontsDirectory}static set fontsDirectory(e){e!==this._fontsDirectory&&(this._fontsDirectory=e,ZE())}get fontsDirectory(){throw new Error("Use MathfieldElement.fontsDirectory instead")}set fontsDirectory(e){throw new Error("Use MathfieldElement.fontsDirectory instead")}static get soundsDirectory(){return this._soundsDirectory}static set soundsDirectory(e){this._soundsDirectory=e,this.audioBuffers={}}get soundsDirectory(){throw new Error("Use MathfieldElement.soundsDirectory instead")}set soundsDirectory(e){throw new Error("Use MathfieldElement.soundsDirectory instead")}static get keypressSound(){return this._keypressSound}static set keypressSound(e){var n,r,i;this.audioBuffers={},e===null?this._keypressSound={spacebar:null,return:null,delete:null,default:null}:typeof e=="string"?this._keypressSound={spacebar:e,return:e,delete:e,default:e}:typeof e=="object"&&"default"in e&&(this._keypressSound={spacebar:(n=e.spacebar)!=null?n:e.default,return:(r=e.return)!=null?r:e.default,delete:(i=e.delete)!=null?i:e.default,default:e.default})}static get plonkSound(){return this._plonkSound}static set plonkSound(e){this.audioBuffers={},this._plonkSound=e}static get audioContext(){return this._audioContext||(this._audioContext=new AudioContext),this._audioContext}static get speechEngine(){return this._speechEngine}static set speechEngine(e){this._speechEngine=e}static get speechEngineRate(){return this._speechEngineRate}static set speechEngineRate(e){this._speechEngineRate=e}static get speechEngineVoice(){return this._speechEngineVoice}static set speechEngineVoice(e){this._speechEngineVoice=e}static get textToSpeechMarkup(){return this._textToSpeechMarkup}static set textToSpeechMarkup(e){this._textToSpeechMarkup=e}static get textToSpeechRules(){return this._textToSpeechRules}static set textToSpeechRules(e){this._textToSpeechRules=e}static get textToSpeechRulesOptions(){return this._textToSpeechRulesOptions}static set textToSpeechRulesOptions(e){this._textToSpeechRulesOptions=e}static get locale(){return qe.locale}static set locale(e){e==="auto"&&(e=navigator.language.slice(0,5)),qe.locale=e}get locale(){throw new Error("Use MathfieldElement.locale instead")}set locale(e){throw new Error("Use MathfieldElement.locale instead")}static get strings(){return qe.strings}static set strings(e){qe.merge(e)}get strings(){throw new Error("Use MathfieldElement.strings instead")}set strings(e){throw new Error("Use MathfieldElement.strings instead")}static get decimalSeparator(){return this._decimalSeparator}static set decimalSeparator(e){this._decimalSeparator=e,this._computeEngine&&(this._computeEngine.decimalSeparator=this.decimalSeparator===","?"{,}":".")}get decimalSeparator(){throw new Error("Use MathfieldElement.decimalSeparator instead")}set decimalSeparator(e){throw new Error("Use MathfieldElement.decimalSeparator instead")}static set scientificNotationTemplate(e){this._scientificNotationTemplate=e}static get scientificNotationTemplate(){return this._scientificNotationTemplate}static get fractionNavigationOrder(){return hc.fractionNavigationOrder}static set fractionNavigationOrder(e){if(e!=="numerator-denominator"&&e!=="denominator-numerator")throw new Error("Invalid value");hc.fractionNavigationOrder!==e&&(hc.fractionNavigationOrder=e,uv())}static get computeEngine(){var e,n;if(this._computeEngine===void 0){let r=(e=window[Symbol.for("io.cortexjs.compute-engine")])==null?void 0:e.ComputeEngine;if(!r)return null;this._computeEngine=new r,this._computeEngine&&this.decimalSeparator===","&&(this._computeEngine.decimalSeparator="{,}")}return(n=this._computeEngine)!=null?n:null}static set computeEngine(e){this._computeEngine=e}get computeEngine(){throw new Error("Use MathfieldElement.computeEngine instead")}set computeEngine(e){throw new Error("Use MathfieldElement.computeEngine instead")}static get isFunction(){return typeof this._isFunction!="function"?()=>!1:this._isFunction}static set isFunction(e){this._isFunction=e,uv()}static async loadSound(e){delete this.audioBuffers[e];let n="";switch(e){case"keypress":n=this._keypressSound.default;break;case"return":n=this._keypressSound.return;break;case"spacebar":n=this._keypressSound.spacebar;break;case"delete":n=this._keypressSound.delete;break;case"plonk":n=this.plonkSound;break}if(typeof n!="string")return;n=n.trim();let r=this.soundsDirectory;if(!(r==null||r==="null"||n==="none"||n==="null"))try{let i=await(await fetch(await m5(`${r}/${n}`))).arrayBuffer(),o=await this.audioContext.decodeAudioData(i);this.audioBuffers[e]=o}catch{}}static async playSound(e){if((this.audioContext.state==="suspended"||this.audioContext.state==="interrupted")&&await this.audioContext.resume(),this.audioBuffers[e]||await this.loadSound(e),!this.audioBuffers[e])return;let n=this.audioContext.createBufferSource();n.buffer=this.audioBuffers[e];let r=this.audioContext.createGain();r.gain.value=SL,n.connect(r).connect(this.audioContext.destination),n.start()}showMenu(e){var n,r;return(r=(n=this._mathfield)==null?void 0:n.showMenu(e))!=null?r:!1}get mathVirtualKeyboard(){throw new Error("The `mathVirtualKeyboard` property is not available on the MathfieldElement. Use `window.mathVirtualKeyboard` instead.")}onPointerDown(){window.addEventListener("pointerup",e=>{let n=this._mathfield;if(n&&e.target===this&&!n.disabled){this.dispatchEvent(new MouseEvent("click",{altKey:e.altKey,button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,relatedTarget:e.relatedTarget,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey}));let r=this.getOffsetFromPoint(e.clientX,e.clientY);r>=0&&Mi.openUrl(FC(n,r)),e.pointerType==="touch"&&this.selectionIsCollapsed&&(this.position=r)}},{once:!0})}getPromptValue(e,n){var r,i;return(i=(r=this._mathfield)==null?void 0:r.getPromptValue(e,n))!=null?i:""}setPromptValue(e,n,r){var i;(i=this._mathfield)==null||i.setPromptValue(e,n,r)}getPromptRange(e){var n,r;return(r=(n=this._mathfield)==null?void 0:n.getPromptRange(e))!=null?r:null}getPrompts(e){var n,r;return(r=(n=this._mathfield)==null?void 0:n.getPrompts(e))!=null?r:[]}get hasEditableContent(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.hasEditableContent)!=null?n:!1}get form(){var e;return(e=this._internals)==null?void 0:e.form}get name(){var e;return(e=this.getAttribute("name"))!=null?e:""}get type(){return this.localName}get mode(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.model.mode)!=null?n:this.defaultMode==="text"?"text":"math"}set mode(e){var n;(n=this._mathfield)==null||n.switchMode(e)}get expression(){if(this._mathfield)return window[Symbol.for("io.cortexjs.compute-engine")]?this._mathfield.expression:(console.error(`MathLive 0.108.2: The CortexJS Compute Engine library is not available.
        
        Load the library, for example with:
        
        import "https://esm.run/@cortex-js/compute-engine"`),null)}set expression(e){var n,r;if(!this._mathfield)return;let i=(r=(n=Mi.computeEngine)==null?void 0:n.box(e).latex)!=null?r:null;i!==null&&this._mathfield.setValue(i),window[Symbol.for("io.cortexjs.compute-engine")]||console.error(`MathLive 0.108.2: The Compute Engine library is not available.
        
        Load the library, for example with:
        
        import "https://esm.run/@cortex-js/compute-engine"`)}get errors(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.errors)!=null?n:[]}_getOptions(e){return this._mathfield?_o(this._mathfield.options,e):it.has(this)?O({},_o(O(O({},mc()),_d(it.get(this).options)),e)):null}getOptions(e){return console.warn("%cMathLive 0.108.2: %cDeprecated Usage%c\n      `mf.getOptions()` is deprecated. Read the property directly on the mathfield instead.\n      See mathfield/changelog/ for details.","color:#12b; font-size: 1.1rem","color:#db1111; font-size: 1.1rem","color: inherit, font-size: 1rem"),this._mathfield?_o(this._mathfield.options,e):it.has(this)?_o(O(O({},mc()),_d(it.get(this).options)),e):null}reflectAttributes(){let e=mc(),n=this._getOptions();Object.keys(Mi.optionsAttributes).forEach(r=>{let i=r==="placeholder"?"contentPlaceholder":qr(r);Mi.optionsAttributes[r]==="on/off"?e[i]!==n[i]?this.setAttribute(r,n[i]?"on":"off"):this.removeAttribute(r):e[i]!==n[i]&&(Mi.optionsAttributes[r]==="boolean"?n[i]?this.setAttribute(r,""):this.removeAttribute(r):(typeof n[i]=="string"||typeof n[i]=="number")&&this.setAttribute(r,n[i].toString()))})}getOption(e){return console.warn("%cMathLive 0.108.2: %cDeprecated Usage%c\n      `mf.getOption()` is deprecated. Read the property directly on the mathfield instead.\n      See mathfield/changelog/ for details.","color:#12b; font-size: 1.1rem","color:#db1111; font-size: 1.1rem","color: inherit, font-size: 1rem"),this._getOptions([e])[e]}_getOption(e){return this._getOptions([e])[e]}_setOptions(e){if(this._mathfield)this._mathfield.setOptions(e);else if(it.has(this)){let n=O(O({},it.get(this).options),e);it.set(this,V(O({},it.get(this)),{selection:{ranges:n.readOnly?[[0,0]]:[[0,-1]]},options:n}))}else it.set(this,{value:void 0,selection:{ranges:[[0,0]]},options:e,menuItems:void 0});this.reflectAttributes()}setOptions(e){console.group("%cMathLive 0.108.2: %cDeprecated Usage","color:#12b; font-size: 1.1rem","color:#db1111; font-size: 1.1rem"),console.warn(" `mf.setOptions()` is deprecated. Set the property directly on the mathfield instead.\n      See mathfield/changelog/ for details.");for(let n of Object.keys(e))xi[n]&&console.warn(`\`mf.setOptions({${n}:...})\` -> ${xi[n]}`);console.groupEnd(),this._setOptions(e)}executeCommand(...e){var n,r;let i;if(e.length===1?i=e[0]:i=[e[0],...e.slice(1)],i)return(r=(n=this._mathfield)==null?void 0:n.executeCommand(i))!=null?r:!1;throw new Error("Invalid selector")}getValue(e,n,r){var i,o;if(this._mathfield)return this._mathfield.model.getValue(e,n,r);if(it.has(this)){let s,a,l;if(uc(e)?([s,a]=e.ranges[0],l=n):gd(e)?([s,a]=e,l=n):Li(e)&&Li(n)?(s=e,a=n,l=r):(s=0,a=-1,l=e),(l===void 0||l==="latex")&&s===0&&a===-1)return(o=(i=it.get(this).value)!=null?i:this.textContent)!=null?o:""}return""}setValue(e,n){if(this._mathfield&&e!==void 0){if(this._mathfield.model.getValue()===e)return;n!=null||(n={silenceNotifications:!0,mode:"math"}),this._mathfield.setValue(e,n);return}if(it.has(this)){let i=it.get(this).options;it.set(this,{value:e,selection:{ranges:[[-1,-1]],direction:"forward"},options:i,menuItems:void 0});return}let r=Qu(this);it.set(this,{value:e,selection:{ranges:[[-1,-1]],direction:"forward"},options:r,menuItems:void 0})}hasFocus(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.hasFocus())!=null?n:!1}focus(){var e;this.disabled||(e=this._mathfield)==null||e.focus()}blur(){var e;(e=this._mathfield)==null||e.blur()}select(){var e;(e=this._mathfield)==null||e.select()}insert(e,n){var r,i;return(i=(r=this._mathfield)==null?void 0:r.insert(e,n))!=null?i:!1}applyStyle(e,n){var r;return(r=this._mathfield)==null?void 0:r.applyStyle(e,n)}queryStyle(e){var n,r;return(r=(n=this._mathfield)==null?void 0:n.queryStyle(e))!=null?r:"none"}getOffsetFromPoint(e,n,r){return this._mathfield?yc(this._mathfield,e,n,r):-1}getElementInfo(e){return wx(this._mathfield,e)}resetUndo(){var e;(e=this._mathfield)==null||e.resetUndo()}canUndo(){return this._mathfield?this._mathfield.canUndo():!1}canRedo(){return this._mathfield?this._mathfield.canRedo():!1}handleEvent(e){var n,r,i,o,s;if(sr.state!=="closed"||((r=(n=this._mathfield)==null?void 0:n.menu)==null?void 0:r.state)!=="closed"||(e.type==="pointerdown"&&this.onPointerDown(),e.type==="focus")||e.type!=="blur")return;let a=J3();a&&(i=window?.mathVirtualKeyboard)!=null&&i.visible||((o=sr.scrim)==null?void 0:o.state)!=="closed"||a&&SM()||(s=this._mathfield)==null||s.onBlur({dispatchEvents:!1})}connectedCallback(){var e,n,r,i;let o=this.shadowRoot,s=o.host,a=window.getComputedStyle(this).userSelect!=="none";if(a)s.addEventListener("pointerdown",this,!0);else{let c=o.querySelector("span");c.style.pointerEvents="none"}s.addEventListener("focus",this,!0),s.addEventListener("blur",this,!0),this._observer=new MutationObserver(()=>{var c;this.value=(c=this.textContent)!=null?c:""}),this._observer.observe(this,{childList:!0,characterData:!0,subtree:!0}),ks()||(this.hasAttribute("role")||this.setAttribute("role","math"),this.hasAttribute("aria-label")||this.setAttribute("aria-label","math input field"),this.setAttribute("aria-multiline","false")),a&&!this.hasAttribute("contenteditable")&&this.setAttribute("contenteditable","true"),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0");let l=o.querySelector("slot:not([name])");if(l)try{this._style=l.assignedElements().filter(c=>c.tagName.toLowerCase()==="style").map(c=>c.textContent).join("")}catch(c){console.error(c)}if(this._style){let c=document.createElement("style");c.textContent=this._style,o.appendChild(c)}let u="";if(this.hasAttribute("value")?u=this.getAttribute("value"):u=(e=l?.assignedNodes().map(c=>c.nodeType===3?c.textContent:"").join("").trim())!=null?e:"",this._mathfield=new vL(o.querySelector(":host > span"),V(O({},(r=(n=it.get(this))==null?void 0:n.options)!=null?r:Qu(this)),{eventSink:this,value:u})),!it.has(this)){this.upgradeProperty("disabled"),this.upgradeProperty("readonly");for(let c of Object.keys(Mi.optionsAttributes))this.upgradeProperty(qr(c))}if(!((i=this._mathfield)!=null&&i.model)){this._mathfield=null;return}if(it.has(this)){let c=this._mathfield,d=it.get(this),p=d.menuItems;c.model.deferNotifications({content:!1,selection:!1},()=>{let f=d.value;f!==void 0&&c.setValue(f),c.model.selection=d.selection,it.delete(this)}),p&&(this.menuItems=p)}window.queueMicrotask(()=>{this.isConnected&&this.dispatchEvent(new Event("mount",{cancelable:!1,bubbles:!0,composed:!0}))}),oh()}disconnectedCallback(){var e,n,r;if(this.shadowRoot.host.removeEventListener("pointerdown",this,!0),!this._mathfield)return;(e=this._observer)==null||e.disconnect(),this._observer=null,window.queueMicrotask(()=>this.dispatchEvent(new Event("unmount",{cancelable:!1,bubbles:!0,composed:!0})));let i=_o(this._mathfield.options,Object.keys(Mi.optionsAttributes).map(o=>qr(o)));it.set(this,{value:this._mathfield.getValue(),selection:this._mathfield.model.selection,menuItems:(r=(n=this._mathfield.menu)==null?void 0:n.menuItems)!=null?r:void 0,options:i}),this._mathfield.dispose(),this._mathfield=null}upgradeProperty(e){if(this.hasOwnProperty(e)){let n=this[e];delete this[e],(e==="readonly"||e==="read-only")&&(e="readOnly"),this[e]=n}}attributeChangedCallback(e,n,r){if(n===r)return;let i=r!==null;switch(e){case"contenteditable":vt(this._mathfield);break;case"placeholder":r===!1&&(r=""),this.placeholder=r;break;case"disabled":this.disabled=i;break;case"read-only":case"readonly":this.readOnly=i;break}}get readonly(){return this.hasAttribute("readonly")||this.hasAttribute("read-only")}set readonly(e){let n=!!e;n?(this.setAttribute("readonly",""),ks()?this._internals.ariaReadOnly="true":this.setAttribute("aria-readonly","true"),this.setAttribute("aria-readonly","true")):(ks()?this._internals.ariaReadOnly="false":this.removeAttribute("aria-readonly"),this.removeAttribute("readonly"),this.removeAttribute("read-only")),this._setOptions({readOnly:n})}get disabled(){return this.hasAttribute("disabled")}set disabled(e){var n;let r=!!e;r?this.setAttribute("disabled",""):this.removeAttribute("disabled"),ks()?this._internals.ariaDisabled=r?"true":"false":this.setAttribute("aria-disabled",r?"true":"false"),r&&(n=this._mathfield)!=null&&n.hasFocus&&window.mathVirtualKeyboard.visible&&this._mathfield.executeCommand("hideVirtualKeyboard")}get value(){return this.getValue()}set value(e){this.setValue(e)}get defaultMode(){return this._getOption("defaultMode")}set defaultMode(e){this._setOptions({defaultMode:e})}get macros(){if(!this._mathfield)throw new Error("Mathfield not mounted");return this._getOption("macros")}set macros(e){this._setOptions({macros:e})}get registers(){if(!this._mathfield)throw new Error("Mathfield not mounted");let e=this;return new Proxy({},{get:(n,r)=>{if(typeof r=="string")return e._getOption("registers")[r]},set(n,r,i){return typeof r!="string"?!1:(e._setOptions({registers:V(O({},e._getOption("registers")),{[r]:i})}),!0)},ownKeys:()=>Reflect.ownKeys(e._getOption("registers")),getOwnPropertyDescriptor:(n,r)=>{let i=e._getOption("registers")[r];if(i!==void 0)return{configurable:!0,enumerable:!0,value:i,writable:!0}}})}set registers(e){this._setOptions({registers:e})}get colorMap(){return this._getOption("colorMap")}set colorMap(e){this._setOptions({colorMap:e})}get backgroundColorMap(){return this._getOption("backgroundColorMap")}set backgroundColorMap(e){this._setOptions({backgroundColorMap:e})}get letterShapeStyle(){return this._getOption("letterShapeStyle")}set letterShapeStyle(e){this._setOptions({letterShapeStyle:e})}get minFontScale(){return this._getOption("minFontScale")}set minFontScale(e){this._setOptions({minFontScale:e})}get maxMatrixCols(){return this._getOption("maxMatrixCols")}set maxMatrixCols(e){this._setOptions({maxMatrixCols:e})}get smartMode(){return this._getOption("smartMode")}set smartMode(e){this._setOptions({smartMode:e})}get smartFence(){return this._getOption("smartFence")}set smartFence(e){this._setOptions({smartFence:e})}get smartSuperscript(){return this._getOption("smartSuperscript")}set smartSuperscript(e){this._setOptions({smartSuperscript:e})}get scriptDepth(){return this._getOption("scriptDepth")}set scriptDepth(e){this._setOptions({scriptDepth:e})}get removeExtraneousParentheses(){return this._getOption("removeExtraneousParentheses")}set removeExtraneousParentheses(e){this._setOptions({removeExtraneousParentheses:e})}get mathModeSpace(){return this._getOption("mathModeSpace")}set mathModeSpace(e){this._setOptions({mathModeSpace:e})}get placeholderSymbol(){return this._getOption("placeholderSymbol")}set placeholderSymbol(e){this._setOptions({placeholderSymbol:e})}get placeholder(){return this._getOption("contentPlaceholder")}set placeholder(e){this._setOptions({contentPlaceholder:e})}get popoverPolicy(){return this._getOption("popoverPolicy")}set popoverPolicy(e){this._setOptions({popoverPolicy:e})}get environmentPopoverPolicy(){return this._getOption("environmentPopoverPolicy")}set environmentPopoverPolicy(e){this._setOptions({environmentPopoverPolicy:e})}get menuItems(){var e;if(!this._mathfield)throw new Error("Mathfield not mounted");return(e=this._mathfield.menu._menuItems.map(n=>n.menuItem))!=null?e:[]}set menuItems(e){var n;if(!this._mathfield)throw new Error("Mathfield not mounted");if(this._mathfield){let r=(n=this._mathfield.element)==null?void 0:n.querySelector("[part=menu-toggle]");r&&(r.style.display=e.length===0?"none":""),this._mathfield.menu.menuItems=e}}get mathVirtualKeyboardPolicy(){return this._getOption("mathVirtualKeyboardPolicy")}set mathVirtualKeyboardPolicy(e){this._setOptions({mathVirtualKeyboardPolicy:e})}get inlineShortcuts(){if(!this._mathfield)throw new Error("Mathfield not mounted");return this._getOption("inlineShortcuts")}set inlineShortcuts(e){if(!this._mathfield)throw new Error("Mathfield not mounted");this._setOptions({inlineShortcuts:e})}get inlineShortcutTimeout(){return this._getOption("inlineShortcutTimeout")}set inlineShortcutTimeout(e){this._setOptions({inlineShortcutTimeout:e})}get keybindings(){if(!this._mathfield)throw new Error("Mathfield not mounted");return this._getOption("keybindings")}set keybindings(e){if(!this._mathfield)throw new Error("Mathfield not mounted");this._setOptions({keybindings:e})}get onInsertStyle(){let e=this._getOption("onInsertStyle");return e===void 0?l0:e}set onInsertStyle(e){this._setOptions({onInsertStyle:e})}get onInlineShortcut(){return this._getOption("onInlineShortcut")}set onInlineShortcut(e){this._setOptions({onInlineShortcut:e})}get onScrollIntoView(){return this._getOption("onScrollIntoView")}set onScrollIntoView(e){this._setOptions({onScrollIntoView:e})}get onExport(){return this._getOption("onExport")}set onExport(e){this._setOptions({onExport:e})}get readOnly(){return this._getOption("readOnly")}set readOnly(e){this._setOptions({readOnly:e})}get isSelectionEditable(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.isSelectionEditable)!=null?n:!1}setPromptState(e,n,r){var i;(i=this._mathfield)==null||i.setPromptState(e,n,r)}getPromptState(e){var n,r;return(r=(n=this._mathfield)==null?void 0:n.getPromptState(e))!=null?r:[void 0,!0]}get selection(){return this._mathfield?this._mathfield.model.selection:it.has(this)?it.get(this).selection:{ranges:[[0,0]],direction:"forward"}}set selection(e){if(typeof e=="number"&&(e={ranges:[[e,e]]}),this._mathfield){this._mathfield.model.selection=e,vt(this._mathfield);return}if(it.has(this)){it.set(this,V(O({},it.get(this)),{selection:e}));return}it.set(this,{value:void 0,selection:e,options:Qu(this),menuItems:void 0})}get selectionIsCollapsed(){let e=this.selection;return e.ranges.length===1&&e.ranges[0][0]===e.ranges[0][1]}get position(){return this._mathfield?this._mathfield.model.position:it.has(this)?it.get(this).selection.ranges[0][0]:0}set position(e){if(this._mathfield&&(this._mathfield.model.position=e,vt(this._mathfield)),it.has(this)){it.set(this,V(O({},it.get(this)),{selection:{ranges:[[e,e]]}}));return}it.set(this,{value:void 0,selection:{ranges:[[e,e]]},options:Qu(this),menuItems:void 0})}get lastOffset(){var e,n;return(n=(e=this._mathfield)==null?void 0:e.model.lastOffset)!=null?n:-1}};Lt.version="0.108.2",Lt.openUrl=t=>{if(!t)return;let e=new URL(t);if(!["http:","https:","file:"].includes(e.protocol.toLowerCase())){Lt.playSound("plonk");return}window.open(e,"_blank")},Lt._fontsDirectory="./fonts/",Lt._soundsDirectory="./sounds",Lt.keypressVibration=!0,Lt._keypressSound={spacebar:"keypress-spacebar.wav",return:"keypress-return.wav",delete:"keypress-delete.wav",default:"keypress-standard.wav"},Lt._plonkSound="plonk.wav",Lt.audioBuffers={},Lt.createHTML=t=>t,Lt._speechEngineRate="100%",Lt._speechEngineVoice="Joanna",Lt._textToSpeechMarkup="",Lt._textToSpeechRules="mathlive",Lt._textToSpeechRulesOptions={},Lt.speakHook=wL,Lt.readAloudHook=kL,Lt.restoreFocusWhenDocumentFocused=!0,Lt._decimalSeparator=".",Lt._scientificNotationTemplate="#1\\times10^{#2}",Lt._isFunction=t=>{var e,n;let r=globalThis.MathfieldElement.computeEngine;return(n=(e=r?.parse(t).domain)==null?void 0:e.isFunction)!=null?n:!1};var Go=Lt;function qr(t){return t.replace(/[^a-zA-Z\d]+(.)/g,(e,n)=>n.toUpperCase())}function Qu(t){let e={readOnly:!1},n=Go.optionsAttributes;return Object.keys(n).forEach(r=>{var i;if(t.hasAttribute(r)){let o=t.getAttribute(r);r==="placeholder"?e.contentPlaceholder=o??"":n[r]==="boolean"?e[qr(r)]=!0:n[r]==="on/off"?(o=(i=o?.toLowerCase())!=null?i:"",o==="on"||o==="true"?e[qr(r)]=!0:o==="off"||o==="false"?e[qr(r)]=!1:e[qr(r)]=void 0):n[r]==="number"?e[qr(r)]=Number.parseFloat(o??"0"):e[qr(r)]=o}}),e}function ks(){return!(!("ElementInternals"in window)||!HTMLElement.prototype.attachInternals||!("role"in window.ElementInternals.prototype))}var p0=Go,Iv,Rv,zv;if(Xn()&&!((Iv=window.customElements)!=null&&Iv.get("math-field"))){window[Rv=Symbol.for("io.cortexjs.mathlive")]!=null||(window[Rv]={});let t=window[Symbol.for("io.cortexjs.mathlive")];t.version="0.108.2",globalThis.MathfieldElement=Go,(zv=window.customElements)==null||zv.define("math-field",Go)}function _L(t,e){let n=Zi.singleton;return n?(n.show(),Bs(),n.currentLayer=e,n.render(),n.focus(),!0):!1}function ML(){let t=window.mathVirtualKeyboard;return t.visible?t.hide({animate:!0}):t.show({animate:!0}),!1}ln({switchKeyboardLayer:_L,toggleVirtualKeyboard:ML,hideVirtualKeyboard:()=>(window.mathVirtualKeyboard.hide({animate:!0}),!1),showVirtualKeyboard:()=>(window.mathVirtualKeyboard.show({animate:!0}),!1)},{target:"virtual-keyboard"});var Fv=!1,$v=null;function CL(){Fv||$v||($v=oh().then(()=>{Fv=!0}))}var X5=class extends HTMLElement{constructor(){if(super(),this._hasRendered=!1,this._shadowRoot=this.attachShadow({mode:"open"}),"adoptedStyleSheets"in this._shadowRoot)this._shadowRoot.adoptedStyleSheets=[So("core")];else{let t=document.createElement("style");t.textContent=Oi("core"),this._shadowRoot.appendChild(t)}this._contentSlot=document.createElement("div"),this._contentSlot.style.display="none",this._contentSlot.setAttribute("part","content"),this._renderContainer=document.createElement("div"),this._renderContainer.setAttribute("part","render"),this._renderContainer.setAttribute("aria-hidden","true"),this._errorFallback=document.createElement("div"),this._errorFallback.style.display="none",this._errorFallback.setAttribute("part","error"),this._shadowRoot.appendChild(this._contentSlot),this._shadowRoot.appendChild(this._renderContainer),this._shadowRoot.appendChild(this._errorFallback),this.addEventListener("keydown",this._handleKeydown.bind(this))}static get observedAttributes(){return["mode","format","macros","letter-shape-style","min-font-scale","max-matrix-cols"]}connectedCallback(){CL(),"IntersectionObserver"in window&&!this._hasRendered?(this._observer=new IntersectionObserver(t=>{var e;t[0].isIntersecting&&!this._hasRendered&&(this.render(),(e=this._observer)==null||e.disconnect())},{rootMargin:"50px"}),this._observer.observe(this)):this.render()}disconnectedCallback(){var t;(t=this._observer)==null||t.disconnect()}attributeChangedCallback(t,e,n){e!==n&&this._hasRendered&&this.render()}_handleKeydown(t){if(this.getAttribute("tabindex")!==null&&(t.key===" "||t.key==="Enter")){t.preventDefault();let e=this.getAttribute("aria-label");if(e&&"speechSynthesis"in window){let n=new SpeechSynthesisUtterance(e);speechSynthesis.speak(n)}}}get mode(){let t=this.getAttribute("mode");return t==="textstyle"||t==="displaystyle"?t:this.getDefaultMathstyle()}set mode(t){this.setAttribute("mode",t)}get format(){let t=this.getAttribute("format");return t==="latex"||t==="ascii-math"||t==="math-json"?t:"latex"}set format(t){this.setAttribute("format",t)}get letterShapeStyle(){let t=this.getAttribute("letter-shape-style");if(t==="auto"||t==="tex"||t==="iso"||t==="french"||t==="upright")return t}set letterShapeStyle(t){t===void 0?this.removeAttribute("letter-shape-style"):this.setAttribute("letter-shape-style",t)}get macros(){var t;return(t=this.getAttribute("macros"))!=null?t:void 0}set macros(t){t===void 0?this.removeAttribute("macros"):this.setAttribute("macros",t)}get minFontScale(){let t=this.getAttribute("min-font-scale");return t?parseFloat(t):void 0}set minFontScale(t){t===void 0?this.removeAttribute("min-font-scale"):this.setAttribute("min-font-scale",String(t))}get maxMatrixCols(){let t=this.getAttribute("max-matrix-cols");return t?parseInt(t,10):void 0}set maxMatrixCols(t){t===void 0?this.removeAttribute("max-matrix-cols"):this.setAttribute("max-matrix-cols",String(t))}render(){var t,e,n;try{let r=(e=(t=this.textContent)==null?void 0:t.trim())!=null?e:"";if(!r){this._renderContainer.innerHTML="",this._errorFallback.style.display="none",this._renderContainer.style.display="none",this._removeMathML();return}this._contentSlot.textContent=r;let i,o=this.format;if(o==="ascii-math")i=VD(r);else if(o==="math-json"){let l=JSON.parse(r);i=qD(l)}else i=r;let s={defaultMode:this.mode==="displaystyle"?"math":"inline-math"};if(this.letterShapeStyle&&(s.letterShapeStyle=this.letterShapeStyle),this.macros)try{s.macros=JSON.parse(this.macros)}catch(l){console.warn("Invalid macros JSON:",l)}this.minFontScale!==void 0&&(s.minFontScale=this.minFontScale),this.maxMatrixCols!==void 0&&(s.maxMatrixCols=this.maxMatrixCols);let a=Pt(i,s);this._renderContainer.innerHTML=a,this._renderContainer.style.display=this.getDefaultDisplay(),this._errorFallback.style.display="none",this._updateAccessibility(i),this._hasRendered=!0,this.dispatchEvent(new CustomEvent("render",{bubbles:!0,composed:!0,detail:{format:o,content:i}}))}catch(r){console.error("MathLive static element render error:",r),this._renderContainer.style.display="none",this._errorFallback.textContent=(n=this.textContent)!=null?n:"",this._errorFallback.style.display="block",this._removeMathML(),this.dispatchEvent(new CustomEvent("render-error",{bubbles:!0,composed:!0,detail:{error:r,content:this.textContent}}))}}_updateAccessibility(t){if(!this.hasAttribute("aria-label"))try{let e=jD(t);this.setAttribute("aria-label",e)}catch(e){console.warn("Could not generate speakable text:",e)}this.hasAttribute("role")||this.setAttribute("role","img"),this._addMathML(t)}_addMathML(t){try{let e=KD(t);this._mathMLContainer||(this._mathMLContainer=document.createElement("div"),this._mathMLContainer.style.position="absolute",this._mathMLContainer.style.width="1px",this._mathMLContainer.style.height="1px",this._mathMLContainer.style.overflow="hidden",this._mathMLContainer.style.clip="rect(0, 0, 0, 0)",this._mathMLContainer.setAttribute("aria-hidden","false"),this._shadowRoot.appendChild(this._mathMLContainer)),this._mathMLContainer.innerHTML=e}catch(e){console.warn("Could not generate MathML:",e)}}_removeMathML(){this._mathMLContainer&&(this._mathMLContainer.remove(),this._mathMLContainer=void 0)}},EL=class extends X5{getDefaultMathstyle(){return"textstyle"}getDefaultDisplay(){return"inline-flex"}},AL=class extends X5{getDefaultMathstyle(){return"displaystyle"}getDefaultDisplay(){return"flex"}};function DL(){var t,e,n,r;typeof window<"u"&&((t=window.customElements)!=null&&t.get("math-span")||(e=window.customElements)==null||e.define("math-span",EL),(n=window.customElements)!=null&&n.get("math-div")||(r=window.customElements)==null||r.define("math-div",AL))}DL();function Ci(){var t;return globalThis[t=Symbol.for("io.cortexjs.mathlive")]!=null||(globalThis[t]={}),globalThis[Symbol.for("io.cortexjs.mathlive")]}const Y5=Xr.forwardRef((t,e)=>{const n=_l.c(21),{value:r,onChange:i,placeholder:o,readOnly:s,className:a,options:l}=t,u=Ne.useRef(null);let c;n[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>u.current,n[0]=c):c=n[0],Xr.useImperativeHandle(e,c);let d,p;n[1]!==i||n[2]!==l||n[3]!==o||n[4]!==s||n[5]!==r?(d=()=>{const B=u.current;if(!B)return;l&&Object.entries(l).forEach(R=>{const[L,P]=R;B[L]=P}),B.readOnly=!!s,o&&(B.placeholder=o),r!==void 0&&B.value!==r&&B.setValue(r);const T=R=>{i&&i(R.target.value)};return B.addEventListener("input",T),()=>{B.removeEventListener("input",T)}},p=[r,i,o,s,l],n[1]=i,n[2]=l,n[3]=o,n[4]=s,n[5]=r,n[6]=d,n[7]=p):(d=n[6],p=n[7]),Ne.useEffect(d,p);let f,g;n[8]!==r?(f=()=>{const B=u.current;B&&r!==void 0&&B.value!==r&&B.setValue(r,{suppressChangeNotifications:!0})},g=[r],n[8]=r,n[9]=f,n[10]=g):(f=n[9],g=n[10]),Ne.useEffect(f,g);const x=a?.includes("border-0")?"none":"1px solid hsl(var(--input))",w=a?.includes("bg-transparent")?"transparent":"hsl(var(--background))";let k;n[11]!==l?(k=l?.style||{},n[11]=l,n[12]=k):k=n[12];let D;n[13]!==x||n[14]!==w||n[15]!==k?(D={display:"inline-block",width:"auto",minWidth:"20px",padding:"0.2rem 0.5rem",borderRadius:"calc(var(--radius) - 2px)",border:x,backgroundColor:w,color:"hsl(var(--foreground))",fontSize:"1em",...k},n[13]=x,n[14]=w,n[15]=k,n[16]=D):D=n[16];let N;return n[17]!==a||n[18]!==D||n[19]!==r?(N=he.jsx("math-field",{ref:u,class:a,style:D,children:r}),n[17]=a,n[18]=D,n[19]=r,n[20]=N):N=n[20],N});Y5.displayName="MathField";const LL=t=>{const e=_l.c(17),n=Ne.useRef(null);let r;e[0]!==t?(r=x=>{t.node.attrs.latex!==x&&t.updateAttributes({latex:x})},e[0]=t,e[1]=r):r=e[1];const i=r;let o;e[2]!==t.node.attrs.latex?(o=()=>{!t.node.attrs.latex&&n.current&&setTimeout(()=>{n.current?.focus()},50)},e[2]=t.node.attrs.latex,e[3]=o):o=e[3];let s;e[4]===Symbol.for("react.memo_cache_sentinel")?(s=[],e[4]=s):s=e[4],Ne.useEffect(o,s);const a=t.editor.isEditable,l=`relative ${a?"border rounded px-2 py-1 bg-slate-50 border-slate-200 min-w-[120px]":""} inline-block`,u=!a,c=`!p-0 !border-0 !bg-transparent text-lg shadow-none focus:ring-0 block ${a?"!w-full":"!w-auto"}`;let d;e[5]===Symbol.for("react.memo_cache_sentinel")?(d={smartFence:!0,virtualKeyboardMode:"manual"},e[5]=d):d=e[5];let p;e[6]!==i||e[7]!==t.node.attrs.latex||e[8]!==u||e[9]!==c?(p=he.jsx(Y5,{ref:n,value:t.node.attrs.latex,onChange:i,readOnly:u,className:c,options:d}),e[6]=i,e[7]=t.node.attrs.latex,e[8]=u,e[9]=c,e[10]=p):p=e[10];let f;e[11]!==a?(f=a&&he.jsx("div",{className:"absolute -top-3 -right-2 bg-slate-200 text-[10px] px-1.5 rounded-full text-slate-600 select-none pointer-events-none border border-slate-300",children:"Math"}),e[11]=a,e[12]=f):f=e[12];let g;return e[13]!==l||e[14]!==p||e[15]!==f?(g=he.jsx(Om,{className:"inline-block align-middle mx-1",children:he.jsxs("div",{className:l,children:[p,f]})}),e[13]=l,e[14]=p,e[15]=f,e[16]=g):g=e[16],g},TL=gn.create({name:"mathComponent",group:"inline",inline:!0,atom:!0,addAttributes(){return{latex:{default:"\\text{Math}"}}},parseHTML(){return[{tag:'span[data-type="math-component"]'},{tag:"math-component"}]},renderHTML({HTMLAttributes:t}){return["span",St(t,{"data-type":"math-component"}),""]},addNodeView(){return Nm(LL)},addCommands(){return{addMathComponent:()=>({commands:t})=>t.insertContent({type:"mathComponent",attrs:{latex:""}})}}});var xc={exports:{}};var BL=xc.exports,Kv;function OL(){return Kv||(Kv=1,(function(t,e){(function(n,r){t.exports=r(Ld())})(BL,(function(n){return(function(){var r={442:function(a){a.exports=n},548:function(a){a.exports=(function(){var l={34:function(S,M,h){var m=h(4901);S.exports=function(y){return typeof y=="object"?y!==null:m(y)}},81:function(S,M,h){var m=h(9565),y=h(9306),b=h(8551),v=h(6823),_=h(851),C=TypeError;S.exports=function(E,A){var I=arguments.length<2?_(E):A;if(y(I))return b(m(I,E));throw new C(v(E)+" is not iterable")}},235:function(S,M,h){var m=h(9213).forEach,y=h(4598)("forEach");S.exports=y?[].forEach:function(b){return m(this,b,arguments.length>1?arguments[1]:void 0)}},283:function(S,M,h){var m=h(9504),y=h(9039),b=h(4901),v=h(9297),_=h(3724),C=h(350).CONFIGURABLE,E=h(3706),A=h(1181),I=A.enforce,K=A.get,F=String,z=Object.defineProperty,j=m("".slice),$=m("".replace),U=m([].join),H=_&&!y((function(){return z((function(){}),"length",{value:8}).length!==8})),J=String(String).split("String"),Y=S.exports=function(X,ie,te){j(F(ie),0,7)==="Symbol("&&(ie="["+$(F(ie),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),te&&te.getter&&(ie="get "+ie),te&&te.setter&&(ie="set "+ie),(!v(X,"name")||C&&X.name!==ie)&&(_?z(X,"name",{value:ie,configurable:!0}):X.name=ie),H&&te&&v(te,"arity")&&X.length!==te.arity&&z(X,"length",{value:te.arity});try{te&&v(te,"constructor")&&te.constructor?_&&z(X,"prototype",{writable:!1}):X.prototype&&(X.prototype=void 0)}catch{}var Q=I(X);return v(Q,"source")||(Q.source=U(J,typeof ie=="string"?ie:"")),X};Function.prototype.toString=Y((function(){return b(this)&&K(this).source||E(this)}),"toString")},298:function(S,M,h){var m=h(2195),y=h(5397),b=h(8480).f,v=h(7680),_=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];S.exports.f=function(C){return _&&m(C)==="Window"?(function(E){try{return b(E)}catch{return v(_)}})(C):b(y(C))}},350:function(S,M,h){var m=h(3724),y=h(9297),b=Function.prototype,v=m&&Object.getOwnPropertyDescriptor,_=y(b,"name"),C=_&&(function(){}).name==="something",E=_&&(!m||m&&v(b,"name").configurable);S.exports={EXISTS:_,PROPER:C,CONFIGURABLE:E}},397:function(S,M,h){var m=h(7751);S.exports=m("document","documentElement")},421:function(S){S.exports={}},511:function(S,M,h){var m=h(9167),y=h(9297),b=h(1951),v=h(4913).f;S.exports=function(_){var C=m.Symbol||(m.Symbol={});y(C,_)||v(C,_,{value:b.f(_)})}},566:function(S,M,h){var m=h(9504),y=h(9306),b=h(34),v=h(9297),_=h(7680),C=h(616),E=Function,A=m([].concat),I=m([].join),K={};S.exports=C?E.bind:function(F){var z=y(this),j=z.prototype,$=_(arguments,1),U=function(){var H=A($,_(arguments));return this instanceof U?(function(J,Y,X){if(!v(K,Y)){for(var ie=[],te=0;te<Y;te++)ie[te]="a["+te+"]";K[Y]=E("C,a","return new C("+I(ie,",")+")")}return K[Y](J,X)})(z,H.length,H):z.apply(F,H)};return b(j)&&(U.prototype=j),U}},597:function(S,M,h){var m=h(9039),y=h(8227),b=h(9519),v=y("species");S.exports=function(_){return b>=51||!m((function(){var C=[];return(C.constructor={})[v]=function(){return{foo:1}},C[_](Boolean).foo!==1}))}},616:function(S,M,h){var m=h(9039);S.exports=!m((function(){var y=(function(){}).bind();return typeof y!="function"||y.hasOwnProperty("prototype")}))},655:function(S,M,h){var m=h(6955),y=String;S.exports=function(b){if(m(b)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return y(b)}},687:function(S,M,h){var m=h(4913).f,y=h(9297),b=h(8227)("toStringTag");S.exports=function(v,_,C){v&&!C&&(v=v.prototype),v&&!y(v,b)&&m(v,b,{configurable:!0,value:_})}},706:function(S,M,h){var m=h(350).PROPER,y=h(9039),b=h(7452);S.exports=function(v){return y((function(){return!!b[v]()||""[v]()!==""||m&&b[v].name!==v}))}},739:function(S,M,h){var m=h(6518),y=h(9039),b=h(8981),v=h(2777);m({target:"Date",proto:!0,arity:1,forced:y((function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}))},{toJSON:function(_){var C=b(this),E=v(C,"number");return typeof E!="number"||isFinite(E)?C.toISOString():null}})},741:function(S){var M=Math.ceil,h=Math.floor;S.exports=Math.trunc||function(m){var y=+m;return(y>0?h:M)(y)}},744:function(S,M,h){var m=h(9565),y=h(9504),b=h(9228),v=h(8551),_=h(34),C=h(7750),E=h(2293),A=h(7829),I=h(8014),K=h(655),F=h(5966),z=h(6682),j=h(8429),$=h(9039),U=j.UNSUPPORTED_Y,H=Math.min,J=y([].push),Y=y("".slice),X=!$((function(){var te=/(?:)/,Q=te.exec;te.exec=function(){return Q.apply(this,arguments)};var ue="ab".split(te);return ue.length!==2||ue[0]!=="a"||ue[1]!=="b"})),ie="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;b("split",(function(te,Q,ue){var fe="0".split(void 0,0).length?function(ne,Pe){return ne===void 0&&Pe===0?[]:m(Q,this,ne,Pe)}:Q;return[function(ne,Pe){var ke=C(this),Se=_(ne)?F(ne,te):void 0;return Se?m(Se,ne,ke,Pe):m(fe,K(ke),ne,Pe)},function(ne,Pe){var ke=v(this),Se=K(ne);if(!ie){var st=ue(fe,ke,Se,Pe,fe!==Q);if(st.done)return st.value}var tt=E(ke,RegExp),Me=ke.unicode,je=(ke.ignoreCase?"i":"")+(ke.multiline?"m":"")+(ke.unicode?"u":"")+(U?"g":"y"),Oe=new tt(U?"^(?:"+ke.source+")":ke,je),Te=Pe===void 0?4294967295:Pe>>>0;if(Te===0)return[];if(Se.length===0)return z(Oe,Se)===null?[Se]:[];for(var Ie=0,Ve=0,ye=[];Ve<Se.length;){Oe.lastIndex=U?0:Ve;var we,_e=z(Oe,U?Y(Se,Ve):Se);if(_e===null||(we=H(I(Oe.lastIndex+(U?Ve:0)),Se.length))===Ie)Ve=A(Se,Ve,Me);else{if(J(ye,Y(Se,Ie,Ve)),ye.length===Te)return ye;for(var Be=1;Be<=_e.length-1;Be++)if(J(ye,_e[Be]),ye.length===Te)return ye;Ve=Ie=we}}return J(ye,Y(Se,Ie)),ye}]}),ie||!X,U)},757:function(S,M,h){var m=h(7751),y=h(4901),b=h(1625),v=h(7040),_=Object;S.exports=v?function(C){return typeof C=="symbol"}:function(C){var E=m("Symbol");return y(E)&&b(E.prototype,_(C))}},788:function(S,M,h){var m=h(34),y=h(2195),b=h(8227)("match");S.exports=function(v){var _;return m(v)&&((_=v[b])!==void 0?!!_:y(v)==="RegExp")}},825:function(S,M,h){var m=h(6518),y=h(7751),b=h(8745),v=h(566),_=h(5548),C=h(8551),E=h(34),A=h(2360),I=h(9039),K=y("Reflect","construct"),F=Object.prototype,z=[].push,j=I((function(){function H(){}return!(K((function(){}),[],H)instanceof H)})),$=!I((function(){K((function(){}))})),U=j||$;m({target:"Reflect",stat:!0,forced:U,sham:U},{construct:function(H,J){_(H),C(J);var Y=arguments.length<3?H:_(arguments[2]);if($&&!j)return K(H,J,Y);if(H===Y){switch(J.length){case 0:return new H;case 1:return new H(J[0]);case 2:return new H(J[0],J[1]);case 3:return new H(J[0],J[1],J[2]);case 4:return new H(J[0],J[1],J[2],J[3])}var X=[null];return b(z,X,J),new(b(v,H,X))}var ie=Y.prototype,te=A(E(ie)?ie:F),Q=b(H,te,J);return E(Q)?Q:te}})},851:function(S,M,h){var m=h(6955),y=h(5966),b=h(4117),v=h(6269),_=h(8227)("iterator");S.exports=function(C){if(!b(C))return y(C,_)||y(C,"@@iterator")||v[m(C)]}},926:function(S,M,h){var m=h(9306),y=h(8981),b=h(7055),v=h(6198),_=TypeError,C="Reduce of empty array with no initial value",E=function(A){return function(I,K,F,z){var j=y(I),$=b(j),U=v(j);if(m(K),U===0&&F<2)throw new _(C);var H=A?U-1:0,J=A?-1:1;if(F<2)for(;;){if(H in $){z=$[H],H+=J;break}if(H+=J,A?H<0:U<=H)throw new _(C)}for(;A?H>=0:U>H;H+=J)H in $&&(z=K(z,$[H],H,j));return z}};S.exports={left:E(!1),right:E(!0)}},1034:function(S,M,h){var m=h(9565),y=h(9297),b=h(1625),v=h(5213),_=h(7979),C=RegExp.prototype;S.exports=v.correct?function(E){return E.flags}:function(E){return v.correct||!b(C,E)||y(E,"flags")?E.flags:m(_,E)}},1056:function(S,M,h){var m=h(4913).f;S.exports=function(y,b,v){v in y||m(y,v,{configurable:!0,get:function(){return b[v]},set:function(_){b[v]=_}})}},1072:function(S,M,h){var m=h(1828),y=h(8727);S.exports=Object.keys||function(b){return m(b,y)}},1088:function(S,M,h){var m=h(6518),y=h(9565),b=h(6395),v=h(350),_=h(4901),C=h(3994),E=h(2787),A=h(2967),I=h(687),K=h(6699),F=h(6840),z=h(8227),j=h(6269),$=h(7657),U=v.PROPER,H=v.CONFIGURABLE,J=$.IteratorPrototype,Y=$.BUGGY_SAFARI_ITERATORS,X=z("iterator"),ie="keys",te="values",Q="entries",ue=function(){return this};S.exports=function(fe,ne,Pe,ke,Se,st,tt){C(Pe,ne,ke);var Me,je,Oe,Te=function(Re){if(Re===Se&&_e)return _e;if(!Y&&Re&&Re in ye)return ye[Re];switch(Re){case ie:case te:case Q:return function(){return new Pe(this,Re)}}return function(){return new Pe(this)}},Ie=ne+" Iterator",Ve=!1,ye=fe.prototype,we=ye[X]||ye["@@iterator"]||Se&&ye[Se],_e=!Y&&we||Te(Se),Be=ne==="Array"&&ye.entries||we;if(Be&&(Me=E(Be.call(new fe)))!==Object.prototype&&Me.next&&(b||E(Me)===J||(A?A(Me,J):_(Me[X])||F(Me,X,ue)),I(Me,Ie,!0,!0),b&&(j[Ie]=ue)),U&&Se===te&&we&&we.name!==te&&(!b&&H?K(ye,"name",te):(Ve=!0,_e=function(){return y(we,this)})),Se)if(je={values:Te(te),keys:st?_e:Te(ie),entries:Te(Q)},tt)for(Oe in je)(Y||Ve||!(Oe in ye))&&F(ye,Oe,je[Oe]);else m({target:ne,proto:!0,forced:Y||Ve},je);return b&&!tt||ye[X]===_e||F(ye,X,_e,{name:Se}),j[ne]=_e,je}},1181:function(S,M,h){var m,y,b,v=h(8622),_=h(4576),C=h(34),E=h(6699),A=h(9297),I=h(7629),K=h(6119),F=h(421),z="Object already initialized",j=_.TypeError,$=_.WeakMap;if(v||I.state){var U=I.state||(I.state=new $);U.get=U.get,U.has=U.has,U.set=U.set,m=function(J,Y){if(U.has(J))throw new j(z);return Y.facade=J,U.set(J,Y),Y},y=function(J){return U.get(J)||{}},b=function(J){return U.has(J)}}else{var H=K("state");F[H]=!0,m=function(J,Y){if(A(J,H))throw new j(z);return Y.facade=J,E(J,H,Y),Y},y=function(J){return A(J,H)?J[H]:{}},b=function(J){return A(J,H)}}S.exports={set:m,get:y,has:b,enforce:function(J){return b(J)?y(J):m(J,{})},getterFor:function(J){return function(Y){var X;if(!C(Y)||(X=y(Y)).type!==J)throw new j("Incompatible receiver, "+J+" required");return X}}}},1240:function(S,M,h){var m=h(9504);S.exports=m(1.1.valueOf)},1278:function(S,M,h){var m=h(6518),y=h(3724),b=h(5031),v=h(5397),_=h(7347),C=h(4659);m({target:"Object",stat:!0,sham:!y},{getOwnPropertyDescriptors:function(E){for(var A,I,K=v(E),F=_.f,z=b(K),j={},$=0;z.length>$;)(I=F(K,A=z[$++]))!==void 0&&C(j,A,I);return j}})},1291:function(S,M,h){var m=h(741);S.exports=function(y){var b=+y;return b!=b||b===0?0:m(b)}},1296:function(S,M,h){var m=h(4495);S.exports=m&&!!Symbol.for&&!!Symbol.keyFor},1436:function(S,M,h){var m=h(8227)("match");S.exports=function(y){var b=/./;try{"/./"[y](b)}catch{try{return b[m]=!1,"/./"[y](b)}catch{}}return!1}},1469:function(S,M,h){var m=h(7433);S.exports=function(y,b){return new(m(y))(b===0?0:b)}},1480:function(S,M,h){var m=h(6518),y=h(9039),b=h(298).f;m({target:"Object",stat:!0,forced:y((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:b})},1510:function(S,M,h){var m=h(6518),y=h(7751),b=h(9297),v=h(655),_=h(5745),C=h(1296),E=_("string-to-symbol-registry"),A=_("symbol-to-string-registry");m({target:"Symbol",stat:!0,forced:!C},{for:function(I){var K=v(I);if(b(E,K))return E[K];var F=y("Symbol")(K);return E[K]=F,A[F]=K,F}})},1625:function(S,M,h){var m=h(9504);S.exports=m({}.isPrototypeOf)},1699:function(S,M,h){var m=h(6518),y=h(9504),b=h(5749),v=h(7750),_=h(655),C=h(1436),E=y("".indexOf);m({target:"String",proto:!0,forced:!C("includes")},{includes:function(A){return!!~E(_(v(this)),_(b(A)),arguments.length>1?arguments[1]:void 0)}})},1761:function(S,M,h){var m=h(9565),y=h(9504),b=h(9228),v=h(8551),_=h(34),C=h(8014),E=h(655),A=h(7750),I=h(5966),K=h(7829),F=h(1034),z=h(6682),j=y("".indexOf);b("match",(function($,U,H){return[function(J){var Y=A(this),X=_(J)?I(J,$):void 0;return X?m(X,J,Y):new RegExp(J)[$](E(Y))},function(J){var Y=v(this),X=E(J),ie=H(U,Y,X);if(ie.done)return ie.value;var te=E(F(Y));if(j(te,"g")===-1)return z(Y,X);var Q=j(te,"u")!==-1;Y.lastIndex=0;for(var ue,fe=[],ne=0;(ue=z(Y,X))!==null;){var Pe=E(ue[0]);fe[ne]=Pe,Pe===""&&(Y.lastIndex=K(X,C(Y.lastIndex),Q)),ne++}return ne===0?null:fe}]}))},1828:function(S,M,h){var m=h(9504),y=h(9297),b=h(5397),v=h(9617).indexOf,_=h(421),C=m([].push);S.exports=function(E,A){var I,K=b(E),F=0,z=[];for(I in K)!y(_,I)&&y(K,I)&&C(z,I);for(;A.length>F;)y(K,I=A[F++])&&(~v(z,I)||C(z,I));return z}},1951:function(S,M,h){var m=h(8227);M.f=m},2008:function(S,M,h){var m=h(6518),y=h(9213).filter;m({target:"Array",proto:!0,forced:!h(597)("filter")},{filter:function(b){return y(this,b,arguments.length>1?arguments[1]:void 0)}})},2010:function(S,M,h){var m=h(3724),y=h(350).EXISTS,b=h(9504),v=h(2106),_=Function.prototype,C=b(_.toString),E=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,A=b(E.exec);m&&!y&&v(_,"name",{configurable:!0,get:function(){try{return A(E,C(this))[1]}catch{return""}}})},2062:function(S,M,h){var m=h(6518),y=h(9213).map;m({target:"Array",proto:!0,forced:!h(597)("map")},{map:function(b){return y(this,b,arguments.length>1?arguments[1]:void 0)}})},2087:function(S,M,h){var m=h(34),y=Math.floor;S.exports=Number.isInteger||function(b){return!m(b)&&isFinite(b)&&y(b)===b}},2106:function(S,M,h){var m=h(283),y=h(4913);S.exports=function(b,v,_){return _.get&&m(_.get,v,{getter:!0}),_.set&&m(_.set,v,{setter:!0}),y.f(b,v,_)}},2140:function(S,M,h){var m={};m[h(8227)("toStringTag")]="z",S.exports=String(m)==="[object z]"},2195:function(S,M,h){var m=h(9504),y=m({}.toString),b=m("".slice);S.exports=function(v){return b(y(v),8,-1)}},2211:function(S,M,h){var m=h(9039);S.exports=!m((function(){function y(){}return y.prototype.constructor=null,Object.getPrototypeOf(new y)!==y.prototype}))},2259:function(S,M,h){h(511)("iterator")},2293:function(S,M,h){var m=h(8551),y=h(5548),b=h(4117),v=h(8227)("species");S.exports=function(_,C){var E,A=m(_).constructor;return A===void 0||b(E=m(A)[v])?C:y(E)}},2360:function(S,M,h){var m,y=h(8551),b=h(6801),v=h(8727),_=h(421),C=h(397),E=h(4055),A=h(6119),I="prototype",K="script",F=A("IE_PROTO"),z=function(){},j=function(H){return"<"+K+">"+H+"</"+K+">"},$=function(H){H.write(j("")),H.close();var J=H.parentWindow.Object;return H=null,J},U=function(){try{m=new ActiveXObject("htmlfile")}catch{}var H,J,Y;U=typeof document<"u"?document.domain&&m?$(m):(J=E("iframe"),Y="java"+K+":",J.style.display="none",C.appendChild(J),J.src=String(Y),(H=J.contentWindow.document).open(),H.write(j("document.F=Object")),H.close(),H.F):$(m);for(var X=v.length;X--;)delete U[I][v[X]];return U()};_[F]=!0,S.exports=Object.create||function(H,J){var Y;return H!==null?(z[I]=y(H),Y=new z,z[I]=null,Y[F]=H):Y=U(),J===void 0?Y:b.f(Y,J)}},2478:function(S,M,h){var m=h(9504),y=h(8981),b=Math.floor,v=m("".charAt),_=m("".replace),C=m("".slice),E=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,A=/\$([$&'`]|\d{1,2})/g;S.exports=function(I,K,F,z,j,$){var U=F+I.length,H=z.length,J=A;return j!==void 0&&(j=y(j),J=E),_($,J,(function(Y,X){var ie;switch(v(X,0)){case"$":return"$";case"&":return I;case"`":return C(K,0,F);case"'":return C(K,U);case"<":ie=j[C(X,1,-1)];break;default:var te=+X;if(te===0)return Y;if(te>H){var Q=b(te/10);return Q===0?Y:Q<=H?z[Q-1]===void 0?v(X,1):z[Q-1]+v(X,1):Y}ie=z[te-1]}return ie===void 0?"":ie}))}},2529:function(S){S.exports=function(M,h){return{value:M,done:h}}},2551:function(S,M,h){var m=h(6395),y=h(4576),b=h(9039),v=h(3607);S.exports=m||!b((function(){if(!(v&&v<535)){var _=Math.random();__defineSetter__.call(null,_,(function(){})),delete y[_]}}))},2637:function(S,M,h){h(6518)({target:"Number",stat:!0},{isInteger:h(2087)})},2675:function(S,M,h){h(6761),h(1510),h(7812),h(3110),h(9773)},2712:function(S,M,h){var m=h(6518),y=h(926).left,b=h(4598),v=h(9519);m({target:"Array",proto:!0,forced:!h(6193)&&v>79&&v<83||!b("reduce")},{reduce:function(_){var C=arguments.length;return y(this,_,C,C>1?arguments[1]:void 0)}})},2762:function(S,M,h){var m=h(6518),y=h(3802).trim;m({target:"String",proto:!0,forced:h(706)("trim")},{trim:function(){return y(this)}})},2777:function(S,M,h){var m=h(9565),y=h(34),b=h(757),v=h(5966),_=h(4270),C=h(8227),E=TypeError,A=C("toPrimitive");S.exports=function(I,K){if(!y(I)||b(I))return I;var F,z=v(I,A);if(z){if(K===void 0&&(K="default"),F=m(z,I,K),!y(F)||b(F))return F;throw new E("Can't convert object to primitive value")}return K===void 0&&(K="number"),_(I,K)}},2787:function(S,M,h){var m=h(9297),y=h(4901),b=h(8981),v=h(6119),_=h(2211),C=v("IE_PROTO"),E=Object,A=E.prototype;S.exports=_?E.getPrototypeOf:function(I){var K=b(I);if(m(K,C))return K[C];var F=K.constructor;return y(F)&&K instanceof F?F.prototype:K instanceof E?A:null}},2796:function(S,M,h){var m=h(9039),y=h(4901),b=/#|\.prototype\./,v=function(I,K){var F=C[_(I)];return F===A||F!==E&&(y(K)?m(K):!!K)},_=v.normalize=function(I){return String(I).replace(b,".").toLowerCase()},C=v.data={},E=v.NATIVE="N",A=v.POLYFILL="P";S.exports=v},2839:function(S,M,h){var m=h(4576).navigator,y=m&&m.userAgent;S.exports=y?String(y):""},2892:function(S,M,h){var m=h(6518),y=h(6395),b=h(3724),v=h(4576),_=h(9167),C=h(9504),E=h(2796),A=h(9297),I=h(3167),K=h(1625),F=h(757),z=h(2777),j=h(9039),$=h(8480).f,U=h(7347).f,H=h(4913).f,J=h(1240),Y=h(3802).trim,X="Number",ie=v[X],te=_[X],Q=ie.prototype,ue=v.TypeError,fe=C("".slice),ne=C("".charCodeAt),Pe=function(tt){var Me,je,Oe,Te,Ie,Ve,ye,we,_e=z(tt,"number");if(F(_e))throw new ue("Cannot convert a Symbol value to a number");if(typeof _e=="string"&&_e.length>2){if(_e=Y(_e),(Me=ne(_e,0))===43||Me===45){if((je=ne(_e,2))===88||je===120)return NaN}else if(Me===48){switch(ne(_e,1)){case 66:case 98:Oe=2,Te=49;break;case 79:case 111:Oe=8,Te=55;break;default:return+_e}for(Ve=(Ie=fe(_e,2)).length,ye=0;ye<Ve;ye++)if((we=ne(Ie,ye))<48||we>Te)return NaN;return parseInt(Ie,Oe)}}return+_e},ke=E(X,!ie(" 0o1")||!ie("0b1")||ie("+0x1")),Se=function(tt){var Me,je=arguments.length<1?0:ie((function(Oe){var Te=z(Oe,"number");return typeof Te=="bigint"?Te:Pe(Te)})(tt));return K(Q,Me=this)&&j((function(){J(Me)}))?I(Object(je),this,Se):je};Se.prototype=Q,ke&&!y&&(Q.constructor=Se),m({global:!0,constructor:!0,wrap:!0,forced:ke},{Number:Se});var st=function(tt,Me){for(var je,Oe=b?$(Me):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Te=0;Oe.length>Te;Te++)A(Me,je=Oe[Te])&&!A(tt,je)&&H(tt,je,U(Me,je))};y&&te&&st(_[X],te),(ke||y)&&st(_[X],ie)},2953:function(S,M,h){var m=h(4576),y=h(7400),b=h(9296),v=h(3792),_=h(6699),C=h(687),E=h(8227)("iterator"),A=v.values,I=function(F,z){if(F){if(F[E]!==A)try{_(F,E,A)}catch{F[E]=A}if(C(F,z,!0),y[z]){for(var j in v)if(F[j]!==v[j])try{_(F,j,v[j])}catch{F[j]=v[j]}}}};for(var K in y)I(m[K]&&m[K].prototype,K);I(b,"DOMTokenList")},2967:function(S,M,h){var m=h(6706),y=h(34),b=h(7750),v=h(3506);S.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var _,C=!1,E={};try{(_=m(Object.prototype,"__proto__","set"))(E,[]),C=E instanceof Array}catch{}return function(A,I){return b(A),v(I),y(A)&&(C?_(A,I):A.__proto__=I),A}})():void 0)},3110:function(S,M,h){var m=h(6518),y=h(7751),b=h(8745),v=h(9565),_=h(9504),C=h(9039),E=h(4376),A=h(4901),I=h(5810),K=h(757),F=h(2195),z=h(655),j=h(7680),$=h(8235),U=h(3392),H=h(4495),J=h(7819),Y=String,X=y("JSON","stringify"),ie=_(/./.exec),te=_("".charAt),Q=_("".charCodeAt),ue=_("".replace),fe=_("".slice),ne=_([].push),Pe=_(1.1.toString),ke=/[\uD800-\uDFFF]/g,Se=/^[\uD800-\uDBFF]$/,st=/^[\uDC00-\uDFFF]$/,tt=U(),Me=tt.length,je=!H||C((function(){var ye=y("Symbol")("stringify detection");return X([ye])!=="[null]"||X({a:ye})!=="{}"||X(Object(ye))!=="{}"})),Oe=C((function(){return X("\uDF06\uD834")!=='"\\udf06\\ud834"'||X("\uDEAD")!=='"\\udead"'})),Te=je?function(ye,we){var _e=j(arguments),Be=Ve(we);if(A(Be)||ye!==void 0&&!K(ye))return _e[1]=function(Re,Ue){if(A(Be)&&(Ue=v(Be,this,Y(Re),Ue)),!K(Ue))return Ue},b(X,null,_e)}:X,Ie=function(ye,we,_e){var Be=te(_e,we-1),Re=te(_e,we+1);return ie(Se,ye)&&!ie(st,Re)||ie(st,ye)&&!ie(Se,Be)?"\\u"+Pe(Q(ye,0),16):ye},Ve=function(ye){if(A(ye))return ye;if(E(ye)){for(var we=ye.length,_e=[],Be=0;Be<we;Be++){var Re=ye[Be];typeof Re=="string"?ne(_e,Re):typeof Re!="number"&&F(Re)!=="Number"&&F(Re)!=="String"||ne(_e,z(Re))}var Ue=_e.length,xt=!0;return function(Rt,_t){if(xt)return xt=!1,_t;if(E(this))return _t;for(var un=0;un<Ue;un++)if(_e[un]===Rt)return _t}}};X&&m({target:"JSON",stat:!0,arity:3,forced:je||Oe||!J},{stringify:function(ye,we,_e){var Be=Ve(we),Re=[],Ue=Te(ye,(function(Zn,tn){var Tn=A(Be)?v(Be,this,Y(Zn),tn):tn;return!J&&I(Tn)?tt+(ne(Re,Tn.rawJSON)-1):Tn}),_e);if(typeof Ue!="string"||(Oe&&(Ue=ue(Ue,ke,Ie)),J))return Ue;for(var xt="",Rt=Ue.length,_t=0;_t<Rt;_t++){var un=te(Ue,_t);if(un==='"'){var Ln=$(Ue,++_t).end-1,jt=fe(Ue,_t,Ln);xt+=fe(jt,0,Me)===tt?Re[fe(jt,Me)]:'"'+jt+'"',_t=Ln}else xt+=un}return xt}})},3167:function(S,M,h){var m=h(4901),y=h(34),b=h(2967);S.exports=function(v,_,C){var E,A;return b&&m(E=_.constructor)&&E!==C&&y(A=E.prototype)&&A!==C.prototype&&b(v,A),v}},3179:function(S,M,h){var m=h(2140),y=h(6955);S.exports=m?{}.toString:function(){return"[object "+y(this)+"]"}},3392:function(S,M,h){var m=h(9504),y=0,b=Math.random(),v=m(1.1.toString);S.exports=function(_){return"Symbol("+(_===void 0?"":_)+")_"+v(++y+b,36)}},3418:function(S,M,h){var m=h(6518),y=h(7916);m({target:"Array",stat:!0,forced:!h(4428)((function(b){Array.from(b)}))},{from:y})},3500:function(S,M,h){var m=h(4576),y=h(7400),b=h(9296),v=h(235),_=h(6699),C=function(A){if(A&&A.forEach!==v)try{_(A,"forEach",v)}catch{A.forEach=v}};for(var E in y)y[E]&&C(m[E]&&m[E].prototype);C(b)},3506:function(S,M,h){var m=h(3925),y=String,b=TypeError;S.exports=function(v){if(m(v))return v;throw new b("Can't set "+y(v)+" as a prototype")}},3517:function(S,M,h){var m=h(9504),y=h(9039),b=h(4901),v=h(6955),_=h(7751),C=h(3706),E=function(){},A=_("Reflect","construct"),I=/^\s*(?:class|function)\b/,K=m(I.exec),F=!I.test(E),z=function($){if(!b($))return!1;try{return A(E,[],$),!0}catch{return!1}},j=function($){if(!b($))return!1;switch(v($)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return F||!!K(I,C($))}catch{return!0}};j.sham=!0,S.exports=!A||y((function(){var $;return z(z.call)||!z(Object)||!z((function(){$=!0}))||$}))?j:z},3607:function(S,M,h){var m=h(2839).match(/AppleWebKit\/(\d+)\./);S.exports=!!m&&+m[1]},3635:function(S,M,h){var m=h(9039),y=h(4576).RegExp;S.exports=m((function(){var b=y(".","s");return!(b.dotAll&&b.test(`
`)&&b.flags==="s")}))},3640:function(S,M,h){var m=h(8551),y=h(4270),b=TypeError;S.exports=function(v){if(m(this),v==="string"||v==="default")v="string";else if(v!=="number")throw new b("Incorrect hint");return y(this,v)}},3706:function(S,M,h){var m=h(9504),y=h(4901),b=h(7629),v=m(Function.toString);y(b.inspectSource)||(b.inspectSource=function(_){return v(_)}),S.exports=b.inspectSource},3709:function(S,M,h){var m=h(2839).match(/firefox\/(\d+)/i);S.exports=!!m&&+m[1]},3717:function(S,M){M.f=Object.getOwnPropertySymbols},3724:function(S,M,h){var m=h(9039);S.exports=!m((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}))},3763:function(S,M,h){var m=h(2839);S.exports=/MSIE|Trident/.test(m)},3792:function(S,M,h){var m=h(5397),y=h(6469),b=h(6269),v=h(1181),_=h(4913).f,C=h(1088),E=h(2529),A=h(6395),I=h(3724),K="Array Iterator",F=v.set,z=v.getterFor(K);S.exports=C(Array,"Array",(function($,U){F(this,{type:K,target:m($),index:0,kind:U})}),(function(){var $=z(this),U=$.target,H=$.index++;if(!U||H>=U.length)return $.target=null,E(void 0,!0);switch($.kind){case"keys":return E(H,!1);case"values":return E(U[H],!1)}return E([H,U[H]],!1)}),"values");var j=b.Arguments=b.Array;if(y("keys"),y("values"),y("entries"),!A&&I&&j.name!=="values")try{_(j,"name",{value:"values"})}catch{}},3802:function(S,M,h){var m=h(9504),y=h(7750),b=h(655),v=h(7452),_=m("".replace),C=RegExp("^["+v+"]+"),E=RegExp("(^|[^"+v+"])["+v+"]+$"),A=function(I){return function(K){var F=b(y(K));return 1&I&&(F=_(F,C,"")),2&I&&(F=_(F,E,"$1")),F}};S.exports={start:A(1),end:A(2),trim:A(3)}},3851:function(S,M,h){var m=h(6518),y=h(9039),b=h(5397),v=h(7347).f,_=h(3724);m({target:"Object",stat:!0,forced:!_||y((function(){v(1)})),sham:!_},{getOwnPropertyDescriptor:function(C,E){return v(b(C),E)}})},3925:function(S,M,h){var m=h(34);S.exports=function(y){return m(y)||y===null}},3994:function(S,M,h){var m=h(7657).IteratorPrototype,y=h(2360),b=h(6980),v=h(687),_=h(6269),C=function(){return this};S.exports=function(E,A,I,K){var F=A+" Iterator";return E.prototype=y(m,{next:b(+!K,I)}),v(E,F,!1,!0),_[F]=C,E}},4055:function(S,M,h){var m=h(4576),y=h(34),b=m.document,v=y(b)&&y(b.createElement);S.exports=function(_){return v?b.createElement(_):{}}},4117:function(S){S.exports=function(M){return M==null}},4209:function(S,M,h){var m=h(8227),y=h(6269),b=m("iterator"),v=Array.prototype;S.exports=function(_){return _!==void 0&&(y.Array===_||v[b]===_)}},4213:function(S,M,h){var m=h(3724),y=h(9504),b=h(9565),v=h(9039),_=h(1072),C=h(3717),E=h(8773),A=h(8981),I=h(7055),K=Object.assign,F=Object.defineProperty,z=y([].concat);S.exports=!K||v((function(){if(m&&K({b:1},K(F({},"a",{enumerable:!0,get:function(){F(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var j={},$={},U=Symbol("assign detection"),H="abcdefghijklmnopqrst";return j[U]=7,H.split("").forEach((function(J){$[J]=J})),K({},j)[U]!==7||_(K({},$)).join("")!==H}))?function(j,$){for(var U=A(j),H=arguments.length,J=1,Y=C.f,X=E.f;H>J;)for(var ie,te=I(arguments[J++]),Q=Y?z(_(te),Y(te)):_(te),ue=Q.length,fe=0;ue>fe;)ie=Q[fe++],m&&!b(X,te,ie)||(U[ie]=te[ie]);return U}:K},4215:function(S,M,h){var m=h(4576),y=h(2839),b=h(2195),v=function(_){return y.slice(0,_.length)===_};S.exports=v("Bun/")?"BUN":v("Cloudflare-Workers")?"CLOUDFLARE":v("Deno/")?"DENO":v("Node.js/")?"NODE":m.Bun&&typeof Bun.version=="string"?"BUN":m.Deno&&typeof Deno.version=="object"?"DENO":b(m.process)==="process"?"NODE":m.window&&m.document?"BROWSER":"REST"},4270:function(S,M,h){var m=h(9565),y=h(4901),b=h(34),v=TypeError;S.exports=function(_,C){var E,A;if(C==="string"&&y(E=_.toString)&&!b(A=m(E,_))||y(E=_.valueOf)&&!b(A=m(E,_))||C!=="string"&&y(E=_.toString)&&!b(A=m(E,_)))return A;throw new v("Can't convert object to primitive value")}},4376:function(S,M,h){var m=h(2195);S.exports=Array.isArray||function(y){return m(y)==="Array"}},4423:function(S,M,h){var m=h(6518),y=h(9617).includes,b=h(9039),v=h(6469);m({target:"Array",proto:!0,forced:b((function(){return!Array(1).includes()}))},{includes:function(_){return y(this,_,arguments.length>1?arguments[1]:void 0)}}),v("includes")},4428:function(S,M,h){var m=h(8227)("iterator"),y=!1;try{var b=0,v={next:function(){return{done:!!b++}},return:function(){y=!0}};v[m]=function(){return this},Array.from(v,(function(){throw 2}))}catch{}S.exports=function(_,C){try{if(!C&&!y)return!1}catch{return!1}var E=!1;try{var A={};A[m]=function(){return{next:function(){return{done:E=!0}}}},_(A)}catch{}return E}},4488:function(S,M,h){var m=h(7680),y=Math.floor,b=function(v,_){var C=v.length;if(C<8)for(var E,A,I=1;I<C;){for(A=I,E=v[I];A&&_(v[A-1],E)>0;)v[A]=v[--A];A!==I++&&(v[A]=E)}else for(var K=y(C/2),F=b(m(v,0,K),_),z=b(m(v,K),_),j=F.length,$=z.length,U=0,H=0;U<j||H<$;)v[U+H]=U<j&&H<$?_(F[U],z[H])<=0?F[U++]:z[H++]:U<j?F[U++]:z[H++];return v};S.exports=b},4495:function(S,M,h){var m=h(9519),y=h(9039),b=h(4576).String;S.exports=!!Object.getOwnPropertySymbols&&!y((function(){var v=Symbol("symbol detection");return!b(v)||!(Object(v)instanceof Symbol)||!Symbol.sham&&m&&m<41}))},4527:function(S,M,h){var m=h(3724),y=h(4376),b=TypeError,v=Object.getOwnPropertyDescriptor,_=m&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(C){return C instanceof TypeError}})();S.exports=_?function(C,E){if(y(C)&&!v(C,"length").writable)throw new b("Cannot set read only .length");return C.length=E}:function(C,E){return C.length=E}},4554:function(S,M,h){var m=h(6518),y=h(8981),b=h(5610),v=h(1291),_=h(6198),C=h(4527),E=h(6837),A=h(1469),I=h(4659),K=h(4606),F=h(597)("splice"),z=Math.max,j=Math.min;m({target:"Array",proto:!0,forced:!F},{splice:function($,U){var H,J,Y,X,ie,te,Q=y(this),ue=_(Q),fe=b($,ue),ne=arguments.length;for(ne===0?H=J=0:ne===1?(H=0,J=ue-fe):(H=ne-2,J=j(z(v(U),0),ue-fe)),E(ue+H-J),Y=A(Q,J),X=0;X<J;X++)(ie=fe+X)in Q&&I(Y,X,Q[ie]);if(Y.length=J,H<J){for(X=fe;X<ue-J;X++)te=X+H,(ie=X+J)in Q?Q[te]=Q[ie]:K(Q,te);for(X=ue;X>ue-J+H;X--)K(Q,X-1)}else if(H>J)for(X=ue-J;X>fe;X--)te=X+H-1,(ie=X+J-1)in Q?Q[te]=Q[ie]:K(Q,te);for(X=0;X<H;X++)Q[X+fe]=arguments[X+2];return C(Q,ue-J+H),Y}})},4576:function(S,M,h){var m=function(y){return y&&y.Math===Math&&y};S.exports=m(typeof globalThis=="object"&&globalThis)||m(typeof window=="object"&&window)||m(typeof self=="object"&&self)||m(typeof h.g=="object"&&h.g)||m(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()},4598:function(S,M,h){var m=h(9039);S.exports=function(y,b){var v=[][y];return!!v&&m((function(){v.call(null,b||function(){return 1},1)}))}},4606:function(S,M,h){var m=h(6823),y=TypeError;S.exports=function(b,v){if(!delete b[v])throw new y("Cannot delete property "+m(v)+" of "+m(b))}},4659:function(S,M,h){var m=h(3724),y=h(4913),b=h(6980);S.exports=function(v,_,C){m?y.f(v,_,b(0,C)):v[_]=C}},4782:function(S,M,h){var m=h(6518),y=h(4376),b=h(3517),v=h(34),_=h(5610),C=h(6198),E=h(5397),A=h(4659),I=h(8227),K=h(597),F=h(7680),z=K("slice"),j=I("species"),$=Array,U=Math.max;m({target:"Array",proto:!0,forced:!z},{slice:function(H,J){var Y,X,ie,te=E(this),Q=C(te),ue=_(H,Q),fe=_(J===void 0?Q:J,Q);if(y(te)&&(Y=te.constructor,(b(Y)&&(Y===$||y(Y.prototype))||v(Y)&&(Y=Y[j])===null)&&(Y=void 0),Y===$||Y===void 0))return F(te,ue,fe);for(X=new(Y===void 0?$:Y)(U(fe-ue,0)),ie=0;ue<fe;ue++,ie++)ue in te&&A(X,ie,te[ue]);return X.length=ie,X}})},4864:function(S,M,h){var m=h(3724),y=h(4576),b=h(9504),v=h(2796),_=h(3167),C=h(6699),E=h(2360),A=h(8480).f,I=h(1625),K=h(788),F=h(655),z=h(1034),j=h(8429),$=h(1056),U=h(6840),H=h(9039),J=h(9297),Y=h(1181).enforce,X=h(7633),ie=h(8227),te=h(3635),Q=h(8814),ue=ie("match"),fe=y.RegExp,ne=fe.prototype,Pe=y.SyntaxError,ke=b(ne.exec),Se=b("".charAt),st=b("".replace),tt=b("".indexOf),Me=b("".slice),je=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Oe=/a/g,Te=/a/g,Ie=new fe(Oe)!==Oe,Ve=j.MISSED_STICKY,ye=j.UNSUPPORTED_Y;if(v("RegExp",m&&(!Ie||Ve||te||Q||H((function(){return Te[ue]=!1,fe(Oe)!==Oe||fe(Te)===Te||String(fe(Oe,"i"))!=="/a/i"}))))){for(var we=function(Re,Ue){var xt,Rt,_t,un,Ln,jt,Zn=I(ne,this),tn=K(Re),Tn=Ue===void 0,Er=[],ni=Re;if(!Zn&&tn&&Tn&&Re.constructor===we)return Re;if((tn||I(ne,Re))&&(Re=Re.source,Tn&&(Ue=z(ni))),Re=Re===void 0?"":F(Re),Ue=Ue===void 0?"":F(Ue),ni=Re,te&&"dotAll"in Oe&&(Rt=!!Ue&&tt(Ue,"s")>-1)&&(Ue=st(Ue,/s/g,"")),xt=Ue,Ve&&"sticky"in Oe&&(_t=!!Ue&&tt(Ue,"y")>-1)&&ye&&(Ue=st(Ue,/y/g,"")),Q&&(un=(function(zt){for(var Et,ia=zt.length,nn=0,Qn="",er=[],ts=E(null),ri=!1,ii=!1,ns=0,Ar="";nn<=ia;nn++){if((Et=Se(zt,nn))==="\\")Et+=Se(zt,++nn);else if(Et==="]")ri=!1;else if(!ri)switch(!0){case Et==="[":ri=!0;break;case Et==="(":if(Qn+=Et,Me(zt,nn+1,nn+3)==="?:")continue;ke(je,Me(zt,nn+1))&&(nn+=2,ii=!0),ns++;continue;case(Et===">"&&ii):if(Ar===""||J(ts,Ar))throw new Pe("Invalid capture group name");ts[Ar]=!0,er[er.length]=[Ar,ns],ii=!1,Ar="";continue}ii?Ar+=Et:Qn+=Et}return[Qn,er]})(Re),Re=un[0],Er=un[1]),Ln=_(fe(Re,Ue),Zn?this:ne,we),(Rt||_t||Er.length)&&(jt=Y(Ln),Rt&&(jt.dotAll=!0,jt.raw=we((function(zt){for(var Et,ia=zt.length,nn=0,Qn="",er=!1;nn<=ia;nn++)(Et=Se(zt,nn))!=="\\"?er||Et!=="."?(Et==="["?er=!0:Et==="]"&&(er=!1),Qn+=Et):Qn+="[\\s\\S]":Qn+=Et+Se(zt,++nn);return Qn})(Re),xt)),_t&&(jt.sticky=!0),Er.length&&(jt.groups=Er)),Re!==ni)try{C(Ln,"source",ni===""?"(?:)":ni)}catch{}return Ln},_e=A(fe),Be=0;_e.length>Be;)$(we,fe,_e[Be++]);ne.constructor=we,we.prototype=ne,U(y,"RegExp",we,{constructor:!0})}X("RegExp")},4901:function(S){var M=typeof document=="object"&&document.all;S.exports=M===void 0&&M!==void 0?function(h){return typeof h=="function"||h===M}:function(h){return typeof h=="function"}},4913:function(S,M,h){var m=h(3724),y=h(5917),b=h(8686),v=h(8551),_=h(6969),C=TypeError,E=Object.defineProperty,A=Object.getOwnPropertyDescriptor,I="enumerable",K="configurable",F="writable";M.f=m?b?function(z,j,$){if(v(z),j=_(j),v($),typeof z=="function"&&j==="prototype"&&"value"in $&&F in $&&!$[F]){var U=A(z,j);U&&U[F]&&(z[j]=$.value,$={configurable:K in $?$[K]:U[K],enumerable:I in $?$[I]:U[I],writable:!1})}return E(z,j,$)}:E:function(z,j,$){if(v(z),j=_(j),v($),y)try{return E(z,j,$)}catch{}if("get"in $||"set"in $)throw new C("Accessors not supported");return"value"in $&&(z[j]=$.value),z}},5031:function(S,M,h){var m=h(7751),y=h(9504),b=h(8480),v=h(3717),_=h(8551),C=y([].concat);S.exports=m("Reflect","ownKeys")||function(E){var A=b.f(_(E)),I=v.f;return I?C(A,I(E)):A}},5213:function(S,M,h){var m=h(4576),y=h(9039),b=m.RegExp,v=!y((function(){var _=!0;try{b(".","d")}catch{_=!1}var C={},E="",A=_?"dgimsy":"gimsy",I=function(z,j){Object.defineProperty(C,z,{get:function(){return E+=j,!0}})},K={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var F in _&&(K.hasIndices="d"),K)I(F,K[F]);return Object.getOwnPropertyDescriptor(b.prototype,"flags").get.call(C)!==A||E!==A}));S.exports={correct:v}},5276:function(S,M,h){var m=h(6518),y=h(7476),b=h(9617).indexOf,v=h(4598),_=y([].indexOf),C=!!_&&1/_([1],1,-0)<0;m({target:"Array",proto:!0,forced:C||!v("indexOf")},{indexOf:function(E){var A=arguments.length>1?arguments[1]:void 0;return C?_(this,E,A)||0:b(this,E,A)}})},5397:function(S,M,h){var m=h(7055),y=h(7750);S.exports=function(b){return m(y(b))}},5440:function(S,M,h){var m=h(8745),y=h(9565),b=h(9504),v=h(9228),_=h(9039),C=h(8551),E=h(4901),A=h(34),I=h(1291),K=h(8014),F=h(655),z=h(7750),j=h(7829),$=h(5966),U=h(2478),H=h(1034),J=h(6682),Y=h(8227)("replace"),X=Math.max,ie=Math.min,te=b([].concat),Q=b([].push),ue=b("".indexOf),fe=b("".slice),ne="a".replace(/./,"$0")==="$0",Pe=!!/./[Y]&&/./[Y]("a","$0")==="";v("replace",(function(ke,Se,st){var tt=Pe?"$":"$0";return[function(Me,je){var Oe=z(this),Te=A(Me)?$(Me,Y):void 0;return Te?y(Te,Me,Oe,je):y(Se,F(Oe),Me,je)},function(Me,je){var Oe=C(this),Te=F(Me);if(typeof je=="string"&&ue(je,tt)===-1&&ue(je,"$<")===-1){var Ie=st(Se,Oe,Te,je);if(Ie.done)return Ie.value}var Ve=E(je);Ve||(je=F(je));var ye,we=F(H(Oe)),_e=ue(we,"g")!==-1;_e&&(ye=ue(we,"u")!==-1,Oe.lastIndex=0);for(var Be,Re=[];(Be=J(Oe,Te))!==null&&(Q(Re,Be),_e);)F(Be[0])===""&&(Oe.lastIndex=j(Te,K(Oe.lastIndex),ye));for(var Ue,xt="",Rt=0,_t=0;_t<Re.length;_t++){for(var un,Ln=F((Be=Re[_t])[0]),jt=X(ie(I(Be.index),Te.length),0),Zn=[],tn=1;tn<Be.length;tn++)Q(Zn,(Ue=Be[tn])===void 0?Ue:String(Ue));var Tn=Be.groups;if(Ve){var Er=te([Ln],Zn,jt,Te);Tn!==void 0&&Q(Er,Tn),un=F(m(je,void 0,Er))}else un=U(Ln,Te,jt,Zn,Tn,je);jt>=Rt&&(xt+=fe(Te,Rt,jt)+un,Rt=jt+Ln.length)}return xt+fe(Te,Rt)}]}),!!_((function(){var ke=/./;return ke.exec=function(){var Se=[];return Se.groups={a:"7"},Se},"".replace(ke,"$<a>")!=="7"}))||!ne||Pe)},5548:function(S,M,h){var m=h(3517),y=h(6823),b=TypeError;S.exports=function(v){if(m(v))return v;throw new b(y(v)+" is not a constructor")}},5610:function(S,M,h){var m=h(1291),y=Math.max,b=Math.min;S.exports=function(v,_){var C=m(v);return C<0?y(C+_,0):b(C,_)}},5700:function(S,M,h){var m=h(511),y=h(8242);m("toPrimitive"),y()},5745:function(S,M,h){var m=h(7629);S.exports=function(y,b){return m[y]||(m[y]=b||{})}},5749:function(S,M,h){var m=h(788),y=TypeError;S.exports=function(b){if(m(b))throw new y("The method doesn't accept regular expressions");return b}},5810:function(S,M,h){var m=h(34),y=h(1181).get;S.exports=function(b){if(!m(b))return!1;var v=y(b);return!!v&&v.type==="RawJSON"}},5917:function(S,M,h){var m=h(3724),y=h(9039),b=h(4055);S.exports=!m&&!y((function(){return Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a!==7}))},5966:function(S,M,h){var m=h(9306),y=h(4117);S.exports=function(b,v){var _=b[v];return y(_)?void 0:m(_)}},6080:function(S,M,h){var m=h(7476),y=h(9306),b=h(616),v=m(m.bind);S.exports=function(_,C){return y(_),C===void 0?_:b?v(_,C):function(){return _.apply(C,arguments)}}},6099:function(S,M,h){var m=h(2140),y=h(6840),b=h(3179);m||y(Object.prototype,"toString",b,{unsafe:!0})},6119:function(S,M,h){var m=h(5745),y=h(3392),b=m("keys");S.exports=function(v){return b[v]||(b[v]=y(v))}},6193:function(S,M,h){var m=h(4215);S.exports=m==="NODE"},6198:function(S,M,h){var m=h(8014);S.exports=function(y){return m(y.length)}},6269:function(S){S.exports={}},6319:function(S,M,h){var m=h(8551),y=h(9539);S.exports=function(b,v,_,C){try{return C?v(m(_)[0],_[1]):v(_)}catch(E){y(b,"throw",E)}}},6395:function(S){S.exports=!1},6469:function(S,M,h){var m=h(8227),y=h(2360),b=h(4913).f,v=m("unscopables"),_=Array.prototype;_[v]===void 0&&b(_,v,{configurable:!0,value:y(null)}),S.exports=function(C){_[v][C]=!0}},6518:function(S,M,h){var m=h(4576),y=h(7347).f,b=h(6699),v=h(6840),_=h(9433),C=h(7740),E=h(2796);S.exports=function(A,I){var K,F,z,j,$,U=A.target,H=A.global,J=A.stat;if(K=H?m:J?m[U]||_(U,{}):m[U]&&m[U].prototype)for(F in I){if(j=I[F],z=A.dontCallGetSet?($=y(K,F))&&$.value:K[F],!E(H?F:U+(J?".":"#")+F,A.forced)&&z!==void 0){if(typeof j==typeof z)continue;C(j,z)}(A.sham||z&&z.sham)&&b(j,"sham",!0),v(K,F,j,A)}}},6682:function(S,M,h){var m=h(9565),y=h(8551),b=h(4901),v=h(2195),_=h(7323),C=TypeError;S.exports=function(E,A){var I=E.exec;if(b(I)){var K=m(I,E,A);return K!==null&&y(K),K}if(v(E)==="RegExp")return m(_,E,A);throw new C("RegExp#exec called on incompatible receiver")}},6699:function(S,M,h){var m=h(3724),y=h(4913),b=h(6980);S.exports=m?function(v,_,C){return y.f(v,_,b(1,C))}:function(v,_,C){return v[_]=C,v}},6706:function(S,M,h){var m=h(9504),y=h(9306);S.exports=function(b,v,_){try{return m(y(Object.getOwnPropertyDescriptor(b,v)[_]))}catch{}}},6761:function(S,M,h){var m=h(6518),y=h(4576),b=h(9565),v=h(9504),_=h(6395),C=h(3724),E=h(4495),A=h(9039),I=h(9297),K=h(1625),F=h(8551),z=h(5397),j=h(6969),$=h(655),U=h(6980),H=h(2360),J=h(1072),Y=h(8480),X=h(298),ie=h(3717),te=h(7347),Q=h(4913),ue=h(6801),fe=h(8773),ne=h(6840),Pe=h(2106),ke=h(5745),Se=h(6119),st=h(421),tt=h(3392),Me=h(8227),je=h(1951),Oe=h(511),Te=h(8242),Ie=h(687),Ve=h(1181),ye=h(9213).forEach,we=Se("hidden"),_e="Symbol",Be="prototype",Re=Ve.set,Ue=Ve.getterFor(_e),xt=Object[Be],Rt=y.Symbol,_t=Rt&&Rt[Be],un=y.RangeError,Ln=y.TypeError,jt=y.QObject,Zn=te.f,tn=Q.f,Tn=X.f,Er=fe.f,ni=v([].push),zt=ke("symbols"),Et=ke("op-symbols"),ia=ke("wks"),nn=!jt||!jt[Be]||!jt[Be].findChild,Qn=function(Je,Qe,nt){var ft=Zn(xt,Qe);ft&&delete xt[Qe],tn(Je,Qe,nt),ft&&Je!==xt&&tn(xt,Qe,ft)},er=C&&A((function(){return H(tn({},"a",{get:function(){return tn(this,"a",{value:7}).a}})).a!==7}))?Qn:tn,ts=function(Je,Qe){var nt=zt[Je]=H(_t);return Re(nt,{type:_e,tag:Je,description:Qe}),C||(nt.description=Qe),nt},ri=function(Je,Qe,nt){Je===xt&&ri(Et,Qe,nt),F(Je);var ft=j(Qe);return F(nt),I(zt,ft)?(nt.enumerable?(I(Je,we)&&Je[we][ft]&&(Je[we][ft]=!1),nt=H(nt,{enumerable:U(0,!1)})):(I(Je,we)||tn(Je,we,U(1,H(null))),Je[we][ft]=!0),er(Je,ft,nt)):tn(Je,ft,nt)},ii=function(Je,Qe){F(Je);var nt=z(Qe),ft=J(nt).concat(g0(nt));return ye(ft,(function(Jt){C&&!b(ns,nt,Jt)||ri(Je,Jt,nt[Jt])})),Je},ns=function(Je){var Qe=j(Je),nt=b(Er,this,Qe);return!(this===xt&&I(zt,Qe)&&!I(Et,Qe))&&(!(nt||!I(this,Qe)||!I(zt,Qe)||I(this,we)&&this[we][Qe])||nt)},Ar=function(Je,Qe){var nt=z(Je),ft=j(Qe);if(nt!==xt||!I(zt,ft)||I(Et,ft)){var Jt=Zn(nt,ft);return!Jt||!I(zt,ft)||I(nt,we)&&nt[we][ft]||(Jt.enumerable=!0),Jt}},m0=function(Je){var Qe=Tn(z(Je)),nt=[];return ye(Qe,(function(ft){I(zt,ft)||I(st,ft)||ni(nt,ft)})),nt},g0=function(Je){var Qe=Je===xt,nt=Tn(Qe?Et:z(Je)),ft=[];return ye(nt,(function(Jt){!I(zt,Jt)||Qe&&!I(xt,Jt)||ni(ft,zt[Jt])})),ft};E||(Rt=function(){if(K(_t,this))throw new Ln("Symbol is not a constructor");var Je=arguments.length&&arguments[0]!==void 0?$(arguments[0]):void 0,Qe=tt(Je),nt=function(ft){var Jt=this===void 0?y:this;Jt===xt&&b(nt,Et,ft),I(Jt,we)&&I(Jt[we],Qe)&&(Jt[we][Qe]=!1);var y0=U(1,ft);try{er(Jt,Qe,y0)}catch(b0){if(!(b0 instanceof un))throw b0;Qn(Jt,Qe,y0)}};return C&&nn&&er(xt,Qe,{configurable:!0,set:nt}),ts(Qe,Je)},ne(_t=Rt[Be],"toString",(function(){return Ue(this).tag})),ne(Rt,"withoutSetter",(function(Je){return ts(tt(Je),Je)})),fe.f=ns,Q.f=ri,ue.f=ii,te.f=Ar,Y.f=X.f=m0,ie.f=g0,je.f=function(Je){return ts(Me(Je),Je)},C&&(Pe(_t,"description",{configurable:!0,get:function(){return Ue(this).description}}),_||ne(xt,"propertyIsEnumerable",ns,{unsafe:!0}))),m({global:!0,constructor:!0,wrap:!0,forced:!E,sham:!E},{Symbol:Rt}),ye(J(ia),(function(Je){Oe(Je)})),m({target:_e,stat:!0,forced:!E},{useSetter:function(){nn=!0},useSimple:function(){nn=!1}}),m({target:"Object",stat:!0,forced:!E,sham:!C},{create:function(Je,Qe){return Qe===void 0?H(Je):ii(H(Je),Qe)},defineProperty:ri,defineProperties:ii,getOwnPropertyDescriptor:Ar}),m({target:"Object",stat:!0,forced:!E},{getOwnPropertyNames:m0}),Te(),Ie(Rt,_e),st[we]=!0},6801:function(S,M,h){var m=h(3724),y=h(8686),b=h(4913),v=h(8551),_=h(5397),C=h(1072);M.f=m&&!y?Object.defineProperties:function(E,A){v(E);for(var I,K=_(A),F=C(A),z=F.length,j=0;z>j;)b.f(E,I=F[j++],K[I]);return E}},6823:function(S){var M=String;S.exports=function(h){try{return M(h)}catch{return"Object"}}},6837:function(S){var M=TypeError;S.exports=function(h){if(h>9007199254740991)throw M("Maximum allowed index exceeded");return h}},6840:function(S,M,h){var m=h(4901),y=h(4913),b=h(283),v=h(9433);S.exports=function(_,C,E,A){A||(A={});var I=A.enumerable,K=A.name!==void 0?A.name:C;if(m(E)&&b(E,K,A),A.global)I?_[C]=E:v(C,E);else{try{A.unsafe?_[C]&&(I=!0):delete _[C]}catch{}I?_[C]=E:y.f(_,C,{value:E,enumerable:!1,configurable:!A.nonConfigurable,writable:!A.nonWritable})}return _}},6910:function(S,M,h){var m=h(6518),y=h(9504),b=h(9306),v=h(8981),_=h(6198),C=h(4606),E=h(655),A=h(9039),I=h(4488),K=h(4598),F=h(3709),z=h(3763),j=h(9519),$=h(3607),U=[],H=y(U.sort),J=y(U.push),Y=A((function(){U.sort(void 0)})),X=A((function(){U.sort(null)})),ie=K("sort"),te=!A((function(){if(j)return j<70;if(!(F&&F>3)){if(z)return!0;if($)return $<603;var Q,ue,fe,ne,Pe="";for(Q=65;Q<76;Q++){switch(ue=String.fromCharCode(Q),Q){case 66:case 69:case 70:case 72:fe=3;break;case 68:case 71:fe=4;break;default:fe=2}for(ne=0;ne<47;ne++)U.push({k:ue+ne,v:fe})}for(U.sort((function(ke,Se){return Se.v-ke.v})),ne=0;ne<U.length;ne++)ue=U[ne].k.charAt(0),Pe.charAt(Pe.length-1)!==ue&&(Pe+=ue);return Pe!=="DGBEFHACIJK"}}));m({target:"Array",proto:!0,forced:Y||!X||!ie||!te},{sort:function(Q){Q!==void 0&&b(Q);var ue=v(this);if(te)return Q===void 0?H(ue):H(ue,Q);var fe,ne,Pe=[],ke=_(ue);for(ne=0;ne<ke;ne++)ne in ue&&J(Pe,ue[ne]);for(I(Pe,(function(Se){return function(st,tt){return tt===void 0?-1:st===void 0?1:Se!==void 0?+Se(st,tt)||0:E(st)>E(tt)?1:-1}})(Q)),fe=_(Pe),ne=0;ne<fe;)ue[ne]=Pe[ne++];for(;ne<ke;)C(ue,ne++);return ue}})},6955:function(S,M,h){var m=h(2140),y=h(4901),b=h(2195),v=h(8227)("toStringTag"),_=Object,C=b((function(){return arguments})())==="Arguments";S.exports=m?b:function(E){var A,I,K;return E===void 0?"Undefined":E===null?"Null":typeof(I=(function(F,z){try{return F[z]}catch{}})(A=_(E),v))=="string"?I:C?b(A):(K=b(A))==="Object"&&y(A.callee)?"Arguments":K}},6969:function(S,M,h){var m=h(2777),y=h(757);S.exports=function(b){var v=m(b,"string");return y(v)?v:v+""}},6980:function(S){S.exports=function(M,h){return{enumerable:!(1&M),configurable:!(2&M),writable:!(4&M),value:h}}},7040:function(S,M,h){var m=h(4495);S.exports=m&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:function(S,M,h){var m=h(9504),y=h(9039),b=h(2195),v=Object,_=m("".split);S.exports=y((function(){return!v("z").propertyIsEnumerable(0)}))?function(C){return b(C)==="String"?_(C,""):v(C)}:v},7323:function(S,M,h){var m,y,b=h(9565),v=h(9504),_=h(655),C=h(7979),E=h(8429),A=h(5745),I=h(2360),K=h(1181).get,F=h(3635),z=h(8814),j=A("native-string-replace",String.prototype.replace),$=RegExp.prototype.exec,U=$,H=v("".charAt),J=v("".indexOf),Y=v("".replace),X=v("".slice),ie=(y=/b*/g,b($,m=/a/,"a"),b($,y,"a"),m.lastIndex!==0||y.lastIndex!==0),te=E.BROKEN_CARET,Q=/()??/.exec("")[1]!==void 0;(ie||Q||te||F||z)&&(U=function(ue){var fe,ne,Pe,ke,Se,st,tt,Me=this,je=K(Me),Oe=_(ue),Te=je.raw;if(Te)return Te.lastIndex=Me.lastIndex,fe=b(U,Te,Oe),Me.lastIndex=Te.lastIndex,fe;var Ie=je.groups,Ve=te&&Me.sticky,ye=b(C,Me),we=Me.source,_e=0,Be=Oe;if(Ve&&(ye=Y(ye,"y",""),J(ye,"g")===-1&&(ye+="g"),Be=X(Oe,Me.lastIndex),Me.lastIndex>0&&(!Me.multiline||Me.multiline&&H(Oe,Me.lastIndex-1)!==`
`)&&(we="(?: "+we+")",Be=" "+Be,_e++),ne=new RegExp("^(?:"+we+")",ye)),Q&&(ne=new RegExp("^"+we+"$(?!\\s)",ye)),ie&&(Pe=Me.lastIndex),ke=b($,Ve?ne:Me,Be),Ve?ke?(ke.input=X(ke.input,_e),ke[0]=X(ke[0],_e),ke.index=Me.lastIndex,Me.lastIndex+=ke[0].length):Me.lastIndex=0:ie&&ke&&(Me.lastIndex=Me.global?ke.index+ke[0].length:Pe),Q&&ke&&ke.length>1&&b(j,ke[0],ne,(function(){for(Se=1;Se<arguments.length-2;Se++)arguments[Se]===void 0&&(ke[Se]=void 0)})),ke&&Ie)for(ke.groups=st=I(null),Se=0;Se<Ie.length;Se++)st[(tt=Ie[Se])[0]]=ke[tt[1]];return ke}),S.exports=U},7347:function(S,M,h){var m=h(3724),y=h(9565),b=h(8773),v=h(6980),_=h(5397),C=h(6969),E=h(9297),A=h(5917),I=Object.getOwnPropertyDescriptor;M.f=m?I:function(K,F){if(K=_(K),F=C(F),A)try{return I(K,F)}catch{}if(E(K,F))return v(!y(b.f,K,F),K[F])}},7400:function(S){S.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7427:function(S,M,h){var m=h(6518),y=h(3724),b=h(2551),v=h(9306),_=h(8981),C=h(4913);y&&m({target:"Object",proto:!0,forced:b},{__defineGetter__:function(E,A){C.f(_(this),E,{get:v(A),enumerable:!0,configurable:!0})}})},7433:function(S,M,h){var m=h(4376),y=h(3517),b=h(34),v=h(8227)("species"),_=Array;S.exports=function(C){var E;return m(C)&&(E=C.constructor,(y(E)&&(E===_||m(E.prototype))||b(E)&&(E=E[v])===null)&&(E=void 0)),E===void 0?_:E}},7452:function(S){S.exports=`	
\v\f\r \u2028\u2029\uFEFF`},7476:function(S,M,h){var m=h(2195),y=h(9504);S.exports=function(b){if(m(b)==="Function")return y(b)}},7495:function(S,M,h){var m=h(6518),y=h(7323);m({target:"RegExp",proto:!0,forced:/./.exec!==y},{exec:y})},7629:function(S,M,h){var m=h(6395),y=h(4576),b=h(9433),v="__core-js_shared__",_=S.exports=y[v]||b(v,{});(_.versions||(_.versions=[])).push({version:"3.47.0",mode:m?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:function(S,M,h){var m=h(7751),y=h(2106),b=h(8227),v=h(3724),_=b("species");S.exports=function(C){var E=m(C);v&&E&&!E[_]&&y(E,_,{configurable:!0,get:function(){return this}})}},7657:function(S,M,h){var m,y,b,v=h(9039),_=h(4901),C=h(34),E=h(2360),A=h(2787),I=h(6840),K=h(8227),F=h(6395),z=K("iterator"),j=!1;[].keys&&("next"in(b=[].keys())?(y=A(A(b)))!==Object.prototype&&(m=y):j=!0),!C(m)||v((function(){var $={};return m[z].call($)!==$}))?m={}:F&&(m=E(m)),_(m[z])||I(m,z,(function(){return this})),S.exports={IteratorPrototype:m,BUGGY_SAFARI_ITERATORS:j}},7680:function(S,M,h){var m=h(9504);S.exports=m([].slice)},7740:function(S,M,h){var m=h(9297),y=h(5031),b=h(7347),v=h(4913);S.exports=function(_,C,E){for(var A=y(C),I=v.f,K=b.f,F=0;F<A.length;F++){var z=A[F];m(_,z)||E&&m(E,z)||I(_,z,K(C,z))}}},7750:function(S,M,h){var m=h(4117),y=TypeError;S.exports=function(b){if(m(b))throw new y("Can't call method on "+b);return b}},7751:function(S,M,h){var m=h(4576),y=h(4901);S.exports=function(b,v){return arguments.length<2?(_=m[b],y(_)?_:void 0):m[b]&&m[b][v];var _}},7764:function(S,M,h){var m=h(8183).charAt,y=h(655),b=h(1181),v=h(1088),_=h(2529),C="String Iterator",E=b.set,A=b.getterFor(C);v(String,"String",(function(I){E(this,{type:C,string:y(I),index:0})}),(function(){var I,K=A(this),F=K.string,z=K.index;return z>=F.length?_(void 0,!0):(I=m(F,z),K.index+=I.length,_(I,!1))}))},7812:function(S,M,h){var m=h(6518),y=h(9297),b=h(757),v=h(6823),_=h(5745),C=h(1296),E=_("symbol-to-string-registry");m({target:"Symbol",stat:!0,forced:!C},{keyFor:function(A){if(!b(A))throw new TypeError(v(A)+" is not a symbol");if(y(E,A))return E[A]}})},7819:function(S,M,h){var m=h(9039);S.exports=!m((function(){var y="9007199254740993",b=JSON.rawJSON(y);return!JSON.isRawJSON(b)||JSON.stringify(b)!==y}))},7829:function(S,M,h){var m=h(8183).charAt;S.exports=function(y,b,v){return b+(v?m(y,b).length:1)}},7916:function(S,M,h){var m=h(6080),y=h(9565),b=h(8981),v=h(6319),_=h(4209),C=h(3517),E=h(6198),A=h(4659),I=h(81),K=h(851),F=Array;S.exports=function(z){var j=b(z),$=C(this),U=arguments.length,H=U>1?arguments[1]:void 0,J=H!==void 0;J&&(H=m(H,U>2?arguments[2]:void 0));var Y,X,ie,te,Q,ue,fe=K(j),ne=0;if(!fe||this===F&&_(fe))for(Y=E(j),X=$?new this(Y):F(Y);Y>ne;ne++)ue=J?H(j[ne],ne):j[ne],A(X,ne,ue);else for(X=$?new this:[],Q=(te=I(j,fe)).next;!(ie=y(Q,te)).done;ne++)ue=J?v(te,H,[ie.value,ne],!0):ie.value,A(X,ne,ue);return X.length=ne,X}},7979:function(S,M,h){var m=h(8551);S.exports=function(){var y=m(this),b="";return y.hasIndices&&(b+="d"),y.global&&(b+="g"),y.ignoreCase&&(b+="i"),y.multiline&&(b+="m"),y.dotAll&&(b+="s"),y.unicode&&(b+="u"),y.unicodeSets&&(b+="v"),y.sticky&&(b+="y"),b}},8014:function(S,M,h){var m=h(1291),y=Math.min;S.exports=function(b){var v=m(b);return v>0?y(v,9007199254740991):0}},8183:function(S,M,h){var m=h(9504),y=h(1291),b=h(655),v=h(7750),_=m("".charAt),C=m("".charCodeAt),E=m("".slice),A=function(I){return function(K,F){var z,j,$=b(v(K)),U=y(F),H=$.length;return U<0||U>=H?I?"":void 0:(z=C($,U))<55296||z>56319||U+1===H||(j=C($,U+1))<56320||j>57343?I?_($,U):z:I?E($,U,U+2):j-56320+(z-55296<<10)+65536}};S.exports={codeAt:A(!1),charAt:A(!0)}},8227:function(S,M,h){var m=h(4576),y=h(5745),b=h(9297),v=h(3392),_=h(4495),C=h(7040),E=m.Symbol,A=y("wks"),I=C?E.for||E:E&&E.withoutSetter||v;S.exports=function(K){return b(A,K)||(A[K]=_&&b(E,K)?E[K]:I("Symbol."+K)),A[K]}},8235:function(S,M,h){var m=h(9504),y=h(9297),b=SyntaxError,v=parseInt,_=String.fromCharCode,C=m("".charAt),E=m("".slice),A=m(/./.exec),I={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},K=/^[\da-f]{4}$/i,F=/^[\u0000-\u001F]$/;S.exports=function(z,j){for(var $=!0,U="";j<z.length;){var H=C(z,j);if(H==="\\"){var J=E(z,j,j+2);if(y(I,J))U+=I[J],j+=2;else{if(J!=="\\u")throw new b('Unknown escape sequence: "'+J+'"');var Y=E(z,j+=2,j+4);if(!A(K,Y))throw new b("Bad Unicode escape at: "+j);U+=_(v(Y,16)),j+=4}}else{if(H==='"'){$=!1,j++;break}if(A(F,H))throw new b("Bad control character in string literal at: "+j);U+=H,j++}}if($)throw new b("Unterminated string at: "+j);return{value:U,end:j}}},8242:function(S,M,h){var m=h(9565),y=h(7751),b=h(8227),v=h(6840);S.exports=function(){var _=y("Symbol"),C=_&&_.prototype,E=C&&C.valueOf,A=b("toPrimitive");C&&!C[A]&&v(C,A,(function(I){return m(E,this)}),{arity:1})}},8344:function(S,M,h){h(8543)},8429:function(S,M,h){var m=h(9039),y=h(4576).RegExp,b=m((function(){var C=y("a","y");return C.lastIndex=2,C.exec("abcd")!==null})),v=b||m((function(){return!y("a","y").sticky})),_=b||m((function(){var C=y("^r","gy");return C.lastIndex=2,C.exec("str")!==null}));S.exports={BROKEN_CARET:_,MISSED_STICKY:v,UNSUPPORTED_Y:b}},8480:function(S,M,h){var m=h(1828),y=h(8727).concat("length","prototype");M.f=Object.getOwnPropertyNames||function(b){return m(b,y)}},8543:function(S,M,h){var m=h(6518),y=h(9565),b=h(7476),v=h(3994),_=h(2529),C=h(7750),E=h(8014),A=h(655),I=h(8551),K=h(34),F=h(2195),z=h(788),j=h(1034),$=h(5966),U=h(6840),H=h(9039),J=h(8227),Y=h(2293),X=h(7829),ie=h(6682),te=h(1181),Q=h(6395),ue=J("matchAll"),fe="RegExp String",ne=fe+" Iterator",Pe=te.set,ke=te.getterFor(ne),Se=RegExp.prototype,st=TypeError,tt=b("".indexOf),Me=b("".matchAll),je=!!Me&&!H((function(){Me("a",/./)})),Oe=v((function(Ie,Ve,ye,we){Pe(this,{type:ne,regexp:Ie,string:Ve,global:ye,unicode:we,done:!1})}),fe,(function(){var Ie=ke(this);if(Ie.done)return _(void 0,!0);var Ve=Ie.regexp,ye=Ie.string,we=ie(Ve,ye);return we===null?(Ie.done=!0,_(void 0,!0)):Ie.global?(A(we[0])===""&&(Ve.lastIndex=X(ye,E(Ve.lastIndex),Ie.unicode)),_(we,!1)):(Ie.done=!0,_(we,!1))})),Te=function(Ie){var Ve,ye,we,_e=I(this),Be=A(Ie),Re=Y(_e,RegExp),Ue=A(j(_e));return Ve=new Re(Re===RegExp?_e.source:_e,Ue),ye=!!~tt(Ue,"g"),we=!!~tt(Ue,"u"),Ve.lastIndex=E(_e.lastIndex),new Oe(Ve,Be,ye,we)};m({target:"String",proto:!0,forced:je},{matchAll:function(Ie){var Ve,ye,we,_e,Be=C(this);if(K(Ie)){if(z(Ie)&&(Ve=A(C(j(Ie))),!~tt(Ve,"g")))throw new st("`.matchAll` does not allow non-global regexes");if(je)return Me(Be,Ie);if((we=$(Ie,ue))===void 0&&Q&&F(Ie)==="RegExp"&&(we=Te),we)return y(we,Ie,Be)}else if(je)return Me(Be,Ie);return ye=A(Be),_e=new RegExp(Ie,"g"),Q?y(Te,_e,ye):_e[ue](ye)}}),Q||ue in Se||U(Se,ue,Te)},8551:function(S,M,h){var m=h(34),y=String,b=TypeError;S.exports=function(v){if(m(v))return v;throw new b(y(v)+" is not an object")}},8598:function(S,M,h){var m=h(6518),y=h(9504),b=h(7055),v=h(5397),_=h(4598),C=y([].join);m({target:"Array",proto:!0,forced:b!==Object||!_("join",",")},{join:function(E){return C(v(this),E===void 0?",":E)}})},8622:function(S,M,h){var m=h(4576),y=h(4901),b=m.WeakMap;S.exports=y(b)&&/native code/.test(String(b))},8686:function(S,M,h){var m=h(3724),y=h(9039);S.exports=m&&y((function(){return Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype!==42}))},8706:function(S,M,h){var m=h(6518),y=h(9039),b=h(4376),v=h(34),_=h(8981),C=h(6198),E=h(6837),A=h(4659),I=h(1469),K=h(597),F=h(8227),z=h(9519),j=F("isConcatSpreadable"),$=z>=51||!y((function(){var H=[];return H[j]=!1,H.concat()[0]!==H})),U=function(H){if(!v(H))return!1;var J=H[j];return J!==void 0?!!J:b(H)};m({target:"Array",proto:!0,arity:1,forced:!$||!K("concat")},{concat:function(H){var J,Y,X,ie,te,Q=_(this),ue=I(Q,0),fe=0;for(J=-1,X=arguments.length;J<X;J++)if(U(te=J===-1?Q:arguments[J]))for(ie=C(te),E(fe+ie),Y=0;Y<ie;Y++,fe++)Y in te&&A(ue,fe,te[Y]);else E(fe+1),A(ue,fe++,te);return ue.length=fe,ue}})},8727:function(S){S.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(S,M,h){var m=h(616),y=Function.prototype,b=y.apply,v=y.call;S.exports=typeof Reflect=="object"&&Reflect.apply||(m?v.bind(b):function(){return v.apply(b,arguments)})},8773:function(S,M){var h={}.propertyIsEnumerable,m=Object.getOwnPropertyDescriptor,y=m&&!h.call({1:2},1);M.f=y?function(b){var v=m(this,b);return!!v&&v.enumerable}:h},8781:function(S,M,h){var m=h(350).PROPER,y=h(6840),b=h(8551),v=h(655),_=h(9039),C=h(1034),E="toString",A=RegExp.prototype,I=A[E],K=_((function(){return I.call({source:"a",flags:"b"})!=="/a/b"})),F=m&&I.name!==E;(K||F)&&y(A,E,(function(){var z=b(this);return"/"+v(z.source)+"/"+v(C(z))}),{unsafe:!0})},8814:function(S,M,h){var m=h(9039),y=h(4576).RegExp;S.exports=m((function(){var b=y("(?<a>b)","g");return b.exec("b").groups.a!=="b"||"b".replace(b,"$<a>c")!=="bc"}))},8981:function(S,M,h){var m=h(7750),y=Object;S.exports=function(b){return y(m(b))}},9039:function(S){S.exports=function(M){try{return!!M()}catch{return!0}}},9085:function(S,M,h){var m=h(6518),y=h(4213);m({target:"Object",stat:!0,arity:2,forced:Object.assign!==y},{assign:y})},9167:function(S,M,h){var m=h(4576);S.exports=m},9213:function(S,M,h){var m=h(6080),y=h(9504),b=h(7055),v=h(8981),_=h(6198),C=h(1469),E=y([].push),A=function(I){var K=I===1,F=I===2,z=I===3,j=I===4,$=I===6,U=I===7,H=I===5||$;return function(J,Y,X,ie){for(var te,Q,ue=v(J),fe=b(ue),ne=_(fe),Pe=m(Y,X),ke=0,Se=ie||C,st=K?Se(J,ne):F||U?Se(J,0):void 0;ne>ke;ke++)if((H||ke in fe)&&(Q=Pe(te=fe[ke],ke,ue),I))if(K)st[ke]=Q;else if(Q)switch(I){case 3:return!0;case 5:return te;case 6:return ke;case 2:E(st,te)}else switch(I){case 4:return!1;case 7:E(st,te)}return $?-1:z||j?j:st}};S.exports={forEach:A(0),map:A(1),filter:A(2),some:A(3),every:A(4),find:A(5),findIndex:A(6),filterReject:A(7)}},9228:function(S,M,h){h(7495);var m=h(9565),y=h(6840),b=h(7323),v=h(9039),_=h(8227),C=h(6699),E=_("species"),A=RegExp.prototype;S.exports=function(I,K,F,z){var j=_(I),$=!v((function(){var Y={};return Y[j]=function(){return 7},""[I](Y)!==7})),U=$&&!v((function(){var Y=!1,X=/a/;if(I==="split"){var ie={};ie[E]=function(){return X},(X={constructor:ie,flags:""})[j]=/./[j]}return X.exec=function(){return Y=!0,null},X[j](""),!Y}));if(!$||!U||F){var H=/./[j],J=K(j,""[I],(function(Y,X,ie,te,Q){var ue=X.exec;return ue===b||ue===A.exec?$&&!Q?{done:!0,value:m(H,X,ie,te)}:{done:!0,value:m(Y,ie,X,te)}:{done:!1}}));y(String.prototype,I,J[0]),y(A,j,J[1])}z&&C(A[j],"sham",!0)}},9296:function(S,M,h){var m=h(4055)("span").classList,y=m&&m.constructor&&m.constructor.prototype;S.exports=y===Object.prototype?void 0:y},9297:function(S,M,h){var m=h(9504),y=h(8981),b=m({}.hasOwnProperty);S.exports=Object.hasOwn||function(v,_){return b(y(v),_)}},9306:function(S,M,h){var m=h(4901),y=h(6823),b=TypeError;S.exports=function(v){if(m(v))return v;throw new b(y(v)+" is not a function")}},9432:function(S,M,h){var m=h(6518),y=h(8981),b=h(1072);m({target:"Object",stat:!0,forced:h(9039)((function(){b(1)}))},{keys:function(v){return b(y(v))}})},9433:function(S,M,h){var m=h(4576),y=Object.defineProperty;S.exports=function(b,v){try{y(m,b,{value:v,configurable:!0,writable:!0})}catch{m[b]=v}return v}},9463:function(S,M,h){var m=h(6518),y=h(3724),b=h(4576),v=h(9504),_=h(9297),C=h(4901),E=h(1625),A=h(655),I=h(2106),K=h(7740),F=b.Symbol,z=F&&F.prototype;if(y&&C(F)&&(!("description"in z)||F().description!==void 0)){var j={},$=function(){var te=arguments.length<1||arguments[0]===void 0?void 0:A(arguments[0]),Q=E(z,this)?new F(te):te===void 0?F():F(te);return te===""&&(j[Q]=!0),Q};K($,F),$.prototype=z,z.constructor=$;var U=String(F("description detection"))==="Symbol(description detection)",H=v(z.valueOf),J=v(z.toString),Y=/^Symbol\((.*)\)[^)]+$/,X=v("".replace),ie=v("".slice);I(z,"description",{configurable:!0,get:function(){var te=H(this);if(_(j,te))return"";var Q=J(te),ue=U?ie(Q,7,-1):X(Q,Y,"$1");return ue===""?void 0:ue}}),m({global:!0,constructor:!0,forced:!0},{Symbol:$})}},9504:function(S,M,h){var m=h(616),y=Function.prototype,b=y.call,v=m&&y.bind.bind(b,b);S.exports=m?v:function(_){return function(){return b.apply(_,arguments)}}},9519:function(S,M,h){var m,y,b=h(4576),v=h(2839),_=b.process,C=b.Deno,E=_&&_.versions||C&&C.version,A=E&&E.v8;A&&(y=(m=A.split("."))[0]>0&&m[0]<4?1:+(m[0]+m[1])),!y&&v&&(!(m=v.match(/Edge\/(\d+)/))||m[1]>=74)&&(m=v.match(/Chrome\/(\d+)/))&&(y=+m[1]),S.exports=y},9539:function(S,M,h){var m=h(9565),y=h(8551),b=h(5966);S.exports=function(v,_,C){var E,A;y(v);try{if(!(E=b(v,"return"))){if(_==="throw")throw C;return C}E=m(E,v)}catch(I){A=!0,E=I}if(_==="throw")throw C;if(A)throw E;return y(E),C}},9565:function(S,M,h){var m=h(616),y=Function.prototype.call;S.exports=m?y.bind(y):function(){return y.apply(y,arguments)}},9572:function(S,M,h){var m=h(9297),y=h(6840),b=h(3640),v=h(8227)("toPrimitive"),_=Date.prototype;m(_,v)||y(_,v,b)},9617:function(S,M,h){var m=h(5397),y=h(5610),b=h(6198),v=function(_){return function(C,E,A){var I=m(C),K=b(I);if(K===0)return!_&&-1;var F,z=y(A,K);if(_&&E!=E){for(;K>z;)if((F=I[z++])!=F)return!0}else for(;K>z;z++)if((_||z in I)&&I[z]===E)return _||z||0;return!_&&-1}};S.exports={includes:v(!0),indexOf:v(!1)}},9773:function(S,M,h){var m=h(6518),y=h(4495),b=h(9039),v=h(3717),_=h(8981);m({target:"Object",stat:!0,forced:!y||b((function(){v.f(1)}))},{getOwnPropertySymbols:function(C){var E=v.f;return E?E(_(C)):[]}})}},u={};function c(S){var M=u[S];if(M!==void 0)return M.exports;var h=u[S]={exports:{}};return l[S].call(h.exports,h,h.exports,c),h.exports}c.d=function(S,M){for(var h in M)c.o(M,h)&&!c.o(S,h)&&Object.defineProperty(S,h,{enumerable:!0,get:M[h]})},c.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),c.o=function(S,M){return Object.prototype.hasOwnProperty.call(S,M)},c.r=function(S){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})};var d={};function p(S){return(function(M){if(Array.isArray(M))return g(M)})(S)||(function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)})(S)||f(S)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function f(S,M){if(S){if(typeof S=="string")return g(S,M);var h={}.toString.call(S).slice(8,-1);return h==="Object"&&S.constructor&&(h=S.constructor.name),h==="Map"||h==="Set"?Array.from(S):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?g(S,M):void 0}}function g(S,M){(M==null||M>S.length)&&(M=S.length);for(var h=0,m=Array(M);h<M;h++)m[h]=S[h];return m}function x(S){return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},x(S)}function w(S,M){for(var h=0;h<M.length;h++){var m=M[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(S,D(m.key),m)}}function k(S,M,h){return(M=D(M))in S?Object.defineProperty(S,M,{value:h,enumerable:!0,configurable:!0,writable:!0}):S[M]=h,S}function D(S){var M=(function(h,m){if(x(h)!="object"||!h)return h;var y=h[Symbol.toPrimitive];if(y!==void 0){var b=y.call(h,m);if(x(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(h)})(S,"string");return x(M)=="symbol"?M:M+""}c.r(d),c.d(d,{SimpleKeyboard:function(){return Bt},default:function(){return Ot}}),c(5276),c(8598),c(4782),c(4554),c(2010),c(7427),c(6099),c(7495),c(8781),c(5440),c(744),c(2762),typeof Element>"u"||"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),typeof self<"u"&&"document"in self&&((!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g")))&&(function(S){if("Element"in S){var M="classList",h="prototype",m=S.Element[h],y=Object,b=String[h].trim||function(){return this.replace(/^\s+|\s+$/g,"")},v=Array[h].indexOf||function(F){for(var z=0,j=this.length;z<j;z++)if(z in this&&this[z]===F)return z;return-1},_=function(F,z){this.name=F,this.code=DOMException[F],this.message=z},C=function(F,z){if(z==="")throw new _("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(z))throw new _("INVALID_CHARACTER_ERR","The token must not contain space characters.");return v.call(F,z)},E=function(F){for(var z=b.call(F.getAttribute("class")||""),j=z?z.split(/\s+/):[],$=0,U=j.length;$<U;$++)this.push(j[$]);this._updateClassName=function(){F.setAttribute("class",this.toString())}},A=E[h]=[],I=function(){return new E(this)};if(_[h]=Error[h],A.item=function(F){return this[F]||null},A.contains=function(F){return~C(this,F+"")},A.add=function(){var F,z=arguments,j=0,$=z.length,U=!1;do~C(this,F=z[j]+"")||(this.push(F),U=!0);while(++j<$);U&&this._updateClassName()},A.remove=function(){var F,z,j=arguments,$=0,U=j.length,H=!1;do for(z=C(this,F=j[$]+"");~z;)this.splice(z,1),H=!0,z=C(this,F);while(++$<U);H&&this._updateClassName()},A.toggle=function(F,z){var j=this.contains(F),$=j?z!==!0&&"remove":z!==!1&&"add";return $&&this[$](F),z===!0||z===!1?z:!j},A.replace=function(F,z){var j=C(F+"");~j&&(this.splice(j,1,z),this._updateClassName())},A.toString=function(){return this.join(" ")},y.defineProperty){var K={get:I,enumerable:!0,configurable:!0};try{y.defineProperty(m,M,K)}catch(F){F.number!==void 0&&F.number!==-2146823252||(K.enumerable=!1,y.defineProperty(m,M,K))}}else y[h].__defineGetter__&&m.__defineGetter__(M,I)}})(self),(function(){var S=document.createElement("_");if(S.classList.add("c1","c2"),!S.classList.contains("c2")){var M=function(m){var y=DOMTokenList.prototype[m];DOMTokenList.prototype[m]=function(b){var v,_=arguments.length;for(v=0;v<_;v++)b=arguments[v],y.call(this,b)}};M("add"),M("remove")}if(S.classList.toggle("c3",!1),S.classList.contains("c3")){var h=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(m,y){return 1 in arguments&&!this.contains(m)==!y?y:h.call(this,m)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(m,y){var b=this.toString().split(" "),v=b.indexOf(m+"");~v&&(b=b.slice(v),this.remove.apply(this,b),this.add(y),this.add.apply(this,b.slice(1)))}),S=null})()),c(2675),c(9463),c(2259),c(5700),c(8706),c(2008),c(3418),c(4423),c(3792),c(2062),c(6910),c(739),c(9572),c(2892),c(9085),c(3851),c(1278),c(9432),c(4864),c(1699),c(7764),c(8344),c(3500),c(2953),c(2712),c(2637),c(1480),c(825),c(1761);var N=(function(){return S=function m(y){var b=y.getOptions,v=y.getCaretPosition,_=y.getCaretPositionEnd,C=y.dispatch;(function(E,A){if(!(E instanceof A))throw new TypeError("Cannot call a class as a function")})(this,m),k(this,"getOptions",void 0),k(this,"getCaretPosition",void 0),k(this,"getCaretPositionEnd",void 0),k(this,"dispatch",void 0),k(this,"maxLengthReached",void 0),k(this,"isStandardButton",(function(E){return E&&!(E[0]==="{"&&E[E.length-1]==="}")})),this.getOptions=b,this.getCaretPosition=v,this.getCaretPositionEnd=_,this.dispatch=C,m.bindMethods(m,this)},M=[{key:"getButtonType",value:function(m){return m.includes("{")&&m.includes("}")&&m!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function(m){var y=this.getButtonType(m),b=m.replace("{","").replace("}",""),v="";return y!=="standardBtn"&&(v=" hg-button-".concat(b)),"hg-".concat(y).concat(v)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"","{arrowleft}":"","{arrowdown}":"","{arrowright}":"","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function(m,y){return(y=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),y):y||this.getDefaultDiplay())[m]||m}},{key:"getUpdatedInput",value:function(m,y,b){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:b,_=arguments.length>4&&arguments[4]!==void 0&&arguments[4],C=this.getOptions(),E=[b,v,_],A=y;return(m==="{bksp}"||m==="{backspace}")&&A.length>0?A=this.removeAt.apply(this,[A].concat(E)):(m==="{delete}"||m==="{forwarddelete}")&&A.length>0?A=this.removeForwardsAt.apply(this,[A].concat(E)):m==="{space}"?A=this.addStringAt.apply(this,[A," "].concat(E)):m!=="{tab}"||typeof C.tabCharOnTab=="boolean"&&C.tabCharOnTab===!1?m!=="{enter}"&&m!=="{numpadenter}"||!C.newLineOnEnter?m.includes("numpad")&&Number.isInteger(Number(m[m.length-2]))?A=this.addStringAt.apply(this,[A,m[m.length-2]].concat(E)):m==="{numpaddivide}"?A=this.addStringAt.apply(this,[A,"/"].concat(E)):m==="{numpadmultiply}"?A=this.addStringAt.apply(this,[A,"*"].concat(E)):m==="{numpadsubtract}"?A=this.addStringAt.apply(this,[A,"-"].concat(E)):m==="{numpadadd}"?A=this.addStringAt.apply(this,[A,"+"].concat(E)):m==="{numpaddecimal}"?A=this.addStringAt.apply(this,[A,"."].concat(E)):m==="{"||m==="}"?A=this.addStringAt.apply(this,[A,m].concat(E)):m.includes("{")||m.includes("}")||(A=this.addStringAt.apply(this,[A,m].concat(E))):A=this.addStringAt.apply(this,[A,`
`].concat(E)):A=this.addStringAt.apply(this,[A,"	"].concat(E)),C.debug&&console.log("Input will be: "+A),A}},{key:"updateCaretPos",value:function(m){var y=arguments.length>1&&arguments[1]!==void 0&&arguments[1],b=this.updateCaretPosAction(m,y);this.dispatch((function(v){v.setCaretPosition(b)}))}},{key:"updateCaretPosAction",value:function(m){var y=arguments.length>1&&arguments[1]!==void 0&&arguments[1],b=this.getOptions(),v=this.getCaretPosition();return v!=null&&(y?v>0&&(v-=m):v+=m),b.debug&&console.log("Caret at:",v),v}},{key:"addStringAt",value:function(m,y){var b,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.length,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:m.length,C=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return v||v===0?(b=[m.slice(0,v),y,m.slice(_)].join(""),this.isMaxLengthReached()||C&&this.updateCaretPos(y.length)):b=m+y,b}},{key:"removeAt",value:function(m){var y,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.length,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.length,_=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(b===0&&v===0)return m;if(b===v){var C=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;b&&b>=0?m.substring(b-2,b).match(C)?(y=m.substr(0,b-2)+m.substr(b),_&&this.updateCaretPos(2,!0)):(y=m.substr(0,b-1)+m.substr(b),_&&this.updateCaretPos(1,!0)):m.slice(-2).match(C)?(y=m.slice(0,-2),_&&this.updateCaretPos(2,!0)):(y=m.slice(0,-1),_&&this.updateCaretPos(1,!0))}else y=m.slice(0,b)+m.slice(v),_&&this.dispatch((function(E){E.setCaretPosition(b)}));return y}},{key:"removeForwardsAt",value:function(m){var y,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m.length,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.length,_=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return m!=null&&m.length&&b!==null?(b===v?y=m.substring(b,b+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?m.substr(0,b)+m.substr(b+2):m.substr(0,b)+m.substr(b+1):(y=m.slice(0,b)+m.slice(v),_&&this.dispatch((function(C){C.setCaretPosition(b)}))),y):m}},{key:"handleMaxLength",value:function(m,y){var b=this.getOptions(),v=b.maxLength,_=m[b.inputName||"default"],C=y.length-1>=v;if(y.length<=_.length)return!1;if(Number.isInteger(v))return b.debug&&console.log("maxLength (num) reached:",C),C?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(x(v)==="object"){var E=y.length-1>=v[b.inputName||"default"];return b.debug&&console.log("maxLength (obj) reached:",E),E?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function(m){return m?m.toLowerCase().trim().split(/[.\-_\s]/g).reduce((function(y,b){return b.length?y+b[0].toUpperCase()+b.slice(1):y})):""}},{key:"chunkArray",value:function(m,y){return p(Array(Math.ceil(m.length/y))).map((function(b,v){return m.slice(y*v,y+y*v)}))}},{key:"escapeRegex",value:function(m){return m.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function(m,y){var b=m,v=y.indexOf("");return v<m&&v!=-1&&b--,y.indexOf("")<m&&v!=-1&&b--,b<0?0:b}},{key:"isConstructor",value:function(m){try{Reflect.construct(String,[],m)}catch{return!1}return!0}}],h=[{key:"bindMethods",value:function(m,y){var b,v=(function(C,E){var A=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!A){if(Array.isArray(C)||(A=f(C))||E){A&&(C=A);var I=0,K=function(){};return{s:K,n:function(){return I>=C.length?{done:!0}:{done:!1,value:C[I++]}},e:function($){throw $},f:K}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var F,z=!0,j=!1;return{s:function(){A=A.call(C)},n:function(){var $=A.next();return z=$.done,$},e:function($){j=!0,F=$},f:function(){try{z||A.return==null||A.return()}finally{if(j)throw F}}}})(Object.getOwnPropertyNames(m.prototype));try{for(v.s();!(b=v.n()).done;){var _=b.value;_==="constructor"||_==="bindMethods"||(y[_]=y[_].bind(y))}}catch(C){v.e(C)}finally{v.f()}}}],M&&w(S.prototype,M),h&&w(S,h),Object.defineProperty(S,"prototype",{writable:!1}),S;var S,M,h})();k(N,"noop",(function(){}));var B=N;function T(S){return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},T(S)}function R(S,M){for(var h=0;h<M.length;h++){var m=M[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(S,P(m.key),m)}}function L(S,M,h){return(M=P(M))in S?Object.defineProperty(S,M,{value:h,enumerable:!0,configurable:!0,writable:!0}):S[M]=h,S}function P(S){var M=(function(h,m){if(T(h)!="object"||!h)return h;var y=h[Symbol.toPrimitive];if(y!==void 0){var b=y.call(h,m);if(T(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(h)})(S,"string");return T(M)=="symbol"?M:M+""}var W=(function(){return S=function m(y){var b=this,v=y.dispatch,_=y.getOptions;(function(C,E){if(!(C instanceof E))throw new TypeError("Cannot call a class as a function")})(this,m),L(this,"getOptions",void 0),L(this,"dispatch",void 0),L(this,"isModifierKey",(function(C){return C.altKey||C.ctrlKey||C.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(C.code||C.key||b.keyCodeToKey(C?.keyCode))})),this.dispatch=v,this.getOptions=_,B.bindMethods(m,this)},M=[{key:"handleHighlightKeyDown",value:function(m){var y=this.getOptions();y.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(m)&&(m.preventDefault(),m.stopImmediatePropagation());var b=this.getSimpleKeyboardLayoutKey(m);this.dispatch((function(v){var _,C,E=v.getButtonElement(b),A=v.getButtonElement("{".concat(b,"}"));if(E)_=E,C=b;else{if(!A)return;_=A,C="{".concat(b,"}")}var I,K,F,z,j=function(U){U.style.background=y.physicalKeyboardHighlightBgColor||"#dadce4",U.style.color=y.physicalKeyboardHighlightTextColor||"black"};if(_)if(Array.isArray(_)){if(_.forEach((function(U){return j(U)})),y.physicalKeyboardHighlightPress)if(y.physicalKeyboardHighlightPressUsePointerEvents)(I=_[0])===null||I===void 0||(K=I.onpointerdown)===null||K===void 0||K.call(I,m);else if(y.physicalKeyboardHighlightPressUseClick){var $;($=_[0])===null||$===void 0||$.click()}else v.handleButtonClicked(C,m)}else j(_),y.physicalKeyboardHighlightPress&&(y.physicalKeyboardHighlightPressUsePointerEvents?(F=_)===null||F===void 0||(z=F.onpointerdown)===null||z===void 0||z.call(F,m):y.physicalKeyboardHighlightPressUseClick?_.click():v.handleButtonClicked(C,m))}))}},{key:"handleHighlightKeyUp",value:function(m){var y=this.getOptions();y.physicalKeyboardHighlightPreventDefault&&this.isModifierKey(m)&&(m.preventDefault(),m.stopImmediatePropagation());var b=this.getSimpleKeyboardLayoutKey(m);this.dispatch((function(v){var _,C,E,A=v.getButtonElement(b)||v.getButtonElement("{".concat(b,"}")),I=function(K){K.removeAttribute&&K.removeAttribute("style")};A&&(Array.isArray(A)?(A.forEach((function(K){return I(K)})),y.physicalKeyboardHighlightPressUsePointerEvents&&((_=A[0])===null||_===void 0||(C=_.onpointerup)===null||C===void 0||C.call(_,m))):(I(A),y.physicalKeyboardHighlightPressUsePointerEvents&&(A==null||(E=A.onpointerup)===null||E===void 0||E.call(A,m))))}))}},{key:"getSimpleKeyboardLayoutKey",value:function(m){var y,b="",v=m.code||m.key||this.keyCodeToKey(m?.keyCode);return(b=v!=null&&v.includes("Numpad")||v!=null&&v.includes("Shift")||v!=null&&v.includes("Space")||v!=null&&v.includes("Backspace")||v!=null&&v.includes("Control")||v!=null&&v.includes("Alt")||v!=null&&v.includes("Meta")?m.code||"":m.key||this.keyCodeToKey(m?.keyCode)||"").length>1?(y=b)===null||y===void 0?void 0:y.toLowerCase():b}},{key:"keyCodeToKey",value:function(m){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[m]||""}}],M&&R(S.prototype,M),h&&R(S,h),Object.defineProperty(S,"prototype",{writable:!1}),S;var S,M,h})();function de(S){return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},de(S)}function q(S,M){for(var h=0;h<M.length;h++){var m=M[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(S,be(m.key),m)}}function ae(S,M,h){return(M=be(M))in S?Object.defineProperty(S,M,{value:h,enumerable:!0,configurable:!0,writable:!0}):S[M]=h,S}function be(S){var M=(function(h,m){if(de(h)!="object"||!h)return h;var y=h[Symbol.toPrimitive];if(y!==void 0){var b=y.call(h,m);if(de(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(h)})(S,"string");return de(M)=="symbol"?M:M+""}var re=(function(){return S=function m(y){var b=y.utilities,v=y.options;(function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")})(this,m),ae(this,"utilities",void 0),ae(this,"options",void 0),ae(this,"candidateBoxElement",void 0),ae(this,"pageIndex",0),ae(this,"pageSize",void 0),this.utilities=b,this.options=v,B.bindMethods(m,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5},M=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(m){var y=this,b=m.candidateValue,v=m.targetElement,_=m.onSelect;if(b&&b.length){var C=this.utilities.chunkArray(b.split(" "),this.pageSize);this.renderPage({candidateListPages:C,targetElement:v,pageIndex:this.pageIndex,nbPages:C.length,onItemSelected:function(E,A){_(E,A),y.destroy()}})}}},{key:"renderPage",value:function(m){var y,b=this,v=m.candidateListPages,_=m.targetElement,C=m.pageIndex,E=m.nbPages,A=m.onItemSelected;(y=this.candidateBoxElement)===null||y===void 0||y.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var I=document.createElement("ul");I.className="hg-candidate-box-list",v[C].forEach((function(H){var J,Y=document.createElement("li"),X=function(){var ie=new(b.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(ie,"target",{value:Y}),ie};Y.className="hg-candidate-box-list-item",Y.innerHTML=((J=b.options.display)===null||J===void 0?void 0:J[H])||H,b.options.useTouchEvents?Y.ontouchstart=function(ie){return A(H,ie||X())}:Y.onclick=function(){var ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X();return A(H,ie)},I.appendChild(Y)}));var K=C>0,F=document.createElement("div");F.classList.add("hg-candidate-box-prev"),K&&F.classList.add("hg-candidate-box-btn-active");var z=function(){K&&b.renderPage({candidateListPages:v,targetElement:_,pageIndex:C-1,nbPages:E,onItemSelected:A})};this.options.useTouchEvents?F.ontouchstart=z:F.onclick=z,this.candidateBoxElement.appendChild(F),this.candidateBoxElement.appendChild(I);var j=C<E-1,$=document.createElement("div");$.classList.add("hg-candidate-box-next"),j&&$.classList.add("hg-candidate-box-btn-active");var U=function(){j&&b.renderPage({candidateListPages:v,targetElement:_,pageIndex:C+1,nbPages:E,onItemSelected:A})};this.options.useTouchEvents?$.ontouchstart=U:$.onclick=U,this.candidateBoxElement.appendChild($),_.prepend(this.candidateBoxElement)}}],M&&q(S.prototype,M),h&&q(S,h),Object.defineProperty(S,"prototype",{writable:!1}),S;var S,M,h})(),ce=re;function ge(S){return(function(M){if(Array.isArray(M))return xe(M)})(S)||(function(M){if(typeof Symbol<"u"&&M[Symbol.iterator]!=null||M["@@iterator"]!=null)return Array.from(M)})(S)||(function(M,h){if(M){if(typeof M=="string")return xe(M,h);var m={}.toString.call(M).slice(8,-1);return m==="Object"&&M.constructor&&(m=M.constructor.name),m==="Map"||m==="Set"?Array.from(M):m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m)?xe(M,h):void 0}})(S)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function xe(S,M){(M==null||M>S.length)&&(M=S.length);for(var h=0,m=Array(M);h<M;h++)m[h]=S[h];return m}function De(S){return De=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},De(S)}function We(S,M){var h=Object.keys(S);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(S);M&&(m=m.filter((function(y){return Object.getOwnPropertyDescriptor(S,y).enumerable}))),h.push.apply(h,m)}return h}function et(S,M){for(var h=0;h<M.length;h++){var m=M[h];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(S,Ke(m.key),m)}}function Ae(S,M,h){return(M=Ke(M))in S?Object.defineProperty(S,M,{value:h,enumerable:!0,configurable:!0,writable:!0}):S[M]=h,S}function Ke(S){var M=(function(h,m){if(De(h)!="object"||!h)return h;var y=h[Symbol.toPrimitive];if(y!==void 0){var b=y.call(h,m);if(De(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(h)})(S,"string");return De(M)=="symbol"?M:M+""}var ot=(function(){return S=function m(y,b){var v=this;if((function(z,j){if(!(z instanceof j))throw new TypeError("Cannot call a class as a function")})(this,m),Ae(this,"input",void 0),Ae(this,"options",void 0),Ae(this,"utilities",void 0),Ae(this,"caretPosition",void 0),Ae(this,"caretPositionEnd",void 0),Ae(this,"keyboardDOM",void 0),Ae(this,"keyboardPluginClasses",void 0),Ae(this,"keyboardDOMClass",void 0),Ae(this,"buttonElements",void 0),Ae(this,"currentInstanceName",void 0),Ae(this,"allKeyboardInstances",void 0),Ae(this,"keyboardInstanceNames",void 0),Ae(this,"isFirstKeyboardInstance",void 0),Ae(this,"physicalKeyboard",void 0),Ae(this,"modules",void 0),Ae(this,"activeButtonClass",void 0),Ae(this,"holdInteractionTimeout",void 0),Ae(this,"holdTimeout",void 0),Ae(this,"isMouseHold",void 0),Ae(this,"initialized",void 0),Ae(this,"candidateBox",void 0),Ae(this,"keyboardRowsDOM",void 0),Ae(this,"defaultName","default"),Ae(this,"activeInputElement",null),Ae(this,"handleParams",(function(z,j){var $,U,H;if(typeof z=="string")$=z.split(".").join(""),U=document.querySelector(".".concat($)),H=j;else if(z instanceof HTMLDivElement){if(!z.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");$=z.className.split(" ")[0],U=z,H=j}else $="simple-keyboard",U=document.querySelector(".".concat($)),H=z;return{keyboardDOMClass:$,keyboardDOM:U,options:H}})),Ae(this,"getOptions",(function(){return v.options})),Ae(this,"getCaretPosition",(function(){return v.caretPosition})),Ae(this,"getCaretPositionEnd",(function(){return v.caretPositionEnd})),Ae(this,"registerModule",(function(z,j){v.modules[z]||(v.modules[z]={}),j(v.modules[z])})),Ae(this,"getKeyboardClassString",(function(){for(var z=arguments.length,j=new Array(z),$=0;$<z;$++)j[$]=arguments[$];return[v.keyboardDOMClass].concat(j).filter((function(U){return!!U})).join(" ")})),typeof window<"u"){var _=this.handleParams(y,b),C=_.keyboardDOMClass,E=_.keyboardDOM,A=_.options,I=A===void 0?{}:A;this.utilities=new B({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=E,this.options=(function(z){for(var j=1;j<arguments.length;j++){var $=arguments[j]!=null?arguments[j]:{};j%2?We(Object($),!0).forEach((function(U){Ae(z,U,$[U])})):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors($)):We(Object($)).forEach((function(U){Object.defineProperty(z,U,Object.getOwnPropertyDescriptor($,U))}))}return z})({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},I),this.keyboardPluginClasses="",B.bindMethods(m,this);var K=this.options.inputName,F=K===void 0?this.defaultName:K;if(this.input={},this.input[F]="",this.keyboardDOMClass=C,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new W({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new ce({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(C,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}},M=[{key:"setCaretPosition",value:function(m){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m;this.caretPosition=m,this.caretPositionEnd=y}},{key:"getInputCandidates",value:function(m){var y=this,b=this.options,v=b.layoutCandidates,_=b.layoutCandidatesCaseSensitiveMatch;if(!v||De(v)!=="object")return{};var C=Object.keys(v).filter((function(I){var K=m.substring(0,y.getCaretPositionEnd()||0)||m,F=new RegExp("".concat(y.utilities.escapeRegex(I),"$"),_?"g":"gi");return!!ge(K.matchAll(F)).length}));if(C.length>1){var E=C.sort((function(I,K){return K.length-I.length}))[0];return{candidateKey:E,candidateValue:v[E]}}if(C.length){var A=C[0];return{candidateKey:A,candidateValue:v[A]}}return{}}},{key:"showCandidatesBox",value:function(m,y,b){var v=this;this.candidateBox&&this.candidateBox.show({candidateValue:y,targetElement:b,onSelect:function(_,C){var E=v.options,A=E.layoutCandidatesCaseSensitiveMatch,I=E.disableCandidateNormalization,K=E.enableLayoutCandidatesKeyPress,F=_;I||(F=_.normalize("NFD")),typeof v.options.beforeInputUpdate=="function"&&v.options.beforeInputUpdate(v);var z=v.getInput(v.options.inputName,!0),j=v.getCaretPositionEnd()||0,$=z.substring(0,j||0)||z,U=new RegExp("".concat(v.utilities.escapeRegex(m),"$"),A?"g":"gi"),H=$.replace(U,F),J=z.replace($,H),Y=H.length-$.length,X=(j||z.length)+Y;X<0&&(X=0),v.setInput(J,v.options.inputName,!0),v.setCaretPosition(X),K&&typeof v.options.onKeyPress=="function"&&v.options.onKeyPress(_,C),typeof v.options.onChange=="function"&&v.options.onChange(v.getInput(v.options.inputName,!0),C),typeof v.options.onChangeAll=="function"&&v.options.onChangeAll(v.getAllInputs(),C)}})}},{key:"handleButtonClicked",value:function(m,y){var b=this.options,v=b.inputName,_=v===void 0?this.defaultName:v,C=b.debug;if(m!=="{//}"){this.input[_]||(this.input[_]=""),typeof this.options.beforeInputUpdate=="function"&&this.options.beforeInputUpdate(this);var E=this.utilities.getUpdatedInput(m,this.input[_],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(m)&&this.activeInputElement&&this.input[_]&&this.input[_]===E&&this.caretPosition===0&&this.caretPositionEnd===E.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(m,y);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(m,y),this.input[_]!==E&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(E))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,E))return;var A=this.utilities.getUpdatedInput(m,this.input[_],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(A,this.options.inputName,!0),C&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),y?.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),y),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),y),y!=null&&y.target&&this.options.enableLayoutCandidates){var I,K=this.getInputCandidates(E),F=K.candidateKey,z=K.candidateValue;F&&z?this.showCandidatesBox(F,z,this.keyboardDOM):(I=this.candidateBox)===null||I===void 0||I.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),C&&console.log("Key pressed:",m)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(m){this.options.syncInstanceInputs?this.dispatch((function(y){y.isMouseHold=m})):this.isMouseHold=m}},{key:"handleButtonMouseDown",value:function(m,y){var b=this;y&&(this.options.preventMouseDownDefault&&y.preventDefault(),this.options.stopMouseDownPropagation&&y.stopPropagation(),y.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout((function(){(b.getMouseHold()&&(!m.includes("{")&&!m.includes("}")||m==="{delete}"||m==="{backspace}"||m==="{bksp}"||m==="{space}"||m==="{tab}")||m==="{arrowright}"||m==="{arrowleft}"||m==="{arrowup}"||m==="{arrowdown}")&&(b.options.debug&&console.log("Button held:",m),b.handleButtonHold(m)),clearTimeout(b.holdTimeout)}),500))}},{key:"handleButtonMouseUp",value:function(m,y){var b=this;y&&(this.options.preventMouseUpDefault&&y.preventDefault&&y.preventDefault(),this.options.stopMouseUpPropagation&&y.stopPropagation&&y.stopPropagation(),!(y.target===this.keyboardDOM||y.target&&this.keyboardDOM.contains(y.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&(y.target===this.candidateBox.candidateBoxElement||y.target&&this.candidateBox.candidateBoxElement.contains(y.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons((function(v){v.classList.remove(b.activeButtonClass)})),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),m&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(m,y)}},{key:"handleKeyboardContainerMouseDown",value:function(m){this.options.preventMouseDownDefault&&m.preventDefault()}},{key:"handleButtonHold",value:function(m){var y=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout((function(){y.getMouseHold()?(y.handleButtonClicked(m),y.handleButtonHold(m)):clearTimeout(y.holdInteractionTimeout)}),100)}},{key:"syncInstanceInputs",value:function(){var m=this;this.dispatch((function(y){y.replaceInput(m.input),y.setCaretPosition(m.caretPosition,m.caretPositionEnd)}))}},{key:"clearInput",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[m]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,y=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!y&&this.syncInstanceInputs(),this.options.rtl?""+this.input[m].replace("","").replace("","")+"":this.input[m]}},{key:"getAllInputs",value:function(){var m=this,y={};return Object.keys(this.input).forEach((function(b){y[b]=m.getInput(b,!0)})),y}},{key:"setInput",value:function(m){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,b=arguments.length>2?arguments[2]:void 0;this.input[y]=m,!b&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(m){this.input=m}},{key:"setOptions",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=this.changedOptions(m);this.options=Object.assign(this.options,m),y.length&&(this.options.debug&&console.log("changedOptions",y),this.onSetOptions(y),this.render())}},{key:"changedOptions",value:function(m){var y=this;return Object.keys(m).filter((function(b){return JSON.stringify(m[b])!==JSON.stringify(y.options[b])}))}},{key:"onSetOptions",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];m.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(m.includes("layoutCandidatesPageSize")||m.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new ce({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(m){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach((function(y){m(window.SimpleKeyboardInstances[y],y)}))}},{key:"addButtonTheme",value:function(m,y){var b=this;y&&m&&(m.split(" ").forEach((function(v){y.split(" ").forEach((function(_){b.options.buttonTheme||(b.options.buttonTheme=[]);var C=!1;b.options.buttonTheme.map((function(E){if(E!=null&&E.class.split(" ").includes(_)){C=!0;var A=E.buttons.split(" ");A.includes(v)||(C=!0,A.push(v),E.buttons=A.join(" "))}return E})),C||b.options.buttonTheme.push({class:_,buttons:m})}))})),this.render())}},{key:"removeButtonTheme",value:function(m,y){var b=this;if(!m&&!y)return this.options.buttonTheme=[],void this.render();m&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(m.split(" ").forEach((function(v){var _;(_=b.options)===null||_===void 0||(_=_.buttonTheme)===null||_===void 0||_.map((function(C,E){if(C&&y&&y.includes(C.class)||!y){var A,I,K=(A=C)===null||A===void 0?void 0:A.buttons.split(" ").filter((function(F){return F!==v}));C&&K!=null&&K.length?C.buttons=K.join(" "):((I=b.options.buttonTheme)===null||I===void 0||I.splice(E,1),C=null)}return C}))})),this.render())}},{key:"getButtonElement",value:function(m){var y,b=this.buttonElements[m];return b&&(y=b.length>1?b:b[0]),y}},{key:"inputPatternIsValid",value:function(m){var y,b=this.options.inputPattern;if((y=b instanceof RegExp?b:b[this.options.inputName||this.defaultName])&&m){var v=y.test(m);return this.options.debug&&console.log('inputPattern ("'.concat(y,'"): ').concat(v?"passed":"did not pass!")),v}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var m=this.options.physicalKeyboardHighlightPreventDefault,y=m!==void 0&&m;document.addEventListener("keyup",this.handleKeyUp,y),document.addEventListener("keydown",this.handleKeyDown,y),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),this.options.updateCaretOnSelectionChange&&document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(m){this.caretEventHandler(m),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(m)}},{key:"handleKeyDown",value:function(m){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(m)}},{key:"handleMouseUp",value:function(m){this.caretEventHandler(m)}},{key:"handleTouchEnd",value:function(m){this.caretEventHandler(m)}},{key:"handleSelect",value:function(m){this.caretEventHandler(m)}},{key:"handleSelectionChange",value:function(m){navigator.userAgent.includes("Firefox")||this.caretEventHandler(m)}},{key:"caretEventHandler",value:function(m){var y,b=this;m.target.tagName&&(y=m.target.tagName.toLowerCase()),this.dispatch((function(v){var _=m.target===v.keyboardDOM||m.target&&v.keyboardDOM.contains(m.target);if(b.options.syncInstanceInputs&&Array.isArray(m.path)&&(_=m.path.some((function(A){var I;return A==null||(I=A.hasAttribute)===null||I===void 0?void 0:I.call(A,"data-skInstance")}))),(y==="textarea"||y==="input"&&["text","search","url","tel","password"].includes(m.target.type))&&!v.options.disableCaretPositioning){var C=m.target.selectionStart,E=m.target.selectionEnd;v.options.rtl&&(C=v.utilities.getRtlOffset(C,v.getInput()),E=v.utilities.getRtlOffset(E,v.getInput())),v.setCaretPosition(C,E),v.activeInputElement=m.target,v.options.debug&&console.log("Caret at: ",v.getCaretPosition(),v.getCaretPositionEnd(),m&&m.target.tagName.toLowerCase(),"(".concat(v.keyboardDOMClass,")"),m?.type)}else!v.options.disableCaretPositioning&&_||m?.type==="selectionchange"||(v.setCaretPosition(null),v.activeInputElement=null,v.options.debug&&console.log('Caret position reset due to "'.concat(m?.type,'" event'),m))}))}},{key:"recurseButtons",value:function(m){var y=this;m&&Object.keys(this.buttonElements).forEach((function(b){return y.buttonElements[b].forEach(m)}))}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var m=this.options.physicalKeyboardHighlightPreventDefault,y=m!==void 0&&m;document.removeEventListener("keyup",this.handleKeyUp,y),document.removeEventListener("keydown",this.handleKeyDown,y),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),this.options.updateCaretOnSelectionChange&&document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons((function(b){b&&(b.onpointerdown=null,b.onpointerup=null,b.onpointercancel=null,b.ontouchstart=null,b.ontouchend=null,b.ontouchcancel=null,b.onclick=null,b.onmousedown=null,b.onmouseup=null,b.remove(),b=null)})),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(m){var y=this.options.buttonTheme,b=[];return Array.isArray(y)&&y.forEach((function(v){if(v&&v.class&&typeof v.class=="string"&&v.buttons&&typeof v.buttons=="string"){var _=v.class.split(" ");v.buttons.split(" ").includes(m)&&(b=[].concat(ge(b),ge(_)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',v)})),b}},{key:"setDOMButtonAttributes",value:function(m,y){var b=this.options.buttonAttributes;Array.isArray(b)&&b.forEach((function(v){v.attribute&&typeof v.attribute=="string"&&v.value&&typeof v.value=="string"?v.buttons&&typeof v.buttons=="string"?v.buttons.split(" ").includes(m)&&y(v.attribute,v.value):y(v.attribute,v.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',v)}))}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(m){var y;if((y=m.target.classList)!==null&&y!==void 0&&y.contains("hg-button"))return m.preventDefault(),m.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var m=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach((function(y){var b=m.utilities.isConstructor(y)?new y(m):y(m);b.init&&b.init(m)})),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(m,y){return!!this.modules[m]&&this.modules[m][y]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(m,y,b,v){var _=this,C=Array.from(m.children),E=0;return C.length&&b.forEach((function(A,I){var K=v[I];if(!(K&&K>A))return!1;var F=A-E,z=K-E,j=document.createElement("div");j.className+="hg-button-container";var $="".concat(_.options.layoutName,"-r").concat(y,"c").concat(I);j.setAttribute("data-skUID",$);var U=C.splice(F,z-F+1);E+=z-F,U.forEach((function(H){return j.appendChild(H)})),C.splice(F,0,j),m.innerHTML="",C.forEach((function(H){return m.appendChild(H)})),_.options.debug&&console.log("rowDOMContainer",U,F,z,E+1)})),m}},{key:"render",value:function(){var m=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var y="hg-layout-".concat(this.options.layoutName),b=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},v=this.options.useTouchEvents||!1,_=v?"hg-touch-events":"",C=this.options.useMouseEvents||!1,E=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,y,this.keyboardPluginClasses,_),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",b[this.options.layoutName||this.defaultName].forEach((function(A,I){var K=A.split(" ");m.options.excludeFromLayout&&m.options.excludeFromLayout[m.options.layoutName||m.defaultName]&&(K=K.filter((function($){return m.options.excludeFromLayout&&!m.options.excludeFromLayout[m.options.layoutName||m.defaultName].includes($)})));var F=document.createElement("div");F.className+="hg-row";var z=[],j=[];K.forEach((function($,U){var H,J=!E&&typeof $=="string"&&$.length>1&&$.indexOf("[")===0,Y=!E&&typeof $=="string"&&$.length>1&&$.indexOf("]")===$.length-1;J&&(z.push(U),$=$.replace(/\[/g,"")),Y&&(j.push(U),$=$.replace(/\]/g,""));var X=m.utilities.getButtonClass($),ie=m.utilities.getButtonDisplayName($,m.options.display,m.options.mergeDisplay),te=m.options.useButtonTag?"button":"div",Q=document.createElement(te);Q.className+="hg-button ".concat(X),(H=Q.classList).add.apply(H,ge(m.getButtonThemeClasses($))),m.setDOMButtonAttributes($,(function(ne,Pe){Q.setAttribute(ne,Pe)})),m.activeButtonClass="hg-activeButton",!m.utilities.pointerEventsSupported()||v||C?v?(Q.ontouchstart=function(ne){m.handleButtonClicked($,ne),m.handleButtonMouseDown($,ne)},Q.ontouchend=function(ne){m.handleButtonMouseUp($,ne)},Q.ontouchcancel=function(ne){m.handleButtonMouseUp($,ne)}):(Q.onclick=function(ne){m.setMouseHold(!1),typeof m.options.onKeyReleased=="function"||m.options.useMouseEvents&&m.options.clickOnMouseDown||m.handleButtonClicked($,ne)},Q.onmousedown=function(ne){(typeof m.options.onKeyReleased=="function"||m.options.useMouseEvents&&m.options.clickOnMouseDown)&&!m.isMouseHold&&m.handleButtonClicked($,ne),m.handleButtonMouseDown($,ne)},Q.onmouseup=function(ne){m.handleButtonMouseUp($,ne)}):(Q.onpointerdown=function(ne){m.handleButtonClicked($,ne),m.handleButtonMouseDown($,ne)},Q.onpointerup=function(ne){m.handleButtonMouseUp($,ne)},Q.onpointercancel=function(ne){m.handleButtonMouseUp($,ne)}),Q.setAttribute("data-skBtn",$);var ue="".concat(m.options.layoutName,"-r").concat(I,"b").concat(U);Q.setAttribute("data-skBtnUID",ue);var fe=document.createElement("span");fe.innerHTML=ie,Q.appendChild(fe),m.buttonElements[$]||(m.buttonElements[$]=[]),m.buttonElements[$].push(Q),F.appendChild(Q)})),F=m.parseRowDOMContainers(F,I,z,j),m.keyboardRowsDOM.appendChild(F)})),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||v||C?v?(document.ontouchend=function(A){return m.handleButtonMouseUp(void 0,A)},document.ontouchcancel=function(A){return m.handleButtonMouseUp(void 0,A)},this.keyboardDOM.ontouchstart=function(A){return m.handleKeyboardContainerMouseDown(A)}):v||(document.onmouseup=function(A){return m.handleButtonMouseUp(void 0,A)},this.keyboardDOM.onmousedown=function(A){return m.handleKeyboardContainerMouseDown(A)}):(document.onpointerup=function(A){return m.handleButtonMouseUp(void 0,A)},this.keyboardDOM.onpointerdown=function(A){return m.handleKeyboardContainerMouseDown(A)}),this.onInit())}}],M&&et(S.prototype,M),h&&et(S,h),Object.defineProperty(S,"prototype",{writable:!1}),S;var S,M,h})(),Bt=ot,Ot=Bt;return d})()},981:function(){typeof Element>"u"||"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),typeof self<"u"&&"document"in self&&((!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g")))&&(function(a){if("Element"in a){var l="classList",u="prototype",c=a.Element[u],d=Object,p=String[u].trim||function(){return this.replace(/^\s+|\s+$/g,"")},f=Array[u].indexOf||function(B){for(var T=0,R=this.length;T<R;T++)if(T in this&&this[T]===B)return T;return-1},g=function(B,T){this.name=B,this.code=DOMException[B],this.message=T},x=function(B,T){if(T==="")throw new g("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(T))throw new g("INVALID_CHARACTER_ERR","The token must not contain space characters.");return f.call(B,T)},w=function(B){for(var T=p.call(B.getAttribute("class")||""),R=T?T.split(/\s+/):[],L=0,P=R.length;L<P;L++)this.push(R[L]);this._updateClassName=function(){B.setAttribute("class",this.toString())}},k=w[u]=[],D=function(){return new w(this)};if(g[u]=Error[u],k.item=function(B){return this[B]||null},k.contains=function(B){return~x(this,B+"")},k.add=function(){var B,T=arguments,R=0,L=T.length,P=!1;do~x(this,B=T[R]+"")||(this.push(B),P=!0);while(++R<L);P&&this._updateClassName()},k.remove=function(){var B,T,R=arguments,L=0,P=R.length,W=!1;do for(T=x(this,B=R[L]+"");~T;)this.splice(T,1),W=!0,T=x(this,B);while(++L<P);W&&this._updateClassName()},k.toggle=function(B,T){var R=this.contains(B),L=R?T!==!0&&"remove":T!==!1&&"add";return L&&this[L](B),T===!0||T===!1?T:!R},k.replace=function(B,T){var R=x(B+"");~R&&(this.splice(R,1,T),this._updateClassName())},k.toString=function(){return this.join(" ")},d.defineProperty){var N={get:D,enumerable:!0,configurable:!0};try{d.defineProperty(c,l,N)}catch(B){B.number!==void 0&&B.number!==-2146823252||(N.enumerable=!1,d.defineProperty(c,l,N))}}else d[u].__defineGetter__&&c.__defineGetter__(l,D)}})(self),(function(){var a=document.createElement("_");if(a.classList.add("c1","c2"),!a.classList.contains("c2")){var l=function(c){var d=DOMTokenList.prototype[c];DOMTokenList.prototype[c]=function(p){var f,g=arguments.length;for(f=0;f<g;f++)p=arguments[f],d.call(this,p)}};l("add"),l("remove")}if(a.classList.toggle("c3",!1),a.classList.contains("c3")){var u=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(c,d){return 1 in arguments&&!this.contains(c)==!d?d:u.call(this,c)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(c,d){var p=this.toString().split(" "),f=p.indexOf(c+"");~f&&(p=p.slice(f),this.remove.apply(this,p),this.add(d),this.add.apply(this,p.slice(1)))}),a=null})())}},i={};function o(a){var l=i[a];if(l!==void 0)return l.exports;var u=i[a]={exports:{}};return r[a].call(u.exports,u,u.exports,o),u.exports}o.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(l,{a:l}),l},o.d=function(a,l){for(var u in l)o.o(l,u)&&!o.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:l[u]})},o.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},o.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var s={};return(function(){o.r(s),o.d(s,{KeyboardReact:function(){return x},default:function(){return w}}),o(981);var a=o(442),l=o(548),u=o.n(l);function c(k){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},c(k)}function d(k,D){var N=Object.keys(k);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(k);D&&(B=B.filter((function(T){return Object.getOwnPropertyDescriptor(k,T).enumerable}))),N.push.apply(N,B)}return N}function p(k){for(var D=1;D<arguments.length;D++){var N=arguments[D]!=null?arguments[D]:{};D%2?d(Object(N),!0).forEach((function(B){f(k,B,N[B])})):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(N)):d(Object(N)).forEach((function(B){Object.defineProperty(k,B,Object.getOwnPropertyDescriptor(N,B))}))}return k}function f(k,D,N){return(D=(function(B){var T=(function(R,L){if(c(R)!="object"||!R)return R;var P=R[Symbol.toPrimitive];if(P!==void 0){var W=P.call(R,L);if(c(W)!="object")return W;throw new TypeError("@@toPrimitive must return a primitive value.")}return(L==="string"?String:Number)(R)})(B,"string");return c(T)=="symbol"?T:T+""})(D))in k?Object.defineProperty(k,D,{value:N,enumerable:!0,configurable:!0,writable:!0}):k[D]=N,k}var g=function(k){return p(p({},k),{},{keyboardRef:null})},x=function(k){var D=k.baseClass||"react-simple-keyboard",N=a.useRef(null),B=a.useRef(null),T=a.useRef(null),R=a.useRef(k);return a.useEffect((function(){return function(){T.current&&T.current.destroy(),N.current=!1}}),[]),a.useEffect((function(){var L=(function(ae){return p(p({},ae),{},{theme:"simple-keyboard ".concat(ae.theme||"hg-theme-default")})})(k);if(!N.current){N.current=!0,L.debug&&console.log("ReactSimpleKeyboard: Init");var P=B.current,W=".".concat(D);T.current=new(u())(P||W,L),L.keyboardRef&&L.keyboardRef(T.current)}var de=(function(ae,be){var re=g(be),ce=g(ae);return Object.keys(re).filter((function(ge){return re[ge]!==ce[ge]}))})(R.current,L);if(de.length){var q=T.current;R.current=L,q?.setOptions(L),L.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",de)}}),[N,D,R,k]),a.createElement("div",{className:D,ref:B})},w=x})(),s})()}))})(xc)),xc.exports}var NL=OL();const Z5=nm(NL);var Ta={exports:{}},$p={},Kp={exports:{}},jp,jv;function PL(){if(jv)return jp;jv=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jp=t,jp}var qp,qv;function IL(){if(qv)return qp;qv=1;var t=PL();function e(){}function n(){}return n.resetWarningCache=e,qp=function(){function r(s,a,l,u,c,d){if(d!==t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function i(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return o.PropTypes=o,o},qp}var Vv;function Q5(){return Vv||(Vv=1,Kp.exports=IL()()),Kp.exports}var ec={exports:{}},Hv;function RL(){if(Hv)return ec.exports;Hv=1;function t(n){var r,i,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(r=0;r<s;r++)n[r]&&(i=t(n[r]))&&(o&&(o+=" "),o+=i)}else for(i in n)n[i]&&(o&&(o+=" "),o+=i);return o}function e(){for(var n,r,i=0,o="",s=arguments.length;i<s;i++)(n=arguments[i])&&(r=t(n))&&(o&&(o+=" "),o+=r);return o}return ec.exports=e,ec.exports.clsx=e,ec.exports}var Nt={},wi={},Wv;function ah(){if(Wv)return wi;Wv=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.dontSetMe=i,wi.findInArray=t,wi.int=r,wi.isFunction=e,wi.isNum=n;function t(o,s){for(let a=0,l=o.length;a<l;a++)if(s.apply(s,[o[a],a,o]))return o[a]}function e(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Function]"}function n(o){return typeof o=="number"&&!isNaN(o)}function r(o){return parseInt(o,10)}function i(o,s,a){if(o[s])return new Error(`Invalid prop ${s} passed to ${a} - do not set this, set it on the child.`)}return wi}var ki={},Uv;function zL(){if(Uv)return ki;Uv=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.browserPrefixToKey=n,ki.browserPrefixToStyle=r,ki.default=void 0,ki.getPrefix=e;const t=["Moz","Webkit","O","ms"];function e(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const s=window.document?.documentElement?.style;if(!s||o in s)return"";for(let a=0;a<t.length;a++)if(n(o,t[a])in s)return t[a];return""}function n(o,s){return s?`${s}${i(o)}`:o}function r(o,s){return s?`-${s.toLowerCase()}-${o}`:o}function i(o){let s="",a=!0;for(let l=0;l<o.length;l++)a?(s+=o[l].toUpperCase(),a=!1):o[l]==="-"?a=!0:s+=o[l];return s}return ki.default=e(),ki}var Jv;function f0(){if(Jv)return Nt;Jv=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.addClassName=T,Nt.addEvent=s,Nt.addUserSelectStyles=D,Nt.createCSSTransform=f,Nt.createSVGTransform=g,Nt.getTouch=w,Nt.getTouchIdentifier=k,Nt.getTranslation=x,Nt.innerHeight=c,Nt.innerWidth=d,Nt.matchesSelector=i,Nt.matchesSelectorAndParentsTo=o,Nt.offsetXYFromParent=p,Nt.outerHeight=l,Nt.outerWidth=u,Nt.removeClassName=R,Nt.removeEvent=a,Nt.scheduleRemoveUserSelectStyles=N;var t=ah(),e=n(zL());function n(L,P){if(typeof WeakMap=="function")var W=new WeakMap,de=new WeakMap;return(n=function(q,ae){if(!ae&&q&&q.__esModule)return q;var be,re,ce={__proto__:null,default:q};if(q===null||typeof q!="object"&&typeof q!="function")return ce;if(be=ae?de:W){if(be.has(q))return be.get(q);be.set(q,ce)}for(const ge in q)ge!=="default"&&{}.hasOwnProperty.call(q,ge)&&((re=(be=Object.defineProperty)&&Object.getOwnPropertyDescriptor(q,ge))&&(re.get||re.set)?be(ce,ge,re):ce[ge]=q[ge]);return ce})(L,P)}let r="";function i(L,P){return r||(r=(0,t.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(W){return(0,t.isFunction)(L[W])})),(0,t.isFunction)(L[r])?L[r](P):!1}function o(L,P,W){let de=L;do{if(i(de,P))return!0;if(de===W)return!1;de=de.parentNode}while(de);return!1}function s(L,P,W,de){if(!L)return;const q={capture:!0,...de};L.addEventListener?L.addEventListener(P,W,q):L.attachEvent?L.attachEvent("on"+P,W):L["on"+P]=W}function a(L,P,W,de){if(!L)return;const q={capture:!0,...de};L.removeEventListener?L.removeEventListener(P,W,q):L.detachEvent?L.detachEvent("on"+P,W):L["on"+P]=null}function l(L){let P=L.clientHeight;const W=L.ownerDocument.defaultView.getComputedStyle(L);return P+=(0,t.int)(W.borderTopWidth),P+=(0,t.int)(W.borderBottomWidth),P}function u(L){let P=L.clientWidth;const W=L.ownerDocument.defaultView.getComputedStyle(L);return P+=(0,t.int)(W.borderLeftWidth),P+=(0,t.int)(W.borderRightWidth),P}function c(L){let P=L.clientHeight;const W=L.ownerDocument.defaultView.getComputedStyle(L);return P-=(0,t.int)(W.paddingTop),P-=(0,t.int)(W.paddingBottom),P}function d(L){let P=L.clientWidth;const W=L.ownerDocument.defaultView.getComputedStyle(L);return P-=(0,t.int)(W.paddingLeft),P-=(0,t.int)(W.paddingRight),P}function p(L,P,W){const q=P===P.ownerDocument.body?{left:0,top:0}:P.getBoundingClientRect(),ae=(L.clientX+P.scrollLeft-q.left)/W,be=(L.clientY+P.scrollTop-q.top)/W;return{x:ae,y:be}}function f(L,P){const W=x(L,P,"px");return{[(0,e.browserPrefixToKey)("transform",e.default)]:W}}function g(L,P){return x(L,P,"")}function x(L,P,W){let{x:de,y:q}=L,ae=`translate(${de}${W},${q}${W})`;if(P){const be=`${typeof P.x=="string"?P.x:P.x+W}`,re=`${typeof P.y=="string"?P.y:P.y+W}`;ae=`translate(${be}, ${re})`+ae}return ae}function w(L,P){return L.targetTouches&&(0,t.findInArray)(L.targetTouches,W=>P===W.identifier)||L.changedTouches&&(0,t.findInArray)(L.changedTouches,W=>P===W.identifier)}function k(L){if(L.targetTouches&&L.targetTouches[0])return L.targetTouches[0].identifier;if(L.changedTouches&&L.changedTouches[0])return L.changedTouches[0].identifier}function D(L){if(!L)return;let P=L.getElementById("react-draggable-style-el");P||(P=L.createElement("style"),P.type="text/css",P.id="react-draggable-style-el",P.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,P.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,L.getElementsByTagName("head")[0].appendChild(P)),L.body&&T(L.body,"react-draggable-transparent-selection")}function N(L){window.requestAnimationFrame?window.requestAnimationFrame(()=>{B(L)}):B(L)}function B(L){if(L)try{if(L.body&&R(L.body,"react-draggable-transparent-selection"),L.selection)L.selection.empty();else{const P=(L.defaultView||window).getSelection();P&&P.type!=="Caret"&&P.removeAllRanges()}}catch{}}function T(L,P){L.classList?L.classList.add(P):L.className.match(new RegExp(`(?:^|\\s)${P}(?!\\S)`))||(L.className+=` ${P}`)}function R(L,P){L.classList?L.classList.remove(P):L.className=L.className.replace(new RegExp(`(?:^|\\s)${P}(?!\\S)`,"g"),"")}return Nt}var gr={},Gv;function e6(){if(Gv)return gr;Gv=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.canDragX=i,gr.canDragY=o,gr.createCoreData=a,gr.createDraggableData=l,gr.getBoundPosition=n,gr.getControlPosition=s,gr.snapToGrid=r;var t=ah(),e=f0();function n(d,p,f){if(!d.props.bounds)return[p,f];let{bounds:g}=d.props;g=typeof g=="string"?g:u(g);const x=c(d);if(typeof g=="string"){const{ownerDocument:w}=x,k=w.defaultView;let D;if(g==="parent"?D=x.parentNode:D=x.getRootNode().querySelector(g),!(D instanceof k.HTMLElement))throw new Error('Bounds selector "'+g+'" could not find an element.');const N=D,B=k.getComputedStyle(x),T=k.getComputedStyle(N);g={left:-x.offsetLeft+(0,t.int)(T.paddingLeft)+(0,t.int)(B.marginLeft),top:-x.offsetTop+(0,t.int)(T.paddingTop)+(0,t.int)(B.marginTop),right:(0,e.innerWidth)(N)-(0,e.outerWidth)(x)-x.offsetLeft+(0,t.int)(T.paddingRight)-(0,t.int)(B.marginRight),bottom:(0,e.innerHeight)(N)-(0,e.outerHeight)(x)-x.offsetTop+(0,t.int)(T.paddingBottom)-(0,t.int)(B.marginBottom)}}return(0,t.isNum)(g.right)&&(p=Math.min(p,g.right)),(0,t.isNum)(g.bottom)&&(f=Math.min(f,g.bottom)),(0,t.isNum)(g.left)&&(p=Math.max(p,g.left)),(0,t.isNum)(g.top)&&(f=Math.max(f,g.top)),[p,f]}function r(d,p,f){const g=Math.round(p/d[0])*d[0],x=Math.round(f/d[1])*d[1];return[g,x]}function i(d){return d.props.axis==="both"||d.props.axis==="x"}function o(d){return d.props.axis==="both"||d.props.axis==="y"}function s(d,p,f){const g=typeof p=="number"?(0,e.getTouch)(d,p):null;if(typeof p=="number"&&!g)return null;const x=c(f),w=f.props.offsetParent||x.offsetParent||x.ownerDocument.body;return(0,e.offsetXYFromParent)(g||d,w,f.props.scale)}function a(d,p,f){const g=!(0,t.isNum)(d.lastX),x=c(d);return g?{node:x,deltaX:0,deltaY:0,lastX:p,lastY:f,x:p,y:f}:{node:x,deltaX:p-d.lastX,deltaY:f-d.lastY,lastX:d.lastX,lastY:d.lastY,x:p,y:f}}function l(d,p){const f=d.props.scale;return{node:p.node,x:d.state.x+p.deltaX/f,y:d.state.y+p.deltaY/f,deltaX:p.deltaX/f,deltaY:p.deltaY/f,lastX:d.state.x,lastY:d.state.y}}function u(d){return{left:d.left,top:d.top,right:d.right,bottom:d.bottom}}function c(d){const p=d.findDOMNode();if(!p)throw new Error("<DraggableCore>: Unmounted during event!");return p}return gr}var Ba={},tc={},Xv;function t6(){if(Xv)return tc;Xv=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.default=t;function t(){}return tc}var Yv;function FL(){if(Yv)return Ba;Yv=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.default=void 0;var t=l(Ld()),e=a(Q5()),n=a(t4()),r=f0(),i=e6(),o=ah(),s=a(t6());function a(x){return x&&x.__esModule?x:{default:x}}function l(x,w){if(typeof WeakMap=="function")var k=new WeakMap,D=new WeakMap;return(l=function(N,B){if(!B&&N&&N.__esModule)return N;var T,R,L={__proto__:null,default:N};if(N===null||typeof N!="object"&&typeof N!="function")return L;if(T=B?D:k){if(T.has(N))return T.get(N);T.set(N,L)}for(const P in N)P!=="default"&&{}.hasOwnProperty.call(N,P)&&((R=(T=Object.defineProperty)&&Object.getOwnPropertyDescriptor(N,P))&&(R.get||R.set)?T(L,P,R):L[P]=N[P]);return L})(x,w)}function u(x,w,k){return(w=c(w))in x?Object.defineProperty(x,w,{value:k,enumerable:!0,configurable:!0,writable:!0}):x[w]=k,x}function c(x){var w=d(x,"string");return typeof w=="symbol"?w:w+""}function d(x,w){if(typeof x!="object"||!x)return x;var k=x[Symbol.toPrimitive];if(k!==void 0){var D=k.call(x,w);if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(x)}const p={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let f=p.mouse,g=class extends t.Component{constructor(){super(...arguments),u(this,"dragging",!1),u(this,"lastX",NaN),u(this,"lastY",NaN),u(this,"touchIdentifier",null),u(this,"mounted",!1),u(this,"handleDragStart",w=>{if(this.props.onMouseDown(w),!this.props.allowAnyClick&&typeof w.button=="number"&&w.button!==0)return!1;const k=this.findDOMNode();if(!k||!k.ownerDocument||!k.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:D}=k;if(this.props.disabled||!(w.target instanceof D.defaultView.Node)||this.props.handle&&!(0,r.matchesSelectorAndParentsTo)(w.target,this.props.handle,k)||this.props.cancel&&(0,r.matchesSelectorAndParentsTo)(w.target,this.props.cancel,k))return;w.type==="touchstart"&&!this.props.allowMobileScroll&&w.preventDefault();const N=(0,r.getTouchIdentifier)(w);this.touchIdentifier=N;const B=(0,i.getControlPosition)(w,N,this);if(B==null)return;const{x:T,y:R}=B,L=(0,i.createCoreData)(this,T,R);(0,s.default)("DraggableCore: handleDragStart: %j",L),(0,s.default)("calling",this.props.onStart),!(this.props.onStart(w,L)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,r.addUserSelectStyles)(D),this.dragging=!0,this.lastX=T,this.lastY=R,(0,r.addEvent)(D,f.move,this.handleDrag),(0,r.addEvent)(D,f.stop,this.handleDragStop))}),u(this,"handleDrag",w=>{const k=(0,i.getControlPosition)(w,this.touchIdentifier,this);if(k==null)return;let{x:D,y:N}=k;if(Array.isArray(this.props.grid)){let R=D-this.lastX,L=N-this.lastY;if([R,L]=(0,i.snapToGrid)(this.props.grid,R,L),!R&&!L)return;D=this.lastX+R,N=this.lastY+L}const B=(0,i.createCoreData)(this,D,N);if((0,s.default)("DraggableCore: handleDrag: %j",B),this.props.onDrag(w,B)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const L=document.createEvent("MouseEvents");L.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(L)}return}this.lastX=D,this.lastY=N}),u(this,"handleDragStop",w=>{if(!this.dragging)return;const k=(0,i.getControlPosition)(w,this.touchIdentifier,this);if(k==null)return;let{x:D,y:N}=k;if(Array.isArray(this.props.grid)){let L=D-this.lastX||0,P=N-this.lastY||0;[L,P]=(0,i.snapToGrid)(this.props.grid,L,P),D=this.lastX+L,N=this.lastY+P}const B=(0,i.createCoreData)(this,D,N);if(this.props.onStop(w,B)===!1||this.mounted===!1)return!1;const R=this.findDOMNode();R&&this.props.enableUserSelectHack&&(0,r.scheduleRemoveUserSelectStyles)(R.ownerDocument),(0,s.default)("DraggableCore: handleDragStop: %j",B),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,R&&((0,s.default)("DraggableCore: Removing handlers"),(0,r.removeEvent)(R.ownerDocument,f.move,this.handleDrag),(0,r.removeEvent)(R.ownerDocument,f.stop,this.handleDragStop))}),u(this,"onMouseDown",w=>(f=p.mouse,this.handleDragStart(w))),u(this,"onMouseUp",w=>(f=p.mouse,this.handleDragStop(w))),u(this,"onTouchStart",w=>(f=p.touch,this.handleDragStart(w))),u(this,"onTouchEnd",w=>(f=p.touch,this.handleDragStop(w)))}componentDidMount(){this.mounted=!0;const w=this.findDOMNode();w&&(0,r.addEvent)(w,p.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const w=this.findDOMNode();if(w){const{ownerDocument:k}=w;(0,r.removeEvent)(k,p.mouse.move,this.handleDrag),(0,r.removeEvent)(k,p.touch.move,this.handleDrag),(0,r.removeEvent)(k,p.mouse.stop,this.handleDragStop),(0,r.removeEvent)(k,p.touch.stop,this.handleDragStop),(0,r.removeEvent)(w,p.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,r.scheduleRemoveUserSelectStyles)(k)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:n.default.findDOMNode(this)}render(){return t.cloneElement(t.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return Ba.default=g,u(g,"displayName","DraggableCore"),u(g,"propTypes",{allowAnyClick:e.default.bool,allowMobileScroll:e.default.bool,children:e.default.node.isRequired,disabled:e.default.bool,enableUserSelectHack:e.default.bool,offsetParent:function(x,w){if(x[w]&&x[w].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:e.default.arrayOf(e.default.number),handle:e.default.string,cancel:e.default.string,nodeRef:e.default.object,onStart:e.default.func,onDrag:e.default.func,onStop:e.default.func,onMouseDown:e.default.func,scale:e.default.number,className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),u(g,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),Ba}var Zv;function $L(){return Zv||(Zv=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),t.default=void 0;var e=d(Ld()),n=c(Q5()),r=c(t4()),i=RL(),o=f0(),s=e6(),a=ah(),l=c(FL()),u=c(t6());function c(k){return k&&k.__esModule?k:{default:k}}function d(k,D){if(typeof WeakMap=="function")var N=new WeakMap,B=new WeakMap;return(d=function(T,R){if(!R&&T&&T.__esModule)return T;var L,P,W={__proto__:null,default:T};if(T===null||typeof T!="object"&&typeof T!="function")return W;if(L=R?B:N){if(L.has(T))return L.get(T);L.set(T,W)}for(const de in T)de!=="default"&&{}.hasOwnProperty.call(T,de)&&((P=(L=Object.defineProperty)&&Object.getOwnPropertyDescriptor(T,de))&&(P.get||P.set)?L(W,de,P):W[de]=T[de]);return W})(k,D)}function p(){return p=Object.assign?Object.assign.bind():function(k){for(var D=1;D<arguments.length;D++){var N=arguments[D];for(var B in N)({}).hasOwnProperty.call(N,B)&&(k[B]=N[B])}return k},p.apply(null,arguments)}function f(k,D,N){return(D=g(D))in k?Object.defineProperty(k,D,{value:N,enumerable:!0,configurable:!0,writable:!0}):k[D]=N,k}function g(k){var D=x(k,"string");return typeof D=="symbol"?D:D+""}function x(k,D){if(typeof k!="object"||!k)return k;var N=k[Symbol.toPrimitive];if(N!==void 0){var B=N.call(k,D);if(typeof B!="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(k)}class w extends e.Component{static getDerivedStateFromProps(D,N){let{position:B}=D,{prevPropsPosition:T}=N;return B&&(!T||B.x!==T.x||B.y!==T.y)?((0,u.default)("Draggable: getDerivedStateFromProps %j",{position:B,prevPropsPosition:T}),{x:B.x,y:B.y,prevPropsPosition:{...B}}):null}constructor(D){super(D),f(this,"onDragStart",(N,B)=>{if((0,u.default)("Draggable: onDragStart: %j",B),this.props.onStart(N,(0,s.createDraggableData)(this,B))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),f(this,"onDrag",(N,B)=>{if(!this.state.dragging)return!1;(0,u.default)("Draggable: onDrag: %j",B);const T=(0,s.createDraggableData)(this,B),R={x:T.x,y:T.y,slackX:0,slackY:0};if(this.props.bounds){const{x:P,y:W}=R;R.x+=this.state.slackX,R.y+=this.state.slackY;const[de,q]=(0,s.getBoundPosition)(this,R.x,R.y);R.x=de,R.y=q,R.slackX=this.state.slackX+(P-R.x),R.slackY=this.state.slackY+(W-R.y),T.x=R.x,T.y=R.y,T.deltaX=R.x-this.state.x,T.deltaY=R.y-this.state.y}if(this.props.onDrag(N,T)===!1)return!1;this.setState(R)}),f(this,"onDragStop",(N,B)=>{if(!this.state.dragging||this.props.onStop(N,(0,s.createDraggableData)(this,B))===!1)return!1;(0,u.default)("Draggable: onDragStop: %j",B);const R={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:P,y:W}=this.props.position;R.x=P,R.y=W}this.setState(R)}),this.state={dragging:!1,dragged:!1,x:D.position?D.position.x:D.defaultPosition.x,y:D.position?D.position.y:D.defaultPosition.y,prevPropsPosition:{...D.position},slackX:0,slackY:0,isElementSVG:!1},D.position&&!(D.onDrag||D.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??r.default.findDOMNode(this)}render(){const{axis:D,bounds:N,children:B,defaultPosition:T,defaultClassName:R,defaultClassNameDragging:L,defaultClassNameDragged:P,position:W,positionOffset:de,scale:q,...ae}=this.props;let be={},re=null;const ge=!!!W||this.state.dragging,xe=W||T,De={x:(0,s.canDragX)(this)&&ge?this.state.x:xe.x,y:(0,s.canDragY)(this)&&ge?this.state.y:xe.y};this.state.isElementSVG?re=(0,o.createSVGTransform)(De,de):be=(0,o.createCSSTransform)(De,de);const We=(0,i.clsx)(B.props.className||"",R,{[L]:this.state.dragging,[P]:this.state.dragged});return e.createElement(l.default,p({},ae,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(B),{className:We,style:{...B.props.style,...be},transform:re}))}}t.default=w,f(w,"displayName","Draggable"),f(w,"propTypes",{...l.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),f(w,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})($p)),$p}var Qv;function KL(){if(Qv)return Ta.exports;Qv=1;const{default:t,DraggableCore:e}=$L();return Ta.exports=t,Ta.exports.default=t,Ta.exports.DraggableCore=e,Ta.exports}var jL=KL();const n6=nm(jL),qL=t=>{const e=_l.c(61),[n,r]=Ne.useState(!1),[i,o]=Ne.useState(t.node.attrs.text||""),[s,a]=Ne.useState(""),[l,u]=Ne.useState(0),[c,d]=Ne.useState("default"),p=Ne.useRef(""),f=t.editor.isEditable,g=Ne.useRef(null),x=Ne.useRef(null),w=Ne.useRef(null);let k;e[0]!==i||e[1]!==n||e[2]!==t.node.attrs.text?(k=()=>{!n&&t.node.attrs.text!==i&&o(t.node.attrs.text||"")},e[0]=i,e[1]=n,e[2]=t.node.attrs.text,e[3]=k):k=e[3];let D;e[4]!==n||e[5]!==t.node.attrs.text?(D=[t.node.attrs.text,n],e[4]=n,e[5]=t.node.attrs.text,e[6]=D):D=e[6],Ne.useEffect(k,D);let N;e[7]!==f||e[8]!==t.node.attrs.text?(N=()=>{f&&!t.node.attrs.text&&r(!0)},e[7]=f,e[8]=t.node.attrs.text,e[9]=N):N=e[9];let B;e[10]===Symbol.for("react.memo_cache_sentinel")?(B=[],e[10]=B):B=e[10],Ne.useEffect(N,B);let T;e[11]!==s||e[12]!==n?(T=()=>{n&&x.current&&(x.current.setInput(s),setTimeout(()=>{w.current?.focus()},50))},e[11]=s,e[12]=n,e[13]=T):T=e[13];let R;e[14]!==n?(R=[n],e[14]=n,e[15]=R):R=e[15],Ne.useEffect(T,R);let L;e[16]!==l||e[17]!==s?(L=h=>{if(!p.current)return;const m=p.current;if(p.current="",m.startsWith("{"))return;const y=["","","","","","","",""],b=y.includes(m);let v=s.substring(0,l);const _=s.substring(l);if(b&&l>0){const A=v[v.length-1];y.includes(A)&&(v=v.substring(0,v.length-1))}const C=v+m+_;a(C),x.current?.setInput(C);const E=v.length+m.length;u(E),setTimeout(()=>{w.current?.setSelectionRange(E,E),w.current?.focus(),x.current?.setCaretPosition(E)},0)},e[16]=l,e[17]=s,e[18]=L):L=e[18];const P=L;let W;e[19]===Symbol.for("react.memo_cache_sentinel")?(W=h=>{const m=h.target.value;a(m);const y=h.target.selectionStart||0;u(y),x.current?.setInput(m)},e[19]=W):W=e[19];const de=W;let q;e[20]===Symbol.for("react.memo_cache_sentinel")?(q=()=>{const h=w.current?.selectionStart||0;u(h),x.current?.setCaretPosition(h)},e[20]=q):q=e[20];const ae=q;let be;e[21]===Symbol.for("react.memo_cache_sentinel")?(be=h=>{ae()},e[21]=be):be=e[21];const re=be;let ce,ge,xe,De;if(e[22]!==l||e[23]!==s||e[24]!==i||e[25]!==f||e[26]!==n||e[27]!==t){ge=m=>{if(m==="{shift}"){d(VL);return}if(p.current=m,m==="{enter}"){p.current="",xe();return}if(m==="{escape}"){p.current="",ce();return}if(m==="{bksp}"){if(p.current="",l>0){const y=s.substring(0,l-1),b=s.substring(l),v=y+b;a(v),x.current?.setInput(v);const _=l-1;u(_),setTimeout(()=>{w.current?.setSelectionRange(_,_),w.current?.focus(),x.current?.setCaretPosition(_)},0)}return}if(m==="{arrowleft}"||m==="{arrowright}"){ae();const y=w.current?.selectionStart||0;let b=y;m==="{arrowleft}"?b=Math.min(i.length,y+1):m==="{arrowright}"&&(b=Math.max(0,y-1)),w.current?.setSelectionRange(b,b),w.current?.focus(),x.current?.setCaretPosition(b);return}};let h;e[32]!==i||e[33]!==f||e[34]!==n?(h=()=>{f&&(n||a(i),r(!n))},e[32]=i,e[33]=f,e[34]=n,e[35]=h):h=e[35],De=h,xe=()=>{o(s),t.updateAttributes({text:s}),r(!1)},ce=()=>{r(!1)},e[22]=l,e[23]=s,e[24]=i,e[25]=f,e[26]=n,e[27]=t,e[28]=ce,e[29]=ge,e[30]=xe,e[31]=De}else ce=e[28],ge=e[29],xe=e[30],De=e[31];const We=f?"bg-green-50 hover:bg-green-100 border border-green-200":"bg-transparent",et=!i&&f?"text-muted-foreground":"text-foreground",Ae=n&&f&&"ring-2 ring-green-500 ring-offset-2";let Ke;e[36]!==We||e[37]!==et||e[38]!==Ae?(Ke=rl("relative inline-flex items-center justify-center min-w-[60px] min-h-[30px] px-2 py-1 rounded cursor-pointer transition-all",We,et,Ae),e[36]=We,e[37]=et,e[38]=Ae,e[39]=Ke):Ke=e[39];let ot;e[40]!==i?(ot=i?he.jsx("span",{className:"text-xl font-medium font-arabic",dir:"rtl",children:i}):he.jsx("span",{className:"text-sm italic opacity-50",children:"Arabic..."}),e[40]=i,e[41]=ot):ot=e[41];let Bt;e[42]!==f?(Bt=f&&he.jsx("div",{className:"absolute -top-2 -right-2 bg-green-100 text-[8px] px-1 rounded text-green-700 border border-green-200 select-none",children:"AR"}),e[42]=f,e[43]=Bt):Bt=e[43];let Ot;e[44]!==Ke||e[45]!==ot||e[46]!==Bt||e[47]!==De?(Ot=he.jsxs("div",{onClick:De,className:Ke,children:[ot,Bt]}),e[44]=Ke,e[45]=ot,e[46]=Bt,e[47]=De,e[48]=Ot):Ot=e[48];let S;e[49]!==s||e[50]!==ce||e[51]!==ge||e[52]!==xe||e[53]!==f||e[54]!==c||e[55]!==P||e[56]!==n?(S=n&&f&&rm.createPortal(he.jsx("div",{className:"fixed inset-0 z-[9999] pointer-events-none",children:he.jsx(n6,{nodeRef:g,handle:".drag-handle",children:he.jsxs("div",{ref:g,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-background border shadow-2xl rounded-xl w-[650px] max-w-[95vw] p-4 pointer-events-auto cursor-auto",children:[he.jsxs("div",{className:"flex justify-between items-center mb-3 border-b pb-2 drag-handle cursor-move",children:[he.jsxs("div",{className:"flex items-center gap-2",children:[he.jsx(s4,{className:"h-4 w-4 text-muted-foreground"}),he.jsx(o4,{className:"h-4 w-4 text-primary"}),he.jsx("span",{className:"font-semibold text-sm select-none",children:"Arabic Keyboard"})]}),he.jsx(Cn,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full hover:bg-destructive/10 hover:text-destructive",onClick:()=>r(!1),children:he.jsx(i4,{className:"h-4 w-4"})})]}),he.jsx("div",{className:"mb-4",children:he.jsx(r4,{ref:w,value:s,onChange:de,onSelect:re,onMouseUp:re,onClick:re,onKeyUp:re,dir:"rtl",className:"font-arabic text-2xl h-12 text-right bg-slate-50 focus-visible:ring-1 focus-visible:ring-primary",placeholder:"Type Arabic here...",autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"})}),he.jsxs("div",{className:"flex gap-2 mb-4",children:[he.jsx(Cn,{onClick:xe,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",size:"lg",children:"Submit"}),he.jsx(Cn,{onClick:ce,variant:"outline",className:"flex-1",size:"lg",children:"Cancel"})]}),he.jsx("div",{className:"arabic-keyboard-wrapper [&_.hg-theme-default]:bg-transparent [&_.hg-button]:h-14 [&_.hg-button]:text-2xl [&_.hg-button]:font-arabic [&_.hg-button]:font-medium",children:he.jsx(Z5,{keyboardRef:h=>x.current=h,onChange:P,onKeyPress:ge,layoutName:c,layout:{default:["          - =","           ","          ","         ","       ","{shift} {arrowright} {space} {arrowleft} {bksp}"],shift:["! @ # $ % ^ & * ) ( _ +","        > < |",'~   [ ]  / : " {enter}',"{shift} {arrowright} {space} {arrowleft} {bksp}"]},display:{"{bksp}":"","{enter}":"Done","{shift}":"","{space}":" ","{escape}":"Esc","{arrowleft}":"","{arrowright}":""},theme:"hg-theme-default hg-layout-default myTheme",inputName:"arabic",rtl:!0})})]})})}),document.body),e[49]=s,e[50]=ce,e[51]=ge,e[52]=xe,e[53]=f,e[54]=c,e[55]=P,e[56]=n,e[57]=S):S=e[57];let M;return e[58]!==Ot||e[59]!==S?(M=he.jsxs(Om,{className:"inline-block align-middle mx-1",children:[Ot,S]}),e[58]=Ot,e[59]=S,e[60]=M):M=e[60],M};function VL(t){return t==="default"?"shift":"default"}const HL=gn.create({name:"arabicComponent",group:"inline",inline:!0,atom:!0,addAttributes(){return{text:{default:""}}},parseHTML(){return[{tag:'span[data-type="arabic-component"]'},{tag:"arabic-component"}]},renderHTML({HTMLAttributes:t}){return["span",St(t,{"data-type":"arabic-component"}),""]},addNodeView(){return Nm(qL)},addCommands(){return{addArabicComponent:()=>({commands:t})=>t.insertContent({type:"arabicComponent",attrs:{text:""}})}}}),e4={"":"ha","":"na","":"ca","":"ra","":"ka","":"da","":"ta","":"sa","":"wa","":"la","":"pa","":"dha","":"ja","":"ya","":"nya","":"ma","":"ga","":"ba","":"tha","":"nga","":"aa","":"i","":"u","":"e","":"","":"o","":"ai","":"au","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"},WL=t=>{const e=_l.c(69),[n,r]=Ne.useState(!1),[i,o]=Ne.useState(t.node.attrs.text||""),[s,a]=Ne.useState(""),[l,u]=Ne.useState(0),[c,d]=Ne.useState("default"),[p,f]=Ne.useState(t.node.attrs.showTransliteration||!1),g=Ne.useRef(""),x=t.editor.isEditable,w=Ne.useRef(null),k=Ne.useRef(null),D=Ne.useRef(null);let N;e[0]!==i||e[1]!==n||e[2]!==t.node.attrs.showTransliteration||e[3]!==t.node.attrs.text||e[4]!==p?(N=()=>{!n&&t.node.attrs.text!==i&&o(t.node.attrs.text||""),t.node.attrs.showTransliteration!==p&&f(t.node.attrs.showTransliteration||!1)},e[0]=i,e[1]=n,e[2]=t.node.attrs.showTransliteration,e[3]=t.node.attrs.text,e[4]=p,e[5]=N):N=e[5];let B;e[6]!==n||e[7]!==t.node.attrs.showTransliteration||e[8]!==t.node.attrs.text?(B=[t.node.attrs.text,t.node.attrs.showTransliteration,n],e[6]=n,e[7]=t.node.attrs.showTransliteration,e[8]=t.node.attrs.text,e[9]=B):B=e[9],Ne.useEffect(N,B);let T;e[10]!==x||e[11]!==t.node.attrs.text?(T=()=>{x&&!t.node.attrs.text&&r(!0)},e[10]=x,e[11]=t.node.attrs.text,e[12]=T):T=e[12];let R;e[13]===Symbol.for("react.memo_cache_sentinel")?(R=[],e[13]=R):R=e[13],Ne.useEffect(T,R);let L;e[14]!==s||e[15]!==n?(L=()=>{n&&k.current&&(k.current.setInput(s),setTimeout(()=>{D.current?.focus()},50))},e[14]=s,e[15]=n,e[16]=L):L=e[16];let P;e[17]!==n?(P=[n],e[17]=n,e[18]=P):P=e[18],Ne.useEffect(L,P);let W;e[19]!==p?(W=()=>{const v={"{bksp}":"","{enter}":"Done","{shift}":"","{space}":" ","{escape}":"Esc","{arrowleft}":"","{arrowright}":""};if(!p)return v;const _={...v};return[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","",""]].forEach(E=>{E.forEach(A=>{const I=e4[A]||e4[A.charAt(0)];I&&(_[A]=`${A}
${I}`)})}),_},e[19]=p,e[20]=W):W=e[20];const de=W;let q;e[21]!==l||e[22]!==s?(q=v=>{if(!g.current)return;const _=g.current;g.current="";const C=_.split(`
`)[0];if(C.startsWith("{"))return;const E=["","","","","","","",""],A=E.includes(C);let I=s.substring(0,l);const K=s.substring(l);if(A&&l>0){const j=I[I.length-1];E.includes(j)&&(I=I.substring(0,I.length-1))}const F=I+C+K;a(F),k.current?.setInput(F);const z=I.length+C.length;u(z),setTimeout(()=>{D.current?.setSelectionRange(z,z),D.current?.focus(),k.current?.setCaretPosition(z)},0)},e[21]=l,e[22]=s,e[23]=q):q=e[23];const ae=q;let be;e[24]===Symbol.for("react.memo_cache_sentinel")?(be=v=>{const _=v.target.value;a(_);const C=v.target.selectionStart||0;u(C),k.current?.setInput(_)},e[24]=be):be=e[24];const re=be;let ce;e[25]===Symbol.for("react.memo_cache_sentinel")?(ce=()=>{const v=D.current?.selectionStart||0;u(v),k.current?.setCaretPosition(v)},e[25]=ce):ce=e[25];const ge=ce;let xe;e[26]===Symbol.for("react.memo_cache_sentinel")?(xe=v=>{ge()},e[26]=xe):xe=e[26];const De=xe;let We,et,Ae,Ke;if(e[27]!==l||e[28]!==s||e[29]!==i||e[30]!==x||e[31]!==n||e[32]!==t||e[33]!==p){et=_=>{if(_==="{shift}"){d(UL);return}if(g.current=_,_==="{enter}"){g.current="",Ae();return}if(_==="{escape}"){g.current="",We();return}if(_==="{bksp}"){if(g.current="",l>0){const C=s.substring(0,l-1),E=s.substring(l),A=C+E;a(A),k.current?.setInput(A);const I=l-1;u(I),setTimeout(()=>{D.current?.setSelectionRange(I,I),D.current?.focus(),k.current?.setCaretPosition(I)},0)}return}if(_==="{arrowleft}"||_==="{arrowright}"){ge();const C=D.current?.selectionStart||0;let E=C;_==="{arrowleft}"?E=Math.max(0,C-1):_==="{arrowright}"&&(E=Math.min(s.length,C+1)),D.current?.setSelectionRange(E,E),D.current?.focus(),k.current?.setCaretPosition(E);return}};let v;e[38]!==i||e[39]!==x||e[40]!==n?(v=()=>{x&&(n||a(i),r(!n))},e[38]=i,e[39]=x,e[40]=n,e[41]=v):v=e[41],Ke=v,Ae=()=>{o(s),t.updateAttributes({text:s,showTransliteration:p}),r(!1)},We=()=>{r(!1)},e[27]=l,e[28]=s,e[29]=i,e[30]=x,e[31]=n,e[32]=t,e[33]=p,e[34]=We,e[35]=et,e[36]=Ae,e[37]=Ke}else We=e[34],et=e[35],Ae=e[36],Ke=e[37];const ot=x?"bg-orange-50 hover:bg-orange-100 border border-orange-200":"bg-transparent",Bt=!i&&x?"text-muted-foreground":"text-foreground",Ot=n&&x&&"ring-2 ring-orange-500 ring-offset-2";let S;e[42]!==ot||e[43]!==Bt||e[44]!==Ot?(S=rl("relative inline-flex flex-col items-center justify-center min-w-[60px] min-h-[30px] px-2 py-1 rounded cursor-pointer transition-all",ot,Bt,Ot),e[42]=ot,e[43]=Bt,e[44]=Ot,e[45]=S):S=e[45];let M;e[46]!==i?(M=i?he.jsx("span",{className:"text-xl font-medium font-javanese",children:i}):he.jsx("span",{className:"text-sm italic opacity-50",children:"Javanese..."}),e[46]=i,e[47]=M):M=e[47];let h;e[48]!==x?(h=x&&he.jsx("div",{className:"absolute -top-2 -right-2 bg-orange-100 text-[8px] px-1 rounded text-orange-700 border border-orange-200 select-none",children:"JW"}),e[48]=x,e[49]=h):h=e[49];let m;e[50]!==S||e[51]!==M||e[52]!==h||e[53]!==Ke?(m=he.jsxs("div",{onClick:Ke,className:S,children:[M,h]}),e[50]=S,e[51]=M,e[52]=h,e[53]=Ke,e[54]=m):m=e[54];let y;e[55]!==s||e[56]!==de||e[57]!==We||e[58]!==et||e[59]!==Ae||e[60]!==x||e[61]!==c||e[62]!==ae||e[63]!==n||e[64]!==p?(y=n&&x&&rm.createPortal(he.jsx("div",{className:"fixed inset-0 z-[9999] pointer-events-none",children:he.jsx(n6,{nodeRef:w,handle:".drag-handle",children:he.jsxs("div",{ref:w,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-background border shadow-2xl rounded-xl w-[700px] max-w-[95vw] p-4 pointer-events-auto cursor-auto",children:[he.jsxs("div",{className:"flex justify-between items-center mb-3 border-b pb-2 drag-handle cursor-move",children:[he.jsxs("div",{className:"flex items-center gap-2",children:[he.jsx(s4,{className:"h-4 w-4 text-muted-foreground"}),he.jsx(o4,{className:"h-4 w-4 text-primary"}),he.jsx("span",{className:"font-semibold text-sm select-none",children:"Javanese Keyboard (Hanacaraka)"})]}),he.jsx(Cn,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full hover:bg-destructive/10 hover:text-destructive",onClick:()=>r(!1),children:he.jsx(i4,{className:"h-4 w-4"})})]}),he.jsx("div",{className:"mb-4",children:he.jsx(r4,{ref:D,value:s,onChange:re,onSelect:De,onMouseUp:De,onClick:De,onKeyUp:De,className:"font-javanese text-2xl h-12 bg-slate-50 focus-visible:ring-1 focus-visible:ring-primary",placeholder:"Type Javanese here...",autoFocus:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"})}),he.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[he.jsx(o6,{id:"show-transliteration",checked:p,onCheckedChange:v=>f(v)}),he.jsx("label",{htmlFor:"show-transliteration",className:"text-sm cursor-pointer select-none",children:"Show Transliteration"})]}),he.jsxs("div",{className:"flex gap-2 mb-4",children:[he.jsx(Cn,{onClick:Ae,className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white",size:"lg",children:"Submit"}),he.jsx(Cn,{onClick:We,variant:"outline",className:"flex-1",size:"lg",children:"Cancel"})]}),he.jsx("div",{className:rl("javanese-keyboard-wrapper [&_.hg-theme-default]:bg-transparent [&_.hg-button]:font-javanese [&_.hg-button]:font-medium",p?"[&_.hg-button]:h-20 [&_.hg-button]:min-w-[3.5rem] [&_.hg-button]:text-base [&_.hg-button]:p-1":"[&_.hg-button]:h-16 [&_.hg-button]:min-w-[3rem] [&_.hg-button]:text-2xl [&_.hg-button]:leading-tight"),children:he.jsx(Z5,{keyboardRef:v=>k.current=v,onChange:ae,onKeyPress:et,layoutName:c,layout:{default:["         ","         ","         ","       ","{shift} {arrowleft} {arrowright} {space} {bksp}"],shift:["         ","         ","        ","{shift} {arrowleft} {arrowright} {space} {bksp}"]},display:de(),theme:"hg-theme-default hg-layout-default myTheme",inputName:"javanese"})})]})})}),document.body),e[55]=s,e[56]=de,e[57]=We,e[58]=et,e[59]=Ae,e[60]=x,e[61]=c,e[62]=ae,e[63]=n,e[64]=p,e[65]=y):y=e[65];let b;return e[66]!==m||e[67]!==y?(b=he.jsxs(Om,{className:"inline-block align-middle mx-1",children:[m,y]}),e[66]=m,e[67]=y,e[68]=b):b=e[68],b};function UL(t){return t==="default"?"shift":"default"}const JL=gn.create({name:"javaneseComponent",group:"inline",inline:!0,atom:!0,addAttributes(){return{text:{default:""},showTransliteration:{default:!1}}},parseHTML(){return[{tag:'span[data-type="javanese-component"]'},{tag:"javanese-component"}]},renderHTML({HTMLAttributes:t}){return["span",St(t,{"data-type":"javanese-component"}),""]},addNodeView(){return Nm(WL)},addCommands(){return{addJavaneseComponent:()=>({commands:t})=>t.insertContent({type:"javaneseComponent",attrs:{text:"",showTransliteration:!1}})}}});function iT(t){const e=_l.c(24),{value:n,onChange:r,className:i,readOnly:o}=t,s=o===void 0?!1:o;let a;e:{if(typeof n=="string"){a=n;break e}if(n==null){a="";break e}console.warn("[RichTextEditor] Invalid content type received:",typeof n,n),a=""}const l=a,u=!s;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=[hM.configure({underline:!1}),H3,j_,TL,HL,JL],e[0]=c):c=e[0];let d;e[1]!==r?(d=R=>{const{editor:L}=R;r?.(L.getHTML())},e[1]=r,e[2]=d):d=e[2];const p=s?"text-sm":"min-h-[150px] p-4";let f;e[3]!==p?(f=rl("max-w-none focus:outline-none [&_ul]:list-disc [&_ul]:pl-5 [&_ol]:list-decimal [&_ol]:pl-5",p),e[3]=p,e[4]=f):f=e[4];let g;e[5]!==f?(g={attributes:{class:f}},e[5]=f,e[6]=g):g=e[6];let x;e[7]!==l||e[8]!==u||e[9]!==d||e[10]!==g?(x={editable:u,extensions:c,content:l,onUpdate:d,editorProps:g},e[7]=l,e[8]=u,e[9]=d,e[10]=g,e[11]=x):x=e[11];const w=_S(x);if(!w)return null;const k=!s&&"border rounded-md";let D;e[12]!==i||e[13]!==k?(D=rl("bg-background",k,i),e[12]=i,e[13]=k,e[14]=D):D=e[14];let N;e[15]!==w||e[16]!==s?(N=!s&&he.jsxs("div",{className:"flex flex-wrap items-center gap-1 border-b bg-muted/50 p-1",children:[he.jsx(Cn,{variant:w.isActive("bold")?"secondary":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>w.chain().focus().toggleBold().run(),title:"Bold",children:he.jsx(a6,{className:"h-4 w-4"})}),he.jsx(Cn,{variant:w.isActive("italic")?"secondary":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>w.chain().focus().toggleItalic().run(),title:"Italic",children:he.jsx(u6,{className:"h-4 w-4"})}),he.jsx(Cn,{variant:w.isActive("underline")?"secondary":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>w.chain().focus().toggleUnderline().run(),title:"Underline",children:he.jsx(x6,{className:"h-4 w-4"})}),he.jsx("div",{className:"w-px h-6 bg-border mx-1"}),he.jsx(Cn,{variant:w.isActive("bulletList")?"secondary":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>w.chain().focus().toggleBulletList().run(),title:"Bullet List",children:he.jsx(m6,{className:"h-4 w-4"})}),he.jsx(Cn,{variant:w.isActive("orderedList")?"secondary":"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>w.chain().focus().toggleOrderedList().run(),title:"Ordered List",children:he.jsx(p6,{className:"h-4 w-4"})}),he.jsx("div",{className:"w-px h-6 bg-border mx-1"}),he.jsxs(Cn,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs font-medium gap-1 text-blue-600 dark:text-blue-400",onClick:()=>w.chain().focus().addMathComponent().run(),title:"Insert Math Formula",children:[he.jsx(b6,{className:"h-4 w-4"}),"Math"]}),he.jsxs(Cn,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs font-medium gap-1 text-green-600 dark:text-green-400",onClick:()=>w.chain().focus().addArabicComponent().run(),title:"Insert Arabic Text",children:[he.jsx(v0,{className:"h-4 w-4"}),"Arabic"]}),he.jsxs(Cn,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs font-medium gap-1 text-orange-600 dark:text-orange-400",onClick:()=>w.chain().focus().addJavaneseComponent().run(),title:"Insert Javanese Text (Hanacaraka)",children:[he.jsx(v0,{className:"h-4 w-4"}),"Jawa"]})]}),e[15]=w,e[16]=s,e[17]=N):N=e[17];let B;e[18]!==w?(B=he.jsx(yS,{editor:w}),e[18]=w,e[19]=B):B=e[19];let T;return e[20]!==D||e[21]!==N||e[22]!==B?(T=he.jsxs("div",{className:D,children:[N,B]}),e[20]=D,e[21]=N,e[22]=B,e[23]=T):T=e[23],T}export{m6 as L,Y5 as M,iT as R,nT as u};

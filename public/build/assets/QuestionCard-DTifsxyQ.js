import{r as p,j as r,c as T}from"./app-BL23_ioL.js";import{b as we,a as je,e as Ne,C as ye}from"./card-BPYLlYs-.js";import{B as G}from"./badge-J0MIFrA3.js";import{c as ke,u as Y,b as _e,a as $,B as Q}from"./button-ErPUhfKM.js";import{D as Ae,T as Ce,S as Pe}from"./ScoreSelector-DIAoZ7CZ.js";import{I as Oe}from"./input-CZPc4iR6.js";import{u as Re,c as Se,a as U,P as Z}from"./index-DuTHxAZ2.js";import{u as Ee,P as $e,h as Te,R as Me,a as Ke,F as Fe,D as Ie}from"./index-DFAfDP5U.js";import{c as ee,R as De,A as te,C as Ue,a as Be}from"./index-CneOgjps.js";import{P as re}from"./index-BoQRUedT.js";import{R as B,M as Le}from"./RichTextEditor-BBqXt6Vd.js";import{u as Ve,a as qe,M as We,B as He,C as ze,i as Ge,H as se,P as ae}from"./style-CnmbGnv_.js";import{M as q}from"./MathRenderer-Dmg9cVUs.js";import{C as Je}from"./circle-check-DAVIKFey.js";import{S as Qe}from"./square-check-big-CfvcNerE.js";import{S as Xe}from"./square-DDqxBGSL.js";import{G as Ye}from"./grip-vertical-CIej0FFK.js";import{C as ne}from"./index-Uqd2XL9l.js";import{X as oe}from"./x-Bvzm8Mbo.js";import{S as Ze}from"./square-pen-BLYf6IE4.js";import{T as et}from"./trash-2-BZUYrCA3.js";const tt=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],rt=ke("Tag",tt);function st(i,e,t,c){var a=this,n=p.useRef(null),d=p.useRef(0),l=p.useRef(0),o=p.useRef(null),s=p.useRef([]),u=p.useRef(),m=p.useRef(),x=p.useRef(i),h=p.useRef(!0);x.current=i;var b=typeof window<"u",f=!e&&e!==0&&b;if(typeof i!="function")throw new TypeError("Expected a function");e=+e||0;var w=!!(t=t||{}).leading,v=!("trailing"in t)||!!t.trailing,y="maxWait"in t,k="debounceOnServer"in t&&!!t.debounceOnServer,_=y?Math.max(+t.maxWait||0,e):null;p.useEffect(function(){return h.current=!0,function(){h.current=!1}},[]);var P=p.useMemo(function(){var O=function(j){var N=s.current,K=u.current;return s.current=u.current=null,d.current=j,l.current=l.current||j,m.current=x.current.apply(K,N)},A=function(j,N){f&&cancelAnimationFrame(o.current),o.current=f?requestAnimationFrame(j):setTimeout(j,N)},C=function(j){if(!h.current)return!1;var N=j-n.current;return!n.current||N>=e||N<0||y&&j-d.current>=_},M=function(j){return o.current=null,v&&s.current?O(j):(s.current=u.current=null,m.current)},R=function j(){var N=Date.now();if(w&&l.current===d.current&&E(),C(N))return M(N);if(h.current){var K=e-(N-n.current),g=y?Math.min(K,_-(N-d.current)):K;A(j,g)}},E=function(){c&&c({})},S=function(){if(b||k){var j=Date.now(),N=C(j);if(s.current=[].slice.call(arguments),u.current=a,n.current=j,N){if(!o.current&&h.current)return d.current=n.current,A(R,e),w?O(n.current):m.current;if(y)return A(R,e),O(n.current)}return o.current||A(R,e),m.current}};return S.cancel=function(){var j=o.current;j&&(f?cancelAnimationFrame(o.current):clearTimeout(o.current)),d.current=0,s.current=n.current=u.current=o.current=null,j&&c&&c({})},S.isPending=function(){return!!o.current},S.flush=function(){return o.current?M(Date.now()):m.current},S},[w,y,e,_,v,f,b,k,c]);return P}function at(i,e){return i===e}function nt(i,e,t){var c=at,a=p.useRef(i),n=p.useState({})[1],d=st(p.useCallback(function(o){a.current=o,n({})},[n]),e,t,n),l=p.useRef(i);return c(l.current,i)||(d(i),l.current=i),[a.current,d]}var W="Popover",[le,xr]=Se(W,[ee]),L=ee(),[ot,I]=le(W),ie=i=>{const{__scopePopover:e,children:t,open:c,defaultOpen:a,onOpenChange:n,modal:d=!1}=i,l=L(e),o=p.useRef(null),[s,u]=p.useState(!1),[m,x]=Re({prop:c,defaultProp:a??!1,onChange:n,caller:W});return r.jsx(De,{...l,children:r.jsx(ot,{scope:e,contentId:Ee(),triggerRef:o,open:m,onOpenChange:x,onOpenToggle:p.useCallback(()=>x(h=>!h),[x]),hasCustomAnchor:s,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:d,children:t})})};ie.displayName=W;var de="PopoverAnchor",lt=p.forwardRef((i,e)=>{const{__scopePopover:t,...c}=i,a=I(de,t),n=L(t),{onCustomAnchorAdd:d,onCustomAnchorRemove:l}=a;return p.useEffect(()=>(d(),()=>l()),[d,l]),r.jsx(te,{...n,...c,ref:e})});lt.displayName=de;var ce="PopoverTrigger",ue=p.forwardRef((i,e)=>{const{__scopePopover:t,...c}=i,a=I(ce,t),n=L(t),d=Y(e,a.triggerRef),l=r.jsx(re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":he(a.open),...c,ref:d,onClick:U(i.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:r.jsx(te,{asChild:!0,...n,children:l})});ue.displayName=ce;var J="PopoverPortal",[it,dt]=le(J,{forceMount:void 0}),me=i=>{const{__scopePopover:e,forceMount:t,children:c,container:a}=i,n=I(J,e);return r.jsx(it,{scope:e,forceMount:t,children:r.jsx(Z,{present:t||n.open,children:r.jsx($e,{asChild:!0,container:a,children:c})})})};me.displayName=J;var D="PopoverContent",fe=p.forwardRef((i,e)=>{const t=dt(D,i.__scopePopover),{forceMount:c=t.forceMount,...a}=i,n=I(D,i.__scopePopover);return r.jsx(Z,{present:c||n.open,children:n.modal?r.jsx(ut,{...a,ref:e}):r.jsx(mt,{...a,ref:e})})});fe.displayName=D;var ct=_e("PopoverContent.RemoveScroll"),ut=p.forwardRef((i,e)=>{const t=I(D,i.__scopePopover),c=p.useRef(null),a=Y(e,c),n=p.useRef(!1);return p.useEffect(()=>{const d=c.current;if(d)return Te(d)},[]),r.jsx(Me,{as:ct,allowPinchZoom:!0,children:r.jsx(pe,{...i,ref:a,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:U(i.onCloseAutoFocus,d=>{d.preventDefault(),n.current||t.triggerRef.current?.focus()}),onPointerDownOutside:U(i.onPointerDownOutside,d=>{const l=d.detail.originalEvent,o=l.button===0&&l.ctrlKey===!0,s=l.button===2||o;n.current=s},{checkForDefaultPrevented:!1}),onFocusOutside:U(i.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),mt=p.forwardRef((i,e)=>{const t=I(D,i.__scopePopover),c=p.useRef(!1),a=p.useRef(!1);return r.jsx(pe,{...i,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:n=>{i.onCloseAutoFocus?.(n),n.defaultPrevented||(c.current||t.triggerRef.current?.focus(),n.preventDefault()),c.current=!1,a.current=!1},onInteractOutside:n=>{i.onInteractOutside?.(n),n.defaultPrevented||(c.current=!0,n.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=n.target;t.triggerRef.current?.contains(d)&&n.preventDefault(),n.detail.originalEvent.type==="focusin"&&a.current&&n.preventDefault()}})}),pe=p.forwardRef((i,e)=>{const{__scopePopover:t,trapFocus:c,onOpenAutoFocus:a,onCloseAutoFocus:n,disableOutsidePointerEvents:d,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:u,...m}=i,x=I(D,t),h=L(t);return Ke(),r.jsx(Fe,{asChild:!0,loop:!0,trapped:c,onMountAutoFocus:a,onUnmountAutoFocus:n,children:r.jsx(Ie,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:s,onDismiss:()=>x.onOpenChange(!1),children:r.jsx(Ue,{"data-state":he(x.open),role:"dialog",id:x.contentId,...h,...m,ref:e,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),xe="PopoverClose",ft=p.forwardRef((i,e)=>{const{__scopePopover:t,...c}=i,a=I(xe,t);return r.jsx(re.button,{type:"button",...c,ref:e,onClick:U(i.onClick,()=>a.onOpenChange(!1))})});ft.displayName=xe;var pt="PopoverArrow",xt=p.forwardRef((i,e)=>{const{__scopePopover:t,...c}=i,a=L(t);return r.jsx(Be,{...a,...c,ref:e})});xt.displayName=pt;function he(i){return i?"open":"closed"}var ht=ie,gt=ue,bt=me,ge=fe;const vt=ht,wt=gt,be=p.forwardRef((i,e)=>{const t=T.c(13);let c,a,n,d;t[0]!==i?({className:c,align:n,sideOffset:d,...a}=i,t[0]=i,t[1]=c,t[2]=a,t[3]=n,t[4]=d):(c=t[1],a=t[2],n=t[3],d=t[4]);const l=n===void 0?"center":n,o=d===void 0?4:d;let s;t[5]!==c?(s=$("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",c),t[5]=c,t[6]=s):s=t[6];let u;return t[7]!==l||t[8]!==a||t[9]!==e||t[10]!==o||t[11]!==s?(u=r.jsx(bt,{children:r.jsx(ge,{ref:e,align:l,sideOffset:o,className:s,...a})}),t[7]=l,t[8]=a,t[9]=e,t[10]=o,t[11]=s,t[12]=u):u=t[12],u});be.displayName=ge.displayName;function jt({onSelect:i,placeholder:e="Add tag...",className:t}){const[c,a]=p.useState(!1),[n,d]=p.useState(""),[l]=nt(n,300),[o,s]=p.useState([]),[u,m]=p.useState(!1),x=p.useRef(null);p.useEffect(()=>{if(l.trim().length===0){s([]);return}(async()=>{m(!0);try{const w=await fetch(`/admin/tags/search?query=${encodeURIComponent(l)}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(w.ok){const v=await w.json();s(v)}}catch(w){console.error("Failed to fetch tags",w)}finally{m(!1)}})()},[l]);const h=f=>{i(f),d(""),a(!1),s([]),x.current?.focus()},b=f=>{f.key==="Enter"&&(f.preventDefault(),n.trim()&&h(n.trim()))};return r.jsxs(vt,{open:c&&o.length>0,onOpenChange:a,children:[r.jsx(wt,{asChild:!0,children:r.jsx("div",{className:$("relative w-full",t),children:r.jsx(Oe,{ref:x,value:n,onChange:f=>{d(f.target.value),a(!0)},onFocus:()=>{o.length>0&&a(!0)},onKeyDown:b,placeholder:e,className:"h-8 text-sm"})})}),r.jsx(be,{className:"p-1 w-[200px]",align:"start",onOpenAutoFocus:f=>f.preventDefault(),children:r.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:o.map((f,w)=>r.jsx("div",{onClick:()=>h(f),className:"cursor-pointer rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",children:f},`${f}-${w}`))})})]})}function Nt(i){const e=T.c(8),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c,n=t[0],d=n?.metadata?.rubric,l=n?.content;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=r.jsx(B,{value:"",placeholder:"Area jawaban peserta...",readOnly:!0,className:"bg-muted/20"}),e[0]=o):o=e[0];let s;e[1]!==l||e[2]!==n||e[3]!==d||e[4]!==a?(s=a&&(n||d)&&r.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-lg border border-slate-100 dark:border-slate-800 space-y-3",children:[r.jsx("h4",{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wider mb-2",children:"Panduan Penilaian / Rubrik"}),l&&r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"text-xs font-medium text-emerald-600 dark:text-emerald-500",children:"Contoh Jawaban / Poin Utama:"}),r.jsx(B,{value:l,readOnly:!0,className:"prose prose-sm max-w-none"})]}),d&&r.jsxs("div",{className:"space-y-1 mt-3 pt-3 border-t border-dashed border-slate-200 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Rubrik Penilaian:"}),r.jsx("pre",{className:"text-xs whitespace-pre-wrap bg-white dark:bg-black/20 p-2 rounded border border-slate-100 dark:border-slate-800",children:JSON.stringify(d,null,2)})]})]}),e[1]=l,e[2]=n,e[3]=d,e[4]=a,e[5]=s):s=e[5];let u;return e[6]!==s?(u=r.jsxs("div",{className:"space-y-4",children:[o,s]}),e[6]=s,e[7]=u):u=e[7],u}function yt(i){const e=T.c(17),{data:t}=i,c=t.colorClass;let a;e[0]!==c?(a=$("relative p-3 rounded-lg border-2 text-sm flex items-center min-h-[100px] bg-card w-[400px] shadow-sm",c),e[0]=c,e[1]=a):a=e[1];let n;e[2]!==t.pairId||e[3]!==t.showKeyAnswer?(n=t.showKeyAnswer&&r.jsx("span",{className:"mr-2 text-xs font-bold opacity-50 bg-white/50 dark:bg-black/20 px-1 rounded",children:t.pairId}),e[2]=t.pairId,e[3]=t.showKeyAnswer,e[4]=n):n=e[4];const d=t.content;let l;e[5]!==d?(l=r.jsx(B,{value:d,readOnly:!0,className:"border-0 bg-transparent p-0 min-h-0 text-sm"}),e[5]=d,e[6]=l):l=e[6];let o;e[7]!==t.mediaUrl?(o=t.mediaUrl&&r.jsx("div",{className:"mt-2 rounded overflow-hidden border border-border h-24 w-auto bg-white/50 inline-block",children:r.jsx("img",{src:t.mediaUrl,alt:"Visual",className:"h-full w-auto object-contain"})}),e[7]=t.mediaUrl,e[8]=o):o=e[8];let s;e[9]!==l||e[10]!==o?(s=r.jsxs("div",{className:"flex-1 min-w-0",children:[l,o]}),e[9]=l,e[10]=o,e[11]=s):s=e[11];let u;e[12]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx(se,{type:"source",position:ae.Right,className:"w-3 h-3 bg-muted-foreground border-2 border-background"}),e[12]=u):u=e[12];let m;return e[13]!==a||e[14]!==n||e[15]!==s?(m=r.jsxs("div",{className:a,children:[n,s,u]}),e[13]=a,e[14]=n,e[15]=s,e[16]=m):m=e[16],m}function kt(i){const e=T.c(17),{data:t}=i,c=t.colorClass;let a;e[0]!==c?(a=$("relative p-3 rounded-lg border-2 text-sm flex items-center min-h-[100px] bg-card w-[400px] shadow-sm",c),e[0]=c,e[1]=a):a=e[1];let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=r.jsx(se,{type:"target",position:ae.Left,className:"w-3 h-3 bg-muted-foreground border-2 border-background"}),e[2]=n):n=e[2];const d=t.content;let l;e[3]!==d?(l=r.jsx(B,{value:d,readOnly:!0,className:"border-0 bg-transparent p-0 min-h-0 text-sm [&_.ProseMirror]:text-right"}),e[3]=d,e[4]=l):l=e[4];let o;e[5]!==t.mediaUrl?(o=t.mediaUrl&&r.jsx("div",{className:"mt-2 rounded overflow-hidden border border-border h-24 w-auto bg-white/50 inline-block",children:r.jsx("img",{src:t.mediaUrl,alt:"Visual",className:"h-full w-auto object-contain"})}),e[5]=t.mediaUrl,e[6]=o):o=e[6];let s;e[7]!==l||e[8]!==o?(s=r.jsxs("div",{className:"flex-1 text-right min-w-0",children:[l,o]}),e[7]=l,e[8]=o,e[9]=s):s=e[9];let u;e[10]!==t.pairId||e[11]!==t.showKeyAnswer?(u=t.showKeyAnswer&&r.jsx("span",{className:"ml-2 text-xs font-bold opacity-50 bg-white/50 dark:bg-black/20 px-1 rounded",children:t.pairId}),e[10]=t.pairId,e[11]=t.showKeyAnswer,e[12]=u):u=e[12];let m;return e[13]!==a||e[14]!==s||e[15]!==u?(m=r.jsxs("div",{className:a,children:[n,s,u]}),e[13]=a,e[14]=s,e[15]=u,e[16]=m):m=e[16],m}const _t={leftOption:yt,rightOption:kt},X=(i,e)=>{if(!e)return"border-border bg-card";const t=["border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950/30","border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/30","border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950/30","border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-950/30","border-purple-200 bg-purple-50 dark:border-purple-800 dark:bg-purple-950/30","border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/30"],c=typeof i=="number"?i:parseInt(i)||0;return t[(c-1)%t.length]};function At(i){const e=T.c(26),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=[],e[0]=n):n=e[0];const[d,l,o]=Ve(n);let s;e[1]===Symbol.for("react.memo_cache_sentinel")?(s=[],e[1]=s):s=e[1];const[u,m,x]=qe(s);let h,b;e[2]!==t||e[3]!==m||e[4]!==l||e[5]!==a?(h=()=>{if(!t)return;const S=t.filter(Rt),j=t.filter(Ot),N=[],K=[];S.forEach((g,F)=>{N.push({id:`l-${g.id}`,type:"leftOption",position:{x:50,y:50+F*180},data:{content:g.content,mediaUrl:g.media_url||g.media_path,pairId:g.metadata?.pair_id,colorClass:X(g.metadata?.pair_id,a),showKeyAnswer:a}})}),j.forEach((g,F)=>{if(N.push({id:`r-${g.id}`,type:"rightOption",position:{x:700,y:50+F*180},data:{content:g.content,mediaUrl:g.media_url||g.media_path,pairId:g.metadata?.pair_id,colorClass:X(g.metadata?.pair_id,a),showKeyAnswer:a}}),a){const H=g.metadata?.pair_id,V=S.find(z=>z.metadata?.pair_id==H);V&&K.push({id:`e-${V.id}-${g.id}`,source:`l-${V.id}`,target:`r-${g.id}`,animated:!0,style:{strokeWidth:2,stroke:"#64748b"},markerEnd:{type:We.ArrowClosed,color:"#64748b"}})}}),l(N),m(K)},b=[t,a,l,m],e[2]=t,e[3]=m,e[4]=l,e[5]=a,e[6]=h,e[7]=b):(h=e[6],b=e[7]),p.useEffect(h,b);let f;e[8]!==t?(f=t.filter(Pt),e[8]=t,e[9]=f):f=e[9];const w=f.length;let v;e[10]!==t?(v=t.filter(Ct),e[10]=t,e[11]=v):v=e[11];const y=Math.max(w,v.length),_=`${Math.max(400,y*180+100)}px`;let P;e[12]!==_?(P={height:_},e[12]=_,e[13]=P):P=e[13];let O,A,C,M;e[14]===Symbol.for("react.memo_cache_sentinel")?(O={padding:.2},A={hideAttribution:!0},C=r.jsx(He,{color:"#94a3b8",gap:20,size:1}),M=r.jsx(ze,{}),e[14]=O,e[15]=A,e[16]=C,e[17]=M):(O=e[14],A=e[15],C=e[16],M=e[17]);let R;e[18]!==u||e[19]!==d||e[20]!==x||e[21]!==o?(R=r.jsxs(Ge,{nodes:d,edges:u,onNodesChange:o,onEdgesChange:x,nodeTypes:_t,fitView:!0,fitViewOptions:O,proOptions:A,children:[C,M]}),e[18]=u,e[19]=d,e[20]=x,e[21]=o,e[22]=R):R=e[22];let E;return e[23]!==P||e[24]!==R?(E=r.jsx("div",{className:"w-full border rounded-xl overflow-hidden bg-muted/10",style:P,children:R}),e[23]=P,e[24]=R,e[25]=E):E=e[25],E}function Ct(i){return i.option_key.startsWith("R")||i.metadata?.side==="right"}function Pt(i){return i.option_key.startsWith("L")||i.metadata?.side==="left"}function Ot(i){return i.option_key.startsWith("R")||i.metadata?.side==="right"}function Rt(i){return i.option_key.startsWith("L")||i.metadata?.side==="left"}function St(i){const e=T.c(7),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c;let n;if(e[0]!==t||e[1]!==a){let l;e[3]!==a?(l=o=>{const s=a&&o.is_correct;return r.jsxs("div",{className:$("flex items-start gap-3 p-4 rounded-xl border transition-all",s?"bg-emerald-50 border-emerald-200 dark:bg-emerald-950/30 dark:border-emerald-800":"bg-card border-border hover:border-primary/50"),children:[r.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s?r.jsx(Je,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"}):r.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-muted-foreground/30 flex items-center justify-center text-[10px] font-medium text-muted-foreground",children:o.option_key})}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx(q,{className:$("text-sm",s&&"font-medium text-emerald-900 dark:text-emerald-100"),content:o.content}),(o.media_url||o.media_path)&&r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-border max-w-xs",children:r.jsx("img",{src:o.media_url||o.media_path||"",alt:`Option ${o.option_key}`,className:"max-h-[100px] max-w-full object-cover"})})]})]},o.id)},e[3]=a,e[4]=l):l=e[4],n=t.map(l),e[0]=t,e[1]=a,e[2]=n}else n=e[2];let d;return e[5]!==n?(d=r.jsx("div",{className:"grid gap-3",children:n}),e[5]=n,e[6]=d):d=e[6],d}function Et(i){const e=T.c(7),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c;let n;if(e[0]!==t||e[1]!==a){let l;e[3]!==a?(l=o=>{const s=a&&o.is_correct;return r.jsxs("div",{className:$("flex items-start gap-3 p-4 rounded-xl border transition-all",s?"bg-emerald-50 border-emerald-200 dark:bg-emerald-950/30 dark:border-emerald-800":"bg-card border-border hover:border-primary/50"),children:[r.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s?r.jsx(Qe,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"}):r.jsx(Xe,{className:"w-5 h-5 text-muted-foreground/30"})}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx("div",{className:"flex items-center gap-2 mb-1",children:r.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400",children:o.option_key})}),r.jsx(q,{className:$("text-sm",s&&"font-medium text-emerald-900 dark:text-emerald-100"),content:o.content}),(o.media_url||o.media_path)&&r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-border max-w-xs",children:r.jsx("img",{src:o.media_url||o.media_path||"",alt:`Option ${o.option_key}`,className:"max-h-[100px] max-w-full object-cover"})})]})]},o.id)},e[3]=a,e[4]=l):l=e[4],n=t.map(l),e[0]=t,e[1]=a,e[2]=n}else n=e[2];let d;return e[5]!==n?(d=r.jsx("div",{className:"grid gap-3",children:n}),e[5]=n,e[6]=d):d=e[6],d}function $t(i){const e=T.c(10),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c,n=t[0];if(!n){let u;return e[0]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("div",{className:"text-muted-foreground",children:"Konfigurasi jawaban tidak valid."}),e[0]=u):u=e[0],u}const d=n.metadata?.correct_answer??n.content;let l;e[1]!==n.media_path||e[2]!==n.media_url?(l=(n.media_url||n.media_path)&&r.jsx("div",{className:"rounded-lg overflow-hidden border border-border max-w-xs",children:r.jsx("img",{src:n.media_url||n.media_path||"",alt:"Context",className:"max-h-[100px] max-w-full object-cover"})}),e[1]=n.media_path,e[2]=n.media_url,e[3]=l):l=e[3];let o;e[4]!==d||e[5]!==a?(o=a&&r.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-lg border border-slate-100 dark:border-slate-800 space-y-2",children:[r.jsx("h4",{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wider",children:"Kunci Jawaban"}),r.jsx("div",{className:"space-y-2",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:"Rumus / Jawaban"}),r.jsx(Le,{value:d,readOnly:!0,className:"w-full p-3 text-base border rounded-lg bg-white dark:bg-slate-950"})]})})]}),e[4]=d,e[5]=a,e[6]=o):o=e[6];let s;return e[7]!==l||e[8]!==o?(s=r.jsxs("div",{className:"space-y-4",children:[l,o]}),e[7]=l,e[8]=o,e[9]=s):s=e[9],s}function Tt(i){const e=T.c(14),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c;let n;e[0]!==t||e[1]!==a?(n=[...t],a?n.sort(Kt):n.sort(Mt),e[0]=t,e[1]=a,e[2]=n):n=e[2];let d;e[3]!==n||e[4]!==a?(d=n.map((u,m)=>r.jsxs("div",{className:"relative group",children:[m<n.length-1&&r.jsx("div",{className:"absolute left-6 top-full h-2 w-0.5 bg-muted/50 -ml-px z-0"}),r.jsxs("div",{className:$("relative z-10 flex items-center gap-3 p-3 rounded-xl border bg-card transition-all",a?"border-emerald-100 bg-emerald-50/30 dark:border-emerald-900/30 dark:bg-emerald-950/10":"border-border"),children:[r.jsx("div",{className:$("w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-sm",a?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900 dark:text-emerald-300":"bg-muted text-muted-foreground"),children:m+1}),r.jsx("div",{className:"bg-muted/30 p-1.5 rounded-md text-muted-foreground cursor-grab active:cursor-grabbing",children:r.jsx(Ye,{className:"w-4 h-4"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx(q,{className:"text-sm font-medium",content:u.content}),(u.media_url||u.media_path)&&r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-border max-w-xs",children:r.jsx("img",{src:u.media_url||u.media_path||"",alt:"Visual",className:"max-h-[100px] max-w-full object-cover"})})]})]})]},u.id)),e[3]=n,e[4]=a,e[5]=d):d=e[5];let l;e[6]!==a?(l=!a&&r.jsx("div",{className:"text-center text-xs text-muted-foreground pt-2 italic",children:"Urutkan item di atas"}),e[6]=a,e[7]=l):l=e[7];let o;e[8]!==a?(o=a&&r.jsx("div",{className:"text-center text-xs text-emerald-600 dark:text-emerald-400 pt-2 font-medium",children:"Susunan Yang Benar"}),e[8]=a,e[9]=o):o=e[9];let s;return e[10]!==d||e[11]!==l||e[12]!==o?(s=r.jsxs("div",{className:"space-y-2",children:[d,l,o]}),e[10]=d,e[11]=l,e[12]=o,e[13]=s):s=e[13],s}function Mt(i,e){return i.order-e.order}function Kt(i,e){const t=i.metadata?.correct_position??0,c=e.metadata?.correct_position??0;return t-c}function Ft(i){const e=T.c(13),{options:t,showKeyAnswer:c}=i,a=c===void 0?!0:c;let n,d,l;if(e[0]!==t||e[1]!==a){const s=t.find(Dt),u=t.find(It);let m;e[5]!==a?(m=(f,w,v,y)=>{if(!f)return null;const k=a&&f.is_correct;return r.jsxs("div",{className:$("flex-1 flex flex-col items-center justify-center p-6 rounded-xl border-2 transition-all gap-3 cursor-default",k?`bg-${v}-50 border-${v}-500 dark:bg-${v}-950/30`:"bg-card border-border opacity-50 grayscale"),children:[r.jsx("div",{className:$("w-12 h-12 rounded-full flex items-center justify-center",k?`bg-${v}-100 text-${v}-600`:"bg-muted text-muted-foreground"),children:y}),r.jsx(q,{className:$("font-bold text-lg",k?`text-${v}-700 dark:text-${v}-300`:"text-muted-foreground"),content:f.content||w}),k&&r.jsx("span",{className:"text-xs font-semibold px-2 py-1 rounded bg-white/50 dark:bg-black/20",children:"JAWABAN BENAR"}),(f.media_url||f.media_path)&&r.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-border w-20 h-20 bg-white/50",children:r.jsx("img",{src:f.media_url||f.media_path||"",alt:w,className:"max-h-[100px] max-w-full object-contain"})})]},f.id)},e[5]=a,e[6]=m):m=e[6];const x=m;n="flex gap-4 w-full";let h;e[7]===Symbol.for("react.memo_cache_sentinel")?(h=r.jsx(ne,{className:"w-6 h-6"}),e[7]=h):h=e[7],d=x(s,"BENAR","emerald",h);let b;e[8]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx(oe,{className:"w-6 h-6"}),e[8]=b):b=e[8],l=x(u,"SALAH","red",b),e[0]=t,e[1]=a,e[2]=n,e[3]=d,e[4]=l}else n=e[2],d=e[3],l=e[4];let o;return e[9]!==n||e[10]!==d||e[11]!==l?(o=r.jsxs("div",{className:n,children:[d,l]}),e[9]=n,e[10]=d,e[11]=l,e[12]=o):o=e[12],o}function It(i){return i.option_key==="F"}function Dt(i){return i.option_key==="T"}function Ut(i){const e=T.c(39),{options:t,showKeyAnswer:c}=i,a=t.length>0?t[0]:null;if(!a)return null;const n=a.content||"",d=a.metadata?.delimiter||" ";let l,o,s,u,m,x,h,b,f;if(e[0]!==d||e[1]!==n){const O=n.split(d).filter(Lt);l="space-y-4",f="p-4 rounded-lg bg-emerald-50 border border-emerald-100 dark:bg-emerald-900/20 dark:border-emerald-800",h="flex items-start gap-3",e[11]===Symbol.for("react.memo_cache_sentinel")?(b=r.jsx("div",{className:"mt-0.5 p-1 rounded-full bg-emerald-100 text-emerald-600 dark:bg-emerald-800 dark:text-emerald-400",children:r.jsx(ne,{className:"w-4 h-4"})}),e[11]=b):b=e[11],m="space-y-3 w-full";let A;e[12]===Symbol.for("react.memo_cache_sentinel")?(A=r.jsx("span",{className:"text-sm font-semibold text-emerald-800 dark:text-emerald-300 block mb-1",children:"Kalimat Benar (Kunci Jawaban):"}),e[12]=A):A=e[12];let C;e[13]!==d?(C=r.jsxs("span",{className:"text-muted-foreground text-sm font-normal",children:['(Delimiter: "',d,'")']}),e[13]=d,e[14]=C):C=e[14],e[15]!==n||e[16]!==C?(x=r.jsxs("div",{children:[A,r.jsxs("p",{className:"text-base font-medium text-emerald-900 dark:text-emerald-100",children:[n," ",C]})]}),e[15]=n,e[16]=C,e[17]=x):x=e[17],e[18]===Symbol.for("react.memo_cache_sentinel")?(u=r.jsx("span",{className:"text-xs font-semibold text-emerald-700 dark:text-emerald-400 block mb-2",children:"Token (Urutan Benar):"}),e[18]=u):u=e[18],o="flex flex-wrap gap-2",s=O.map(Bt),e[0]=d,e[1]=n,e[2]=l,e[3]=o,e[4]=s,e[5]=u,e[6]=m,e[7]=x,e[8]=h,e[9]=b,e[10]=f}else l=e[2],o=e[3],s=e[4],u=e[5],m=e[6],x=e[7],h=e[8],b=e[9],f=e[10];let w;e[19]!==o||e[20]!==s?(w=r.jsx("div",{className:o,children:s}),e[19]=o,e[20]=s,e[21]=w):w=e[21];let v;e[22]!==w||e[23]!==u?(v=r.jsxs("div",{children:[u,w]}),e[22]=w,e[23]=u,e[24]=v):v=e[24];let y;e[25]!==v||e[26]!==m||e[27]!==x?(y=r.jsxs("div",{className:m,children:[x,v]}),e[25]=v,e[26]=m,e[27]=x,e[28]=y):y=e[28];let k;e[29]!==y||e[30]!==h||e[31]!==b?(k=r.jsxs("div",{className:h,children:[b,y]}),e[29]=y,e[30]=h,e[31]=b,e[32]=k):k=e[32];let _;e[33]!==k||e[34]!==f?(_=r.jsx("div",{className:f,children:k}),e[33]=k,e[34]=f,e[35]=_):_=e[35];let P;return e[36]!==l||e[37]!==_?(P=r.jsx("div",{className:l,children:_}),e[36]=l,e[37]=_,e[38]=P):P=e[38],P}function Bt(i,e){return r.jsxs(G,{variant:"outline",className:"bg-white border-emerald-200 text-emerald-700 hover:bg-emerald-50 dark:bg-black/20 dark:border-emerald-700 dark:text-emerald-300",children:[r.jsxs("span",{className:"opacity-50 mr-1.5 text-xs text-emerald-500",children:["#",e+1]}),i]},e)}function Lt(i){return i.length>0}function Vt(i){const e=T.c(29),{question:t,showKeyAnswer:c}=i,a=c===void 0?!0:c,{question_type:n,options:d}=t;let l;e[0]!==d?(l=d===void 0?[]:d,e[0]=d,e[1]=l):l=e[1];const o=l;if((!o||o.length===0)&&n!=="numerical_input"&&n!=="essay"){let s;return e[2]===Symbol.for("react.memo_cache_sentinel")?(s=r.jsx("div",{className:"text-sm text-muted-foreground italic p-4 text-center border border-dashed rounded-lg",children:"Belum ada opsi jawaban."}),e[2]=s):s=e[2],s}switch(n){case"multiple_choice":{let s;return e[3]!==o||e[4]!==a?(s=r.jsx(St,{options:o,showKeyAnswer:a}),e[3]=o,e[4]=a,e[5]=s):s=e[5],s}case"multiple_selection":{let s;return e[6]!==o||e[7]!==a?(s=r.jsx(Et,{options:o,showKeyAnswer:a}),e[6]=o,e[7]=a,e[8]=s):s=e[8],s}case"true_false":{let s;return e[9]!==o||e[10]!==a?(s=r.jsx(Ft,{options:o,showKeyAnswer:a}),e[9]=o,e[10]=a,e[11]=s):s=e[11],s}case"matching":{let s;return e[12]!==o||e[13]!==a?(s=r.jsx(At,{options:o,showKeyAnswer:a}),e[12]=o,e[13]=a,e[14]=s):s=e[14],s}case"ordering":{let s;return e[15]!==o||e[16]!==a?(s=r.jsx(Tt,{options:o,showKeyAnswer:a}),e[15]=o,e[16]=a,e[17]=s):s=e[17],s}case"numerical_input":{let s;return e[18]!==o||e[19]!==a?(s=r.jsx($t,{options:o,showKeyAnswer:a}),e[18]=o,e[19]=a,e[20]=s):s=e[20],s}case"essay":{let s;return e[21]!==o||e[22]!==a?(s=r.jsx(Nt,{options:o,showKeyAnswer:a}),e[21]=o,e[22]=a,e[23]=s):s=e[23],s}case"arrange_words":{let s;return e[24]!==o||e[25]!==a?(s=r.jsx(Ut,{options:o,showKeyAnswer:a}),e[24]=o,e[25]=a,e[26]=s):s=e[26],s}default:{let s;return e[27]!==n?(s=r.jsxs("div",{className:"text-red-500 text-sm",children:["Tipe soal tidak didukung: ",n]}),e[27]=n,e[28]=s):s=e[28],s}}}const qt={multiple_choice:"Pilihan Ganda",multiple_selection:"Pilihan Kompleks",true_false:"Benar/Salah",matching:"Menjodohkan",ordering:"Mengurutkan",numerical_input:"Input Angka",essay:"Esai/Uraian"};function hr(i){const e=T.c(65),{question:t,onUpdate:c,onEdit:a,onDelete:n,readOnly:d}=i,l=d===void 0?!1:d;let o;e[0]!==c||e[1]!==t.id||e[2]!==l?(o=(g,F)=>{c&&!l&&c(t.id,g,F)},e[0]=c,e[1]=t.id,e[2]=l,e[3]=o):o=e[3];const s=o,u=qt[t.question_type]??t.question_type;let m;e[4]!==u?(m=r.jsx(G,{variant:"outline",className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700",children:u}),e[4]=u,e[5]=m):m=e[5];let x;e[6]!==s?(x=g=>s("difficulty_level",g),e[6]=s,e[7]=x):x=e[7];let h;e[8]!==t.difficulty_level||e[9]!==l||e[10]!==x?(h=r.jsx(Ae,{value:t.difficulty_level,onValueChange:x,disabled:l}),e[8]=t.difficulty_level,e[9]=l,e[10]=x,e[11]=h):h=e[11];let b;e[12]!==s?(b=g=>s("timer",g),e[12]=s,e[13]=b):b=e[13];let f;e[14]!==t.timer||e[15]!==l||e[16]!==b?(f=r.jsx(Ce,{value:t.timer,onValueChange:b,disabled:l}),e[14]=t.timer,e[15]=l,e[16]=b,e[17]=f):f=e[17];let w;e[18]!==s?(w=g=>s("score_value",g),e[18]=s,e[19]=w):w=e[19];let v;e[20]!==t.score_value||e[21]!==l||e[22]!==w?(v=r.jsx(Pe,{value:t.score_value,onValueChange:w,disabled:l}),e[20]=t.score_value,e[21]=l,e[22]=w,e[23]=v):v=e[23];let y;e[24]!==n||e[25]!==a||e[26]!==t||e[27]!==l?(y=!l&&r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>a&&a(t),children:r.jsx(Ze,{className:"w-4 h-4"})}),r.jsx(Q,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:()=>{n&&window.confirm("Apakah anda yakin ingin menghapus pertanyaan ini?")&&n(t.id)},children:r.jsx(et,{className:"w-4 h-4"})})]}),e[24]=n,e[25]=a,e[26]=t,e[27]=l,e[28]=y):y=e[28];let k;e[29]!==v||e[30]!==y||e[31]!==m||e[32]!==h||e[33]!==f?(k=r.jsx(we,{className:"p-3 bg-slate-50/50 dark:bg-slate-900/50 border-b border-slate-100 dark:border-slate-800",children:r.jsx("div",{className:"flex flex-col gap-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[m,h,f,v,y]})})}),e[29]=v,e[30]=y,e[31]=m,e[32]=h,e[33]=f,e[34]=k):k=e[34];let _;e[35]!==t.media_url?(_=t.media_url&&r.jsx("div",{className:"mb-4",children:r.jsx("img",{src:t.media_url,alt:"Question Media",className:"max-h-[100px] max-w-full rounded-md object-contain border bg-slate-50 dark:bg-slate-900"})}),e[35]=t.media_url,e[36]=_):_=e[36];const P=typeof t.content=="string"?t.content:"";let O;e[37]!==P?(O=r.jsx(B,{value:P,readOnly:!0,className:"bg-transparent border-none p-0"}),e[37]=P,e[38]=O):O=e[38];let A;e[39]!==_||e[40]!==O?(A=r.jsx(je,{className:"p-6",children:r.jsxs("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:[_,O]})}),e[39]=_,e[40]=O,e[41]=A):A=e[41];let C;e[42]!==t?(C=r.jsx("div",{className:"w-full",children:r.jsx(Vt,{question:t,showKeyAnswer:!0})}),e[42]=t,e[43]=C):C=e[43];let M;e[44]===Symbol.for("react.memo_cache_sentinel")?(M=r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(rt,{className:"w-4 h-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Tags"})]}),e[44]=M):M=e[44];let R;e[45]!==s||e[46]!==t.tags||e[47]!==l?(R=t.tags?.map((g,F)=>{const H=typeof g.name=="object"?g.name.en||g.name.id||Object.values(g.name)[0]:g.name;return r.jsxs(G,{variant:"secondary",className:"gap-1 pr-1",children:[H,!l&&r.jsx("button",{onClick:()=>{const z=(t.tags?.map(Ht)||[]).filter((zt,ve)=>ve!==F);s("tags",z)},className:"hover:bg-red-100 hover:text-red-600 rounded-full p-0.5 transition-colors",children:r.jsx(oe,{className:"w-3 h-3"})})]},F)}),e[45]=s,e[46]=t.tags,e[47]=l,e[48]=R):R=e[48];let E;e[49]!==R?(E=r.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:R}),e[49]=R,e[50]=E):E=e[50];let S;e[51]!==s||e[52]!==t.tags||e[53]!==l?(S=!l&&r.jsx("div",{className:"flex w-full max-w-xs items-center space-x-2",children:r.jsx(jt,{onSelect:g=>{if(g){const F=t.tags?.map(Wt)||[];F.includes(g)||s("tags",[...F,g])}}})}),e[51]=s,e[52]=t.tags,e[53]=l,e[54]=S):S=e[54];let j;e[55]!==E||e[56]!==S?(j=r.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800",children:[M,E,S]}),e[55]=E,e[56]=S,e[57]=j):j=e[57];let N;e[58]!==C||e[59]!==j?(N=r.jsxs(Ne,{className:"p-3 bg-slate-50/20 dark:bg-slate-900/20 border-t border-slate-100 dark:border-slate-800 flex-col items-start gap-4",children:[C,j]}),e[58]=C,e[59]=j,e[60]=N):N=e[60];let K;return e[61]!==k||e[62]!==A||e[63]!==N?(K=r.jsxs(ye,{className:"overflow-hidden border-slate-200 dark:border-slate-800 shadow-sm rounded-2xl transition-all hover:shadow-md",children:[k,A,N]}),e[61]=k,e[62]=A,e[63]=N,e[64]=K):K=e[64],K}function Wt(i){return typeof i.name=="object"?i.name.en||i.name.id||Object.values(i.name)[0]:i.name}function Ht(i){return typeof i.name=="object"?i.name.en||i.name.id||Object.values(i.name)[0]:i.name}export{hr as Q};

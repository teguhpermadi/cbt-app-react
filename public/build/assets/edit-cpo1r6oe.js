import{c as Ce,j as e,r as k,u as ce,H as Fe,L as ie,b as M}from"./app-DyN-wpxS.js";import{A as Pe}from"./app-shell-6BFfOcnH.js";import{c as Ee,B as c}from"./button-CdyPjVIa.js";import{C as le,a as ne}from"./card-C6hf_ydR.js";import{I as G}from"./input-x6uegPVQ.js";import{a as we,b as xe,c as he,d as pe,e as je,f as ge,D as ze}from"./dialog-Y5ccQPmd.js";import{S as q,a as ee,b as se,c as ae,d as h}from"./select-UBe8Lx71.js";import{S as Ae}from"./switch-BXcIHqI3.js";import{T as Me}from"./textarea-nVpaP2SM.js";import{L as o}from"./label-DLKOY3Rp.js";import{C as te}from"./checkbox-CA68c0MG.js";import{M as Ge,T as Qe}from"./multi-select-Dsw5-tKt.js";import{I as Q}from"./input-error-BQBpUoES.js";import{Q as ve}from"./QuestionBankController-VWCdcKL6.js";import{Q as B}from"./QuestionController-D8rxudnx.js";import{E as oe}from"./ExamController-DtW2Bo6_.js";import{u as Ue,C as Le,a as $e,b as be,D as Oe,c as Ke,S as Ve,v as He,s as We,K as Re,P as Je,d as Ye}from"./sortable.esm-S1gzMnEx.js";import{Q as Be}from"./QuestionCard-C2_Ak5yn.js";import{G as Xe}from"./grip-vertical-D0hiBtzd.js";import{A as ye,a as _e}from"./alert-D7bYVx_5.js";import{C as Ne}from"./circle-alert-Brz_dMHK.js";import{F as Se}from"./file-text-CV8EhlpI.js";import"./MathRenderer-DYpDUqD8.js";import{A as Ze}from"./arrow-left-C3VA2XrV.js";import{S as qe}from"./settings-DKL5Z4ZW.js";import{P as ke}from"./plus-ChxiFZ-N.js";import{S as es}from"./save-BMVL6hlU.js";import{S as de}from"./sparkles-CahZkNCz.js";import{L as ue}from"./loader-circle-B_rqc5mt.js";/* empty css            */import"./sheet-y5P-CDkj.js";import"./index-D0w3UerL.js";import"./index-B9ZEsc9v.js";import"./index-B7_9QI6J.js";import"./index-CNe1fd7B.js";import"./x-lNOBUcxD.js";import"./index-CUOTptWl.js";import"./index-pm4w21PO.js";import"./index-BdQq_4o_.js";import"./index-CSsDPExf.js";import"./index-DjGDGm1v.js";import"./chevron-down-DNehCCXA.js";import"./zap-Bzlb9SVw.js";import"./clock-D52EKvNA.js";import"./dropdown-menu-CH8bgok8.js";import"./index-NYQbQWWo.js";import"./badge-DvMEEYXx.js";import"./index-DW9AIAM8.js";import"./ScoreSelector-06NR82lj.js";import"./star-yK2puOfk.js";import"./RichTextEditor-DBZWqaZR.js";import"./index-Bw4bqpEh.js";import"./style-B2nCtcBB.js";import"./circle-check-VDgprh3j.js";import"./square-check-big-NwfVi49y.js";import"./square-D7hxKJse.js";import"./square-pen-BPB4lnzT.js";import"./trash-2-DUuu_oLz.js";const ss=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],as=Ee("Upload",ss);function ts(i){const s=Ce.c(24),{question:g,onUpdate:f,onDelete:v,onEdit:T,id:b}=i;let u;s[0]!==g.id?(u={id:g.id},s[0]=g.id,s[1]=u):u=s[1];const{attributes:E,listeners:C,setNodeRef:m,transform:y,transition:F,isDragging:U}=Ue(u);let d;s[2]!==y?(d=Le.Transform.toString(y),s[2]=y,s[3]=d):d=s[3];const w=U?10:1,r=U?.5:1;let _;s[4]!==d||s[5]!==w||s[6]!==r||s[7]!==F?(_={transform:d,transition:F,zIndex:w,opacity:r},s[4]=d,s[5]=w,s[6]=r,s[7]=F,s[8]=_):_=s[8];const N=_;let D;s[9]===Symbol.for("react.memo_cache_sentinel")?(D=e.jsx("div",{className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:e.jsx(Xe,{className:"size-5"})}),s[9]=D):D=s[9];let S;s[10]!==E||s[11]!==C?(S=e.jsx("div",{...E,...C,className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity flex items-center h-full",children:D}),s[10]=E,s[11]=C,s[12]=S):S=s[12];let x;s[13]!==v||s[14]!==T||s[15]!==f||s[16]!==g?(x=e.jsx(Be,{question:g,onUpdate:f,onDelete:v,onEdit:T}),s[13]=v,s[14]=T,s[15]=f,s[16]=g,s[17]=x):x=s[17];let p;return s[18]!==b||s[19]!==m||s[20]!==N||s[21]!==S||s[22]!==x?(p=e.jsxs("div",{ref:m,style:N,className:"relative group",id:b,children:[S,x]}),s[18]=b,s[19]=m,s[20]=N,s[21]=S,s[22]=x,s[23]=p):p=s[23],p}function rs(i){const s=Ce.c(46),{questionBankId:g}=i,[f,v]=k.useState(!1);let T;s[0]===Symbol.for("react.memo_cache_sentinel")?(T={file:null},s[0]=T):T=s[0];const{data:b,setData:u,post:E,processing:C,errors:m,reset:y}=ce(T);let F;s[1]!==b.file||s[2]!==E||s[3]!==g||s[4]!==y?(F=W=>{W.preventDefault(),b.file&&E(`/admin/question-banks/${g}/upload-questions`,{forceFormData:!0,onSuccess:()=>{v(!1),y()}})},s[1]=b.file,s[2]=E,s[3]=g,s[4]=y,s[5]=F):F=s[5];const U=F;let d;s[6]!==u?(d=W=>{W.target.files&&W.target.files[0]&&u("file",W.target.files[0])},s[6]=u,s[7]=d):d=s[7];const w=d;let r;s[8]===Symbol.for("react.memo_cache_sentinel")?(r=e.jsx(we,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(as,{className:"mr-2 h-4 w-4"}),"Upload Soal dari Word"]})}),s[8]=r):r=s[8];let _;s[9]===Symbol.for("react.memo_cache_sentinel")?(_=e.jsxs(xe,{children:[e.jsx(he,{children:"Upload Soal dari Dokumen Word"}),e.jsx(pe,{children:"Upload file .docx yang berisi soal-soal dengan format tabel."})]}),s[9]=_):_=s[9];let N;s[10]===Symbol.for("react.memo_cache_sentinel")?(N=e.jsx(o,{htmlFor:"file",children:"File Word (.docx)"}),s[10]=N):N=s[10];let D;s[11]===Symbol.for("react.memo_cache_sentinel")?(D=e.jsx(Se,{className:"h-4 w-4"}),s[11]=D):D=s[11];const S=b.file?b.file.name:"Pilih file...";let x;s[12]!==S?(x=e.jsx("span",{className:"text-sm text-muted-foreground",children:S}),s[12]=S,s[13]=x):x=s[13];let p;s[14]!==w?(p=e.jsx("input",{id:"file",type:"file",accept:".docx",onChange:w,className:"hidden"}),s[14]=w,s[15]=p):p=s[15];let I;s[16]!==p||s[17]!==x?(I=e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{htmlFor:"file",className:"flex-1 flex items-center gap-2 px-4 py-2 border border-input rounded-md cursor-pointer hover:bg-accent hover:text-accent-foreground transition-colors",children:[D,x,p]})}),s[16]=p,s[17]=x,s[18]=I):I=s[18];let j;s[19]!==m.file?(j=m.file&&e.jsx("p",{className:"text-sm text-red-500",children:m.file}),s[19]=m.file,s[20]=j):j=s[20];let L;s[21]!==m.upload?(L=m.upload&&e.jsxs(ye,{variant:"destructive",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx(_e,{className:"text-sm",children:m.upload})]}),s[21]=m.upload,s[22]=L):L=s[22];let z;s[23]!==I||s[24]!==j||s[25]!==L?(z=e.jsxs("div",{className:"space-y-2",children:[N,I,j,L]}),s[23]=I,s[24]=j,s[25]=L,s[26]=z):z=s[26];let H;s[27]===Symbol.for("react.memo_cache_sentinel")?(H=e.jsx(Ne,{className:"h-4 w-4"}),s[27]=H):H=s[27];let R;s[28]===Symbol.for("react.memo_cache_sentinel")?(R=e.jsxs("p",{children:["File harus berupa tabel dengan 5 kolom: ",e.jsx("strong",{children:"Tipe Soal, Pertanyaan, Opsi, Kunci, Poin"}),". Maksimal ukuran file 10MB."]}),s[28]=R):R=s[28];let J;s[29]===Symbol.for("react.memo_cache_sentinel")?(J=e.jsxs(ye,{children:[H,e.jsx(_e,{className:"text-sm",children:e.jsxs("div",{className:"space-y-2",children:[R,e.jsxs("a",{href:"/admin/question-banks/template/download",className:"inline-flex items-center gap-2 text-sm text-primary hover:underline",download:!0,children:[e.jsx(Se,{className:"h-4 w-4"}),"Download Template Word"]})]})})]}),s[29]=J):J=s[29];let t;s[30]===Symbol.for("react.memo_cache_sentinel")?(t=()=>v(!1),s[30]=t):t=s[30];let $;s[31]!==C?($=e.jsx(c,{type:"button",variant:"outline",onClick:t,disabled:C,children:"Batal"}),s[31]=C,s[32]=$):$=s[32];const O=C||!b.file,X=C?"Mengupload...":"Upload";let K;s[33]!==O||s[34]!==X?(K=e.jsx(c,{type:"submit",disabled:O,children:X}),s[33]=O,s[34]=X,s[35]=K):K=s[35];let P;s[36]!==$||s[37]!==K?(P=e.jsxs("div",{className:"flex justify-end gap-2",children:[$,K]}),s[36]=$,s[37]=K,s[38]=P):P=s[38];let A;s[39]!==U||s[40]!==z||s[41]!==P?(A=e.jsxs(je,{className:"sm:max-w-[525px]",children:[_,e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[z,J,P]})]}),s[39]=U,s[40]=z,s[41]=P,s[42]=A):A=s[42];let Y;return s[43]!==f||s[44]!==A?(Y=e.jsxs(ge,{open:f,onOpenChange:v,children:[r,A]}),s[43]=f,s[44]=A,s[45]=Y):Y=s[45],Y}function da({questionBank:i,questions:s=[],subjects:g}){const{data:f,setData:v,put:T,processing:b,errors:u,isDirty:E}=ce({name:i.name,subject_id:i.subject_id,description:i.description||"",is_public:i.is_public}),C=a=>{a.preventDefault(),T(ve.update(i.id).url)},[m,y]=k.useState(!1),[F,U]=k.useState(0),[d,w]=k.useState(null),r=ce({topic:"",question_type:"multiple_choice",count:5,difficulty:"sedang"}),[_,N]=k.useState(!1),D=()=>{M.reload({only:["questions"],preserveScroll:!0,preserveState:!0,onSuccess:a=>{(a.props.questions||[]).length>F&&(y(!1),d&&(clearInterval(d),w(null)))}})};k.useEffect(()=>()=>{d&&clearInterval(d)},[d]);const S=a=>{a.preventDefault(),U(s.length),y(!0),r.post(`/admin/question-banks/${i.id}/generate-ai`,{preserveScroll:!0,onSuccess:()=>{r.reset();const l=setInterval(D,3e3);w(l),setTimeout(()=>{y(!1),l&&(clearInterval(l),w(null))},3e5)},onError:()=>{y(!1)}})},x=()=>{s.length!==0&&(N(!0),M.post(`/admin/question-banks/${i.id}/generate-tags`,{},{preserveScroll:!0,onSuccess:()=>{const a=setInterval(()=>{M.reload({only:["questions"],preserveScroll:!0,preserveState:!0})},3e3);setTimeout(()=>{N(!1),clearInterval(a)},3e5)},onError:()=>{N(!1)}}))},[p,I]=k.useState(!1),[j,L]=k.useState(null),[z,H]=k.useState(!1),R=()=>new Date().toISOString().slice(0,16),J=()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().slice(0,16)},t=ce({academic_year_id:"",grade_ids:i.subject?.grade?.id?[i.subject.grade.id.toString()]:[],subject_id:i.subject_id.toString(),teacher_id:i.teacher?.id?.toString()||"",question_bank_id:i.id.toString(),title:i.name,exam_type:"daily",duration:60,is_published:!0,is_randomized:!0,is_answer_randomized:!1,is_hint_visible:!1,show_result_on_finish:!0,max_attempts:null,timer_type:"flexible",passing_score:70,start_time:R(),end_time:J()}),$=async()=>{H(!0);try{const l=await(await fetch(oe.create.url())).json();L(l);const n=l.academicYears.find(V=>V.is_active);n&&t.setData("academic_year_id",n.id.toString())}catch(a){console.error("Failed to load form data:",a)}finally{H(!1)}},O=a=>{const l=new Date(t.data.start_time),n=new Date(l);n.setDate(n.getDate()+a),t.setData("end_time",n.toISOString().slice(0,16))},X=()=>{I(!0),j||$()},K=a=>{a.preventDefault(),t.post(oe.store.url(),{onSuccess:l=>{I(!1),t.reset();const n=l.props.exam?.id;n?M.visit(oe.monitor(n).url):M.visit(oe.index().url)}})},[P,A]=k.useState(s);k.useEffect(()=>{A(s)},[s]),k.useEffect(()=>{const l=new URLSearchParams(window.location.search).get("scrollTo");l&&setTimeout(()=>{const n=document.getElementById(l);if(n){n.scrollIntoView({behavior:"smooth",block:"center"}),n.classList.add("ring-2","ring-primary","ring-offset-2"),setTimeout(()=>n.classList.remove("ring-2","ring-primary","ring-offset-2"),2e3);const V=window.location.pathname;window.history.replaceState({},"",V)}},500)},[s]);const Y=$e(be(Je),be(Re,{coordinateGetter:We})),W=a=>{const{active:l,over:n}=a;l.id!==n?.id&&A(V=>{const re=V.findIndex(Z=>Z.id===l.id),me=V.findIndex(Z=>Z.id===n?.id),fe=Ye(V,re,me);return M.post("/admin/questions/reorder",{ids:fe.map(Z=>Z.id)},{preserveScroll:!0,preserveState:!0}),fe})},De=(a,l,n)=>{if(!P.find(me=>me.id===a))return;let re={[l]:n};l==="tags"&&(re.tags=n),M.put(B.update(a).url,re,{preserveScroll:!0,preserveState:!0})},Ie=a=>{M.delete(B.destroy(a).url,{preserveScroll:!0,preserveState:!0})},Te=({order:a})=>e.jsxs("div",{className:"group relative h-8 -my-4 z-10 flex items-center justify-center cursor-pointer",children:[e.jsx("div",{className:"absolute inset-0 z-0"}),e.jsx("div",{className:"absolute inset-x-0 h-px bg-primary/20 opacity-0 group-hover:opacity-100 transition-opacity z-10"}),e.jsx(ie,{href:`${B.create().url}?question_bank_id=${i.id}&order=${a}`,className:"relative z-20 bg-background border rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-all shadow-sm hover:bg-primary hover:text-primary-foreground pointer-events-auto transform scale-75 group-hover:scale-100 duration-200",title:"Sisipkan Pertanyaan Disini",children:e.jsx(ke,{className:"h-4 w-4"})})]});return e.jsxs(Pe,{variant:"header",children:[e.jsx(Fe,{title:`Edit ${i.name}`}),e.jsxs("div",{className:"sticky top-0 z-10 flex h-16 items-center gap-4 border-b bg-background px-6 shadow-sm",children:[e.jsx(c,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(ie,{href:ve.index().url,children:e.jsx(Ze,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(G,{value:f.name,onChange:a=>v("name",a.target.value),className:"h-10 text-lg font-semibold border-transparent focus-visible:ring-0 px-0 hover:border-input focus-visible:border-input focus-visible:px-3 transition-all max-w-md",placeholder:"Nama Bank Soal"}),u.name&&e.jsx("div",{className:"text-sm text-red-500 mt-1",children:u.name})]}),e.jsxs(ge,{children:[e.jsx(we,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"icon",children:e.jsx(qe,{className:"h-4 w-4"})})}),e.jsxs(je,{children:[e.jsxs(xe,{children:[e.jsx(he,{children:"Pengaturan Bank Soal"}),e.jsx(pe,{children:"Ubah detail konfigurasi untuk bank soal ini."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"subject",children:"Mata Pelajaran"}),e.jsxs(q,{value:f.subject_id.toString(),onValueChange:a=>v("subject_id",parseInt(a)),children:[e.jsx(ee,{id:"subject",children:e.jsx(se,{placeholder:"Pilih Mata Pelajaran"})}),e.jsx(ae,{children:g.map(a=>e.jsx(h,{value:a.id.toString(),children:a.name},a.id))})]}),u.subject_id&&e.jsx("div",{className:"text-sm text-red-500",children:u.subject_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{htmlFor:"description",children:"Deskripsi"}),e.jsx(Me,{id:"description",value:f.description,onChange:a=>v("description",a.target.value),placeholder:"Deskripsi singkat bank soal..."}),u.description&&e.jsx("div",{className:"text-sm text-red-500",children:u.description})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Publik"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Izinkan bank soal ini diakses oleh guru lain."})]}),e.jsx(Ae,{checked:f.is_public,onCheckedChange:a=>v("is_public",a)})]})]})]})]}),e.jsxs(c,{onClick:X,children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Buat Exam"]}),e.jsxs(c,{onClick:C,disabled:b||!E,children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Simpan"]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6 bg-muted/10",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(le,{className:"border-primary/20",children:e.jsxs(ne,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(de,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Generator Soal AI"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(o,{htmlFor:"topic",children:"Topik Soal"}),e.jsx(G,{id:"topic",value:r.data.topic,onChange:a=>r.setData("topic",a.target.value),placeholder:"Contoh: Sistem Pernapasan Manusia",required:!0}),r.errors.topic&&e.jsx("div",{className:"text-sm text-red-500",children:r.errors.topic})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"question_type",children:"Tipe Soal"}),e.jsxs(q,{value:r.data.question_type,onValueChange:a=>r.setData("question_type",a),children:[e.jsx(ee,{id:"question_type",children:e.jsx(se,{placeholder:"Pilih Tipe Soal"})}),e.jsxs(ae,{children:[e.jsx(h,{value:"multiple_choice",children:"Pilihan Ganda (Tunggal)"}),e.jsx(h,{value:"true_false",children:"Benar/Salah"}),e.jsx(h,{value:"essay",children:"Esai/Uraian"}),e.jsx(h,{value:"matching",children:"Menjodohkan"}),e.jsx(h,{value:"ordering",children:"Mengurutkan"}),e.jsx(h,{value:"multiple_selection",children:"Pilihan Ganda Kompleks"}),e.jsx(h,{value:"numerical_input",children:"Input Angka"}),e.jsx(h,{value:"arrange_words",children:"Susun Kata"})]})]}),r.errors.question_type&&e.jsx("div",{className:"text-sm text-red-500",children:r.errors.question_type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"count",children:"Jumlah Soal"}),e.jsx(G,{id:"count",type:"number",min:"1",max:"5",value:r.data.count,onChange:a=>r.setData("count",parseInt(a.target.value)),required:!0}),r.errors.count&&e.jsx("div",{className:"text-sm text-red-500",children:r.errors.count})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"difficulty",children:"Tingkat Kesulitan"}),e.jsxs(q,{value:r.data.difficulty,onValueChange:a=>r.setData("difficulty",a),children:[e.jsx(ee,{id:"difficulty",children:e.jsx(se,{placeholder:"Pilih Kesulitan"})}),e.jsxs(ae,{children:[e.jsx(h,{value:"mudah",children:"Mudah"}),e.jsx(h,{value:"sedang",children:"Sedang"}),e.jsx(h,{value:"sulit",children:"Sulit"})]})]}),r.errors.difficulty&&e.jsx("div",{className:"text-sm text-red-500",children:r.errors.difficulty})]})]}),e.jsx(c,{type:"submit",disabled:r.processing||m,className:"w-full sm:w-auto",children:m?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4 animate-spin"}),"Sedang Membuat Soal..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),r.processing?"Mengirim...":"Generate Soal dengan AI"]})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ðŸ’¡ AI akan membuat soal berdasarikan topik dan parameter yang Anda berikan. Proses ini mungkin memakan waktu beberapa menit."})]})]})}),m&&e.jsx(le,{className:"border-blue-500 bg-blue-50 dark:bg-blue-950/20",children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-5 w-5 text-blue-500 animate-spin"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"AI sedang membuat soal..."}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Mohon tunggu, soal akan muncul otomatis ketika selesai. Tidak perlu reload halaman."})]})]})})}),s.length>0&&e.jsx(le,{className:"border-purple-500/20",children:e.jsx(ne,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generator Tag AI"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Buat tag otomatis untuk semua pertanyaan (",s.length," soal)"]})]})]}),e.jsx(c,{onClick:x,disabled:_,variant:"outline",className:"border-purple-500 text-purple-700 hover:bg-purple-50 dark:hover:bg-purple-950",children:_?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4 animate-spin"}),"Sedang Membuat Tag..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Generate Tag dengan AI"]})})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-bold tracking-tight",children:["Daftar Pertanyaan (",s.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{questionBankId:i.id}),e.jsx(c,{size:"sm",variant:"outline",asChild:!0,children:e.jsx(ie,{href:`${B.create().url}?question_bank_id=${i.id}`,children:"Tambah Pertanyaan"})})]})]}),s.length>0?e.jsx(Oe,{sensors:Y,collisionDetection:Ke,onDragEnd:W,children:e.jsx(Ve,{items:P.map(a=>a.id),strategy:He,children:e.jsxs("div",{className:"space-y-4 pl-8",children:[" ",P.map((a,l)=>e.jsxs("div",{children:[e.jsx(ts,{id:`question-${a.id}`,question:a,onUpdate:De,onDelete:Ie,onEdit:n=>M.visit(B.edit(n.id).url)}),e.jsx(Te,{order:l+2})]},a.id))]})})}):e.jsx(le,{className:"min-h-[300px] flex items-center justify-center border-dashed",children:e.jsxs(ne,{className:"text-center text-muted-foreground",children:[e.jsx("p",{children:"Belum ada pertanyaan di bank soal ini."}),e.jsx(c,{variant:"link",className:"mt-2",asChild:!0,children:e.jsx(ie,{href:`${B.create().url}?question_bank_id=${i.id}`,children:"Buat Pertanyaan Baru"})})]})})]})}),e.jsx(ge,{open:p,onOpenChange:I,children:e.jsx(je,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:K,children:[e.jsxs(xe,{children:[e.jsx(he,{className:"text-xl font-bold",children:"Buat Exam Baru"}),e.jsxs(pe,{children:['Buat exam baru dari bank soal "',i.name,'"']})]}),z?e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:"Loading..."}):j?e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Judul Exam"}),e.jsx(G,{value:t.data.title,onChange:a=>t.setData("title",a.target.value),placeholder:"Nama exam..."}),e.jsx(Q,{message:t.errors.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Kelas"}),e.jsx(Ge,{options:j.grades.map(a=>({label:a.name,value:a.id.toString()})),value:t.data.grade_ids,onChange:a=>t.setData("grade_ids",a),placeholder:"Pilih Kelas"}),e.jsx(Q,{message:t.errors.grade_ids})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Tahun Ajaran"}),e.jsxs(q,{value:t.data.academic_year_id,onValueChange:a=>t.setData("academic_year_id",a),children:[e.jsx(ee,{children:e.jsx(se,{placeholder:"Pilih Tahun Ajaran"})}),e.jsx(ae,{children:j.academicYears.map(a=>e.jsxs(h,{value:a.id.toString(),children:[a.year," ",a.is_active&&"(Aktif)"]},a.id))})]}),e.jsx(Q,{message:t.errors.academic_year_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Tipe Exam"}),e.jsxs(q,{value:t.data.exam_type,onValueChange:a=>t.setData("exam_type",a),children:[e.jsx(ee,{children:e.jsx(se,{placeholder:"Pilih Tipe"})}),e.jsx(ae,{children:j.examTypes.map(a=>e.jsx(h,{value:a,children:a},a))})]}),e.jsx(Q,{message:t.errors.exam_type})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Waktu Mulai"}),e.jsx(G,{type:"datetime-local",value:t.data.start_time,onChange:a=>t.setData("start_time",a.target.value)}),e.jsx(Q,{message:t.errors.start_time})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Waktu Selesai"}),e.jsx(G,{type:"datetime-local",value:t.data.end_time,onChange:a=>t.setData("end_time",a.target.value)}),e.jsx(Q,{message:t.errors.end_time})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs text-muted-foreground",children:"Durasi Cepat (dari waktu mulai)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:()=>O(1),children:"1 Hari"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:()=>O(3),children:"3 Hari"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:()=>O(7),children:"1 Minggu"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:()=>O(14),children:"2 Minggu"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Durasi (menit)"}),e.jsx(G,{type:"number",value:t.data.duration,onChange:a=>t.setData("duration",parseInt(a.target.value))}),e.jsx(Q,{message:t.errors.duration})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Passing Score (%)"}),e.jsx(G,{type:"number",value:t.data.passing_score,onChange:a=>t.setData("passing_score",parseInt(a.target.value))}),e.jsx(Q,{message:t.errors.passing_score})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"is_randomized",checked:t.data.is_randomized,onCheckedChange:a=>t.setData("is_randomized",!!a)}),e.jsx("label",{htmlFor:"is_randomized",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acak Urutan Soal"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"is_answer_randomized",checked:t.data.is_answer_randomized,onCheckedChange:a=>t.setData("is_answer_randomized",!!a)}),e.jsx("label",{htmlFor:"is_answer_randomized",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acak Urutan Jawaban"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"show_result_on_finish",checked:t.data.show_result_on_finish,onCheckedChange:a=>t.setData("show_result_on_finish",!!a)}),e.jsx("label",{htmlFor:"show_result_on_finish",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tampilkan Nilai Diahir"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"is_hint_visible",checked:t.data.is_hint_visible,onCheckedChange:a=>t.setData("is_hint_visible",!!a)}),e.jsx("label",{htmlFor:"is_hint_visible",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tampilkan Hint/Bantuan"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{id:"is_published",checked:t.data.is_published,onCheckedChange:a=>t.setData("is_published",!!a)}),e.jsx("label",{htmlFor:"is_published",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Publish Exam"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Max Attempts (kosongkan untuk unlimited)"}),e.jsx(G,{type:"number",min:"1",value:t.data.max_attempts||"",onChange:a=>t.setData("max_attempts",a.target.value?parseInt(a.target.value):null),placeholder:"Unlimited"}),e.jsx(Q,{message:t.errors.max_attempts})]}),e.jsx(Qe,{value:t.data.timer_type,onValueChange:a=>t.setData("timer_type",a),timerTypes:j?.timerTypes,error:t.errors.timer_type}),e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Mata Pelajaran:"})," ",i.subject?.name||"-"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Guru:"})," ",i.teacher?.name||"-"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Bank Soal:"})," ",i.name]})]})]}):e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:"Gagal memuat data form"}),e.jsxs(ze,{children:[e.jsx(c,{type:"button",variant:"outline",onClick:()=>I(!1),children:"Batal"}),e.jsx(c,{type:"submit",disabled:t.processing||z,children:t.processing?"Menyimpan...":"Buat Exam"})]})]})})})]})}export{da as default};

import{r as j,u as Q,j as e,H as G,L as g,b}from"./app-BL23_ioL.js";import{A as V}from"./app-shell-jJUctm17.js";import{c as U,B as i}from"./button-ErPUhfKM.js";import{C as N,b as y,c as C,a as D}from"./card-BPYLlYs-.js";import{B as w}from"./badge-J0MIFrA3.js";import{Q as f}from"./QuestionBankController-VWCdcKL6.js";import{E as p}from"./ExamController-DtW2Bo6_.js";import{Q as Y}from"./QuestionCard-DTifsxyQ.js";import{f as J,e as K,b as W,c as R,d as X,D as Z}from"./dialog-CUguBIrB.js";import{I as m}from"./input-CZPc4iR6.js";import{L as r}from"./label-CDDyI8HS.js";import{S,a as k,b as T,c as z,d as E}from"./select-1dTW8A67.js";import{C as o}from"./checkbox-BB3F9eKw.js";import{M as $,T as B}from"./multi-select-DEcOG2nf.js";import{I as d}from"./input-error-lmp1hJdo.js";import"./MathRenderer-Dmg9cVUs.js";import{A as q}from"./arrow-left-DtOF6xQY.js";import{S as ee}from"./square-pen-BLYf6IE4.js";import{P as ae}from"./plus-BCgrxRhX.js";import{L as se}from"./lock-CNSyMQu5.js";/* empty css            */import"./sheet-CAKOvksQ.js";import"./index-CuzgK42c.js";import"./index-DuTHxAZ2.js";import"./index-DFAfDP5U.js";import"./index-BoQRUedT.js";import"./x-Bvzm8Mbo.js";import"./index-CneOgjps.js";import"./index-Uqd2XL9l.js";import"./index-DW9AIAM8.js";import"./ScoreSelector-DIAoZ7CZ.js";import"./clock-C56MbyDU.js";import"./star-CKh0qepW.js";import"./RichTextEditor-BBqXt6Vd.js";import"./index-CCL8Hooa.js";import"./style-CnmbGnv_.js";import"./circle-check-DAVIKFey.js";import"./square-check-big-CfvcNerE.js";import"./square-DDqxBGSL.js";import"./grip-vertical-CIej0FFK.js";import"./trash-2-BZUYrCA3.js";import"./index-BdQq_4o_.js";import"./index-CQgWKaQN.js";import"./index-BzB_uvRg.js";import"./chevron-down-sjlZp7h5.js";import"./switch-CId34p76.js";import"./zap-CDxo6CBz.js";import"./dropdown-menu-CNt4bR-q.js";import"./index-e0nZHYEA.js";const te=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ie=U("Globe",te);function ea({questionBank:t,questions:u}){const[I,x]=j.useState(!1),[c,P]=j.useState(null),[v,_]=j.useState(!1),A=()=>new Date().toISOString().slice(0,16),F=()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().slice(0,16)},s=Q({academic_year_id:"",grade_ids:t.subject.grade?.id?[t.subject.grade.id.toString()]:[],subject_id:t.subject_id.toString(),teacher_id:t.teacher.id.toString(),question_bank_id:t.id.toString(),title:t.name,exam_type:"daily",duration:60,is_published:!0,is_randomized:!0,is_answer_randomized:!1,is_hint_visible:!1,show_result_on_finish:!0,max_attempts:null,timer_type:"flexible",passing_score:70,start_time:A(),end_time:F()}),M=async()=>{_(!0);try{const n=await(await fetch(p.create.url())).json();P(n);const l=n.academicYears.find(H=>H.is_active);l&&s.setData("academic_year_id",l.id.toString())}catch(a){console.error("Failed to load form data:",a)}finally{_(!1)}},h=a=>{const n=new Date(s.data.start_time),l=new Date(n);l.setDate(l.getDate()+a),s.setData("end_time",l.toISOString().slice(0,16))},L=()=>{x(!0),c||M()},O=a=>{a.preventDefault(),s.post(p.store.url(),{onSuccess:n=>{x(!1),s.reset();const l=n.props.exam?.id;l?b.visit(p.monitor(l).url):b.visit(p.index().url)}})};return e.jsxs(V,{variant:"header",children:[e.jsx(G,{title:t.name}),e.jsxs("div",{className:"sticky top-0 z-50 flex h-16 items-center gap-4 border-b bg-background px-6 shadow-sm",children:[e.jsx(i,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(g,{href:f.index().url,children:e.jsx(q,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"text-lg font-semibold",children:t.name})}),e.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(g,{href:f.edit(t.id).url,children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Edit"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6 bg-muted/10",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs(N,{children:[e.jsxs(y,{className:"flex flex-row items-start justify-between space-y-0 pb-4",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsx(C,{className:"text-2xl font-bold",children:"Informasi Bank Soal"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Detail dan informasi terkait bank soal ini"})]}),e.jsxs(i,{onClick:L,children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Buat Exam dari Bank Soal"]})]}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Nama"}),e.jsx("div",{className:"text-base font-semibold",children:t.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Mata Pelajaran"}),e.jsxs("div",{className:"text-base",children:[t.subject.name,t.subject.grade&&e.jsxs("span",{className:"text-muted-foreground",children:[" - ",t.subject.grade.name]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Pembuat"}),e.jsxs("div",{className:"text-base",children:[e.jsx("div",{className:"font-medium",children:t.teacher.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.teacher.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{children:t.is_public?e.jsxs(w,{variant:"outline",className:"gap-1",children:[e.jsx(ie,{className:"h-3 w-3"}),"Publik"]}):e.jsxs(w,{variant:"secondary",className:"gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),"Privat"]})})]})]}),t.description&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Deskripsi"}),e.jsx("div",{className:"text-base text-muted-foreground bg-muted/50 rounded-md p-4",children:t.description})]})]})]}),e.jsxs(N,{children:[e.jsx(y,{children:e.jsxs(C,{className:"text-xl font-bold",children:["Daftar Pertanyaan (",u.length,")"]})}),e.jsx(D,{children:u.length>0?e.jsx("div",{className:"space-y-4",children:u.map((a,n)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-3 top-4 z-10",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-semibold text-sm shadow-md",children:n+1})}),e.jsx("div",{className:"ml-6",children:e.jsx(Y,{question:a,readOnly:!0})})]},a.id))}):e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx("p",{children:"Belum ada pertanyaan di bank soal ini."}),e.jsx(i,{variant:"link",className:"mt-2",asChild:!0,children:e.jsx(g,{href:f.edit(t.id).url,children:"Tambah Pertanyaan"})})]})})]})]})}),e.jsx(J,{open:I,onOpenChange:x,children:e.jsx(K,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:O,children:[e.jsxs(W,{children:[e.jsx(R,{className:"text-xl font-bold",children:"Buat Exam Baru"}),e.jsxs(X,{children:['Buat exam baru dari bank soal "',t.name,'"']})]}),v?e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:"Loading..."}):c?e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Judul Exam"}),e.jsx(m,{value:s.data.title,onChange:a=>s.setData("title",a.target.value),placeholder:"Nama exam..."}),e.jsx(d,{message:s.errors.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Kelas"}),e.jsx($,{options:c.grades.map(a=>({label:a.name,value:a.id.toString()})),value:s.data.grade_ids,onChange:a=>s.setData("grade_ids",a),placeholder:"Pilih Kelas"}),e.jsx(d,{message:s.errors.grade_ids})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Tahun Ajaran"}),e.jsxs(S,{value:s.data.academic_year_id,onValueChange:a=>s.setData("academic_year_id",a),children:[e.jsx(k,{children:e.jsx(T,{placeholder:"Pilih Tahun Ajaran"})}),e.jsx(z,{children:c.academicYears.map(a=>e.jsxs(E,{value:a.id.toString(),children:[a.year," ",a.is_active&&"(Aktif)"]},a.id))})]}),e.jsx(d,{message:s.errors.academic_year_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Tipe Exam"}),e.jsxs(S,{value:s.data.exam_type,onValueChange:a=>s.setData("exam_type",a),children:[e.jsx(k,{children:e.jsx(T,{placeholder:"Pilih Tipe"})}),e.jsx(z,{children:c.examTypes.map(a=>e.jsx(E,{value:a,children:a},a))})]}),e.jsx(d,{message:s.errors.exam_type})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Waktu Mulai"}),e.jsx(m,{type:"datetime-local",value:s.data.start_time,onChange:a=>s.setData("start_time",a.target.value)}),e.jsx(d,{message:s.errors.start_time})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Waktu Selesai"}),e.jsx(m,{type:"datetime-local",value:s.data.end_time,onChange:a=>s.setData("end_time",a.target.value)}),e.jsx(d,{message:s.errors.end_time})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"text-xs text-muted-foreground",children:"Durasi Cepat (dari waktu mulai)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{type:"button",variant:"outline",size:"sm",onClick:()=>h(1),children:"1 Hari"}),e.jsx(i,{type:"button",variant:"outline",size:"sm",onClick:()=>h(3),children:"3 Hari"}),e.jsx(i,{type:"button",variant:"outline",size:"sm",onClick:()=>h(7),children:"1 Minggu"}),e.jsx(i,{type:"button",variant:"outline",size:"sm",onClick:()=>h(14),children:"2 Minggu"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Durasi (menit)"}),e.jsx(m,{type:"number",value:s.data.duration,onChange:a=>s.setData("duration",parseInt(a.target.value))}),e.jsx(d,{message:s.errors.duration})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Passing Score (%)"}),e.jsx(m,{type:"number",value:s.data.passing_score,onChange:a=>s.setData("passing_score",parseInt(a.target.value))}),e.jsx(d,{message:s.errors.passing_score})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"is_randomized",checked:s.data.is_randomized,onCheckedChange:a=>s.setData("is_randomized",!!a)}),e.jsx("label",{htmlFor:"is_randomized",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acak Urutan Soal"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"is_answer_randomized",checked:s.data.is_answer_randomized,onCheckedChange:a=>s.setData("is_answer_randomized",!!a)}),e.jsx("label",{htmlFor:"is_answer_randomized",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Acak Urutan Jawaban"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"show_result_on_finish",checked:s.data.show_result_on_finish,onCheckedChange:a=>s.setData("show_result_on_finish",!!a)}),e.jsx("label",{htmlFor:"show_result_on_finish",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tampilkan Nilai Diahir"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"is_hint_visible",checked:s.data.is_hint_visible,onCheckedChange:a=>s.setData("is_hint_visible",!!a)}),e.jsx("label",{htmlFor:"is_hint_visible",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tampilkan Hint/Bantuan"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{id:"is_published",checked:s.data.is_published,onCheckedChange:a=>s.setData("is_published",!!a)}),e.jsx("label",{htmlFor:"is_published",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Publish Exam"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Max Attempts (kosongkan untuk unlimited)"}),e.jsx(m,{type:"number",min:"1",value:s.data.max_attempts||"",onChange:a=>s.setData("max_attempts",a.target.value?parseInt(a.target.value):null),placeholder:"Unlimited"}),e.jsx(d,{message:s.errors.max_attempts})]}),e.jsx(B,{value:s.data.timer_type,onValueChange:a=>s.setData("timer_type",a),timerTypes:c?.timerTypes,error:s.errors.timer_type}),e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Mata Pelajaran:"})," ",t.subject.name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Guru:"})," ",t.teacher.name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Bank Soal:"})," ",t.name]})]})]}):e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:"Gagal memuat data form"}),e.jsxs(Z,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Batal"}),e.jsx(i,{type:"submit",disabled:s.processing||v,children:s.processing?"Menyimpan...":"Buat Exam"})]})]})})})]})}export{ea as default};
